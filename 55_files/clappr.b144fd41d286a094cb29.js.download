(this.webpackJsonpLivePlayer=this.webpackJsonpLivePlayer||[]).push([[0],{1:function(e,t,r){!function(Qi){e.exports=function(){"use strict";function M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function F(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2)M(Object(r),true).forEach(function(e){B(t,e,r[e])});else if(Object.getOwnPropertyDescriptors)Object.defineProperties(t,Object.getOwnPropertyDescriptors(r));else M(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function B(e,t,r){if(t in e)Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});else e[t]=r;return e}function U(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol")U=function(e){return typeof e};else U=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return U(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function c(e,t,r){if(t)j(e.prototype,t);if(r)j(e,r);return e}function V(e,t,r){if(t in e)Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});else e[t]=r;return e}function G(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function K(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2)G(Object(r),true).forEach(function(e){V(t,e,r[e])});else if(Object.getOwnPropertyDescriptors)Object.defineProperties(t,Object.getOwnPropertyDescriptors(r));else G(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function d(e,t){if(typeof t!=="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)Y(e,t)}function s(e){s=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return s(e)}function Y(e,t){Y=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return Y(e,t)}function H(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t){if(t&&(typeof t==="object"||typeof t==="function"))return t;return z(e)}function f(i){var a=H();return function e(){var t=s(i),r;if(a){var n=s(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return $(this,r)}}function W(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=s(e);if(e===null)break}return e}function q(e,t,r){if(typeof Reflect!=="undefined"&&Reflect.get)q=Reflect.get;else q=function e(t,r,n){var i=W(t,r);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,r);if(a.get)return a.get.call(n);return a.value};return q(e,t,r||e)}function X(e,t){return J(e)||te(e,t)||re(e,t)||ae()}function Z(e){return Q(e)||ee(e)||re(e)||ie()}function Q(e){if(Array.isArray(e))return ne(e)}function J(e){if(Array.isArray(e))return e}function ee(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function te(e,t){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(e)))return;var r=[];var n=true;var i=false;var a=undefined;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done);n=true){r.push(o.value);if(t&&r.length===t)break}}catch(e){i=true;a=e}finally{try{if(!n&&s["return"]!=null)s["return"]()}finally{if(i)throw a}}return r}function re(e,t){if(!e)return;if(typeof e==="string")return ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ne(e,t)}function ne(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ie(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ae(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function se(e,t){var r;if(typeof Symbol==="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(r=re(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var n=0;var i=function(){};return{s:i,n:function(){if(n>=e.length)return{done:true};return{done:false,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a=true,s=false,o;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();a=e.done;return e},e:function(e){s=true;o=e},f:function(){try{if(!a&&r.return!=null)r.return()}finally{if(s)throw o}}}}if(!Array.prototype.find)Object.defineProperty(Array.prototype,"find",{value:function e(t){if(this==null)throw new TypeError('"this" is null or not defined');var r=Object(this);var n=r.length>>>0;if(typeof t!=="function")throw new TypeError("predicate must be a function");var i=arguments[1];var a=0;while(a<n){var s=r[a];if(t.call(i,s,a,r))return s;a++}return undefined}});if(!Object.entries)Object.entries=function(e){var t=Object.keys(e),r=t.length,n=new Array(r);while(r--)n[r]=[t[r],e[t[r]]];return n};if(!Object.values)Object.values=function(e){var t=Object.keys(e),r=t.length,n=new Array(r);while(r--)n[r]=e[t[r]];return n};if(typeof Object.assign!="function")Object.defineProperty(Object,"assign",{value:function e(t,r){if(t==null)throw new TypeError("Cannot convert undefined or null to object");var n=Object(t);for(var i=1;i<arguments.length;i++){var a=arguments[i];if(a!=null)for(var s in a)if(Object.prototype.hasOwnProperty.call(a,s))n[s]=a[s]}return n},writable:true,configurable:true});if(!Array.prototype.findIndex)Object.defineProperty(Array.prototype,"findIndex",{value:function e(t){if(this==null)throw new TypeError('"this" is null or not defined');var r=Object(this);var n=r.length>>>0;if(typeof t!=="function")throw new TypeError("predicate must be a function");var i=arguments[1];var a=0;while(a<n){var s=r[a];if(t.call(i,s,a,r))return a;a++}return-1},configurable:true,writable:true});var oe,le={mp4:"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="},e=function(){var l,s,u,i,n=[],M=n.concat,a=n.filter,o=n.slice,c=window.document,d={},t={},F={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},f=/^\s*<(\w+|!)[^>]*>/,B=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,U=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,h=/^(?:body|html)$/i,j=/([A-Z])/g,V=["val","css","html","text","data","width","height","offset"],G=["after","prepend","before","append"],e=c.createElement("table"),r=c.createElement("tr"),p={tr:c.createElement("tbody"),tbody:e,thead:e,tfoot:e,td:r,th:r,"*":c.createElement("div")},K=/complete|loaded|interactive/,Y=/^[\w-]*$/,v={},H=v.toString,g={},A,m,y=c.createElement("div"),E={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},b=Array.isArray||function(e){return e instanceof Array};g.matches=function(e,t){if(!t||!e||e.nodeType!==1)return false;var r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(r)return r.call(e,t);var n,i=e.parentNode,a=!i;if(a)(i=y).appendChild(e);n=~g.qsa(i,t).indexOf(e);a&&y.removeChild(e);return n};function k(e){return e==null?String(e):v[H.call(e)]||"object"}function _(e){return k(e)=="function"}function T(e){return e!=null&&e==e.window}function S(e){return e!=null&&e.nodeType==e.DOCUMENT_NODE}function C(e){return k(e)=="object"}function R(e){return C(e)&&!T(e)&&Object.getPrototypeOf(e)==Object.prototype}function w(e){var t=!!e&&"length"in e&&e.length,r=u.type(e);return"function"!=r&&!T(e)&&("array"==r||t===0||typeof t=="number"&&t>0&&t-1 in e)}function z(e){return a.call(e,function(e){return e!=null})}function $(e){return e.length>0?u.fn.concat.apply([],e):e}A=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})};function O(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}m=function(r){return a.call(r,function(e,t){return r.indexOf(e)==t})};function L(e){return e in t?t[e]:t[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function I(e,t){return typeof t=="number"&&!F[O(e)]?t+"px":t}function W(e){var t,r;if(!d[e]){t=c.createElement(e);c.body.appendChild(t);r=getComputedStyle(t,"").getPropertyValue("display");t.parentNode.removeChild(t);r=="none"&&(r="block");d[e]=r}return d[e]}function q(e){return"children"in e?o.call(e.children):u.map(e.childNodes,function(e){if(e.nodeType==1)return e})}function X(e,t){var r,n=e?e.length:0;for(r=0;r<n;r++)this[r]=e[r];this.length=n;this.selector=t||""}g.fragment=function(e,t,r){var n,i,a;if(B.test(e))n=u(c.createElement(RegExp.$1));if(!n){if(e.replace)e=e.replace(U,"<$1></$2>");if(t===l)t=f.test(e)&&RegExp.$1;if(!(t in p))t="*";a=p[t];a.innerHTML=""+e;n=u.each(o.call(a.childNodes),function(){a.removeChild(this)})}if(R(r)){i=u(n);u.each(r,function(e,t){if(V.indexOf(e)>-1)i[e](t);else i.attr(e,t)})}return n};g.Z=function(e,t){return new X(e,t)};g.isZ=function(e){return e instanceof g.Z};g.init=function(e,t){var r;if(!e)return g.Z();else if(typeof e=="string"){e=e.trim();if(e[0]=="<"&&f.test(e))r=g.fragment(e,RegExp.$1,t),e=null;else if(t!==l)return u(t).find(e);else r=g.qsa(c,e)}else if(_(e))return u(c).ready(e);else if(g.isZ(e))return e;else if(b(e))r=z(e);else if(C(e))r=[e],e=null;else if(f.test(e))r=g.fragment(e.trim(),RegExp.$1,t),e=null;else if(t!==l)return u(t).find(e);else r=g.qsa(c,e);return g.Z(r,e)};u=function(e,t){return g.init(e,t)};function Z(e,t,r){for(s in t)if(r&&(R(t[s])||b(t[s]))){if(R(t[s])&&!R(e[s]))e[s]={};if(b(t[s])&&!b(e[s]))e[s]=[];Z(e[s],t[s],r)}else if(t[s]!==l)e[s]=t[s]}u.extend=function(t){var r,e=o.call(arguments,1);if(typeof t=="boolean"){r=t;t=e.shift()}e.forEach(function(e){Z(t,e,r)});return t};g.qsa=function(e,t){var r,n=t[0]=="#",i=!n&&t[0]==".",a=n||i?t.slice(1):t,s=Y.test(a);return e.getElementById&&s&&n?(r=e.getElementById(a))?[r]:[]:e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11?[]:o.call(s&&!n&&e.getElementsByClassName?i?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))};function D(e,t){return t==null?u(e):u(e).filter(t)}u.contains=c.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){while(t&&(t=t.parentNode))if(t===e)return true;return false};function P(e,t,r,n){return _(t)?t.call(e,r,n):t}function N(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function x(e,t){var r=e.className||"",n=r&&r.baseVal!==l;if(t===l)return n?r.baseVal:r;n?r.baseVal=t:e.className=t}function Q(t){try{return t?t=="true"||(t=="false"?false:t=="null"?null:+t+""==t?+t:/^[\[\{]/.test(t)?u.parseJSON(t):t):t}catch(e){return t}}u.type=k;u.isFunction=_;u.isWindow=T;u.isArray=b;u.isPlainObject=R;u.isEmptyObject=function(e){var t;for(t in e)return false;return true};u.isNumeric=function(e){var t=Number(e),r=typeof e;return e!=null&&r!="boolean"&&(r!="string"||e.length)&&!isNaN(t)&&isFinite(t)||false};u.inArray=function(e,t,r){return n.indexOf.call(t,e,r)};u.camelCase=A;u.trim=function(e){return e==null?"":String.prototype.trim.call(e)};u.uuid=0;u.support={};u.expr={};u.noop=function(){};u.map=function(e,t){var r,n=[],i,a;if(w(e))for(i=0;i<e.length;i++){r=t(e[i],i);if(r!=null)n.push(r)}else for(a in e){r=t(e[a],a);if(r!=null)n.push(r)}return $(n)};u.each=function(e,t){var r,n;if(w(e)){for(r=0;r<e.length;r++)if(t.call(e[r],r,e[r])===false)return e}else for(n in e)if(t.call(e[n],n,e[n])===false)return e;return e};u.grep=function(e,t){return a.call(e,t)};if(window.JSON)u.parseJSON=JSON.parse;u.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){v["[object "+t+"]"]=t.toLowerCase()});u.fn={constructor:g.Z,length:0,forEach:n.forEach,reduce:n.reduce,push:n.push,sort:n.sort,splice:n.splice,indexOf:n.indexOf,concat:function(){var e,t,r=[];for(e=0;e<arguments.length;e++){t=arguments[e];r[e]=g.isZ(t)?t.toArray():t}return M.apply(g.isZ(this)?this.toArray():this,r)},map:function(r){return u(u.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return u(o.apply(this,arguments))},ready:function(e){if(K.test(c.readyState)&&c.body)e(u);else c.addEventListener("DOMContentLoaded",function(){e(u)},false);return this},get:function(e){return e===l?o.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){if(this.parentNode!=null)this.parentNode.removeChild(this)})},each:function(r){n.every.call(this,function(e,t){return r.call(e,t,e)!==false});return this},filter:function(t){if(_(t))return this.not(this.not(t));return u(a.call(this,function(e){return g.matches(e,t)}))},add:function(e,t){return u(m(this.concat(u(e,t))))},is:function(e){return this.length>0&&g.matches(this[0],e)},not:function(t){var r=[];if(_(t)&&t.call!==l)this.each(function(e){if(!t.call(this,e))r.push(this)});else{var n=typeof t=="string"?this.filter(t):w(t)&&_(t.item)?o.call(t):u(t);this.forEach(function(e){if(n.indexOf(e)<0)r.push(e)})}return u(r)},has:function(e){return this.filter(function(){return C(e)?u.contains(this,e):u(this).find(e).size()})},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!C(e)?e:u(e)},last:function(){var e=this[this.length-1];return e&&!C(e)?e:u(e)},find:function(e){var t,r=this;if(!e)t=u();else if(typeof e=="object")t=u(e).filter(function(){var t=this;return n.some.call(r,function(e){return u.contains(e,t)})});else if(this.length==1)t=u(g.qsa(this[0],e));else t=this.map(function(){return g.qsa(this,e)});return t},closest:function(r,n){var i=[],a=typeof r=="object"&&u(r);this.each(function(e,t){while(t&&!(a?a.indexOf(t)>=0:g.matches(t,r)))t=t!==n&&!S(t)&&t.parentNode;if(t&&i.indexOf(t)<0)i.push(t)});return u(i)},parents:function(e){var t=[],r=this;while(r.length>0)r=u.map(r,function(e){if((e=e.parentNode)&&!S(e)&&t.indexOf(e)<0){t.push(e);return e}});return D(t,e)},parent:function(e){return D(m(this.pluck("parentNode")),e)},children:function(e){return D(this.map(function(){return q(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||o.call(this.childNodes)})},siblings:function(e){return D(this.map(function(e,t){return a.call(q(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return u.map(this,function(e){return e[t]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display="");if(getComputedStyle(this,"").getPropertyValue("display")=="none")this.style.display=W(this.nodeName)})},replaceWith:function(e){return this.before(e).remove()},wrap:function(t){var r=_(t);if(this[0]&&!r)var n=u(t).get(0),i=n.parentNode||this.length>1;return this.each(function(e){u(this).wrapAll(r?t.call(this,e):i?n.cloneNode(true):n)})},wrapAll:function(e){if(this[0]){u(this[0]).before(e=u(e));var t;while((t=e.children()).length)e=t.first();u(e).append(this)}return this},wrapInner:function(i){var a=_(i);return this.each(function(e){var t=u(this),r=t.contents(),n=a?i.call(this,e):i;r.length?r.wrapAll(n):t.append(n)})},unwrap:function(){this.parent().each(function(){u(this).replaceWith(u(this).children())});return this},clone:function(){return this.map(function(){return this.cloneNode(true)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=u(this);(t===l?e.css("display")=="none":t)?e.show():e.hide()})},prev:function(e){return u(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return u(this.pluck("nextElementSibling")).filter(e||"*")},html:function(r){return 0 in arguments?this.each(function(e){var t=this.innerHTML;u(this).empty().append(P(this,r,e,t))}):0 in this?this[0].innerHTML:null},text:function(r){return 0 in arguments?this.each(function(e){var t=P(this,r,e,this.textContent);this.textContent=t==null?"":""+t}):0 in this?this.pluck("textContent").join(""):null},attr:function(t,r){var e;return typeof t=="string"&&!(1 in arguments)?0 in this&&this[0].nodeType==1&&(e=this[0].getAttribute(t))!=null?e:l:this.each(function(e){if(this.nodeType!==1)return;if(C(t))for(s in t)N(this,s,t[s]);else N(this,t,P(this,r,e,this.getAttribute(t)))})},removeAttr:function(e){return this.each(function(){this.nodeType===1&&e.split(" ").forEach(function(e){N(this,e)},this)})},prop:function(t,r){t=E[t]||t;return 1 in arguments?this.each(function(e){this[t]=P(this,r,e,this[t])}):this[0]&&this[0][t]},removeProp:function(e){e=E[e]||e;return this.each(function(){delete this[e]})},data:function(e,t){var r="data-"+e.replace(j,"-$1").toLowerCase();var n=1 in arguments?this.attr(r,t):this.attr(r);return n!==null?Q(n):l},val:function(t){if(0 in arguments){if(t==null)t="";return this.each(function(e){this.value=P(this,t,e,this.value)})}else return this[0]&&(this[0].multiple?u(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(a){if(a)return this.each(function(e){var t=u(this),r=P(this,a,e,t.offset()),n=t.offsetParent().offset(),i={top:r.top-n.top,left:r.left-n.left};if(t.css("position")=="static")i["position"]="relative";t.css(i)});if(!this.length)return null;if(c.documentElement!==this[0]&&!u.contains(c.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,t){if(arguments.length<2){var r=this[0];if(typeof e=="string"){if(!r)return;return r.style[A(e)]||getComputedStyle(r,"").getPropertyValue(e)}else if(b(e)){if(!r)return;var n={};var i=getComputedStyle(r,"");u.each(e,function(e,t){n[t]=r.style[A(t)]||i.getPropertyValue(t)});return n}}var a="";if(k(e)=="string")if(!t&&t!==0)this.each(function(){this.style.removeProperty(O(e))});else a=O(e)+":"+I(e,t);else for(s in e)if(!e[s]&&e[s]!==0)this.each(function(){this.style.removeProperty(O(s))});else a+=O(s)+":"+I(s,e[s])+";";return this.each(function(){this.style.cssText+=";"+a})},index:function(e){return e?this.indexOf(u(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){if(!e)return false;return n.some.call(this,function(e){return this.test(x(e))},L(e))},addClass:function(n){if(!n)return this;return this.each(function(e){if(!("className"in this))return;i=[];var t=x(this),r=P(this,n,e,t);r.split(/\s+/g).forEach(function(e){if(!u(this).hasClass(e))i.push(e)},this);i.length&&x(this,t+(t?" ":"")+i.join(" "))})},removeClass:function(t){return this.each(function(e){if(!("className"in this))return;if(t===l)return x(this,"");i=x(this);P(this,t,e,i).split(/\s+/g).forEach(function(e){i=i.replace(L(e)," ")});x(this,i.trim())})},toggleClass:function(n,i){if(!n)return this;return this.each(function(e){var t=u(this),r=P(this,n,e,x(this));r.split(/\s+/g).forEach(function(e){(i===l?!t.hasClass(e):i)?t.addClass(e):t.removeClass(e)})})},scrollTop:function(e){if(!this.length)return;var t="scrollTop"in this[0];if(e===l)return t?this[0].scrollTop:this[0].pageYOffset;return this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})},scrollLeft:function(e){if(!this.length)return;var t="scrollLeft"in this[0];if(e===l)return t?this[0].scrollLeft:this[0].pageXOffset;return this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})},position:function(){if(!this.length)return;var e=this[0],t=this.offsetParent(),r=this.offset(),n=h.test(t[0].nodeName)?{top:0,left:0}:t.offset();r.top-=parseFloat(u(e).css("margin-top"))||0;r.left-=parseFloat(u(e).css("margin-left"))||0;n.top+=parseFloat(u(t[0]).css("border-top-width"))||0;n.left+=parseFloat(u(t[0]).css("border-left-width"))||0;return{top:r.top-n.top,left:r.left-n.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||c.body;while(e&&!h.test(e.nodeName)&&u(e).css("position")=="static")e=e.offsetParent;return e})}};u.fn.detach=u.fn.remove;["width","height"].forEach(function(n){var i=n.replace(/./,function(e){return e[0].toUpperCase()});u.fn[n]=function(t){var e,r=this[0];if(t===l)return T(r)?r["inner"+i]:S(r)?r.documentElement["scroll"+i]:(e=this.offset())&&e[n];else return this.each(function(e){r=u(this);r.css(n,P(this,t,e,r[n]()))})}});function J(e,t){t(e);for(var r=0,n=e.childNodes.length;r<n;r++)J(e.childNodes[r],t)}G.forEach(function(t,s){var o=s%2;u.fn[t]=function(){var r,n=u.map(arguments,function(e){var t=[];r=k(e);if(r=="array"){e.forEach(function(e){if(e.nodeType!==l)return t.push(e);else if(u.zepto.isZ(e))return t=t.concat(e.get());t=t.concat(g.fragment(e))});return t}return r=="object"||e==null?e:g.fragment(e)}),i,a=this.length>1;if(n.length<1)return this;return this.each(function(e,t){i=o?t:t.parentNode;t=s==0?t.nextSibling:s==1?t.firstChild:s==2?t:null;var r=u.contains(c.documentElement,i);n.forEach(function(e){if(a)e=e.cloneNode(true);else if(!i)return u(e).remove();i.insertBefore(e,t);if(r)J(e,function(e){if(e.nodeName!=null&&e.nodeName.toUpperCase()==="SCRIPT"&&(!e.type||e.type==="text/javascript")&&!e.src){var t=e.ownerDocument?e.ownerDocument.defaultView:window;t["eval"].call(t,e.innerHTML)}})})})};u.fn[o?t+"To":"insert"+(s?"Before":"After")]=function(e){u(e)[t](this);return this}});g.Z.prototype=X.prototype=u.fn;g.uniq=m;g.deserializeValue=Q;u.zepto=g;return u}(),v=(window.Zepto=e,window.$===undefined&&(window.$=e),e),ue=+new Date,ce=window.document,de,g,fe=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,he=/^(?:text|application)\/javascript/i,pe=/^(?:text|application)\/xml/i,ve="application/json",ge="text/html",Ae=/^\s*$/,me=ce.createElement("a");function ye(e,t,r){var n=v.Event(t);v(e).trigger(n,r);return!n.isDefaultPrevented()}function Ee(e,t,r,n){if(e.global)return ye(t||ce,r,n)}function be(e){if(e.global&&v.active++===0)Ee(e,null,"ajaxStart")}function ke(e){if(e.global&&!--v.active)Ee(e,null,"ajaxStop")}function _e(e,t){var r=t.context;if(t.beforeSend.call(r,e,t)===false||Ee(t,r,"ajaxBeforeSend",[e,t])===false)return false;Ee(t,r,"ajaxSend",[e,t])}function Te(e,t,r,n){var i=r.context,a="success";r.success.call(i,e,a,t);if(n)n.resolveWith(i,[e,a,t]);Ee(r,i,"ajaxSuccess",[t,r,e]);Ce(a,t,r)}function Se(e,t,r,n,i){var a=n.context;n.error.call(a,r,t,e);if(i)i.rejectWith(a,[r,t,e]);Ee(n,a,"ajaxError",[r,n,e||t]);Ce(t,r,n)}function Ce(e,t,r){var n=r.context;r.complete.call(n,t,e);Ee(r,n,"ajaxComplete",[t,r]);ke(r)}function Re(e,t,r){if(r.dataFilter==A)return e;var n=r.context;return r.dataFilter.call(n,e,t)}function A(){}function we(e){if(e)e=e.split(";",2)[0];return e&&(e==ge?"html":e==ve?"json":he.test(e)?"script":pe.test(e)&&"xml")||"text"}function Oe(e,t){if(t=="")return e;return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function Le(e){if(e.processData&&e.data&&v.type(e.data)!="string")e.data=v.param(e.data,e.traditional);if(e.data&&(!e.type||e.type.toUpperCase()=="GET"||"jsonp"==e.dataType))e.url=Oe(e.url,e.data),e.data=undefined}function Ie(e,t,r,n){if(v.isFunction(t))n=r,r=t,t=undefined;if(!v.isFunction(r))n=r,r=undefined;return{url:e,data:t,success:r,dataType:n}}me.href=window.location.href,v.active=0,v.ajaxJSONP=function(r,n){if(!("type"in r))return v.ajax(r);var e=r.jsonpCallback,i=(v.isFunction(e)?e():e)||"Zepto"+ue++,a=ce.createElement("script"),s=window[i],o,t=function(e){v(a).triggerHandler("error",e||"abort")},l={abort:t},u;if(n)n.promise(l);v(a).on("load error",function(e,t){clearTimeout(u);v(a).off().remove();if(e.type=="error"||!o)Se(null,t||"error",l,r,n);else Te(o[0],l,r,n);window[i]=s;if(o&&v.isFunction(s))s(o[0]);s=o=undefined});if(_e(l,r)===false){t("abort");return l}window[i]=function(){o=arguments};a.src=r.url.replace(/\?(.+)=\?/,"?$1="+i);ce.head.appendChild(a);if(r.timeout>0)u=setTimeout(function(){t("timeout")},r.timeout);return l},v.ajaxSettings={type:"GET",beforeSend:A,success:A,error:A,complete:A,context:null,global:true,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:ve,xml:"application/xml, text/xml",html:ge,text:"text/plain"},crossDomain:false,timeout:0,processData:true,cache:true,dataFilter:A},v.ajax=function(e){var r=v.extend({},e||{}),n=v.Deferred&&v.Deferred(),t,i;for(de in v.ajaxSettings)if(r[de]===undefined)r[de]=v.ajaxSettings[de];be(r);if(!r.crossDomain){t=ce.createElement("a");t.href=r.url;t.href=t.href;r.crossDomain=me.protocol+"//"+me.host!==t.protocol+"//"+t.host}if(!r.url)r.url=window.location.toString();if((i=r.url.indexOf("#"))>-1)r.url=r.url.slice(0,i);Le(r);var a=r.dataType,s=/\?.+=\?/.test(r.url);if(s)a="jsonp";if(r.cache===false||(!e||e.cache!==true)&&("script"==a||"jsonp"==a))r.url=Oe(r.url,"_="+Date.now());if("jsonp"==a){if(!s)r.url=Oe(r.url,r.jsonp?r.jsonp+"=?":r.jsonp===false?"":"callback=?");return v.ajaxJSONP(r,n)}var o=r.accepts[a],l={},u=function(e,t){l[e.toLowerCase()]=[e,t]},c=/^([\w-]+:)\/\//.test(r.url)?RegExp.$1:window.location.protocol,d=r.xhr(),f=d.setRequestHeader,h;if(n)n.promise(d);if(!r.crossDomain)u("X-Requested-With","XMLHttpRequest");u("Accept",o||"*/*");if(o=r.mimeType||o){if(o.indexOf(",")>-1)o=o.split(",",2)[0];d.overrideMimeType&&d.overrideMimeType(o)}if(r.contentType||r.contentType!==false&&r.data&&r.type.toUpperCase()!="GET")u("Content-Type",r.contentType||"application/x-www-form-urlencoded");if(r.headers)for(g in r.headers)u(g,r.headers[g]);d.setRequestHeader=u;d.onreadystatechange=function(){if(d.readyState==4){d.onreadystatechange=A;clearTimeout(h);var e,t=false;if(d.status>=200&&d.status<300||d.status==304||d.status==0&&c=="file:"){a=a||we(r.mimeType||d.getResponseHeader("content-type"));if(d.responseType=="arraybuffer"||d.responseType=="blob")e=d.response;else{e=d.responseText;try{e=Re(e,a,r);if(a=="script")(1,eval)(e);else if(a=="xml")e=d.responseXML;else if(a=="json")e=Ae.test(e)?null:v.parseJSON(e)}catch(e){t=e}if(t)return Se(t,"parsererror",d,r,n)}Te(e,d,r,n)}else Se(d.statusText||null,d.status?"error":"abort",d,r,n)}};if(_e(d,r)===false){d.abort();Se(null,"abort",d,r,n);return d}var p="async"in r?r.async:true;d.open(r.type,r.url,p,r.username,r.password);if(r.xhrFields)for(g in r.xhrFields)d[g]=r.xhrFields[g];for(g in l)f.apply(d,l[g]);if(r.timeout>0)h=setTimeout(function(){d.onreadystatechange=A;d.abort();Se(null,"timeout",d,r,n)},r.timeout);d.send(r.data?r.data:null);return d},v.get=function(){return v.ajax(Ie.apply(null,arguments))},v.post=function(){var e=Ie.apply(null,arguments);e.type="POST";return v.ajax(e)},v.getJSON=function(){var e=Ie.apply(null,arguments);e.dataType="json";return v.ajax(e)},v.fn.load=function(e,t,r){if(!this.length)return this;var n=this,i=e.split(/\s/),a,s=Ie(e,t,r),o=s.success;if(i.length>1)s.url=i[0],a=i[1];s.success=function(e){n.html(a?v("<div>").html(e.replace(fe,"")).find(a):e);o&&o.apply(n,arguments)};v.ajax(s);return this};var De=encodeURIComponent;function Pe(r,e,n,i){var a,s=v.isArray(e),o=v.isPlainObject(e);v.each(e,function(e,t){a=v.type(t);if(i)e=n?i:i+"["+(o||a=="object"||a=="array"?e:"")+"]";if(!i&&s)r.add(t.name,t.value);else if(a=="array"||!n&&a=="object")Pe(r,t,n,e);else r.add(e,t)})}v.param=function(e,t){var r=[];r.add=function(e,t){if(v.isFunction(t))t=t();if(t==null)t="";this.push(De(e)+"="+De(t))};Pe(r,e,t);return r.join("&").replace(/%20/g,"+")};var Ne=e,h=(Ne.Callbacks=function(n){n=Ne.extend({},n);var t,r,i,a,s,o,l=[],u=!n.once&&[],c=function(e){t=n.memory&&e;r=true;o=a||0;a=0;s=l.length;i=true;for(;l&&o<s;++o)if(l[o].apply(e[0],e[1])===false&&n.stopOnFalse){t=false;break}i=false;if(l)if(u)u.length&&c(u.shift());else if(t)l.length=0;else d.disable()},d={add:function(){if(l){var e=l.length,r=function(e){Ne.each(e,function(e,t){if(typeof t==="function"){if(!n.unique||!d.has(t))l.push(t)}else if(t&&t.length&&typeof t!=="string")r(t)})};r(arguments);if(i)s=l.length;else if(t){a=e;c(t)}}return this},remove:function(){if(l)Ne.each(arguments,function(e,t){var r;while((r=Ne.inArray(t,l,r))>-1){l.splice(r,1);if(i){if(r<=s)--s;if(r<=o)--o}}});return this},has:function(e){return!!(l&&(e?Ne.inArray(e,l)>-1:l.length))},empty:function(){s=l.length=0;return this},disable:function(){l=u=t=undefined;return this},disabled:function(){return!l},lock:function(){u=undefined;if(!t)d.disable();return this},locked:function(){return!u},fireWith:function(e,t){if(l&&(!r||u)){t=t||[];t=[e,t.slice?t.slice():t];if(i)u.push(t);else c(t)}return this},fire:function(){return d.fireWith(this,arguments)},fired:function(){return!!r}};return d},e),xe=Array.prototype.slice;function Me(e){var i=[["resolve","done",h.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",h.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",h.Callbacks({memory:1})]],a="pending",s={state:function(){return a},always:function(){o.done(arguments).fail(arguments);return this},then:function(){var t=arguments;return Me(function(a){h.each(i,function(e,n){var i=h.isFunction(t[e])&&t[e];o[n[1]](function(){var e=i&&i.apply(this,arguments);if(e&&h.isFunction(e.promise))e.promise().done(a.resolve).fail(a.reject).progress(a.notify);else{var t=this===s?a.promise():this,r=i?[e]:arguments;a[n[0]+"With"](t,r)}})});t=null}).promise()},promise:function(e){return e!=null?h.extend(e,s):s}},o={};h.each(i,function(e,t){var r=t[2],n=t[3];s[t[1]]=r.add;if(n)r.add(function(){a=n},i[e^1][2].disable,i[2][2].lock);o[t[0]]=function(){o[t[0]+"With"](this===o?s:this,arguments);return this};o[t[0]+"With"]=r.fireWith});s.promise(o);if(e)e.call(o,o);return o}h.when=function(e){var t=xe.call(arguments),r=t.length,n=0,i=r!==1||e&&h.isFunction(e.promise)?r:0,a=i===1?e:Me(),s,o,l,u=function(t,r,n){return function(e){r[t]=this;n[t]=arguments.length>1?xe.call(arguments):e;if(n===s)a.notifyWith(r,n);else if(!--i)a.resolveWith(r,n)}};if(r>1){s=new Array(r);o=new Array(r);l=new Array(r);for(;n<r;++n)if(t[n]&&h.isFunction(t[n].promise))t[n].promise().done(u(n,l,t)).fail(a.reject).progress(u(n,o,s));else--i}if(!i)a.resolveWith(l,t);return a.promise()},h.Deferred=Me;var p=e,Fe=1,Be,Ue=Array.prototype.slice,je=p.isFunction,m=function(e){return typeof e=="string"},Ve={},Ge={},Ke="onfocusin"in window,Ye={focus:"focusin",blur:"focusout"},He={mouseenter:"mouseover",mouseleave:"mouseout"};function ze(e){return e._zid||(e._zid=Fe++)}function $e(e,t,r,n){t=We(t);if(t.ns)var i=qe(t.ns);return(Ve[ze(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||i.test(e.ns))&&(!r||ze(e.fn)===ze(r))&&(!n||e.sel==n)})}function We(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function qe(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function Xe(e,t){return e.del&&!Ke&&e.e in Ye||!!t}function Ze(e){return He[e]||Ke&&Ye[e]||e}function Qe(i,e,t,a,s,o,l){var r=ze(i),u=Ve[r]||(Ve[r]=[]);e.split(/\s/).forEach(function(e){if(e=="ready")return p(document).ready(t);var r=We(e);r.fn=t;r.sel=s;if(r.e in He)t=function(e){var t=e.relatedTarget;if(!t||t!==this&&!p.contains(this,t))return r.fn.apply(this,arguments)};r.del=o;var n=o||t;r.proxy=function(e){e=it(e);if(e.isImmediatePropagationStopped())return;e.data=a;var t=n.apply(i,e._args==Be?[e]:[e].concat(e._args));if(t===false)e.preventDefault(),e.stopPropagation();return t};r.i=u.length;u.push(r);if("addEventListener"in i)i.addEventListener(Ze(r.e),r.proxy,Xe(r,l))})}function Je(t,e,r,n,i){var a=ze(t);(e||"").split(/\s/).forEach(function(e){$e(t,e,r,n).forEach(function(e){delete Ve[a][e.i];if("removeEventListener"in t)t.removeEventListener(Ze(e.e),e.proxy,Xe(e,i))})})}Ge.click=Ge.mousedown=Ge.mouseup=Ge.mousemove="MouseEvents",p.event={add:Qe,remove:Je},p.proxy=function(e,t){var r=2 in arguments&&Ue.call(arguments,2);if(je(e)){var n=function(){return e.apply(t,r?r.concat(Ue.call(arguments)):arguments)};n._zid=ze(e);return n}else if(m(t))if(r){r.unshift(e[t],e);return p.proxy.apply(null,r)}else return p.proxy(e[t],e);else throw new TypeError("expected function")},p.fn.bind=function(e,t,r){return this.on(e,t,r)},p.fn.unbind=function(e,t){return this.off(e,t)},p.fn.one=function(e,t,r,n){return this.on(e,t,r,n,1)};var et=function(){return true},tt=function(){return false},rt=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,nt={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function it(n,i){if(i||!n.isDefaultPrevented){i||(i=n);p.each(nt,function(e,t){var r=i[e];n[e]=function(){this[t]=et;return r&&r.apply(i,arguments)};n[t]=tt});n.timeStamp||(n.timeStamp=Date.now());if(i.defaultPrevented!==Be?i.defaultPrevented:"returnValue"in i?i.returnValue===false:i.getPreventDefault&&i.getPreventDefault())n.isDefaultPrevented=et}return n}function at(e){var t,r={originalEvent:e};for(t in e)if(!rt.test(t)&&e[t]!==Be)r[t]=e[t];return it(r,e)}p.fn.delegate=function(e,t,r){return this.on(t,e,r)},p.fn.undelegate=function(e,t,r){return this.off(t,e,r)},p.fn.live=function(e,t){p(document.body).delegate(this.selector,e,t);return this},p.fn.die=function(e,t){p(document.body).undelegate(this.selector,e,t);return this},p.fn.on=function(t,i,r,a,s){var o,l,n=this;if(t&&!m(t)){p.each(t,function(e,t){n.on(e,i,r,t,s)});return n}if(!m(i)&&!je(a)&&a!==false)a=r,r=i,i=Be;if(a===Be||r===false)a=r,r=Be;if(a===false)a=tt;return n.each(function(e,n){if(s)o=function(e){Je(n,e.type,a);return a.apply(this,arguments)};if(i)l=function(e){var t,r=p(e.target).closest(i,n).get(0);if(r&&r!==n){t=p.extend(at(e),{currentTarget:r,liveFired:n});return(o||a).apply(r,[t].concat(Ue.call(arguments,1)))}};Qe(n,t,a,r,i,l||o)})},p.fn.off=function(e,r,t){var n=this;if(e&&!m(e)){p.each(e,function(e,t){n.off(e,r,t)});return n}if(!m(r)&&!je(t)&&t!==false)t=r,r=Be;if(t===false)t=tt;return n.each(function(){Je(this,e,t,r)})},p.fn.trigger=function(e,t){e=m(e)||p.isPlainObject(e)?p.Event(e):it(e);e._args=t;return this.each(function(){if(e.type in Ye&&typeof this[e.type]=="function")this[e.type]();else if("dispatchEvent"in this)this.dispatchEvent(e);else p(this).triggerHandler(e,t)})},p.fn.triggerHandler=function(r,n){var i,a;this.each(function(e,t){i=at(m(r)?p.Event(r):r);i._args=n;i.target=t;p.each($e(t,r.type||r),function(e,t){a=t.proxy(i);if(i.isImmediatePropagationStopped())return false})});return a},("focusin focusout focus blur load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select keydown keypress keyup error").split(" ").forEach(function(t){p.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),p.Event=function(e,t){if(!m(e))t=e,e=t.type;var r=document.createEvent(Ge[e]||"Events"),n=true;if(t)for(var i in t)i=="bubbles"?n=!!t[i]:r[i]=t[i];r.initEvent(e,n,true);return it(r)};try{getComputedStyle(undefined)}catch(e){var st=getComputedStyle;window.getComputedStyle=function(e,t){try{return st(e,t)}catch(e){return null}}}var ot=e,lt=ot.zepto,ut=lt.qsa,ct=lt.matches;function dt(e){e=ot(e);return!!(e.width()||e.height())&&e.css("display")!=="none"}var ft=ot.expr[":"]={visible:function(){if(dt(this))return this},hidden:function(){if(!dt(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(e){if(e===0)return this},last:function(e,t){if(e===t.length-1)return this},eq:function(e,t,r){if(e===r)return this},contains:function(e,t,r){if(ot(this).text().indexOf(r)>-1)return this},has:function(e,t,r){if(lt.qsa(this,r).length)return this}},ht=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),pt=/^\s*>/,vt="Zepto"+ +new Date;function gt(e,t){e=e.replace(/=#\]/g,'="#"]');var r,n,i=ht.exec(e);if(i&&i[2]in ft){r=ft[i[2]],n=i[3];e=i[1];if(n){var a=Number(n);if(isNaN(a))n=n.replace(/^["']|["']$/g,"");else n=a}}return t(e,r,n)}lt.qsa=function(a,s){return gt(s,function(e,r,n){try{var t;if(!e&&r)e="*";else if(pt.test(e))t=ot(a).addClass(vt),e="."+vt+" "+e;var i=ut(a,e)}catch(e){console.error("error performing selector: %o",s);throw e}finally{if(t)t.removeClass(vt)}return!r?i:lt.uniq(ot.map(i,function(e,t){return r.call(e,t,i,n)}))})},lt.matches=function(n,e){return gt(e,function(e,t,r){return(!e||ct(n,e))&&(!t||t.call(n,null,r)===n)})};var y=e,At=[{name:"Chromium",group:"Chrome",identifier:"Chromium/([0-9.]*)"},{name:"Chrome Mobile",group:"Chrome",identifier:"Chrome/([0-9.]*) Mobile",versionIdentifier:"Chrome/([0-9.]*)"},{name:"Chrome",group:"Chrome",identifier:"Chrome/([0-9.]*)"},{name:"Chrome for iOS",group:"Chrome",identifier:"CriOS/([0-9.]*)"},{name:"Android Browser",group:"Chrome",identifier:"CrMo/([0-9.]*)"},{name:"Firefox",group:"Firefox",identifier:"Firefox/([0-9.]*)"},{name:"Opera Mini",group:"Opera",identifier:"Opera Mini/([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera ([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"},{name:"IEMobile",group:"Explorer",identifier:"IEMobile/([0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"MSIE ([a-zA-Z0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"Trident/([0-9.]*)",versionIdentifier:"rv:([0-9.]*)"},{name:"Spartan",group:"Spartan",identifier:"Edge/([0-9.]*)",versionIdentifier:"Edge/([0-9.]*)"},{name:"Safari",group:"Safari",identifier:"Safari/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"}],mt=[{name:"Windows 2000",group:"Windows",identifier:"Windows NT 5.0",version:"5.0"},{name:"Windows XP",group:"Windows",identifier:"Windows NT 5.1",version:"5.1"},{name:"Windows Vista",group:"Windows",identifier:"Windows NT 6.0",version:"6.0"},{name:"Windows 7",group:"Windows",identifier:"Windows NT 6.1",version:"7.0"},{name:"Windows 8",group:"Windows",identifier:"Windows NT 6.2",version:"8.0"},{name:"Windows 8.1",group:"Windows",identifier:"Windows NT 6.3",version:"8.1"},{name:"Windows 10",group:"Windows",identifier:"Windows NT 10.0",version:"10.0"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone ([0-9.]*)"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone OS ([0-9.]*)"},{name:"Windows",group:"Windows",identifier:"Windows"},{name:"Chrome OS",group:"Chrome OS",identifier:"CrOS"},{name:"Android",group:"Android",identifier:"Android",versionIdentifier:"Android ([a-zA-Z0-9.-]*)"},{name:"iPad",group:"iOS",identifier:"iPad",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPod",group:"iOS",identifier:"iPod",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPhone",group:"iOS",identifier:"iPhone OS",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"Mac OS X High Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])13([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])12([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X El Capitan",group:"Mac OS",identifier:"Mac OS X (10([_|.])11([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Yosemite",group:"Mac OS",identifier:"Mac OS X (10([_|.])10([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mavericks",group:"Mac OS",identifier:"Mac OS X (10([_|.])9([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mountain Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])8([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])7([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Snow Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])6([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])5([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Tiger",group:"Mac OS",identifier:"Mac OS X (10([_|.])4([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Panther",group:"Mac OS",identifier:"Mac OS X (10([_|.])3([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Jaguar",group:"Mac OS",identifier:"Mac OS X (10([_|.])2([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Puma",group:"Mac OS",identifier:"Mac OS X (10([_|.])1([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Cheetah",group:"Mac OS",identifier:"Mac OS X (10([_|.])0([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS",group:"Mac OS",identifier:"Mac OS"},{name:"Ubuntu",group:"Linux",identifier:"Ubuntu",versionIdentifier:"Ubuntu/([0-9.]*)"},{name:"Debian",group:"Linux",identifier:"Debian"},{name:"Gentoo",group:"Linux",identifier:"Gentoo"},{name:"Linux",group:"Linux",identifier:"Linux"},{name:"BlackBerry",group:"BlackBerry",identifier:"BlackBerry"}],E={},yt=function e(){try{localStorage.setItem("clappr","clappr");localStorage.removeItem("clappr");return true}catch(e){return false}},Et=function e(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!!t}catch(e){return!!(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==undefined&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)}},bt,kt=function e(){var t={};var r=E.userAgent.toLowerCase();var n=se(At),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;var s=new RegExp(a.identifier.toLowerCase());var o=s.exec(r);if(o!=null&&o[1]){t.name=a.name;t.group=a.group;if(a.versionIdentifier){var l=new RegExp(a.versionIdentifier.toLowerCase());var u=l.exec(r);if(u!=null&&u[1])_t(u[1],t)}else _t(o[1],t);break}}}catch(e){n.e(e)}finally{n.f()}return t},_t=function e(t,r){var n=t.split(".",2);r.fullVersion=t;if(n[0])r.majorVersion=parseInt(n[0]);if(n[1])r.minorVersion=parseInt(n[1])},Tt=function e(){var t={};var r=E.userAgent.toLowerCase();var n=se(mt),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;var s=new RegExp(a.identifier.toLowerCase());var o=s.exec(r);if(o!=null){t.name=a.name;t.group=a.group;if(a.version)St(a.version,a.versionSeparator?a.versionSeparator:".",t);else if(o[1])St(o[1],a.versionSeparator?a.versionSeparator:".",t);else if(a.versionIdentifier){var l=new RegExp(a.versionIdentifier.toLowerCase());var u=l.exec(r);if(u!=null&&u[1])St(u[1],a.versionSeparator?a.versionSeparator:".",t)}break}}}catch(e){n.e(e)}finally{n.f()}return t},St=function e(t,r,n){var i=r.substr(0,1)=="["?new RegExp(r,"g"):r;var a=t.split(i,2);if(r!=".")t=t.replace(new RegExp(r,"g"),".");n.fullVersion=t;if(a&&a[0])n.majorVersion=parseInt(a[0]);if(a&&a[1])n.minorVersion=parseInt(a[1])},Ct=function e(){var t={};t.width=y(window).width();t.height=y(window).height();return t},Rt=function e(){switch(window.orientation){case-90:case 90:E.viewport.orientation="landscape";break;default:E.viewport.orientation="portrait";break}},wt=function e(t){var r=/\((iP(?:hone|ad|od))?(?:[^;]*; ){0,2}([^)]+(?=\)))/;var n=r.exec(t);var i=n&&(n[1]||n[2])||"";return i},Ot=function e(t){var r=t.match(/\b(playstation 4|nx|opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],n;if(/trident/i.test(r[1])){n=/\brv[ :]+(\d+)/g.exec(t)||[];return{name:"IE",version:parseInt(n[1]||"")}}else if(r[1]==="Chrome"){n=t.match(/\bOPR\/(\d+)/);if(n!=null)return{name:"Opera",version:parseInt(n[1])};n=t.match(/\bEdge\/(\d+)/);if(n!=null)return{name:"Edge",version:parseInt(n[1])}}else if(/android/i.test(t)&&(n=t.match(/version\/(\d+)/i))){r.splice(1,1,"Android WebView");r.splice(2,1,n[1])}r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"];return{name:r[0],version:parseInt(r[1])}}(navigator.userAgent),Lt=(E.isEdge=/edge/i.test(navigator.userAgent),E.isChrome=/chrome|CriOS/i.test(navigator.userAgent)&&!E.isEdge,E.isSafari=/safari/i.test(navigator.userAgent)&&!E.isChrome&&!E.isEdge,E.isFirefox=/firefox/i.test(navigator.userAgent),E.isLegacyIE=!!window.ActiveXObject,E.isIE=E.isLegacyIE||/trident.*rv:1\d/i.test(navigator.userAgent),E.isIE11=/trident.*rv:11/i.test(navigator.userAgent),E.isChromecast=E.isChrome&&/CrKey/i.test(navigator.userAgent),E.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(navigator.userAgent),E.isiOS=/iPad|iPhone|iPod/i.test(navigator.userAgent),E.isAndroid=/Android/i.test(navigator.userAgent),E.isWindowsPhone=/Windows Phone/i.test(navigator.userAgent),E.isWin8App=/MSAppHost/i.test(navigator.userAgent),E.isWiiU=/WiiU/i.test(navigator.userAgent),E.isPS4=/PlayStation 4/i.test(navigator.userAgent),E.hasLocalstorage=yt(),E.hasFlash=Et(),E.name=Ot.name,E.version=Ot.version,E.userAgent=navigator.userAgent,E.data=kt(),E.os=Tt(),E.viewport=Ct(),E.device=wt(E.userAgent),typeof window.orientation!=="undefined"&&Rt(),{}),It=[],Dt=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}).bind(window),Pt=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);function Nt(e,t){if(t)for(var r in t){var n=Object.getOwnPropertyDescriptor(t,r);n?Object.defineProperty(e,r,n):e[r]=t[r]}return e}function xt(e,s){var t=function(e){d(a,e);var i=f(a);function a(){var e;u(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e=i.call.apply(i,[this].concat(r));if(s.initialize)s.initialize.apply(z(e),r);return e}return a}(e);Nt(t.prototype,s);return t}function Mt(e,t){if(!isFinite(e))return"--:--";e=e*1e3;e=parseInt(e/1e3);var r=e%60;e=parseInt(e/60);var n=e%60;e=parseInt(e/60);var i=e%24;var a=parseInt(e/24);var s="";if(a&&a>0){s+=a+":";if(i<1)s+="00:"}if(i&&i>0||t)s+=("0"+i).slice(-2)+":";s+=("0"+n).slice(-2)+":";s+=("0"+r).slice(-2);return s.trim()}var Ft={fullscreenElement:function e(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullscreen:function e(t){if(t.requestFullscreen)return t.requestFullscreen();else if(t.webkitRequestFullscreen){if(typeof t.then==="function")return t.webkitRequestFullscreen();t.webkitRequestFullscreen()}else if(t.mozRequestFullScreen)return t.mozRequestFullScreen();else if(t.msRequestFullscreen)return t.msRequestFullscreen();else if(t.querySelector&&t.querySelector("video")&&t.querySelector("video").webkitEnterFullScreen)t.querySelector("video").webkitEnterFullScreen();else if(t.webkitEnterFullScreen)t.webkitEnterFullScreen()},cancelFullscreen:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;if(t.exitFullscreen)t.exitFullscreen();else if(t.webkitCancelFullScreen)t.webkitCancelFullScreen();else if(t.webkitExitFullscreen)t.webkitExitFullscreen();else if(t.mozCancelFullScreen)t.mozCancelFullScreen();else if(t.msExitFullscreen)t.msExitFullscreen()},fullscreenEnabled:function e(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},Bt=function(){function e(){u(this,e)}c(e,null,[{key:"_defaultConfig",value:function e(){return{volume:{value:100,parse:parseInt}}}},{key:"_defaultValueFor",value:function e(t){try{return this._defaultConfig()[t].parse(this._defaultConfig()[t].value)}catch(e){return undefined}}},{key:"_createKeyspace",value:function e(t){return"clappr.".concat(document.domain,".").concat(t)}},{key:"restore",value:function e(t){if(E.hasLocalstorage&&localStorage[this._createKeyspace(t)])return this._defaultConfig()[t].parse(localStorage[this._createKeyspace(t)]);return this._defaultValueFor(t)}},{key:"persist",value:function e(t,r){if(E.hasLocalstorage)try{localStorage[this._createKeyspace(t)]=r;return true}catch(e){return false}}}]);return e}(),Ut=function(){function e(){u(this,e)}c(e,null,[{key:"parse",value:function e(t){var r;var n=/\+/g,i=/([^&=]+)=?([^&]*)/g,a=function e(t){return decodeURIComponent(t.replace(n," "))},s={};while(r=i.exec(t))s[a(r[1]).toLowerCase()]=a(r[2]);return s}},{key:"params",get:function e(){var t=window.location.search.substring(1);if(t!==this.query){this._urlParams=this.parse(t);this.query=t}return this._urlParams}},{key:"hashParams",get:function e(){var t=window.location.hash.substring(1);if(t!==this.hash){this._hashParams=this.parse(t);this.hash=t}return this._hashParams}}]);return e}();function jt(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"t";var n=0;var t=Ut.params[e]||Ut.hashParams[e]||"";var r=t.match(/[0-9]+[hms]+/g)||[];if(r.length>0){var i={h:3600,m:60,s:1};r.forEach(function(e){if(e){var t=e[e.length-1];var r=parseInt(e.slice(0,e.length-1),10);n+=r*i[t]}})}else if(t)n=parseInt(t,10);return n}function Vt(e){Lt[e]||(Lt[e]=0);var t=++Lt[e];return e+t}function Gt(e){return e-parseFloat(e)+1>=0}function Kt(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function Yt(){return window.navigator&&window.navigator.language}function Ht(){if(window.performance&&window.performance.now)return performance.now();return Date.now()}function zt(e,t){var r=e.indexOf(t);if(r>=0)e.splice(r,1)}function $t(t,e){if(t===undefined||e===undefined)return false;return e.find(function(e){return t.toLowerCase()===e.toLowerCase()})!==undefined}function Wt(n,e){e=Object.assign({inline:false,muted:false,timeout:250,type:"video",source:le.mp4,element:null},e);var t=e.element?e.element:document.createElement(e.type);t.muted=e.muted;if(e.muted===true)t.setAttribute("muted","muted");if(e.inline===true)t.setAttribute("playsinline","playsinline");t.src=e.source;var r=t.play();var i=setTimeout(function(){a(false,new Error("Timeout ".concat(e.timeout," ms has been reached")))},e.timeout);var a=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;clearTimeout(i);n(t,r)};if(r!==undefined)r.then(function(){return a(true)})["catch"](function(e){return a(false,e)});else a(true)}var qt=function(){function e(){u(this,e)}c(e,null,[{key:"configure",value:function e(t){this.options=y.extend(true,this.options,t)}},{key:"create",value:function e(t){if(this.options.recycleVideo&&t==="video"&&It.length>0)return It.shift();return document.createElement(t)}},{key:"garbage",value:function e(t){if(!this.options.recycleVideo||t.tagName.toUpperCase()!=="VIDEO")return;y(t).children().remove();Object.values(t.attributes).forEach(function(e){return t.removeAttribute(e.name)});It.push(t)}}]);return e}(),Xt=(qt.options={recycleVideo:false},function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:500;u(this,t);this.delay=e;this.lastTime=0}c(t,[{key:"handle",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var i=(new Date).getTime();var a=i-this.lastTime;if(a<this.delay&&a>0){r();n&&t.preventDefault()}this.lastTime=i}}]);return t}()),t={Config:Bt,Fullscreen:Ft,QueryString:Ut,DomRecycler:qt,assign:Nt,extend:xt,formatTime:Mt,seekStringToSeconds:jt,uniqueId:Vt,currentScriptUrl:Kt,isNumber:Gt,requestAnimationFrame:Dt,cancelAnimationFrame:Pt,getBrowserLanguage:Yt,now:Ht,removeArrayItem:zt,listContainsIgnoreCase:$t,canAutoPlayMedia:Wt,Media:le,DoubleEventHandler:Xt},Zt="font-weight: bold; font-size: 13px;",Qt,Jt,er="color: #ff8000;"+Zt,tr="color: #ff0000;"+Zt,rr=0,nr=1,ir=2,ar=3,sr=ar,or=["color: #0000ff;"+Zt,"color: #006600;"+Zt,er,tr,tr],lr=["debug","info","warn","error","disabled"],b=function(){c(r,[{key:"level",get:function e(){return this._level},set:function e(t){this._level=t}}]);function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:nr;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:sr;u(this,r);this.EXCLUDE_LIST=["timeupdate","playback:timeupdate","playback:progress","container:hover","container:timeupdate","container:progress"];this.level=e;this.previousLevel=this.level;this.offLevel=t}c(r,[{key:"debug",value:function e(t){this.log(t,rr,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function e(t){this.log(t,nr,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function e(t){this.log(t,ir,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function e(t){this.log(t,ar,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function e(){if(this.level===this.offLevel)this.level=this.previousLevel;else{this.previousLevel=this.level;this.level=this.offLevel}window.console&&window.console.log&&window.console.log("%c[Clappr.Log] set log level to "+lr[this.level],er)}},{key:"log",value:function e(t,r,n){if(this.EXCLUDE_LIST.indexOf(n[0])>=0)return;if(r<this.level)return;if(!n){n=t;t=null}var i=or[r];var a="";if(t)a="["+t+"]";window.console&&window.console.log&&window.console.log.apply(console,["%c["+lr[r]+"]"+a,i].concat(n))}}]);return r}(),ur=(b.LEVEL_DEBUG=rr,b.LEVEL_INFO=nr,b.LEVEL_WARN=ir,b.LEVEL_ERROR=ar,b.getInstance=function(){if(this._instance===undefined)this._instance=new this;return this._instance},b.setLevel=function(e){this.getInstance().level=e},b.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)},b.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)},b.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)},b.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)},Array.prototype.slice),cr=/\s+/,dr=function e(t,r,n,i){if(!n)return true;if(U(n)==="object"){for(var a in n)t[r].apply(t,[a,n[a]].concat(i));return false}if(cr.test(n)){var s=n.split(cr);for(var o=0,l=s.length;o<l;o++)t[r].apply(t,[s[o]].concat(i));return false}return true},fr=function e(t,r,n,i){var a,s=-1;var o=t.length,l=r[0],u=r[1],c=r[2];d();function d(){try{switch(r.length){case 0:while(++s<o)(a=t[s]).callback.call(a.ctx);return;case 1:while(++s<o)(a=t[s]).callback.call(a.ctx,l);return;case 2:while(++s<o)(a=t[s]).callback.call(a.ctx,l,u);return;case 3:while(++s<o)(a=t[s]).callback.call(a.ctx,l,u,c);return;default:while(++s<o)(a=t[s]).callback.apply(a.ctx,r);return}}catch(e){b.error.apply(b,[n,"error on event",i,"trigger","-",e]);d()}}},k=function(){function n(){u(this,n)}c(n,[{key:"on",value:function e(t,r,n){if(!dr(this,"on",t,[r,n])||!r)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);i.push({callback:r,context:n,ctx:n||this});return this}},{key:"once",value:function e(t,r,n){var i=this;var a;if(!dr(this,"once",t,[r,n])||!r)return this;var s=function e(){return i.off(t,a)};a=function e(){s();r.apply(this,arguments)};return this.on(t,a,n)}},{key:"off",value:function e(t,r,n){var i,a,s,o,l,u,c,d;if(!this._events||!dr(this,"off",t,[r,n]))return this;if(!t&&!r&&!n){this._events=void 0;return this}o=t?[t]:Object.keys(this._events);for(l=0,u=o.length;l<u;l++){t=o[l];s=this._events[t];if(s){this._events[t]=i=[];if(r||n)for(c=0,d=s.length;c<d;c++){a=s[c];if(r&&r!==a.callback&&r!==a.callback._callback||n&&n!==a.context)i.push(a)}if(!i.length)delete this._events[t]}}return this}},{key:"trigger",value:function e(t){var r=this.name||this.constructor.name;b.debug.apply(b,[r].concat(Array.prototype.slice.call(arguments)));if(!this._events)return this;var n=ur.call(arguments,1);if(!dr(this,"trigger",t,n))return this;var i=this._events[t];var a=this._events.all;if(i)fr(i,n,r,t);if(a)fr(a,arguments,r,t);return this}},{key:"stopListening",value:function e(t,r,n){var i=this._listeningTo;if(!i)return this;var a=!r&&!n;if(!n&&U(r)==="object")n=this;if(t)(i={})[t._listenId]=t;for(var s in i){t=i[s];t.off(r,n,this);if(a||Object.keys(t._events).length===0)delete this._listeningTo[s]}return this}}],[{key:"register",value:function e(t){n.Custom||(n.Custom={});var r=typeof t==="string"&&t.toUpperCase().trim();if(r&&!n.Custom[r])n.Custom[r]=r.toLowerCase().split("_").map(function(e,t){return t===0?e:e=e[0].toUpperCase()+e.slice(1)}).join("");else b.error("Events","Error when register event: "+t)}},{key:"listAvailableCustomEvents",value:function e(){n.Custom||(n.Custom={});return Object.keys(n.Custom).filter(function(e){return typeof n.Custom[e]==="string"})}}]);return n}(),hr={listenTo:"on",listenToOnce:"once"},r=(Object.keys(hr).forEach(function(a){k.prototype[a]=function(e,t,r){var n=this._listeningTo||(this._listeningTo={});var i=e._listenId||(e._listenId=Vt("l"));n[i]=e;if(!r&&U(t)==="object")r=this;e[hr[a]](t,r,this);return this}}),k.PLAYER_READY="ready",k.PLAYER_RESIZE="resize",k.PLAYER_FULLSCREEN="fullscreen",k.PLAYER_PLAY="play",k.PLAYER_PAUSE="pause",k.PLAYER_STOP="stop",k.PLAYER_ENDED="ended",k.PLAYER_SEEK="seek",k.PLAYER_ERROR="playererror",k.ERROR="error",k.PLAYER_TIMEUPDATE="timeupdate",k.PLAYER_VOLUMEUPDATE="volumeupdate",k.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable",k.PLAYBACK_PROGRESS="playback:progress",k.PLAYBACK_TIMEUPDATE="playback:timeupdate",k.PLAYBACK_READY="playback:ready",k.PLAYBACK_BUFFERING="playback:buffering",k.PLAYBACK_BUFFERFULL="playback:bufferfull",k.PLAYBACK_SETTINGSUPDATE="playback:settingsupdate",k.PLAYBACK_LOADEDMETADATA="playback:loadedmetadata",k.PLAYBACK_HIGHDEFINITIONUPDATE="playback:highdefinitionupdate",k.PLAYBACK_BITRATE="playback:bitrate",k.PLAYBACK_LEVELS_AVAILABLE="playback:levels:available",k.PLAYBACK_LEVEL_SWITCH_START="playback:levels:switch:start",k.PLAYBACK_LEVEL_SWITCH_END="playback:levels:switch:end",k.PLAYBACK_PLAYBACKSTATE="playback:playbackstate",k.PLAYBACK_DVR="playback:dvr",k.PLAYBACK_MEDIACONTROL_DISABLE="playback:mediacontrol:disable",k.PLAYBACK_MEDIACONTROL_ENABLE="playback:mediacontrol:enable",k.PLAYBACK_ENDED="playback:ended",k.PLAYBACK_PLAY_INTENT="playback:play:intent",k.PLAYBACK_PLAY="playback:play",k.PLAYBACK_PAUSE="playback:pause",k.PLAYBACK_SEEK="playback:seek",k.PLAYBACK_SEEKED="playback:seeked",k.PLAYBACK_STOP="playback:stop",k.PLAYBACK_ERROR="playback:error",k.PLAYBACK_STATS_ADD="playback:stats:add",k.PLAYBACK_FRAGMENT_LOADED="playback:fragment:loaded",k.PLAYBACK_LEVEL_SWITCH="playback:level:switch",k.PLAYBACK_SUBTITLE_AVAILABLE="playback:subtitle:available",k.PLAYBACK_SUBTITLE_CHANGED="playback:subtitle:changed",k.CORE_CONTAINERS_CREATED="core:containers:created",k.CORE_ACTIVE_CONTAINER_CHANGED="core:active:container:changed",k.CORE_OPTIONS_CHANGE="core:options:change",k.CORE_READY="core:ready",k.CORE_FULLSCREEN="core:fullscreen",k.CORE_RESIZE="core:resize",k.CORE_SCREEN_ORIENTATION_CHANGED="core:screen:orientation:changed",k.CORE_MOUSE_MOVE="core:mousemove",k.CORE_MOUSE_LEAVE="core:mouseleave",k.CONTAINER_PLAYBACKSTATE="container:playbackstate",k.CONTAINER_PLAYBACKDVRSTATECHANGED="container:dvr",k.CONTAINER_BITRATE="container:bitrate",k.CONTAINER_STATS_REPORT="container:stats:report",k.CONTAINER_DESTROYED="container:destroyed",k.CONTAINER_READY="container:ready",k.CONTAINER_RESIZE="container:resize",k.CONTAINER_ERROR="container:error",k.CONTAINER_LOADEDMETADATA="container:loadedmetadata",k.CONTAINER_SUBTITLE_AVAILABLE="container:subtitle:available",k.CONTAINER_SUBTITLE_CHANGED="container:subtitle:changed",k.CONTAINER_TIMEUPDATE="container:timeupdate",k.CONTAINER_PROGRESS="container:progress",k.CONTAINER_PLAY="container:play",k.CONTAINER_STOP="container:stop",k.CONTAINER_PAUSE="container:pause",k.CONTAINER_ENDED="container:ended",k.CONTAINER_CLICK="container:click",k.CONTAINER_DBLCLICK="container:dblclick",k.CONTAINER_CONTEXTMENU="container:contextmenu",k.CONTAINER_MOUSE_ENTER="container:mouseenter",k.CONTAINER_MOUSE_LEAVE="container:mouseleave",k.CONTAINER_MOUSE_UP="container:mouseup",k.CONTAINER_MOUSE_DOWN="container:mousedown",k.CONTAINER_SEEK="container:seek",k.CONTAINER_SEEKED="container:seeked",k.CONTAINER_VOLUME="container:volume",k.CONTAINER_FULLSCREEN="container:fullscreen",k.CONTAINER_STATE_BUFFERING="container:state:buffering",k.CONTAINER_STATE_BUFFERFULL="container:state:bufferfull",k.CONTAINER_SETTINGSUPDATE="container:settingsupdate",k.CONTAINER_HIGHDEFINITIONUPDATE="container:highdefinitionupdate",k.CONTAINER_MEDIACONTROL_SHOW="container:mediacontrol:show",k.CONTAINER_MEDIACONTROL_HIDE="container:mediacontrol:hide",k.CONTAINER_MEDIACONTROL_DISABLE="container:mediacontrol:disable",k.CONTAINER_MEDIACONTROL_ENABLE="container:mediacontrol:enable",k.CONTAINER_STATS_ADD="container:stats:add",k.CONTAINER_OPTIONS_CHANGE="container:options:change",k.MEDIACONTROL_RENDERED="mediacontrol:rendered",k.MEDIACONTROL_FULLSCREEN="mediacontrol:fullscreen",k.MEDIACONTROL_SHOW="mediacontrol:show",k.MEDIACONTROL_HIDE="mediacontrol:hide",k.MEDIACONTROL_MOUSEMOVE_SEEKBAR="mediacontrol:mousemove:seekbar",k.MEDIACONTROL_MOUSELEAVE_SEEKBAR="mediacontrol:mouseleave:seekbar",k.MEDIACONTROL_PLAYING="mediacontrol:playing",k.MEDIACONTROL_NOTPLAYING="mediacontrol:notplaying",k.MEDIACONTROL_CONTAINERCHANGED="mediacontrol:containerchanged",k.MEDIACONTROL_OPTIONS_CHANGE="mediacontrol:options:change",function(e){d(n,e);var r=f(n);c(n,[{key:"options",get:function e(){return this._options}}]);function n(){var e;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};u(this,n);e=r.call(this,t);e._options=t;e.uniqueId=Vt("o");return e}return n}(k)),pr={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},vr=/(.)^/,gr={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},Ar=/\\|'|\r|\n|\t|\u2028|\u2029/g,mr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},yr=new RegExp("[&<>\"']","g"),Er=function e(t){if(t===null)return"";return(""+t).replace(yr,function(e){return mr[e]})},br=0,_=function e(a,t){var r;var n=new RegExp([(pr.escape||vr).source,(pr.interpolate||vr).source,(pr.evaluate||vr).source].join("|")+"|$","g");var s=0;var o="__p+='";a.replace(n,function(e,t,r,n,i){o+=a.slice(s,i).replace(Ar,function(e){return"\\"+gr[e]});if(t)o+="'+\n((__t=("+t+"))==null?'':escapeExpr(__t))+\n'";if(r)o+="'+\n((__t=("+r+"))==null?'':__t)+\n'";if(n)o+="';\n"+n+"\n__p+='";s=i+e.length;return e});o+="';\n";if(!pr.variable)o="with(obj||{}){\n"+o+"}\n";o="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n//# sourceURL=/microtemplates/source["+br+++"]";try{r=new Function(pr.variable||"obj","escapeExpr",o)}catch(e){e.source=o;throw e}if(t)return r(t,Er);var i=function e(t){return r.call(this,t,Er)};i.source="function("+(pr.variable||"obj")+"){\n"+o+"}";return i},kr=(_.settings=pr,{getStyleFor:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{baseUrl:""};return y('<style class="clappr-style"></style>').html(_(t.toString())(r))}}),_r=/^(\S+)\s*(.*)$/,Tr=function(e){d(n,e);var r=f(n);c(n,[{key:"tagName",get:function e(){return"div"}},{key:"events",get:function e(){return{}}},{key:"attributes",get:function e(){return{}}}]);function n(e){var t;u(this,n);t=r.call(this,e);t.cid=Vt("c");t._ensureElement();t.delegateEvents();return t}c(n,[{key:"$",value:function e(t){return this.$el.find(t)}},{key:"render",value:function e(){return this}},{key:"destroy",value:function e(){this.$el.remove();this.stopListening();this.undelegateEvents();return this}},{key:"setElement",value:function e(t,r){if(this.$el)this.undelegateEvents();this.$el=y.zepto.isZ(t)?t:y(t);this.el=this.$el[0];if(r!==false)this.delegateEvents();return this}},{key:"delegateEvents",value:function e(t){if(!t)t=this.events;this.undelegateEvents();for(var r in t){var n=t[r];if(n&&n.constructor!==Function)n=this[t[r]];if(!n)continue;var i=r.match(_r);var a=i[1],s=i[2];a+=".delegateEvents"+this.cid;if(s==="")this.$el.on(a,n.bind(this));else this.$el.on(a,s,n.bind(this))}return this}},{key:"undelegateEvents",value:function e(){this.$el.off(".delegateEvents"+this.cid);return this}},{key:"_ensureElement",value:function e(){if(!this.el){var t=y.extend(true,{},this.attributes);if(this.id)t.id=this.id;if(this.className)t["class"]=this.className;var r=y(qt.create(this.tagName)).attr(t);this.setElement(r,false)}else this.setElement(this.el,false)}}]);return n}(r),T=function(e){d(i,e);var n=f(i);c(i,[{key:"name",get:function e(){return"error"}}],[{key:"Levels",get:function e(){return{FATAL:"FATAL",WARN:"WARN",INFO:"INFO"}}}]);function i(){var e;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1?arguments[1]:undefined;u(this,i);e=n.call(this,t);e.core=r;return e}c(i,[{key:"createError",value:function e(t){if(!this.core){b.warn(this.name,"Core is not set. Error: ",t);return}this.core.trigger(k.ERROR,t)}}]);return i}(r),n={createError:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{useCodePrefix:true};var n=this.constructor&&this.constructor.type||"";var i=this.name||n;var a=this.i18n||this.core&&this.core.i18n||this.container&&this.container.i18n;var s="".concat(i,":").concat(t&&t.code||"unknown");var o={description:"",level:T.Levels.FATAL,origin:i,scope:n,raw:{}};var l=Object.assign({},o,t,{code:r.useCodePrefix?s:t.code});if(a&&l.level==T.Levels.FATAL&&!l.UI){var u={title:a.t("default_error_title"),message:a.t("default_error_message")};l.UI=u}this.playerError?this.playerError.createError(l):b.warn(i,"PlayerError is not defined. Error: ",l);return l}},i=function(e){d(n,e);var r=f(n);c(n,[{key:"playerError",get:function e(){return this.core.playerError}}]);function n(e){var t;u(this,n);t=r.call(this,e.options);t.core=e;t.enabled=true;t.bindEvents();t.render();return t}c(n,[{key:"bindEvents",value:function e(){}},{key:"getExternalInterface",value:function e(){return{}}},{key:"enable",value:function e(){if(!this.enabled){this.bindEvents();this.$el.show();this.enabled=true}}},{key:"disable",value:function e(){this.stopListening();this.$el.hide();this.enabled=false}},{key:"render",value:function e(){return this}}]);return n}(Tr),Sr=(Object.assign(i.prototype,n),i.extend=function(e){return xt(i,e)},i.type="core",".container[data-container] {\n  position: absolute;\n  background-color: black;\n  height: 100%;\n  width: 100%;\n  max-width: 100%; }\n  .container[data-container] .chromeless {\n    cursor: default; }\n\n[data-player]:not(.nocursor) .container[data-container]:not(.chromeless).pointer-enabled {\n  cursor: pointer; }\n"),Cr=function(e){d(a,e);var i=f(a);c(a,[{key:"name",get:function e(){return"Container"}},{key:"attributes",get:function e(){return{class:"container","data-container":""}}},{key:"events",get:function e(){return{click:"clicked",dblclick:"dblClicked",touchend:"dblTap",contextmenu:"onContextMenu",mouseenter:"mouseEnter",mouseleave:"mouseLeave",mouseup:"onMouseUp",mousedown:"onMouseDown"}}},{key:"ended",get:function e(){return this.playback.ended}},{key:"buffering",get:function e(){return this.playback.buffering}},{key:"i18n",get:function e(){return this._i18n}},{key:"hasClosedCaptionsTracks",get:function e(){return this.playback.hasClosedCaptionsTracks}},{key:"closedCaptionsTracks",get:function e(){return this.playback.closedCaptionsTracks}},{key:"closedCaptionsTrackId",get:function e(){return this.playback.closedCaptionsTrackId},set:function e(t){this.playback.closedCaptionsTrackId=t}}]);function a(e,t,r){var n;u(this,a);n=i.call(this,e);n._i18n=t;n.currentTime=0;n.volume=100;n.playback=e.playback;n.playerError=r;n.settings=y.extend(true,{},n.playback.settings);n.isReady=false;n.mediaControlDisabled=false;n.plugins=[n.playback];n.dblTapHandler=new Xt(500);n.clickTimer=null;n.clickDelay=200;n.bindEvents();return n}c(a,[{key:"bindEvents",value:function e(){this.listenTo(this.playback,k.PLAYBACK_PROGRESS,this.onProgress);this.listenTo(this.playback,k.PLAYBACK_TIMEUPDATE,this.timeUpdated);this.listenTo(this.playback,k.PLAYBACK_READY,this.ready);this.listenTo(this.playback,k.PLAYBACK_BUFFERING,this.onBuffering);this.listenTo(this.playback,k.PLAYBACK_BUFFERFULL,this.bufferfull);this.listenTo(this.playback,k.PLAYBACK_SETTINGSUPDATE,this.settingsUpdate);this.listenTo(this.playback,k.PLAYBACK_LOADEDMETADATA,this.loadedMetadata);this.listenTo(this.playback,k.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate);this.listenTo(this.playback,k.PLAYBACK_BITRATE,this.updateBitrate);this.listenTo(this.playback,k.PLAYBACK_PLAYBACKSTATE,this.playbackStateChanged);this.listenTo(this.playback,k.PLAYBACK_DVR,this.playbackDvrStateChanged);this.listenTo(this.playback,k.PLAYBACK_MEDIACONTROL_DISABLE,this.disableMediaControl);this.listenTo(this.playback,k.PLAYBACK_MEDIACONTROL_ENABLE,this.enableMediaControl);this.listenTo(this.playback,k.PLAYBACK_SEEK,this.onSeek);this.listenTo(this.playback,k.PLAYBACK_SEEKED,this.onSeeked);this.listenTo(this.playback,k.PLAYBACK_ENDED,this.onEnded);this.listenTo(this.playback,k.PLAYBACK_PLAY,this.playing);this.listenTo(this.playback,k.PLAYBACK_PAUSE,this.paused);this.listenTo(this.playback,k.PLAYBACK_STOP,this.stopped);this.listenTo(this.playback,k.PLAYBACK_ERROR,this.error);this.listenTo(this.playback,k.PLAYBACK_SUBTITLE_AVAILABLE,this.subtitleAvailable);this.listenTo(this.playback,k.PLAYBACK_SUBTITLE_CHANGED,this.subtitleChanged)}},{key:"subtitleAvailable",value:function e(){this.trigger(k.CONTAINER_SUBTITLE_AVAILABLE)}},{key:"subtitleChanged",value:function e(t){this.trigger(k.CONTAINER_SUBTITLE_CHANGED,t)}},{key:"playbackStateChanged",value:function e(t){this.trigger(k.CONTAINER_PLAYBACKSTATE,t)}},{key:"playbackDvrStateChanged",value:function e(t){this.settings=this.playback.settings;this.dvrInUse=t;this.trigger(k.CONTAINER_PLAYBACKDVRSTATECHANGED,t)}},{key:"updateBitrate",value:function e(t){this.trigger(k.CONTAINER_BITRATE,t)}},{key:"statsReport",value:function e(t){this.trigger(k.CONTAINER_STATS_REPORT,t)}},{key:"getPlaybackType",value:function e(){return this.playback.getPlaybackType()}},{key:"isDvrEnabled",value:function e(){return!!this.playback.dvrEnabled}},{key:"isDvrInUse",value:function e(){return!!this.dvrInUse}},{key:"destroy",value:function e(){this.disableResizeObserver();this.trigger(k.CONTAINER_DESTROYED,this,this.name);this.stopListening();this.plugins.forEach(function(e){return e.destroy()});this.$el.remove()}},{key:"setStyle",value:function e(t){this.$el.css(t)}},{key:"animate",value:function e(t,r){return this.$el.animate(t,r).promise()}},{key:"ready",value:function e(){this.isReady=true;this.trigger(k.CONTAINER_READY,this.name)}},{key:"isPlaying",value:function e(){return this.playback.isPlaying()}},{key:"getStartTimeOffset",value:function e(){return this.playback.getStartTimeOffset()}},{key:"getCurrentTime",value:function e(){return this.currentTime}},{key:"getDuration",value:function e(){return this.playback.getDuration()}},{key:"error",value:function e(t){if(!this.isReady)this.ready();this.trigger(k.CONTAINER_ERROR,t,this.name)}},{key:"loadedMetadata",value:function e(t){this.trigger(k.CONTAINER_LOADEDMETADATA,t)}},{key:"timeUpdated",value:function e(t){this.currentTime=t.current;this.trigger(k.CONTAINER_TIMEUPDATE,t,this.name)}},{key:"onProgress",value:function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.trigger.apply(this,[k.CONTAINER_PROGRESS].concat(r,[this.name]))}},{key:"playing",value:function e(){this.trigger(k.CONTAINER_PLAY,this.name)}},{key:"paused",value:function e(){this.trigger(k.CONTAINER_PAUSE,this.name)}},{key:"play",value:function e(){this.playback.play()}},{key:"stop",value:function e(){this.playback.stop();this.currentTime=0}},{key:"pause",value:function e(){this.playback.pause()}},{key:"onEnded",value:function e(){this.trigger(k.CONTAINER_ENDED,this,this.name);this.currentTime=0}},{key:"stopped",value:function e(){this.trigger(k.CONTAINER_STOP)}},{key:"clicked",value:function e(){var t=this;if(!this.options.chromeless||this.options.allowUserInteraction)this.clickTimer=setTimeout(function(){t.clickTimer&&t.trigger(k.CONTAINER_CLICK,t,t.name)},this.clickDelay)}},{key:"cancelClicked",value:function e(){clearTimeout(this.clickTimer);this.clickTimer=null}},{key:"dblClicked",value:function e(){if(!this.options.chromeless||this.options.allowUserInteraction){this.cancelClicked();this.trigger(k.CONTAINER_DBLCLICK,this,this.name)}}},{key:"dblTap",value:function e(t){var r=this;if(!this.options.chromeless||this.options.allowUserInteraction)this.dblTapHandler.handle(t,function(){r.cancelClicked();r.trigger(k.CONTAINER_DBLCLICK,r,r.name)})}},{key:"onContextMenu",value:function e(t){if(!this.options.chromeless||this.options.allowUserInteraction)this.trigger(k.CONTAINER_CONTEXTMENU,t,this.name)}},{key:"seek",value:function e(t){this.playback.seek(t)}},{key:"onSeek",value:function e(t){this.trigger(k.CONTAINER_SEEK,t,this.name)}},{key:"onSeeked",value:function e(){this.trigger(k.CONTAINER_SEEKED,this.name)}},{key:"seekPercentage",value:function e(t){var r=this.getDuration();if(t>=0&&t<=100){var n=r*(t/100);this.seek(n)}}},{key:"setVolume",value:function e(t){this.volume=parseFloat(t);this.trigger(k.CONTAINER_VOLUME,this.volume,this.name);this.playback.volume(this.volume)}},{key:"fullscreen",value:function e(){this.trigger(k.CONTAINER_FULLSCREEN,this.name)}},{key:"onBuffering",value:function e(){this.trigger(k.CONTAINER_STATE_BUFFERING,this.name)}},{key:"bufferfull",value:function e(){this.trigger(k.CONTAINER_STATE_BUFFERFULL,this.name)}},{key:"addPlugin",value:function e(t){this.plugins.push(t)}},{key:"hasPlugin",value:function e(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function e(t){return this.plugins.filter(function(e){return e.name===t})[0]}},{key:"mouseEnter",value:function e(){if(!this.options.chromeless||this.options.allowUserInteraction)this.trigger(k.CONTAINER_MOUSE_ENTER)}},{key:"mouseLeave",value:function e(){if(!this.options.chromeless||this.options.allowUserInteraction)this.trigger(k.CONTAINER_MOUSE_LEAVE)}},{key:"mouseUp",value:function e(){if(!this.options.chromeless||this.options.allowUserInteraction)this.trigger(k.CONTAINER_MOUSE_UP)}},{key:"mouseDown",value:function e(){if(!this.options.chromeless||this.options.allowUserInteraction)this.trigger(k.CONTAINER_MOUSE_DOWN)}},{key:"settingsUpdate",value:function e(){this.settings=this.playback.settings;this.trigger(k.CONTAINER_SETTINGSUPDATE)}},{key:"highDefinitionUpdate",value:function e(t){this.trigger(k.CONTAINER_HIGHDEFINITIONUPDATE,t)}},{key:"isHighDefinitionInUse",value:function e(){return this.playback.isHighDefinitionInUse()}},{key:"disableMediaControl",value:function e(){if(!this.mediaControlDisabled){this.mediaControlDisabled=true;this.trigger(k.CONTAINER_MEDIACONTROL_DISABLE)}}},{key:"enableMediaControl",value:function e(){if(this.mediaControlDisabled){this.mediaControlDisabled=false;this.trigger(k.CONTAINER_MEDIACONTROL_ENABLE)}}},{key:"updateStyle",value:function e(){if(!this.options.chromeless||this.options.allowUserInteraction)this.$el.removeClass("chromeless");else this.$el.addClass("chromeless")}},{key:"enableResizeObserver",value:function e(){var t=this;this.disableResizeObserver();this.resizeObserverInterval=setInterval(function(){return t.checkResize()},500)}},{key:"disableResizeObserver",value:function e(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval)}},{key:"checkResize",value:function e(){var t={width:this.el.clientWidth,height:this.el.clientHeight};var r=this.currentSize||{},n=r.width,i=r.height;var a=i!==t.height||n!==t.width;if(a){this.currentSize=t;this.trigger(k.CONTAINER_RESIZE,t)}}},{key:"configure",value:function e(t){this._options=y.extend(true,this._options,t);this.updateStyle();this.playback.configure(this.options);this.trigger(k.CONTAINER_OPTIONS_CHANGE)}},{key:"render",value:function e(){var t=kr.getStyleFor(Sr.toString(),{baseUrl:this.options.baseUrl});this.$el.append(t[0]);this.$el.append(this.playback.render().el);this.updateStyle();this.checkResize();this.enableResizeObserver();return this}}]);return a}(Tr),S=(Object.assign(Cr.prototype,n),function(e){d(a,e);var i=f(a);c(a,[{key:"isAudioOnly",get:function e(){return false}},{key:"isAdaptive",get:function e(){return false}},{key:"ended",get:function e(){return false}},{key:"i18n",get:function e(){return this._i18n}},{key:"buffering",get:function e(){return false}}]);function a(e,t,r){var n;u(this,a);n=i.call(this,e);n.settings={};n._i18n=t;n.playerError=r;n._consented=false;return n}c(a,[{key:"consent",value:function e(t){typeof t==="function"&&t()}},{key:"play",value:function e(){}},{key:"pause",value:function e(){}},{key:"stop",value:function e(){}},{key:"seek",value:function e(t){}},{key:"seekPercentage",value:function e(t){}},{key:"getStartTimeOffset",value:function e(){return 0}},{key:"getDuration",value:function e(){return 0}},{key:"isPlaying",value:function e(){return false}},{key:"getPlaybackType",value:function e(){return a.NO_OP}},{key:"isHighDefinitionInUse",value:function e(){return false}},{key:"mute",value:function e(){}},{key:"unmute",value:function e(){}},{key:"volume",value:function e(t){}},{key:"configure",value:function e(t){this._options=y.extend(true,this._options,t)}},{key:"attemptAutoPlay",value:function e(){var r=this;this.canAutoPlay(function(e,t){e&&r.play()})}},{key:"canAutoPlay",value:function e(t){t(true,null)}},{key:"isReady",get:function e(){return false}},{key:"hasClosedCaptionsTracks",get:function e(){return this.closedCaptionsTracks.length>0}},{key:"closedCaptionsTracks",get:function e(){return[]}},{key:"closedCaptionsTrackId",get:function e(){return-1},set:function e(t){}}]);return a}(Tr)),Rr=(Object.assign(S.prototype,n),S.extend=function(e){return xt(S,e)},S.canPlay=function(e,t){return false},S.VOD="vod",S.AOD="aod",S.LIVE="live",S.NO_OP="no_op",S.type="playback",function(e){d(s,e);var a=f(s);c(s,[{key:"options",get:function e(){return this._options},set:function e(t){this._options=t}}]);function s(e,t,r,n){var i;u(this,s);i=a.call(this,e);i._i18n=r;i.loader=t;i.playerError=n;return i}c(s,[{key:"createContainers",value:function e(){var t=this;return y.Deferred(function(e){e.resolve(t.options.sources.map(function(e){return t.createContainer(e)}))})}},{key:"findPlaybackPlugin",value:function e(t,r){return this.loader.playbackPlugins.filter(function(e){return e.canPlay(t,r)})[0]}},{key:"createContainer",value:function e(t){var r=null;var n=this.options.mimeType;if(U(t)==="object"){r=t.source.toString();if(t.mimeType)n=t.mimeType}else r=t.toString();if(r.match(/^\/\//))r=window.location.protocol+r;var i=K(K({},this.options),{},{src:r,mimeType:n});var a=this.findPlaybackPlugin(r,n);var s=a?new a(i,this._i18n,this.playerError):new S;i=K(K({},i),{},{playback:s});var o=new Cr(i,this._i18n,this.playerError);var l=y.Deferred();l.promise(o);this.addContainerPlugins(o);this.listenToOnce(o,k.CONTAINER_READY,function(){return l.resolve(o)});return o}},{key:"addContainerPlugins",value:function e(t){this.loader.containerPlugins.forEach(function(e){t.addPlugin(new e(t))})}}]);return s}(r)),wr='[data-player] {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  transform: translate3d(0, 0, 0);\n  position: relative;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-style: normal;\n  font-weight: normal;\n  text-align: center;\n  overflow: hidden;\n  font-size: 100%;\n  font-family: "Roboto", "Open Sans", Arial, sans-serif;\n  text-shadow: 0 0 0;\n  box-sizing: border-box; }\n  [data-player]:focus {\n    outline: 0; }\n  [data-player] * {\n    box-sizing: inherit; }\n  [data-player] > * {\n    float: none;\n    max-width: none; }\n  [data-player] > div {\n    display: block; }\n  [data-player].fullscreen {\n    width: 100% !important;\n    height: 100% !important;\n    top: 0;\n    left: 0; }\n  [data-player].nocursor {\n    cursor: none; }\n\n.clappr-style {\n  display: none !important; }\n',Or='[data-player] div, [data-player] span, [data-player] applet, [data-player] object, [data-player] iframe,\n[data-player] h1, [data-player] h2, [data-player] h3, [data-player] h4, [data-player] h5, [data-player] h6, [data-player] p, [data-player] blockquote, [data-player] pre,\n[data-player] a, [data-player] abbr, [data-player] acronym, [data-player] address, [data-player] big, [data-player] cite, [data-player] code,\n[data-player] del, [data-player] dfn, [data-player] em, [data-player] img, [data-player] ins, [data-player] kbd, [data-player] q, [data-player] s, [data-player] samp,\n[data-player] small, [data-player] strike, [data-player] strong, [data-player] sub, [data-player] sup, [data-player] tt, [data-player] var,\n[data-player] b, [data-player] u, [data-player] i, [data-player] center,\n[data-player] dl, [data-player] dt, [data-player] dd, [data-player] ol, [data-player] ul, [data-player] li,\n[data-player] fieldset, [data-player] form, [data-player] label, [data-player] legend,\n[data-player] table, [data-player] caption, [data-player] tbody, [data-player] tfoot, [data-player] thead, [data-player] tr, [data-player] th, [data-player] td,\n[data-player] article, [data-player] aside, [data-player] canvas, [data-player] details, [data-player] embed,\n[data-player] figure, [data-player] figcaption, [data-player] footer, [data-player] header, [data-player] hgroup,\n[data-player] menu, [data-player] nav, [data-player] output, [data-player] ruby, [data-player] section, [data-player] summary,\n[data-player] time, [data-player] mark, [data-player] audio, [data-player] video {\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font: inherit;\n  font-size: 100%;\n  vertical-align: baseline; }\n\n[data-player] table {\n  border-collapse: collapse;\n  border-spacing: 0; }\n\n[data-player] caption, [data-player] th, [data-player] td {\n  text-align: left;\n  font-weight: normal;\n  vertical-align: middle; }\n\n[data-player] q, [data-player] blockquote {\n  quotes: none; }\n  [data-player] q:before, [data-player] q:after, [data-player] blockquote:before, [data-player] blockquote:after {\n    content: "";\n    content: none; }\n\n[data-player] a img {\n  border: none; }\n',Lr=function(e){d(n,e);var r=f(n);c(n,[{key:"events",get:function e(){return{webkitfullscreenchange:"handleFullscreenChange",mousemove:"onMouseMove",mouseleave:"onMouseLeave"}}},{key:"attributes",get:function e(){return{"data-player":"",tabindex:9999}}},{key:"isReady",get:function e(){return!!this.ready}},{key:"i18n",get:function e(){return this.getPlugin("strings")||{t:function e(t){return t}}}},{key:"mediaControl",get:function e(){return this._mediaControl||(this._mediaControl=this.getPlugin("media_control"))||this.dummyMediaControl}},{key:"dummyMediaControl",get:function e(){if(this._dummyMediaControl)return this._dummyMediaControl;this._dummyMediaControl=new i(this);return this._dummyMediaControl}},{key:"activeContainer",get:function e(){return this._activeContainer},set:function e(t){this._activeContainer=t;this.trigger(k.CORE_ACTIVE_CONTAINER_CHANGED,this._activeContainer)}},{key:"activePlayback",get:function e(){return this.activeContainer&&this.activeContainer.playback}}]);function n(e){var t;u(this,n);t=r.call(this,e);t.playerError=new T(e,z(t));t.configureDomRecycler();t.firstResize=true;t.plugins=[];t.containers=[];t._boundFullscreenHandler=function(){return t.handleFullscreenChange()};y(document).bind("fullscreenchange",t._boundFullscreenHandler);y(document).bind("MSFullscreenChange",t._boundFullscreenHandler);y(document).bind("mozfullscreenchange",t._boundFullscreenHandler);E.isMobile&&y(window).bind("resize",function(e){t.handleWindowResize(e)});return t}c(n,[{key:"configureDomRecycler",value:function e(){var t=this.options&&this.options.playback&&this.options.playback.recycleVideo;qt.configure({recycleVideo:t})}},{key:"createContainers",value:function e(t){this.defer=y.Deferred();this.defer.promise(this);this.containerFactory=new Rr(t,t.loader,this.i18n,this.playerError);this.prepareContainers()}},{key:"prepareContainers",value:function e(){var t=this;this.containerFactory.createContainers().then(function(e){return t.setupContainers(e)}).then(function(e){return t.resolveOnContainersReady(e)})}},{key:"updateSize",value:function e(){this.isFullscreen()?this.setFullscreen():this.setPlayerSize()}},{key:"setFullscreen",value:function e(){if(!E.isiOS){this.$el.addClass("fullscreen");this.$el.removeAttr("style");this.previousSize={width:this.options.width,height:this.options.height};this.currentSize={width:y(window).width(),height:y(window).height()}}}},{key:"setPlayerSize",value:function e(){this.$el.removeClass("fullscreen");this.currentSize=this.previousSize;this.previousSize={width:y(window).width(),height:y(window).height()};this.resize(this.currentSize)}},{key:"resize",value:function e(t){if(!Gt(t.height)&&!Gt(t.width)){this.el.style.height="".concat(t.height);this.el.style.width="".concat(t.width)}else{this.el.style.height="".concat(t.height,"px");this.el.style.width="".concat(t.width,"px")}this.previousSize={width:this.options.width,height:this.options.height};this.options.width=t.width;this.options.height=t.height;this.currentSize=t;this.triggerResize(this.currentSize)}},{key:"enableResizeObserver",value:function e(){var t=this;this.disableResizeObserver();var r=function e(){t.triggerResize({width:t.el.clientWidth,height:t.el.clientHeight})};this.resizeObserverInterval=setInterval(r,500)}},{key:"triggerResize",value:function e(t){var r=this.firstResize||this.oldHeight!==t.height||this.oldWidth!==t.width;if(r){this.oldHeight=t.height;this.oldWidth=t.width;this.computedSize=t;this.firstResize=false;this.trigger(k.CORE_RESIZE,t)}}},{key:"disableResizeObserver",value:function e(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval);this.resizeObserverInterval=null}},{key:"resolveOnContainersReady",value:function e(t){var r=this;y.when.apply(y,t).done(function(){r.defer.resolve(r);r.ready=true;r.trigger(k.CORE_READY)})}},{key:"addPlugin",value:function e(t){this.plugins.push(t)}},{key:"hasPlugin",value:function e(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function e(t){return this.plugins.filter(function(e){return e.name===t})[0]}},{key:"load",value:function e(t,r){this.options.mimeType=r;t=t&&t.constructor===Array?t:[t];this.options.sources=t;this.containers.forEach(function(e){return e.destroy()});this.containerFactory.options=y.extend(true,this.options,{sources:t});this.prepareContainers()}},{key:"destroy",value:function e(){this.disableResizeObserver();this.containers.forEach(function(e){return e.destroy()});this.plugins.forEach(function(e){return e.destroy()});this.$el.remove();y(document).unbind("fullscreenchange",this._boundFullscreenHandler);y(document).unbind("MSFullscreenChange",this._boundFullscreenHandler);y(document).unbind("mozfullscreenchange",this._boundFullscreenHandler);this.stopListening()}},{key:"handleFullscreenChange",value:function e(){this.trigger(k.CORE_FULLSCREEN,this.isFullscreen());this.updateSize()}},{key:"handleWindowResize",value:function e(t){var r=window.innerWidth>window.innerHeight?"landscape":"portrait";if(this._screenOrientation===r)return;this._screenOrientation=r;this.triggerResize({width:this.el.clientWidth,height:this.el.clientHeight});this.trigger(k.CORE_SCREEN_ORIENTATION_CHANGED,{event:t,orientation:this._screenOrientation})}},{key:"removeContainer",value:function e(t){this.stopListening(t);this.containers=this.containers.filter(function(e){return e!==t})}},{key:"setupContainer",value:function e(t){this.listenTo(t,k.CONTAINER_DESTROYED,this.removeContainer);this.containers.push(t)}},{key:"setupContainers",value:function e(t){t.forEach(this.setupContainer.bind(this));this.trigger(k.CORE_CONTAINERS_CREATED);this.renderContainers();this.activeContainer=t[0];this.render();this.appendToParent();return this.containers}},{key:"renderContainers",value:function e(){var t=this;this.containers.forEach(function(e){return t.el.appendChild(e.render().el)})}},{key:"createContainer",value:function e(t,r){var n=this.containerFactory.createContainer(t,r);this.setupContainer(n);this.el.appendChild(n.render().el);return n}},{key:"getCurrentContainer",value:function e(){return this.activeContainer}},{key:"getCurrentPlayback",value:function e(){return this.activePlayback}},{key:"getPlaybackType",value:function e(){return this.activeContainer&&this.activeContainer.getPlaybackType()}},{key:"isFullscreen",value:function e(){var t=Ft.fullscreenElement();if(!t)return false;var r=this.activePlayback&&this.activePlayback.el;return t===this.el||t===r}},{key:"toggleFullscreen",value:function e(){var t=this;if(this.isFullscreen()){Ft.cancelFullscreen();!E.isiOS&&this.$el.removeClass("fullscreen nocursor")}else{var r=E.isiOS?this.activePlayback&&this.activePlayback.el:this.el;if(!r)return;E.isSafari||E.isiOS?Ft.requestFullscreen(r):Ft.requestFullscreen(r).then(function(e){return e},function(e){return setTimeout(function(){if(!t.isFullscreen())throw new ReferenceError(e)},600)});!E.isiOS&&this.$el.addClass("fullscreen")}}},{key:"onMouseMove",value:function e(t){this.trigger(k.CORE_MOUSE_MOVE,t)}},{key:"onMouseLeave",value:function e(t){this.trigger(k.CORE_MOUSE_LEAVE,t)}},{key:"configure",value:function e(t){var r=this;this._options=y.extend(true,this._options,t);this.configureDomRecycler();var n=t.source||t.sources;n&&this.load(n,t.mimeType||this.options.mimeType);this.trigger(k.CORE_OPTIONS_CHANGE,t);this.containers.forEach(function(e){return e.configure(r.options)})}},{key:"appendToParent",value:function e(){var t=kr.getStyleFor(wr.toString(),{baseUrl:this.options.baseUrl});var r=kr.getStyleFor(Or.toString(),{baseUrl:this.options.baseUrl});this.$el.append(t[0]);this.options.includeResetStyle&&this.$el.append(r[0]);var n=this.$el.parent()&&this.$el.parent().length;!n&&this.$el.appendTo(this.options.parentElement)}},{key:"render",value:function e(){this.options.width=this.options.width||this.$el.width();this.options.height=this.options.height||this.$el.height();var t={width:this.options.width,height:this.options.height};this.previousSize=this.currentSize=this.computedSize=t;this.updateSize();this.enableResizeObserver();return this}}]);return n}(Tr),Ir=(Object.assign(Lr.prototype,n),function(e){d(n,e);var r=f(n);c(n,[{key:"loader",get:function e(){return this.player.loader}}]);function n(e){var t;u(this,n);t=r.call(this,e.options);t.player=e;return t}c(n,[{key:"create",value:function e(){this.options.loader=this.loader;this.core=new Lr(this.options);this.addCorePlugins();this.core.createContainers(this.options);return this.core}},{key:"addCorePlugins",value:function e(){var r=this;this.loader.corePlugins.forEach(function(e){var t=new e(r.core);r.core.addPlugin(t);r.setupExternalInterface(t)});return this.core}},{key:"setupExternalInterface",value:function e(t){var r=t.getExternalInterface();for(var n in r)this.player[n]=r[n].bind(t)}}]);return n}(r)),Dr=/(\d+)(?:\.(\d+))?(?:\.(\d+))?/,Pr=function(){c(o,null,[{key:"parse",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=t.match(Dr)||[];var n=X(r,4),i=n[1],a=n[2],s=n[3];if(typeof i==="undefined")return null;return new o(i,a,s)}}]);function o(e,t,r){u(this,o);this.major=parseInt(e||0,10);this.minor=parseInt(t||0,10);this.patch=parseInt(r||0,10)}c(o,[{key:"compare",value:function e(t){var r=this.major-t.major;r=r||this.minor-t.minor;r=r||this.patch-t.patch;return r}},{key:"inc",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"patch";typeof this[t]!=="undefined"&&(this[t]+=1);return this}},{key:"satisfies",value:function e(t,r){return this.compare(t)>=0&&(!r||this.compare(r)<0)}},{key:"toString",value:function e(){return"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}]);return o}(),Nr=function e(t,n){if(!t||!n)return{};return Object.entries(t).filter(function(e){var t=X(e,2),r=t[1];return r.type===n}).reduce(function(e,t){var r=X(t,2),n=r[0],i=r[1];return e[n]=i,e},{})},o=function(){var a={plugins:{},playbacks:[]};var l="0.4.19";return function(){c(o,null,[{key:"checkVersionSupport",value:function e(t){var r=t.prototype,n=r.supportedVersion,i=r.name;if(!n||!n.min){b.warn("Loader","missing version information for ".concat(i));return false}var a=n.max?Pr.parse(n.max):Pr.parse(n.min).inc("minor");var s=Pr.parse(n.min);if(!Pr.parse(l).satisfies(s,a)){b.warn("Loader","unsupported plugin ".concat(i,": Clappr version ").concat(l," does not match required range [").concat(s,",").concat(a,")"));return false}return true}},{key:"registerPlugin",value:function e(t){if(!t||!t.prototype.name){b.warn("Loader","missing information to register plugin: ".concat(t));return false}o.checkVersionSupport(t);var r=a.plugins;if(!r)return false;var n=r[t.prototype.name];if(n)b.warn("Loader","overriding plugin entry: ".concat(t.prototype.name," - ").concat(n));r[t.prototype.name]=t;return true}},{key:"registerPlayback",value:function e(t){if(!t||!t.prototype.name)return false;o.checkVersionSupport(t);var r=a.playbacks;var n=r.findIndex(function(e){return e.prototype.name===t.prototype.name});if(n>=0){var i=r[n];r.splice(n,1);b.warn("Loader","overriding playback entry: ".concat(i.name," - ").concat(i))}a.playbacks=[t].concat(Z(r));return true}},{key:"unregisterPlugin",value:function e(t){if(!t)return false;var r=a.plugins;var n=r[t];if(!n)return false;delete r[t];return true}},{key:"unregisterPlayback",value:function e(t){if(!t)return false;var r=a.playbacks;var n=r.findIndex(function(e){return e.prototype.name===t});if(n<0)return false;r.splice(n,1);a.playbacks=r;return true}},{key:"clearPlugins",value:function e(){a.plugins={}}},{key:"clearPlaybacks",value:function e(){a.playbacks=[]}},{key:"registeredPlaybacks",get:function e(){return Z(a.playbacks)}},{key:"registeredPlugins",get:function e(){var t=a.plugins;var r=Nr(t,"core");var n=Nr(t,"container");return{core:r,container:n}}}]);function o(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;u(this,o);this.playerId=t;this.playbackPlugins=Z(a.playbacks);var r=o.registeredPlugins,n=r.core,i=r.container;this.containerPlugins=Object.values(i);this.corePlugins=Object.values(n);if(!Array.isArray(e))this.validateExternalPluginsType(e);this.addExternalPlugins(e)}c(o,[{key:"groupPluginsByType",value:function e(t){if(Array.isArray(t))t=t.reduce(function(e,t){e[t.type]||(e[t.type]=[]);e[t.type].push(t);return e},{});return t}},{key:"removeDups",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var r=function e(t,r){if(t[r.prototype.name]&&n)return t;t[r.prototype.name]&&delete t[r.prototype.name];t[r.prototype.name]=r;return t};var i=t.reduceRight(r,Object.create(null));var a=[];for(var s in i)a.unshift(i[s]);return a}},{key:"addExternalPlugins",value:function e(t){var r=typeof t.loadExternalPluginsFirst==="boolean"?t.loadExternalPluginsFirst:true;var n=typeof t.loadExternalPlaybacksFirst==="boolean"?t.loadExternalPlaybacksFirst:true;t=this.groupPluginsByType(t);if(t.playback){var i=t.playback.filter(function(e){return o.checkVersionSupport(e),true});this.playbackPlugins=n?this.removeDups(i.concat(this.playbackPlugins)):this.removeDups(this.playbackPlugins.concat(i),true)}if(t.container){var a=t.container.filter(function(e){return o.checkVersionSupport(e),true});this.containerPlugins=r?this.removeDups(a.concat(this.containerPlugins)):this.removeDups(this.containerPlugins.concat(a),true)}if(t.core){var s=t.core.filter(function(e){return o.checkVersionSupport(e),true});this.corePlugins=r?this.removeDups(s.concat(this.corePlugins)):this.removeDups(this.corePlugins.concat(s),true)}}},{key:"validateExternalPluginsType",value:function e(t){var r=["playback","container","core"];r.forEach(function(r){(t[r]||[]).forEach(function(e){var t="external "+e.type+" plugin on "+r+" array";if(e.type!==r)throw new ReferenceError(t)})})}}]);return o}()}(),xr=Kt().replace(/\/[^/]+$/,""),Mr=function(e){d(a,e);var i=f(a);c(a,[{key:"loader",set:function e(t){this._loader=t},get:function e(){if(!this._loader)this._loader=new o(this.options.plugins||{},this.options.playerId);return this._loader}},{key:"ended",get:function e(){return this.core.activeContainer.ended}},{key:"buffering",get:function e(){return this.core.activeContainer.buffering}},{key:"isReady",get:function e(){return!!this._ready}},{key:"eventsMapping",get:function e(){return{onReady:k.PLAYER_READY,onResize:k.PLAYER_RESIZE,onPlay:k.PLAYER_PLAY,onPause:k.PLAYER_PAUSE,onStop:k.PLAYER_STOP,onEnded:k.PLAYER_ENDED,onSeek:k.PLAYER_SEEK,onError:k.PLAYER_ERROR,onTimeUpdate:k.PLAYER_TIMEUPDATE,onVolumeUpdate:k.PLAYER_VOLUMEUPDATE,onSubtitleAvailable:k.PLAYER_SUBTITLE_AVAILABLE}}}]);function a(e){var t;u(this,a);t=i.call(this,e);var r={recycleVideo:true};var n={playerId:Vt(""),persistConfig:true,width:640,height:360,baseUrl:xr,allowUserInteraction:E.isMobile,includeResetStyle:true,playback:r};t._options=y.extend(true,n,e);t.options.sources=t._normalizeSources(e);if(!t.options.chromeless)t.options.allowUserInteraction=true;if(!t.options.allowUserInteraction)t.options.disableKeyboardShortcuts=true;t._registerOptionEventListeners(t.options.events);t._coreFactory=new Ir(z(t));if(t.options.parentId)t.setParentId(t.options.parentId);else if(t.options.parent)t.attachTo(t.options.parent);return t}c(a,[{key:"setParentId",value:function e(t){var r=document.querySelector(t);if(r)this.attachTo(r);return this}},{key:"attachTo",value:function e(t){this.options.parentElement=t;this.core=this._coreFactory.create();this._addEventListeners();return this}},{key:"_addEventListeners",value:function e(){if(!this.core.isReady)this.listenToOnce(this.core,k.CORE_READY,this._onReady);else this._onReady();this.listenTo(this.core,k.CORE_ACTIVE_CONTAINER_CHANGED,this._containerChanged);this.listenTo(this.core,k.CORE_FULLSCREEN,this._onFullscreenChange);this.listenTo(this.core,k.CORE_RESIZE,this._onResize);return this}},{key:"_addContainerEventListeners",value:function e(){var t=this.core.activeContainer;if(t){this.listenTo(t,k.CONTAINER_PLAY,this._onPlay);this.listenTo(t,k.CONTAINER_PAUSE,this._onPause);this.listenTo(t,k.CONTAINER_STOP,this._onStop);this.listenTo(t,k.CONTAINER_ENDED,this._onEnded);this.listenTo(t,k.CONTAINER_SEEK,this._onSeek);this.listenTo(t,k.CONTAINER_ERROR,this._onError);this.listenTo(t,k.CONTAINER_TIMEUPDATE,this._onTimeUpdate);this.listenTo(t,k.CONTAINER_VOLUME,this._onVolumeUpdate);this.listenTo(t,k.CONTAINER_SUBTITLE_AVAILABLE,this._onSubtitleAvailable)}return this}},{key:"_registerOptionEventListeners",value:function e(){var n=this;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var t=Object.keys(i).length>0;t&&Object.keys(r).forEach(function(e){var t=n.eventsMapping[e];t&&n.off(t,r[e])});Object.keys(i).forEach(function(e){var t=n.eventsMapping[e];if(t){var r=i[e];r=typeof r==="function"&&r;r&&n.on(t,r)}});return this}},{key:"_containerChanged",value:function e(){this.stopListening();this._addEventListeners()}},{key:"_onReady",value:function e(){this._ready=true;this._addContainerEventListeners();this.trigger(k.PLAYER_READY)}},{key:"_onFullscreenChange",value:function e(t){this.trigger(k.PLAYER_FULLSCREEN,t)}},{key:"_onVolumeUpdate",value:function e(t){this.trigger(k.PLAYER_VOLUMEUPDATE,t)}},{key:"_onSubtitleAvailable",value:function e(){this.trigger(k.PLAYER_SUBTITLE_AVAILABLE)}},{key:"_onResize",value:function e(t){this.trigger(k.PLAYER_RESIZE,t)}},{key:"_onPlay",value:function e(){this.trigger(k.PLAYER_PLAY)}},{key:"_onPause",value:function e(){this.trigger(k.PLAYER_PAUSE)}},{key:"_onStop",value:function e(){this.trigger(k.PLAYER_STOP,this.getCurrentTime())}},{key:"_onEnded",value:function e(){this.trigger(k.PLAYER_ENDED)}},{key:"_onSeek",value:function e(t){this.trigger(k.PLAYER_SEEK,t)}},{key:"_onTimeUpdate",value:function e(t){this.trigger(k.PLAYER_TIMEUPDATE,t)}},{key:"_onError",value:function e(t){this.trigger(k.PLAYER_ERROR,t)}},{key:"_normalizeSources",value:function e(t){var r=t.sources||(t.source!==undefined?[t.source]:[]);return r.length===0?[{source:"",mimeType:""}]:r}},{key:"resize",value:function e(t){this.core.resize(t);return this}},{key:"load",value:function e(t,r,n){if(n!==undefined)this.configure({autoPlay:!!n});this.core.load(t,r);return this}},{key:"destroy",value:function e(){this.stopListening();this.core.destroy();return this}},{key:"consent",value:function e(t){this.core.getCurrentPlayback().consent(t)}},{key:"play",value:function e(){this.core.activeContainer.play();return this}},{key:"pause",value:function e(){this.core.activeContainer.pause();return this}},{key:"stop",value:function e(){this.core.activeContainer.stop();return this}},{key:"seek",value:function e(t){this.core.activeContainer.seek(t);return this}},{key:"seekPercentage",value:function e(t){this.core.activeContainer.seekPercentage(t);return this}},{key:"mute",value:function e(){this.core.activePlayback.mute();return this}},{key:"unmute",value:function e(){this.core.activePlayback.unmute();return this}},{key:"isPlaying",value:function e(){return this.core.activeContainer.isPlaying()}},{key:"isDvrEnabled",value:function e(){return this.core.activeContainer.isDvrEnabled()}},{key:"isDvrInUse",value:function e(){return this.core.activeContainer.isDvrInUse()}},{key:"configure",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._registerOptionEventListeners(t.events,this.options.events);this.core.configure(t);return this}},{key:"getPlugin",value:function e(t){var r=this.core.plugins.concat(this.core.activeContainer.plugins);return r.filter(function(e){return e.name===t})[0]}},{key:"getCurrentTime",value:function e(){return this.core.activeContainer.getCurrentTime()}},{key:"getStartTimeOffset",value:function e(){return this.core.activeContainer.getStartTimeOffset()}},{key:"getDuration",value:function e(){return this.core.activeContainer.getDuration()}}]);return a}(r),a=(Object.assign(Mr.prototype,n),function(e){d(n,e);var r=f(n);c(n,[{key:"playerError",get:function e(){return this.container.playerError}}]);function n(e){var t;u(this,n);t=r.call(this,e.options);t.container=e;t.enabled=true;t.bindEvents();return t}c(n,[{key:"enable",value:function e(){if(!this.enabled){this.bindEvents();this.enabled=true}}},{key:"disable",value:function e(){if(this.enabled){this.stopListening();this.enabled=false}}},{key:"bindEvents",value:function e(){}},{key:"destroy",value:function e(){this.stopListening()}}]);return n}(r)),l=(Object.assign(a.prototype,n),a.extend=function(e){return xt(a,e)},a.type="container",function(e){d(n,e);var r=f(n);c(n,[{key:"playerError",get:function e(){return this.core.playerError}}]);function n(e){var t;u(this,n);t=r.call(this,e.options);t.core=e;t.enabled=true;t.bindEvents();return t}c(n,[{key:"bindEvents",value:function e(){}},{key:"enable",value:function e(){if(!this.enabled){this.bindEvents();this.enabled=true}}},{key:"disable",value:function e(){if(this.enabled){this.stopListening();this.enabled=false}}},{key:"getExternalInterface",value:function e(){return{}}},{key:"destroy",value:function e(){this.stopListening()}}]);return n}(r)),C=(Object.assign(l.prototype,n),l.extend=function(e){return xt(l,e)},l.type="core",function(e){d(n,e);var r=f(n);c(n,[{key:"playerError",get:function e(){return this.container.playerError}}]);function n(e){var t;u(this,n);t=r.call(this,e.options);t.container=e;t.enabled=true;t.bindEvents();return t}c(n,[{key:"enable",value:function e(){if(!this.enabled){this.bindEvents();this.$el.show();this.enabled=true}}},{key:"disable",value:function e(){this.stopListening();this.$el.hide();this.enabled=false}},{key:"bindEvents",value:function e(){}}]);return n}(Tr)),Fr=(Object.assign(C.prototype,n),C.extend=function(e){return xt(C,e)},C.type="container",'<% for (var i = 0; i < tracks.length; i++) { %>\n  <track data-html5-video-track="<%= i %>" kind="<%= tracks[i].kind %>" label="<%= tracks[i].label %>" srclang="<%= tracks[i].lang %>" src="<%= tracks[i].src %>">\n<% }; %>\n'),Br="[data-html5-video] {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  display: block; }\n",Ur={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]},jr=(Ur["ogv"]=Ur["ogg"],Ur["3gp"]=Ur["3gpp"],{wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]}),Vr=Object.keys(jr).reduce(function(e,t){return[].concat(Z(e),Z(jr[t]))},[]),Gr={code:"unknown",message:"unknown"},R=function(e){d(l,e);var o=f(l);c(l,[{key:"name",get:function e(){return"html5_video"}},{key:"supportedVersion",get:function e(){return{min:"0.4.19"}}},{key:"tagName",get:function e(){return this.isAudioOnly?"audio":"video"}},{key:"isAudioOnly",get:function e(){var t=this.options.src;var r=l._mimeTypesForUrl(t,jr,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||Vr.indexOf(r[0])>=0}},{key:"attributes",get:function e(){return{"data-html5-video":""}}},{key:"events",get:function e(){return{canplay:"_onCanPlay",canplaythrough:"_handleBufferingEvents",durationchange:"_onDurationChange",ended:"_onEnded",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",stalled:"_handleBufferingEvents",timeupdate:"_onTimeUpdate",waiting:"_onWaiting"}}},{key:"ended",get:function e(){return this.el.ended}},{key:"buffering",get:function e(){return this._isBuffering}},{key:"isLive",get:function e(){return this.getPlaybackType()===S.LIVE}},{key:"dvrEnabled",get:function e(){return this.getDuration()>=this._minDvrSize&&this.isLive}},{key:"minimumDVRSizeConfig",get:function e(){return this.options.playback&&this.options.playback.minimumDvrSize}},{key:"isValidMinimumDVRSizeConfig",get:function e(){return typeof this.minimumDVRSizeConfig!=="undefined"&&typeof this.minimumDVRSizeConfig==="number"}}]);function l(){var e;u(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e=o.call.apply(o,[this].concat(r));e._destroyed=false;e._loadStarted=false;e._isBuffering=false;e._playheadMoving=false;e._playheadMovingTimer=null;e._stopped=false;e._ccTrackId=-1;e._setupSrc(e.options.src);e.options.playback||(e.options.playback=e.options||{});e.options.playback.disableContextMenu=e.options.playback.disableContextMenu||e.options.disableVideoTagContextMenu;e._minDvrSize=e.isValidMinimumDVRSizeConfig?e.minimumDVRSizeConfig:60;var i=e.options.playback;var a=i.preload||(E.isSafari?"auto":e.options.preload);var s;if(e.options.poster)if(typeof e.options.poster==="string")s=e.options.poster;else if(typeof e.options.poster.url==="string")s=e.options.poster.url;y.extend(true,e.el,{muted:e.options.mute,defaultMuted:e.options.mute,loop:e.options.loop,poster:s,preload:a||"metadata",crossOrigin:i.crossOrigin,"x-webkit-playsinline":i.playInline});if(i.controls||e.options.useVideoTagDefaultControls)e.$el.attr("controls","");i.playInline&&e.$el.attr({playsinline:"playsinline"});i.crossOrigin&&e.$el.attr({crossorigin:i.crossOrigin});e.settings={default:["seekbar"]};e.settings.left=["playpause","position","duration"];e.settings.right=["fullscreen","volume","hd-indicator"];i.externalTracks&&e._setupExternalTracks(i.externalTracks);e.options.autoPlay&&e.attemptAutoPlay();return e}c(l,[{key:"configure",value:function e(t){q(s(l.prototype),"configure",this).call(this,t);this.el.loop=!!t.loop}},{key:"attemptAutoPlay",value:function e(){var r=this;this.canAutoPlay(function(e,t){t&&b.warn(r.name,"autoplay error.",{result:e,error:t});e&&setTimeout(function(){return!r._destroyed&&r.play()},0)})}},{key:"canAutoPlay",value:function e(t){if(this.options.disableCanAutoPlay){t(true,null);return}var r={timeout:this.options.autoPlayTimeout||500,inline:this.options.playback.playInline||false,muted:this.options.mute||false};if(E.isMobile&&qt.options.recycleVideo)r.element=this.el;Wt(t,r)}},{key:"_setupExternalTracks",value:function e(t){this._externalTracks=t.map(function(e){return{kind:e.kind||"subtitles",label:e.label,lang:e.lang,src:e.src}})}},{key:"_setupSrc",value:function e(t){if(this.el.src===t)return;this._ccIsSetup=false;this.el.src=t;this._src=this.el.src}},{key:"_onLoadedMetadata",value:function e(t){this._handleBufferingEvents();this.trigger(k.PLAYBACK_LOADEDMETADATA,{duration:t.target.duration,data:t});this._updateSettings();var r=typeof this._options.autoSeekFromUrl==="undefined"||this._options.autoSeekFromUrl;if(this.getPlaybackType()!==S.LIVE&&r)this._checkInitialSeek()}},{key:"_onDurationChange",value:function e(){this._updateSettings();this._onTimeUpdate();this._onProgress()}},{key:"_updateSettings",value:function e(){if(this.getPlaybackType()===S.VOD||this.getPlaybackType()===S.AOD)this.settings.left=["playpause","position","duration"];else this.settings.left=["playstop"];this.settings.seekEnabled=this.isSeekEnabled();this.trigger(k.PLAYBACK_SETTINGSUPDATE)}},{key:"isSeekEnabled",value:function e(){return isFinite(this.getDuration())}},{key:"getPlaybackType",value:function e(){var t=this.tagName==="audio"?S.AOD:S.VOD;return[0,undefined,Infinity].indexOf(this.el.duration)>=0?S.LIVE:t}},{key:"isHighDefinitionInUse",value:function e(){return false}},{key:"consent",value:function e(t){var r=this;if(this.isPlaying()||this.el._consented)q(s(l.prototype),"consent",this).call(this,t);else{var n=function e(){r.el.removeEventListener("loadedmetadata",e,false);r.el.removeEventListener("error",e,false);r.el._consented=true;q(s(l.prototype),"consent",r).call(r,t)};this.el.addEventListener("loadedmetadata",n,false);this.el.addEventListener("error",n,false);this.el.load()}}},{key:"play",value:function e(){this.trigger(k.PLAYBACK_PLAY_INTENT);this._stopped=false;this._setupSrc(this._src);this._handleBufferingEvents();var t=this.el.play();if(t&&t["catch"])t["catch"](function(){})}},{key:"pause",value:function e(){this.el.pause();this.dvrEnabled&&this._updateDvr(true)}},{key:"stop",value:function e(){this.pause();this._stopped=true;this.el.removeAttribute("src");this.el.load();this._stopPlayheadMovingChecks();this._handleBufferingEvents();this.trigger(k.PLAYBACK_STOP)}},{key:"volume",value:function e(t){if(t===0){this.$el.attr({muted:"true"});this.el.muted=true}else{this.$el.attr({muted:null});this.el.muted=false;this.el.volume=t/100}}},{key:"mute",value:function e(){this.el.muted=true}},{key:"unmute",value:function e(){this.el.muted=false}},{key:"isMuted",value:function e(){return this.el.muted===true||this.el.volume===0}},{key:"isPlaying",value:function e(){return!this.el.paused&&!this.el.ended}},{key:"_startPlayheadMovingChecks",value:function e(){if(this._playheadMovingTimer!==null)return;this._playheadMovingTimeOnCheck=null;this._determineIfPlayheadMoving();this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500)}},{key:"_stopPlayheadMovingChecks",value:function e(){if(this._playheadMovingTimer===null)return;clearInterval(this._playheadMovingTimer);this._playheadMovingTimer=null;this._playheadMoving=false}},{key:"_determineIfPlayheadMoving",value:function e(){var t=this._playheadMovingTimeOnCheck;var r=this.el.currentTime;this._playheadMoving=t!==r;this._playheadMovingTimeOnCheck=r;this._handleBufferingEvents()}},{key:"_onWaiting",value:function e(){this._loadStarted=true;this._handleBufferingEvents()}},{key:"_onLoadedData",value:function e(){this._loadStarted=true;this._handleBufferingEvents()}},{key:"_onCanPlay",value:function e(){this._handleBufferingEvents()}},{key:"_onPlaying",value:function e(){this._checkForClosedCaptions();this._startPlayheadMovingChecks();this._handleBufferingEvents();this.trigger(k.PLAYBACK_PLAY)}},{key:"_onPause",value:function e(){this._stopPlayheadMovingChecks();this._handleBufferingEvents();this.trigger(k.PLAYBACK_PAUSE)}},{key:"_onSeeking",value:function e(){this.trigger(k.PLAYBACK_SEEK,this.getCurrentTime());this._handleBufferingEvents()}},{key:"_onSeeked",value:function e(){this._handleBufferingEvents();this.trigger(k.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function e(){this._handleBufferingEvents();this.trigger(k.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingEvents",value:function e(){var t=!this.el.ended&&!this.el.paused;var r=this._loadStarted&&!this.el.ended&&!this._stopped&&(t&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);if(this._isBuffering!==r){this._isBuffering=r;if(r)this.trigger(k.PLAYBACK_BUFFERING,this.name);else this.trigger(k.PLAYBACK_BUFFERFULL,this.name)}}},{key:"_onError",value:function e(){var t=this.el.error||Gr,r=t.code,n=t.message;var i=r===Gr.code;var a=this.createError({code:r,description:n,raw:this.el.error,level:i?T.Levels.WARN:T.Levels.FATAL});if(i)b.warn(this.name,"HTML5 unknown error: ",a);else this.trigger(k.PLAYBACK_ERROR,a)}},{key:"destroy",value:function e(){this._destroyed=true;this.handleTextTrackChange&&this.el.textTracks.removeEventListener("change",this.handleTextTrackChange);q(s(l.prototype),"destroy",this).call(this);this.el.removeAttribute("src");this.el.load();this._src=null;qt.garbage(this.el)}},{key:"_updateDvr",value:function e(t){this.trigger(k.PLAYBACK_DVR,t);this.trigger(k.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"seek",value:function e(t){if(t<0){b.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point.");t=this.getDuration()}this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3);t+=this.el.seekable.start(0);this.el.currentTime=t}},{key:"seekPercentage",value:function e(t){var r=this.el.duration*(t/100);this.seek(r)}},{key:"_checkInitialSeek",value:function e(){var t=jt();if(t!==0)this.seek(t)}},{key:"getCurrentTime",value:function e(){return this.el.currentTime}},{key:"getDuration",value:function e(){if(this.isLive)if(this.el.seekable.length>0)return this.el.seekable.end(0)-this.el.seekable.start(0);else this._scheduleUpdateSettingsCheck();return this.el.duration}},{key:"_scheduleUpdateSettingsCheck",value:function e(){var t=this;if(this._updateSettingsCheckInFlight)return;this._updateSettingsCheckInFlight=setTimeout(function(){t._updateSettings();t._updateSettingsCheckInFlight=null},1e3)}},{key:"_onTimeUpdate",value:function e(){var t=this.isLive?this.getDuration():this.el.duration;this.trigger(k.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:t},this.name)}},{key:"_onProgress",value:function e(){if(!this.el.buffered.length)return;var t=[];var r=0;for(var n=0;n<this.el.buffered.length;n++){t=[].concat(Z(t),[{start:this.el.buffered.start(n),end:this.el.buffered.end(n)}]);if(this.el.currentTime>=t[n].start&&this.el.currentTime<=t[n].end)r=n}var i={start:t[r].start,current:t[r].end,total:this.el.duration};this.trigger(k.PLAYBACK_PROGRESS,i,t)}},{key:"_typeFor",value:function e(t){var r=l._mimeTypesForUrl(t,Ur,this.options.mimeType);if(r.length===0)r=l._mimeTypesForUrl(t,jr,this.options.mimeType);var n=r[0]||"";return n.split(";")[0]}},{key:"_ready",value:function e(){if(this._isReadyState)return;this._isReadyState=true;this.trigger(k.PLAYBACK_READY,this.name)}},{key:"_checkForClosedCaptions",value:function e(){if(this.isHTML5Video&&!this._ccIsSetup){if(this.hasClosedCaptionsTracks){this.trigger(k.PLAYBACK_SUBTITLE_AVAILABLE);var t=this.closedCaptionsTrackId;this.closedCaptionsTrackId=t;this.handleTextTrackChange=this._handleTextTrackChange.bind(this);this.el.textTracks.addEventListener("change",this.handleTextTrackChange)}this._ccIsSetup=true}}},{key:"_handleTextTrackChange",value:function e(){var t=this.closedCaptionsTracks;var r=t.find(function(e){return e.track.mode==="showing"})||{id:-1};if(this._ccTrackId!==r.id){this._ccTrackId=r.id;this.trigger(k.PLAYBACK_SUBTITLE_CHANGED,{id:r.id})}}},{key:"render",value:function e(){if(this.options.playback.disableContextMenu)this.$el.on("contextmenu",function(){return false});if(this._externalTracks&&this._externalTracks.length>0)this.$el.html(this.template({tracks:this._externalTracks}));this._ready();var t=kr.getStyleFor(Br.toString(),{baseUrl:this.options.baseUrl});this.$el.append(t[0]);return this}},{key:"isReady",get:function e(){return this._isReadyState}},{key:"isHTML5Video",get:function e(){return this.name===l.prototype.name}},{key:"closedCaptionsTracks",get:function e(){var t=0;var r=function e(){return t++};var n=this.el.textTracks?Array.from(this.el.textTracks):[];return n.filter(function(e){return e.kind==="subtitles"||e.kind==="captions"}).map(function(e){return{id:r(),name:e.label,track:e}})}},{key:"closedCaptionsTrackId",get:function e(){return this._ccTrackId},set:function e(t){if(!Gt(t))return;var r=this.closedCaptionsTracks;var n;if(t!==-1){n=r.find(function(e){return e.id===t});if(!n)return;if(n.track.mode==="showing")return}r.filter(function(e){return e.track.mode!=="hidden"}).forEach(function(e){return e.track.mode="hidden"});n&&(n.track.mode="showing");this._ccTrackId=t;this.trigger(k.PLAYBACK_SUBTITLE_CHANGED,{id:t})}},{key:"template",get:function e(){return _(Fr)}}]);return l}(S),Kr=(R._mimeTypesForUrl=function(e,t,r){var n=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1];var i=r||n&&t[n.toLowerCase()]||[];return i.constructor===Array?i:[i]},R._canPlay=function(e,t,r,n){var i=R._mimeTypesForUrl(r,t,n);var a=document.createElement(e);return!!i.filter(function(e){return!!a.canPlayType(e).replace(/no/,"")})[0]},R.canPlay=function(e,t){return R._canPlay("audio",jr,e,t)||R._canPlay("video",Ur,e,t)},function(e){d(r,e);var t=f(r);function r(){u(this,r);return t.apply(this,arguments)}c(r,[{key:"updateSettings",value:function e(){this.settings.left=["playpause","position","duration"];this.settings.seekEnabled=this.isSeekEnabled();this.trigger(k.PLAYBACK_SETTINGSUPDATE)}},{key:"getPlaybackType",value:function e(){return S.AOD}},{key:"name",get:function e(){return"html5_audio"}},{key:"supportedVersion",get:function e(){return{min:"0.4.19"}}},{key:"tagName",get:function e(){return"audio"}},{key:"isAudioOnly",get:function e(){return true}}]);return r}(R)),Yr=(Kr.canPlay=function(e,t){var r={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]};return R._canPlay("audio",r,e,t)},"[data-html-img] {\n  max-width: 100%;\n  max-height: 100%; }\n"),Hr=function(e){d(n,e);var r=f(n);c(n,[{key:"getPlaybackType",value:function e(){return S.NO_OP}},{key:"name",get:function e(){return"html_img"}},{key:"supportedVersion",get:function e(){return{min:"0.4.19"}}},{key:"tagName",get:function e(){return"img"}},{key:"attributes",get:function e(){return{"data-html-img":""}}},{key:"events",get:function e(){return{load:"_onLoad",abort:"_onError",error:"_onError"}}}]);function n(e){var t;u(this,n);t=r.call(this,e);t.el.src=e.src;return t}c(n,[{key:"render",value:function e(){var t=kr.getStyleFor(Yr.toString(),{baseUrl:this.options.baseUrl});this.$el.append(t[0]);this.trigger(k.PLAYBACK_READY,this.name);return this}},{key:"_onLoad",value:function e(){this.trigger(k.PLAYBACK_ENDED,this.name)}},{key:"_onError",value:function e(t){var r=t.type==="error"?"load error":"loading aborted";this.trigger(k.PLAYBACK_ERROR,{message:r},this.name)}}]);return n}(S),zr=(Hr.canPlay=function(e){return/\.(png|jpg|jpeg|gif|bmp|tiff|pgm|pnm|webp)(|\?.*)$/i.test(e)},"<canvas data-no-op-canvas></canvas>\n<p data-no-op-msg><%=message%></p><p>\n</p>"),$r="[data-no-op] {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  text-align: center; }\n\n[data-no-op] p[data-no-op-msg] {\n  position: absolute;\n  text-align: center;\n  font-size: 25px;\n  left: 0;\n  right: 0;\n  color: white;\n  padding: 10px;\n  /* center vertically */\n  top: 50%;\n  transform: translateY(-50%);\n  max-height: 100%;\n  overflow: auto; }\n\n[data-no-op] canvas[data-no-op-canvas] {\n  background-color: #777;\n  height: 100%;\n  width: 100%; }\n",Wr=function(e){d(a,e);var i=f(a);c(a,[{key:"name",get:function e(){return"no_op"}},{key:"supportedVersion",get:function e(){return{min:"0.4.19"}}},{key:"template",get:function e(){return _(zr)}},{key:"attributes",get:function e(){return{"data-no-op":""}}}]);function a(){var e;u(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e=i.call.apply(i,[this].concat(r));e._noiseFrameNum=-1;return e}c(a,[{key:"render",value:function e(){var t=this.options.playbackNotSupportedMessage||this.i18n.t("playback_not_supported");var r=kr.getStyleFor($r.toString(),{baseUrl:this.options.baseUrl});this.$el.append(r[0]);this.$el.html(this.template({message:t}));this.trigger(k.PLAYBACK_READY,this.name);var n=!!(this.options.poster&&this.options.poster.showForNoOp);if(this.options.autoPlay||!n)this._animate();return this}},{key:"_noise",value:function e(){this._noiseFrameNum=(this._noiseFrameNum+1)%5;if(this._noiseFrameNum)return;var t=this.context.createImageData(this.context.canvas.width,this.context.canvas.height);var r;try{r=new Uint32Array(t.data.buffer)}catch(e){r=new Uint32Array(this.context.canvas.width*this.context.canvas.height*4);var n=t.data;for(var i=0;i<n.length;i++)r[i]=n[i]}var a=r.length,s=Math.random()*6+4;var o=0,l=0;for(var u=0;u<a;){if(o<0){o=s*Math.random();var c=Math.pow(Math.random(),.4);l=255*c<<24}o-=1;r[u++]=l}this.context.putImageData(t,0,0)}},{key:"_loop",value:function e(){var t=this;if(this._stop)return;this._noise();this._animationHandle=Dt(function(){return t._loop()})}},{key:"destroy",value:function e(){if(this._animationHandle){Pt(this._animationHandle);this._stop=true}}},{key:"_animate",value:function e(){this.canvas=this.$el.find("canvas[data-no-op-canvas]")[0];this.context=this.canvas.getContext("2d");this._loop()}}]);return a}(S),qr=(Wr.canPlay=function(e){return true},function(e){d(n,e);var r=f(n);c(n,[{key:"name",get:function e(){return"strings"}},{key:"supportedVersion",get:function e(){return{min:"0.4.19"}}}]);function n(e){var t;u(this,n);t=r.call(this,e);t._initializeMessages();return t}c(n,[{key:"t",value:function e(t){var r=this._language();var n=this._messages["en"];var i=r&&this._messages[r]||n;return i[t]||n[t]||t}},{key:"_language",value:function e(){return this.core.options.language||Yt()}},{key:"_initializeMessages",value:function e(){var t={en:{live:"live",back_to_live:"back to live",disabled:"Disabled",playback_not_supported:"Your browser does not support the playback of this video. Please try using a different browser.",default_error_title:"Could not play video.",default_error_message:"There was a problem trying to load the video."},de:{live:"Live",back_to_live:"Zurück zum Live-Video",disabled:"Deaktiviert",playback_not_supported:"Ihr Browser unterstützt das Playback Verfahren nicht. Bitte vesuchen Sie es mit einem anderen Browser.",default_error_title:"Video kann nicht abgespielt werden",default_error_message:"Es gab ein Problem beim Laden des Videos"},pt:{live:"ao vivo",back_to_live:"voltar para o ao vivo",disabled:"Desativado",playback_not_supported:"Seu navegador não supporta a reprodução deste video. Por favor, tente usar um navegador diferente.",default_error_title:"Não foi possível reproduzir o vídeo.",default_error_message:"Ocorreu um problema ao tentar carregar o vídeo."},es:{live:"vivo",back_to_live:"volver en vivo",disabled:"Discapacitado",playback_not_supported:"Su navegador no soporta la reproducción de un video. Por favor, trate de usar un navegador diferente."},ru:{live:"прямой эфир",back_to_live:"к прямому эфиру",disabled:"Отключено",playback_not_supported:"Ваш браузер не поддерживает воспроизведение этого видео. Пожалуйста, попробуйте другой браузер."},fr:{live:"en direct",back_to_live:"retour au direct",disabled:"Désactivé",playback_not_supported:"Votre navigateur ne supporte pas la lecture de cette vidéo. Merci de tenter sur un autre navigateur.",default_error_title:"Impossible de lire la vidéo.",default_error_message:"Un problème est survenu lors du chargement de la vidéo."},tr:{live:"canlı",back_to_live:"canlı yayına dön",disabled:"Engelli",playback_not_supported:"Tarayıcınız bu videoyu oynatma desteğine sahip değil. Lütfen farklı bir tarayıcı ile deneyin."},et:{live:"Otseülekanne",back_to_live:"Tagasi otseülekande juurde",disabled:"Keelatud",playback_not_supported:"Teie brauser ei toeta selle video taasesitust. Proovige kasutada muud brauserit."},ar:{live:"مباشر",back_to_live:"الرجوع إلى المباشر",disabled:"معطّل",playback_not_supported:"المتصفح الذي تستخدمه لا يدعم تشغيل هذا الفيديو. الرجاء إستخدام متصفح آخر.",default_error_title:"غير قادر الى التشغيل.",default_error_message:"حدثت مشكلة أثناء تحميل الفيديو."}};this._messages=y.extend(true,t,this.core.options.strings||{});this._messages["de-DE"]=this._messages["de"];this._messages["pt-BR"]=this._messages["pt"];this._messages["en-US"]=this._messages["en"];this._messages["es-419"]=this._messages["es"];this._messages["fr-FR"]=this._messages["fr"];this._messages["tr-TR"]=this._messages["tr"];this._messages["et-EE"]=this._messages["et"];this._messages["ar-IQ"]=this._messages["ar"]}}]);return n}(l)),Xr=function(e){d(r,e);var t=f(r);function r(){u(this,r);return t.apply(this,arguments)}c(r,[{key:"bindEvents",value:function e(){this.listenTo(this.core,k.CORE_CONTAINERS_CREATED,this.onContainersCreated)}},{key:"onContainersCreated",value:function e(){var t=this.core.containers.filter(function(e){return e.playback.name!=="no_op"})[0]||this.core.containers[0];t&&this.core.containers.forEach(function(e){if(e!==t)e.destroy()})}},{key:"name",get:function e(){return"sources"}},{key:"supportedVersion",get:function e(){return{min:"0.4.19"}}}]);return r}(l),Zr="0.4.19",Qr=(o.registerPlugin(qr),o.registerPlugin(Xr),o.registerPlayback(Wr),o.registerPlayback(Hr),o.registerPlayback(Kr),o.registerPlayback(R),{Player:Mr,Events:k,Browser:E,ContainerPlugin:a,UIContainerPlugin:C,CorePlugin:l,UICorePlugin:i,Playback:S,Container:Cr,Core:Lr,PlayerError:T,Loader:o,BaseObject:r,UIObject:Tr,Utils:t,HTML5Audio:Kr,HTML5Video:R,HTMLImg:Hr,Log:b,Styler:kr,version:Zr,template:_,$:y});function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function O(e,t,r){if(t)Jr(e.prototype,t);if(r)Jr(e,r);return e}function L(e,t){if(typeof t!=="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)tn(e,t)}function en(e){en=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return en(e)}function tn(e,t){tn=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return tn(e,t)}function rn(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function an(e,t){if(t&&(typeof t==="object"||typeof t==="function"))return t;return nn(e)}function I(i){var a=rn();return function e(){var t=en(i),r;if(a){var n=en(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return an(this,r)}}function sn(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=en(e);if(e===null)break}return e}function on(e,t,r){if(typeof Reflect!=="undefined"&&Reflect.get)on=Reflect.get;else on=function e(t,r,n){var i=sn(t,r);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,r);if(a.get)return a.get.call(n);return a.value};return on(e,t,r||e)}var ln=function(e){L(r,e);var t=I(r);function r(e){w(this,r);return t.call(this,e)}O(r,[{key:"name",get:function e(){return"click_to_pause"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"bindEvents",value:function e(){this.listenTo(this.container,k.CONTAINER_CLICK,this.click);this.listenTo(this.container,k.CONTAINER_SETTINGSUPDATE,this.settingsUpdate)}},{key:"click",value:function e(){if(this.container.getPlaybackType()!==S.LIVE||this.container.isDvrEnabled())if(this.container.isPlaying())this.container.pause();else this.container.play()}},{key:"settingsUpdate",value:function e(){var t=this.container.getPlaybackType()!==S.LIVE||this.container.isDvrEnabled();if(t===this.pointerEnabled)return;var r=t?"addClass":"removeClass";this.container.$el[r]("pointer-enabled");this.pointerEnabled=t}}]);return r}(a),un='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve">\n<path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1\n\tc1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4\n\tc0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9\n\tC10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4\n\tc0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"/>\n</svg>',cn='<button type="button" class="cc-button media-control-button media-control-icon" data-cc-button aria-label="<%= ariaLabel %>"></button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>\n  <% for (var i = 0; i < tracks.length; i++) { %>\n    <li><a href="#" data-cc-select="<%= tracks[i].id %>"><%= tracks[i].label %></a></li>\n  <% }; %>\n</ul>\n';function dn(e,t){if(t===void 0)t={};var r=t.insertAt;if(!e||typeof document==="undefined")return;var n=document.head||document.getElementsByTagName("head")[0];var i=document.createElement("style");i.type="text/css";if(r==="top")if(n.firstChild)n.insertBefore(i,n.firstChild);else n.appendChild(i);else n.appendChild(i);if(i.styleSheet)i.styleSheet.cssText=e;else i.appendChild(document.createTextNode(e))}var fn,hn=(dn(".cc-controls[data-cc-controls] {\n  float: right;\n  position: relative;\n  display: none; }\n  .cc-controls[data-cc-controls].available {\n    display: block; }\n  .cc-controls[data-cc-controls] .cc-button {\n    padding: 6px !important; }\n    .cc-controls[data-cc-controls] .cc-button.enabled {\n      display: block;\n      opacity: 1.0; }\n      .cc-controls[data-cc-controls] .cc-button.enabled:hover {\n        opacity: 1.0;\n        text-shadow: none; }\n  .cc-controls[data-cc-controls] > ul {\n    list-style-type: none;\n    position: absolute;\n    bottom: 25px;\n    border: 1px solid black;\n    display: none;\n    background-color: #e6e6e6; }\n  .cc-controls[data-cc-controls] li {\n    font-size: 10px; }\n    .cc-controls[data-cc-controls] li[data-title] {\n      background-color: #c3c2c2;\n      padding: 5px; }\n    .cc-controls[data-cc-controls] li a {\n      color: #444;\n      padding: 2px 10px;\n      display: block;\n      text-decoration: none; }\n      .cc-controls[data-cc-controls] li a:hover {\n        background-color: #555;\n        color: white; }\n        .cc-controls[data-cc-controls] li a:hover a {\n          color: white;\n          text-decoration: none; }\n    .cc-controls[data-cc-controls] li.current a {\n      color: #f00; }\n"),function(e){L(i,e);var n=I(i);function i(e){var t;w(this,i);t=n.call(this,e);var r=e.options.closedCaptionsConfig;t._title=r&&r.title?r.title:null;t._ariaLabel=r&&r.ariaLabel?r.ariaLabel:"cc-button";t._labelCb=r&&r.labelCallback&&typeof r.labelCallback==="function"?r.labelCallback:function(e){return e.name};return t}O(i,[{key:"name",get:function e(){return"closed_captions"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"template",get:function e(){return _(cn)}},{key:"events",get:function e(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function e(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function e(){this.listenTo(this.core,k.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);this.listenTo(this.core.mediaControl,k.MEDIACONTROL_RENDERED,this.render);this.listenTo(this.core.mediaControl,k.MEDIACONTROL_HIDE,this.hideContextMenu);this.bindContainerEvents()}},{key:"bindContainerEvents",value:function e(){this.container=this.core.activeContainer;if(this.container){this.listenTo(this.container,k.CONTAINER_SUBTITLE_AVAILABLE,this.onSubtitleAvailable);this.listenTo(this.container,k.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged);this.listenTo(this.container,k.CONTAINER_STOP,this.onContainerStop)}}},{key:"onContainerStop",value:function e(){this.ccAvailable(false)}},{key:"containerChanged",value:function e(){this.ccAvailable(false);this.stopListening();this.bindEvents()}},{key:"onSubtitleAvailable",value:function e(){this.renderCcButton();this.ccAvailable(true)}},{key:"onSubtitleChanged",value:function e(t){this.setCurrentContextMenuElement(t.id)}},{key:"onTrackSelect",value:function e(t){var r=parseInt(t.target.dataset.ccSelect,10);this.container.closedCaptionsTrackId=r;this.hideContextMenu();t.stopPropagation();return false}},{key:"ccAvailable",value:function e(t){var r=t?"addClass":"removeClass";this.$el[r]("available")}},{key:"toggleContextMenu",value:function e(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function e(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function e(t){return this.$el.find("ul a"+(!isNaN(t)?'[data-cc-select="'+t+'"]':"")).parent()}},{key:"setCurrentContextMenuElement",value:function e(t){if(this._trackId!==t){this.contextMenuElement().removeClass("current");this.contextMenuElement(t).addClass("current");var r=t>-1?"addClass":"removeClass";this.$ccButton[r]("enabled");this._trackId=t}}},{key:"renderCcButton",value:function e(){var t=this.container?this.container.closedCaptionsTracks:[];for(var r=0;r<t.length;r++)t[r].label=this._labelCb(t[r]);this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:t}));this.$ccButton=this.$el.find("button.cc-button[data-cc-button]");this.$ccButton.append(un);this.$el.append(this.style)}},{key:"render",value:function e(){this.renderCcButton();var t=this.core.mediaControl.$el.find("button[data-fullscreen]");if(t[0])this.$el.insertAfter(t);else this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el);return this}}]);return i}(i)),pn='<div class="live-info"><%= live %></div>\n<button type="button" class="live-button" aria-label="<%= backToLive %>"><%= backToLive %></button>\n',vn,gn=(dn('.dvr-controls[data-dvr-controls] {\n  display: inline-block;\n  float: left;\n  color: #fff;\n  line-height: 32px;\n  font-size: 10px;\n  font-weight: bold;\n  margin-left: 6px; }\n  .dvr-controls[data-dvr-controls] .live-info {\n    cursor: default;\n    font-family: "Roboto", "Open Sans", Arial, sans-serif;\n    text-transform: uppercase; }\n    .dvr-controls[data-dvr-controls] .live-info:before {\n      content: "";\n      display: inline-block;\n      position: relative;\n      width: 7px;\n      height: 7px;\n      border-radius: 3.5px;\n      margin-right: 3.5px;\n      background-color: #ff0101; }\n    .dvr-controls[data-dvr-controls] .live-info.disabled {\n      opacity: 0.3; }\n      .dvr-controls[data-dvr-controls] .live-info.disabled:before {\n        background-color: #fff; }\n  .dvr-controls[data-dvr-controls] .live-button {\n    cursor: pointer;\n    outline: none;\n    display: none;\n    border: 0;\n    color: #fff;\n    background-color: transparent;\n    height: 32px;\n    padding: 0;\n    opacity: 0.7;\n    font-family: "Roboto", "Open Sans", Arial, sans-serif;\n    text-transform: uppercase;\n    transition: all 0.1s ease; }\n    .dvr-controls[data-dvr-controls] .live-button:before {\n      content: "";\n      display: inline-block;\n      position: relative;\n      width: 7px;\n      height: 7px;\n      border-radius: 3.5px;\n      margin-right: 3.5px;\n      background-color: #fff; }\n    .dvr-controls[data-dvr-controls] .live-button:hover {\n      opacity: 1;\n      text-shadow: rgba(255, 255, 255, 0.75) 0 0 5px; }\n\n.dvr .dvr-controls[data-dvr-controls] .live-info {\n  display: none; }\n\n.dvr .dvr-controls[data-dvr-controls] .live-button {\n  display: block; }\n\n.dvr.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {\n  background-color: #005aff; }\n\n.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {\n  background-color: #ff0101; }\n'),function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.settingsUpdate();return t}O(n,[{key:"template",get:function e(){return _(pn)}},{key:"name",get:function e(){return"dvr_controls"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"events",get:function e(){return{"click .live-button":"click"}}},{key:"attributes",get:function e(){return{class:"dvr-controls","data-dvr-controls":""}}},{key:"bindEvents",value:function e(){this.bindCoreEvents();this.bindContainerEvents()}},{key:"bindCoreEvents",value:function e(){var t=this;if(this.core.mediaControl.settings){this.listenTo(this.core.mediaControl,k.MEDIACONTROL_CONTAINERCHANGED,this.containerChanged);this.listenTo(this.core.mediaControl,k.MEDIACONTROL_RENDERED,this.settingsUpdate);this.listenTo(this.core,k.CORE_OPTIONS_CHANGE,this.render)}else setTimeout(function(){return t.bindCoreEvents()},100)}},{key:"bindContainerEvents",value:function e(){if(this.core.activeContainer){this.listenToOnce(this.core.activeContainer,k.CONTAINER_TIMEUPDATE,this.render);this.listenTo(this.core.activeContainer,k.CONTAINER_PLAYBACKDVRSTATECHANGED,this.dvrChanged)}}},{key:"containerChanged",value:function e(){this.stopListening();this.bindEvents()}},{key:"dvrChanged",value:function e(t){if(this.core.getPlaybackType()!==S.LIVE)return;this.settingsUpdate();this.core.mediaControl.$el.addClass("live");if(t){this.core.mediaControl.$el.addClass("dvr");this.core.mediaControl.$el.find(".media-control-indicator[data-position], .media-control-indicator[data-duration]").hide()}else this.core.mediaControl.$el.removeClass("dvr")}},{key:"click",value:function e(){var t=this.core.mediaControl;var r=t.container;if(!r.isPlaying())r.play();if(t.$el.hasClass("dvr"))r.seek(r.getDuration())}},{key:"settingsUpdate",value:function e(){var t=this;this.stopListening();this.core.mediaControl.$el.removeClass("live");if(this.shouldRender()){this.render();this.$el.click(function(){return t.click()})}this.bindEvents()}},{key:"shouldRender",value:function e(){var t=this.core.options.useDvrControls===undefined||!!this.core.options.useDvrControls;return t&&this.core.getPlaybackType()===S.LIVE}},{key:"render",value:function e(){this.$el.html(this.template({live:this.core.i18n.t("live"),backToLive:this.core.i18n.t("back_to_live")}));if(this.shouldRender()){this.core.mediaControl.$el.addClass("live");this.core.mediaControl.$(".media-control-left-panel[data-media-control]").append(this.$el)}return this}}]);return n}(i)),An=function(e){L(r,e);var t=I(r);function r(){w(this,r);return t.apply(this,arguments)}O(r,[{key:"name",get:function e(){return"end_video"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"bindEvents",value:function e(){this.listenTo(this.core,k.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);var t=this.core.activeContainer;if(t){this.listenTo(t,k.CONTAINER_ENDED,this.ended);this.listenTo(t,k.CONTAINER_STOP,this.ended)}}},{key:"containerChanged",value:function e(){this.stopListening();this.bindEvents()}},{key:"ended",value:function e(){var t=typeof this.core.options.exitFullscreenOnEnd==="undefined"||this.core.options.exitFullscreenOnEnd;if(t&&this.core.isFullscreen())this.core.toggleFullscreen()}}]);return r}(l),mn='<svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>',yn='<div class="player-error-screen__content" data-error-screen>\n  <% if (icon) { %>\n  <div class="player-error-screen__icon" data-error-screen><%= icon %></div>\n  <% } %>\n  <div class="player-error-screen__title" data-error-screen><%= title %></div>\n  <div class="player-error-screen__message" data-error-screen><%= message %></div>\n  <div class="player-error-screen__code" data-error-screen>Error code: <%= code %></div>\n  <div class="player-error-screen__reload" data-error-screen><%= reloadIcon %></div>\n</div>\n',En,bn=(dn("[data-player] .player-error-screen {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #CCCACA;\n  position: absolute;\n  top: 0;\n  height: 100%;\n  width: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: 2000;\n  display: flex;\n  flex-direction: column;\n  justify-content: center; }\n  [data-player] .player-error-screen__content[data-error-screen] {\n    font-size: 14px;\n    color: #CCCACA;\n    margin-top: 45px; }\n  [data-player] .player-error-screen__title[data-error-screen] {\n    font-weight: bold;\n    line-height: 30px;\n    font-size: 18px; }\n  [data-player] .player-error-screen__message[data-error-screen] {\n    width: 90%;\n    margin: 0 auto; }\n  [data-player] .player-error-screen__code[data-error-screen] {\n    font-size: 13px;\n    margin-top: 15px; }\n  [data-player] .player-error-screen__reload {\n    cursor: pointer;\n    width: 30px;\n    margin: 15px auto 0 !important; }\n"),function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);if(t.options.disableErrorScreen)return an(t,t.disable());return t}O(n,[{key:"name",get:function e(){return"error_screen"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"template",get:function e(){return _(yn)}},{key:"container",get:function e(){return this.core.getCurrentContainer()}},{key:"attributes",get:function e(){return{class:"player-error-screen","data-error-screen":""}}},{key:"bindEvents",value:function e(){this.listenTo(this.core,k.ERROR,this.onError);this.listenTo(this.core,k.CORE_ACTIVE_CONTAINER_CHANGED,this.onContainerChanged)}},{key:"bindReload",value:function e(){this.reloadButton=this.$el.find(".player-error-screen__reload");this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function e(){var t=this;this.listenToOnce(this.core,k.CORE_READY,function(){return t.container.play()});this.core.load(this.options.sources,this.options.mimeType);this.unbindReload()}},{key:"unbindReload",value:function e(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onContainerChanged",value:function e(){this.err=null;this.unbindReload();this.hide()}},{key:"onError",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(t.level===T.Levels.FATAL){this.err=t;this.container.disableMediaControl();this.container.stop();this.show()}}},{key:"show",value:function e(){this.render();this.$el.show()}},{key:"hide",value:function e(){this.$el.hide()}},{key:"render",value:function e(){if(!this.err)return;this.$el.html(this.template({title:this.err.UI.title,message:this.err.UI.message,code:this.err.code,icon:this.err.UI.icon||"",reloadIcon:mn}));this.core.$el.append(this.el);this.bindReload();return this}}]);return n}(i)),kn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill="#010101" d="M1.425.35L14.575 8l-13.15 7.65V.35z"/>\n</svg>',_n='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 14.76H6.43V1.24H1.71v13.52zm7.86-13.52v13.52h4.716V1.24H9.573z"/>\n</svg>',Tn=y('link[rel="shortcut icon"]'),Sn=function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t._container=null;t.configure();return t}O(n,[{key:"name",get:function e(){return"favicon"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"oldIcon",get:function e(){return Tn}},{key:"configure",value:function e(){if(this.core.options.changeFavicon){if(!this.enabled){this.stopListening(this.core,k.CORE_OPTIONS_CHANGE);this.enable()}}else if(this.enabled){this.disable();this.listenTo(this.core,k.CORE_OPTIONS_CHANGE,this.configure)}}},{key:"bindEvents",value:function e(){this.listenTo(this.core,k.CORE_OPTIONS_CHANGE,this.configure);this.listenTo(this.core,k.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);this.core.activeContainer&&this.containerChanged()}},{key:"containerChanged",value:function e(){this._container&&this.stopListening(this._container);this._container=this.core.activeContainer;this.listenTo(this._container,k.CONTAINER_PLAY,this.setPlayIcon);this.listenTo(this._container,k.CONTAINER_PAUSE,this.setPauseIcon);this.listenTo(this._container,k.CONTAINER_STOP,this.resetIcon);this.listenTo(this._container,k.CONTAINER_ENDED,this.resetIcon);this.listenTo(this._container,k.CONTAINER_ERROR,this.resetIcon);this.resetIcon()}},{key:"disable",value:function e(){on(en(n.prototype),"disable",this).call(this);this.resetIcon()}},{key:"destroy",value:function e(){on(en(n.prototype),"destroy",this).call(this);this.resetIcon()}},{key:"createIcon",value:function e(t){var r=y("<canvas/>");r[0].width=16;r[0].height=16;var n=r[0].getContext("2d");n.fillStyle="#000";var i=y(t).find("path").attr("d");var a=new Path2D(i);n.fill(a);var s=y('<link rel="shortcut icon" type="image/png"/>');s.attr("href",r[0].toDataURL("image/png"));return s}},{key:"setPlayIcon",value:function e(){if(!this.playIcon)this.playIcon=this.createIcon(kn);this.changeIcon(this.playIcon)}},{key:"setPauseIcon",value:function e(){if(!this.pauseIcon)this.pauseIcon=this.createIcon(_n);this.changeIcon(this.pauseIcon)}},{key:"resetIcon",value:function e(){y('link[rel="shortcut icon"]').remove();y("head").append(this.oldIcon)}},{key:"changeIcon",value:function e(t){if(t){y('link[rel="shortcut icon"]').remove();y("head").append(t)}}}]);return n}(l),Cn=function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);if(t.container.options.gaAccount){t.account=t.container.options.gaAccount;t.trackerName=t.container.options.gaTrackerName?t.container.options.gaTrackerName+".":"Clappr.";t.domainName=t.container.options.gaDomainName;t.currentHDState=undefined;t.embedScript()}return t}O(n,[{key:"name",get:function e(){return"google_analytics"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"embedScript",value:function e(){var t=this;if(!window._gat){var r=document.createElement("script");r.setAttribute("type","text/javascript");r.setAttribute("async","async");r.setAttribute("src","//www.google-analytics.com/ga.js");r.onload=function(){return t.addEventListeners()};document.body.appendChild(r)}else this.addEventListeners()}},{key:"addEventListeners",value:function e(){var t=this;if(this.container){this.listenTo(this.container,k.CONTAINER_READY,this.onReady);this.listenTo(this.container,k.CONTAINER_PLAY,this.onPlay);this.listenTo(this.container,k.CONTAINER_STOP,this.onStop);this.listenTo(this.container,k.CONTAINER_PAUSE,this.onPause);this.listenTo(this.container,k.CONTAINER_ENDED,this.onEnded);this.listenTo(this.container,k.CONTAINER_STATE_BUFFERING,this.onBuffering);this.listenTo(this.container,k.CONTAINER_STATE_BUFFERFULL,this.onBufferFull);this.listenTo(this.container,k.CONTAINER_ERROR,this.onError);this.listenTo(this.container,k.CONTAINER_PLAYBACKSTATE,this.onPlaybackChanged);this.listenTo(this.container,k.CONTAINER_VOLUME,function(e){return t.onVolumeChanged(e)});this.listenTo(this.container,k.CONTAINER_SEEK,function(e){return t.onSeek(e)});this.listenTo(this.container,k.CONTAINER_FULL_SCREEN,this.onFullscreen);this.listenTo(this.container,k.CONTAINER_HIGHDEFINITIONUPDATE,this.onHD);this.listenTo(this.container,k.CONTAINER_PLAYBACKDVRSTATECHANGED,this.onDVR)}_gaq.push([this.trackerName+"_setAccount",this.account]);if(this.domainName)_gaq.push([this.trackerName+"_setDomainName",this.domainName])}},{key:"onReady",value:function e(){this.push(["Video","Playback",this.container.playback.name])}},{key:"onPlay",value:function e(){this.push(["Video","Play",this.container.playback.src])}},{key:"onStop",value:function e(){this.push(["Video","Stop",this.container.playback.src])}},{key:"onEnded",value:function e(){this.push(["Video","Ended",this.container.playback.src])}},{key:"onBuffering",value:function e(){this.push(["Video","Buffering",this.container.playback.src])}},{key:"onBufferFull",value:function e(){this.push(["Video","Bufferfull",this.container.playback.src])}},{key:"onError",value:function e(){this.push(["Video","Error",this.container.playback.src])}},{key:"onHD",value:function e(t){var r=t?"ON":"OFF";if(r!==this.currentHDState){this.currentHDState=r;this.push(["Video","HD - "+r,this.container.playback.src])}}},{key:"onPlaybackChanged",value:function e(t){if(t.type!==null)this.push(["Video","Playback Type - "+t.type,this.container.playback.src])}},{key:"onDVR",value:function e(t){var r=t?"ON":"OFF";this.push(["Interaction","DVR - "+r,this.container.playback.src])}},{key:"onPause",value:function e(){this.push(["Video","Pause",this.container.playback.src])}},{key:"onSeek",value:function e(){this.push(["Video","Seek",this.container.playback.src])}},{key:"onVolumeChanged",value:function e(){this.push(["Interaction","Volume",this.container.playback.src])}},{key:"onFullscreen",value:function e(){this.push(["Interaction","Fullscreen",this.container.playback.src])}},{key:"push",value:function e(t){var r=[this.trackerName+"_trackEvent"].concat(t);_gaq.push(r)}}]);return n}(a),D=function e(t){this.element=t||window.document;this.initialize()},Rn;for(Rn in D.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps_lock",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},D.KEY_CODES_BY_NAME={},D.KEY_NAMES_BY_CODE)if(Object.prototype.hasOwnProperty.call(D.KEY_NAMES_BY_CODE,Rn))D.KEY_CODES_BY_NAME[D.KEY_NAMES_BY_CODE[Rn]]=+Rn;D.MODIFIERS=["shift","ctrl","alt"],D.registerEvent=function(){if(document.addEventListener)return function(e,t,r){e.addEventListener(t,r,false)};else if(document.attachEvent)return function(e,t,r){e.attachEvent("on"+t,r)}}(),D.unregisterEvent=function(){if(document.removeEventListener)return function(e,t,r){e.removeEventListener(t,r,false)};else if(document.detachEvent)return function(e,t,r){e.detachEvent("on"+t,r)}}(),D.stringContains=function(e,t){return e.indexOf(t)!==-1},D.neatString=function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")},D.capitalize=function(e){return e.toLowerCase().replace(/^./,function(e){return e.toUpperCase()})},D.isString=function(e){return D.stringContains(Object.prototype.toString.call(e),"String")},D.arrayIncludes=function(){if(Array.prototype.indexOf)return function(e,t){return e.indexOf(t)!==-1};else return function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return true;return false}}(),D.extractModifiers=function(e){var t,r;t=[];for(r=0;r<D.MODIFIERS.length;r++)if(D.stringContains(e,D.MODIFIERS[r]))t.push(D.MODIFIERS[r]);return t},D.extractKey=function(e){var t,r;t=D.neatString(e).split(" ");for(r=0;r<t.length;r++)if(!D.arrayIncludes(D.MODIFIERS,t[r]))return t[r]},D.modifiersAndKey=function(e){var t,r;if(D.stringContains(e,"any"))return D.neatString(e).split(" ").slice(0,2).join(" ");t=D.extractModifiers(e);r=D.extractKey(e);if(r&&!D.arrayIncludes(D.MODIFIERS,r))t.push(r);return t.join(" ")},D.keyName=function(e){return D.KEY_NAMES_BY_CODE[e+""]},D.keyCode=function(e){return+D.KEY_CODES_BY_NAME[e]},D.prototype.initialize=function(){var e,t=this;this.lastKeyCode=-1;this.lastModifiers={};for(e=0;e<D.MODIFIERS.length;e++)this.lastModifiers[D.MODIFIERS[e]]=false;this.keysDown={any:[]};this.keysUp={any:[]};this.downHandler=this.handler("down");this.upHandler=this.handler("up");D.registerEvent(this.element,"keydown",this.downHandler);D.registerEvent(this.element,"keyup",this.upHandler);D.registerEvent(window,"unload",function e(){D.unregisterEvent(t.element,"keydown",t.downHandler);D.unregisterEvent(t.element,"keyup",t.upHandler);D.unregisterEvent(window,"unload",e)})},D.prototype.handler=function(i){var a=this;return function(e){var t,r,n;e=e||window.event;a.lastKeyCode=e.keyCode;for(t=0;t<D.MODIFIERS.length;t++)a.lastModifiers[D.MODIFIERS[t]]=e[D.MODIFIERS[t]+"Key"];if(D.arrayIncludes(D.MODIFIERS,D.keyName(a.lastKeyCode)))a.lastModifiers[D.keyName(a.lastKeyCode)]=true;r=a["keys"+D.capitalize(i)];for(t=0;t<r.any.length;t++)if(r.any[t](e)===false&&e.preventDefault)e.preventDefault();n=a.lastModifiersAndKey();if(r[n])for(t=0;t<r[n].length;t++)if(r[n][t](e)===false&&e.preventDefault)e.preventDefault()}},D.prototype.registerKeys=function(e,t,r){var n,i,a=this["keys"+D.capitalize(e)];if(D.isString(t))t=[t];for(n=0;n<t.length;n++){i=t[n];i=D.modifiersAndKey(i+"");if(a[i])a[i].push(r);else a[i]=[r]}return this},D.prototype.unregisterKeys=function(e,t,r){var n,i,a,s=this["keys"+D.capitalize(e)];if(D.isString(t))t=[t];for(n=0;n<t.length;n++){a=t[n];a=D.modifiersAndKey(a+"");if(r===null)delete s[a];else if(s[a])for(i=0;i<s[a].length;i++)if(String(s[a][i])===String(r)){s[a].splice(i,1);break}}return this},D.prototype.off=function(e){return this.unregisterKeys("down",e,null)},D.prototype.delegate=function(e,t,r){return r!==null||r!==undefined?this.registerKeys(e,t,r):this.unregisterKeys(e,t,r)},D.prototype.down=function(e,t){return this.delegate("down",e,t)},D.prototype.up=function(e,t){return this.delegate("up",e,t)},D.prototype.lastKey=function(e){if(!e)return D.keyName(this.lastKeyCode);return this.lastModifiers[e]},D.prototype.lastModifiersAndKey=function(){var e,t;e=[];for(t=0;t<D.MODIFIERS.length;t++)if(this.lastKey(D.MODIFIERS[t]))e.push(D.MODIFIERS[t]);if(!D.arrayIncludes(e,this.lastKey()))e.push(this.lastKey());return e.join(" ")};var wn={Kibo:D},On,Ln=(dn('.media-control-notransition {\n  transition: none !important; }\n\n.media-control[data-media-control] {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 9999;\n  pointer-events: none; }\n  .media-control[data-media-control].dragging {\n    pointer-events: auto;\n    cursor: -webkit-grabbing !important;\n    cursor: grabbing !important;\n    cursor: url("closed-hand.cur"), move; }\n    .media-control[data-media-control].dragging * {\n      cursor: -webkit-grabbing !important;\n      cursor: grabbing !important;\n      cursor: url("closed-hand.cur"), move; }\n  .media-control[data-media-control] .media-control-background[data-background] {\n    position: absolute;\n    height: 40%;\n    width: 100%;\n    bottom: 0;\n    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));\n    will-change: transform, opacity;\n    transition: opacity 0.6s ease-out; }\n  .media-control[data-media-control] .media-control-icon {\n    line-height: 0;\n    letter-spacing: 0;\n    speak: none;\n    color: #fff;\n    opacity: 0.5;\n    vertical-align: middle;\n    text-align: left;\n    transition: all 0.1s ease; }\n  .media-control[data-media-control] .media-control-icon:hover {\n    color: white;\n    opacity: 0.75;\n    text-shadow: rgba(255, 255, 255, 0.8) 0 0 5px; }\n  .media-control[data-media-control].media-control-hide .media-control-background[data-background] {\n    opacity: 0; }\n  .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] {\n    transform: translateY(50px); }\n    .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {\n      opacity: 0; }\n  .media-control[data-media-control] .media-control-layer[data-controls] {\n    position: absolute;\n    transform: translateY(-7px);\n    bottom: 0;\n    width: 100%;\n    height: 32px;\n    font-size: 0;\n    vertical-align: middle;\n    pointer-events: auto;\n    transition: bottom 0.4s ease-out; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-left-panel[data-media-control] {\n      position: absolute;\n      top: 0;\n      left: 4px;\n      height: 100%; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-center-panel[data-media-control] {\n      height: 100%;\n      text-align: center;\n      line-height: 32px; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-right-panel[data-media-control] {\n      position: absolute;\n      top: 0;\n      right: 4px;\n      height: 100%; }\n    .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button {\n      background-color: transparent;\n      border: 0;\n      margin: 0 6px;\n      padding: 0;\n      cursor: pointer;\n      display: inline-block;\n      width: 32px;\n      height: 100%; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg {\n        width: 100%;\n        height: 22px; }\n        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg path {\n          fill: white; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button:focus {\n        outline: none; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-play] {\n        float: left;\n        height: 100%; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-pause] {\n        float: left;\n        height: 100%; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-stop] {\n        float: left;\n        height: 100%; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-fullscreen] {\n        float: right;\n        background-color: transparent;\n        border: 0;\n        height: 100%; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator] {\n        background-color: transparent;\n        border: 0;\n        cursor: default;\n        display: none;\n        float: right;\n        height: 100%; }\n        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled {\n          display: block;\n          opacity: 1.0; }\n          .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled:hover {\n            opacity: 1.0;\n            text-shadow: none; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playpause] {\n        float: left; }\n      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playstop] {\n        float: left; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position], .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {\n      display: inline-block;\n      font-size: 10px;\n      color: white;\n      cursor: default;\n      line-height: 32px;\n      position: relative; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position] {\n      margin: 0 6px 0 7px; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {\n      color: rgba(255, 255, 255, 0.5);\n      margin-right: 6px; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration]:before {\n        content: "|";\n        margin-right: 7px; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] {\n      position: absolute;\n      top: -20px;\n      left: 0;\n      display: inline-block;\n      vertical-align: middle;\n      width: 100%;\n      height: 25px;\n      cursor: pointer; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] {\n        width: 100%;\n        height: 1px;\n        position: relative;\n        top: 12px;\n        background-color: #666666; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-1[data-seekbar] {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 0;\n          height: 100%;\n          background-color: #c2c2c2;\n          transition: all 0.1s ease-out; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 0;\n          height: 100%;\n          background-color: #005aff;\n          transition: all 0.1s ease-out; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-hover[data-seekbar] {\n          opacity: 0;\n          position: absolute;\n          top: -3px;\n          width: 5px;\n          height: 7px;\n          background-color: rgba(255, 255, 255, 0.5);\n          transition: opacity 0.1s ease; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar]:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {\n        opacity: 1; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled {\n        cursor: default; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {\n          opacity: 0; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {\n        position: absolute;\n        transform: translateX(-50%);\n        top: 2px;\n        left: 0;\n        width: 20px;\n        height: 20px;\n        opacity: 1;\n        transition: all 0.1s ease-out; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] .bar-scrubber-icon[data-seekbar] {\n          position: absolute;\n          left: 6px;\n          top: 6px;\n          width: 8px;\n          height: 8px;\n          border-radius: 10px;\n          box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);\n          background-color: white; }\n    .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] {\n      float: right;\n      display: inline-block;\n      height: 32px;\n      cursor: pointer;\n      margin: 0 6px;\n      box-sizing: border-box; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] {\n        float: left;\n        bottom: 0; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] {\n          background-color: transparent;\n          border: 0;\n          box-sizing: content-box;\n          width: 32px;\n          height: 32px;\n          opacity: 0.5; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume]:hover {\n            opacity: 0.75; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg {\n            height: 24px;\n            position: relative;\n            top: 3px; }\n            .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg path {\n              fill: white; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume].muted svg {\n            margin-left: 2px; }\n      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] {\n        float: left;\n        position: relative;\n        overflow: hidden;\n        top: 6px;\n        width: 42px;\n        height: 18px;\n        padding: 3px 0;\n        transition: width .2s ease-out; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] {\n          height: 1px;\n          position: relative;\n          top: 7px;\n          margin: 0 3px;\n          background-color: #666666; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-1[data-volume] {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 0;\n            height: 100%;\n            background-color: #c2c2c2;\n            transition: all 0.1s ease-out; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-2[data-volume] {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 0;\n            height: 100%;\n            background-color: #005aff;\n            transition: all 0.1s ease-out; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-hover[data-volume] {\n            opacity: 0;\n            position: absolute;\n            top: -3px;\n            width: 5px;\n            height: 7px;\n            background-color: rgba(255, 255, 255, 0.5);\n            transition: opacity 0.1s ease; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] {\n          position: absolute;\n          transform: translateX(-50%);\n          top: 0px;\n          left: 0;\n          width: 20px;\n          height: 20px;\n          opacity: 1;\n          transition: all 0.1s ease-out; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] .bar-scrubber-icon[data-volume] {\n            position: absolute;\n            left: 6px;\n            top: 6px;\n            width: 8px;\n            height: 8px;\n            border-radius: 10px;\n            box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);\n            background-color: white; }\n        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume] {\n          float: left;\n          width: 4px;\n          padding-left: 2px;\n          height: 12px;\n          opacity: 0.5;\n          box-shadow: inset 2px 0 0 white;\n          transition: transform .2s ease-out; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume].fill {\n            box-shadow: inset 2px 0 0 #fff;\n            opacity: 1; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:nth-of-type(1) {\n            padding-left: 0; }\n          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:hover {\n            transform: scaleY(1.5); }\n  .media-control[data-media-control].w320 .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume].volume-bar-hide {\n    width: 0;\n    height: 12px;\n    top: 9px;\n    padding: 0; }\n'),'<div class="media-control-background" data-background></div>\n<div class="media-control-layer" data-controls>\n  <%  var renderBar = function(name) { %>\n      <div class="bar-container" data-<%= name %>>\n        <div class="bar-background" data-<%= name %>>\n          <div class="bar-fill-1" data-<%= name %>></div>\n          <div class="bar-fill-2" data-<%= name %>></div>\n          <div class="bar-hover" data-<%= name %>></div>\n        </div>\n        <div class="bar-scrubber" data-<%= name %>>\n          <div class="bar-scrubber-icon" data-<%= name %>></div>\n        </div>\n      </div>\n  <%  }; %>\n  <%  var renderSegmentedBar = function(name, segments) {\n      segments = segments || 10; %>\n    <div class="bar-container" data-<%= name %>>\n    <% for (var i = 0; i < segments; i++) { %>\n      <div class="segmented-bar-element" data-<%= name %>></div>\n    <% } %>\n    </div>\n  <% }; %>\n  <% var renderDrawer = function(name, renderContent) { %>\n      <div class="drawer-container" data-<%= name %>>\n        <div class="drawer-icon-container" data-<%= name %>>\n          <div class="drawer-icon media-control-icon" data-<%= name %>></div>\n          <span class="drawer-text" data-<%= name %>></span>\n        </div>\n        <% renderContent(name); %>\n      </div>\n  <% }; %>\n  <% var renderIndicator = function(name) { %>\n      <div class="media-control-indicator" data-<%= name %>></div>\n  <% }; %>\n  <% var renderButton = function(name) { %>\n    <button type="button" class="media-control-button media-control-icon" data-<%= name %> aria-label="<%= name %>"></button>\n  <% }; %>\n  <%  var templates = {\n        bar: renderBar,\n        segmentedBar: renderSegmentedBar,\n      };\n      var render = function(settingsList) {\n        settingsList.forEach(function(setting) {\n          if(setting === "seekbar") {\n            renderBar(setting);\n          } else if (setting === "volume") {\n            renderDrawer(setting, settings.volumeBarTemplate ? templates[settings.volumeBarTemplate] : function(name) { return renderSegmentedBar(name); });\n          } else if (setting === "duration" || setting === "position") {\n            renderIndicator(setting);\n          } else {\n            renderButton(setting);\n          }\n        });\n      }; %>\n  <% if (settings.default && settings.default.length) { %>\n  <div class="media-control-center-panel" data-media-control>\n    <% render(settings.default); %>\n  </div>\n  <% } %>\n  <% if (settings.left && settings.left.length) { %>\n  <div class="media-control-left-panel" data-media-control>\n    <% render(settings.left); %>\n  </div>\n  <% } %>\n  <% if (settings.right && settings.right.length) { %>\n  <div class="media-control-right-panel" data-media-control>\n    <% render(settings.right); %>\n  </div>\n  <% } %>\n</div>\n'),In='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 1.24h12.6v13.52h-12.6z"/>\n</svg>',Dn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M11.5 11h-.002v1.502L7.798 10H4.5V6h3.297l3.7-2.502V4.5h.003V11zM11 4.49L7.953 6.5H5v3h2.953L11 11.51V4.49z"/>\n</svg>',Pn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M9.75 11.51L6.7 9.5H3.75v-3H6.7L9.75 4.49v.664l.497.498V3.498L6.547 6H3.248v4h3.296l3.7 2.502v-2.154l-.497.5v.662zm3-5.165L12.404 6l-1.655 1.653L9.093 6l-.346.345L10.402 8 8.747 9.654l.346.347 1.655-1.653L12.403 10l.348-.346L11.097 8l1.655-1.655z"/>\n</svg>',Nn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill="#010101" d="M7.156 8L4 11.156V8.5H3V13h4.5v-1H4.844L8 8.844 7.156 8zM8.5 3v1h2.657L8 7.157 8.846 8 12 4.844V7.5h1V3H8.5z"/>\n</svg>',xn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill="#010101" d="M13.5 3.344l-.844-.844L9.5 5.656V3h-1v4.5H13v-1h-2.656L13.5 3.344zM3 9.5h2.656L2.5 12.656l.844.844L6.5 10.344V13h1V8.5H3v1z"/>\n</svg>',Mn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill="#010101" d="M5.375 7.062H2.637V4.26H.502v7.488h2.135V8.9h2.738v2.848h2.133V4.26H5.375v2.802zm5.97-2.81h-2.84v7.496h2.798c2.65 0 4.195-1.607 4.195-3.77v-.022c0-2.162-1.523-3.704-4.154-3.704zm2.06 3.758c0 1.21-.81 1.896-2.03 1.896h-.83V6.093h.83c1.22 0 2.03.696 2.03 1.896v.02z"/>\n</svg>',Fn=t.Config,Bn=t.Fullscreen,Un=t.formatTime,jn=t.extend,Vn=t.removeArrayItem,Gn=function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.persistConfig=t.options.persistConfig;t.currentPositionValue=null;t.currentDurationValue=null;t.keepVisible=false;t.fullScreenOnVideoTagSupported=null;t.setInitialVolume();t.settings={left:["play","stop","pause"],right:["volume"],default:["position","seekbar","duration"]};t.kibo=new D(t.options.focusElement);t.bindKeyEvents();if(t.container){if(!y.isEmptyObject(t.container.settings))t.settings=y.extend({},t.container.settings)}else t.settings={};t.userDisabled=false;if(t.container&&t.container.mediaControlDisabled||t.options.chromeless)t.disable();t.stopDragHandler=function(e){return t.stopDrag(e)};t.updateDragHandler=function(e){return t.updateDrag(e)};y(document).bind("mouseup",t.stopDragHandler);y(document).bind("mousemove",t.updateDragHandler);return t}O(n,[{key:"name",get:function e(){return"media_control"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"disabled",get:function e(){var t=this.container&&this.container.getPlaybackType()===S.NO_OP;return this.userDisabled||t}},{key:"container",get:function e(){return this.core&&this.core.activeContainer}},{key:"playback",get:function e(){return this.core&&this.core.activePlayback}},{key:"attributes",get:function e(){return{class:"media-control","data-media-control":""}}},{key:"events",get:function e(){return{"click [data-play]":"play","click [data-pause]":"pause","click [data-playpause]":"togglePlayPause","click [data-stop]":"stop","click [data-playstop]":"togglePlayStop","click [data-fullscreen]":"toggleFullscreen","click .bar-container[data-seekbar]":"seek","click .bar-container[data-volume]":"onVolumeClick","click .drawer-icon[data-volume]":"toggleMute","mouseenter .drawer-container[data-volume]":"showVolumeBar","mouseleave .drawer-container[data-volume]":"hideVolumeBar","mousedown .bar-container[data-volume]":"startVolumeDrag","mousemove .bar-container[data-volume]":"mousemoveOnVolumeBar","mousedown .bar-scrubber[data-seekbar]":"startSeekDrag","mousemove .bar-container[data-seekbar]":"mousemoveOnSeekBar","mouseleave .bar-container[data-seekbar]":"mouseleaveOnSeekBar","mouseenter .media-control-layer[data-controls]":"setUserKeepVisible","mouseleave .media-control-layer[data-controls]":"resetUserKeepVisible"}}},{key:"template",get:function e(){return _(Ln)}},{key:"volume",get:function e(){return this.container&&this.container.isReady?this.container.volume:this.intendedVolume}},{key:"muted",get:function e(){return this.volume===0}},{key:"getExternalInterface",value:function e(){var t=this;return{setVolume:this.setVolume,getVolume:function e(){return t.volume}}}},{key:"bindEvents",value:function e(){var t=this;this.stopListening();this.listenTo(this.core,k.CORE_ACTIVE_CONTAINER_CHANGED,this.onActiveContainerChanged);this.listenTo(this.core,k.CORE_MOUSE_MOVE,this.show);this.listenTo(this.core,k.CORE_MOUSE_LEAVE,function(){return t.hide(t.options.hideMediaControlDelay)});this.listenTo(this.core,k.CORE_FULLSCREEN,this.show);this.listenTo(this.core,k.CORE_OPTIONS_CHANGE,this.configure);this.listenTo(this.core,k.CORE_RESIZE,this.playerResize);this.bindContainerEvents()}},{key:"bindContainerEvents",value:function e(){if(!this.container)return;this.listenTo(this.container,k.CONTAINER_PLAY,this.changeTogglePlay);this.listenTo(this.container,k.CONTAINER_PAUSE,this.changeTogglePlay);this.listenTo(this.container,k.CONTAINER_STOP,this.changeTogglePlay);this.listenTo(this.container,k.CONTAINER_DBLCLICK,this.toggleFullscreen);this.listenTo(this.container,k.CONTAINER_TIMEUPDATE,this.onTimeUpdate);this.listenTo(this.container,k.CONTAINER_PROGRESS,this.updateProgressBar);this.listenTo(this.container,k.CONTAINER_SETTINGSUPDATE,this.settingsUpdate);this.listenTo(this.container,k.CONTAINER_PLAYBACKDVRSTATECHANGED,this.settingsUpdate);this.listenTo(this.container,k.CONTAINER_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate);this.listenTo(this.container,k.CONTAINER_MEDIACONTROL_DISABLE,this.disable);this.listenTo(this.container,k.CONTAINER_MEDIACONTROL_ENABLE,this.enable);this.listenTo(this.container,k.CONTAINER_ENDED,this.ended);this.listenTo(this.container,k.CONTAINER_VOLUME,this.onVolumeChanged);this.listenTo(this.container,k.CONTAINER_OPTIONS_CHANGE,this.setInitialVolume);if(this.container.playback.el.nodeName.toLowerCase()==="video")this.listenToOnce(this.container,k.CONTAINER_LOADEDMETADATA,this.onLoadedMetadataOnVideoTag)}},{key:"disable",value:function e(){this.userDisabled=true;this.hide();this.unbindKeyEvents();this.$el.hide()}},{key:"enable",value:function e(){if(this.options.chromeless)return;this.userDisabled=false;this.bindKeyEvents();this.show()}},{key:"play",value:function e(){this.container&&this.container.play()}},{key:"pause",value:function e(){this.container&&this.container.pause()}},{key:"stop",value:function e(){this.container&&this.container.stop()}},{key:"setInitialVolume",value:function e(){var t=this.persistConfig?Fn.restore("volume"):100;var r=this.container&&this.container.options||this.options;this.setVolume(r.mute?0:t,true)}},{key:"onVolumeChanged",value:function e(){this.updateVolumeUI()}},{key:"onLoadedMetadataOnVideoTag",value:function e(){var t=this.playback&&this.playback.el;if(!Bn.fullscreenEnabled()&&t.webkitSupportsFullscreen){this.fullScreenOnVideoTagSupported=true;this.settingsUpdate()}}},{key:"updateVolumeUI",value:function e(){if(!this.rendered)return;this.$volumeBarContainer.find(".bar-fill-2").css({});var t=this.$volumeBarContainer.width();var r=this.$volumeBarBackground.width();var n=(t-r)/2;var i=r*this.volume/100+n;this.$volumeBarFill.css({width:"".concat(this.volume,"%")});this.$volumeBarScrubber.css({left:i});this.$volumeBarContainer.find(".segmented-bar-element").removeClass("fill");var a=Math.ceil(this.volume/10);this.$volumeBarContainer.find(".segmented-bar-element").slice(0,a).addClass("fill");this.$volumeIcon.html("");this.$volumeIcon.removeClass("muted");if(!this.muted)this.$volumeIcon.append(Dn);else{this.$volumeIcon.append(Pn);this.$volumeIcon.addClass("muted")}this.applyButtonStyle(this.$volumeIcon)}},{key:"changeTogglePlay",value:function e(){this.$playPauseToggle.html("");this.$playStopToggle.html("");if(this.container&&this.container.isPlaying()){this.$playPauseToggle.append(_n);this.$playStopToggle.append(In);this.trigger(k.MEDIACONTROL_PLAYING)}else{this.$playPauseToggle.append(kn);this.$playStopToggle.append(kn);this.trigger(k.MEDIACONTROL_NOTPLAYING);E.isMobile&&this.show()}this.applyButtonStyle(this.$playPauseToggle);this.applyButtonStyle(this.$playStopToggle)}},{key:"mousemoveOnSeekBar",value:function e(t){if(this.settings.seekEnabled){var r=t.pageX-this.$seekBarContainer.offset().left-this.$seekBarHover.width()/2;this.$seekBarHover.css({left:r})}this.trigger(k.MEDIACONTROL_MOUSEMOVE_SEEKBAR,t)}},{key:"mouseleaveOnSeekBar",value:function e(t){this.trigger(k.MEDIACONTROL_MOUSELEAVE_SEEKBAR,t)}},{key:"onVolumeClick",value:function e(t){this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"mousemoveOnVolumeBar",value:function e(t){this.draggingVolumeBar&&this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"playerResize",value:function e(t){this.$fullscreenToggle.html("");var r=this.core.isFullscreen()?xn:Nn;this.$fullscreenToggle.append(r);this.applyButtonStyle(this.$fullscreenToggle);this.$el.find(".media-control").length!==0&&this.$el.removeClass("w320");if(t.width<=320||this.options.hideVolumeBar)this.$el.addClass("w320")}},{key:"togglePlayPause",value:function e(){this.container.isPlaying()?this.container.pause():this.container.play();return false}},{key:"togglePlayStop",value:function e(){this.container.isPlaying()?this.container.stop():this.container.play()}},{key:"startSeekDrag",value:function e(t){if(!this.settings.seekEnabled)return;this.draggingSeekBar=true;this.$el.addClass("dragging");this.$seekBarLoaded.addClass("media-control-notransition");this.$seekBarPosition.addClass("media-control-notransition");this.$seekBarScrubber.addClass("media-control-notransition");t&&t.preventDefault()}},{key:"startVolumeDrag",value:function e(t){this.draggingVolumeBar=true;this.$el.addClass("dragging");t&&t.preventDefault()}},{key:"stopDrag",value:function e(t){this.draggingSeekBar&&this.seek(t);this.$el.removeClass("dragging");this.$seekBarLoaded.removeClass("media-control-notransition");this.$seekBarPosition.removeClass("media-control-notransition");this.$seekBarScrubber.removeClass("media-control-notransition dragging");this.draggingSeekBar=false;this.draggingVolumeBar=false}},{key:"updateDrag",value:function e(t){if(this.draggingSeekBar){t.preventDefault();var r=t.pageX-this.$seekBarContainer.offset().left;var n=r/this.$seekBarContainer.width()*100;n=Math.min(100,Math.max(n,0));this.setSeekPercentage(n)}else if(this.draggingVolumeBar){t.preventDefault();this.setVolume(this.getVolumeFromUIEvent(t))}}},{key:"getVolumeFromUIEvent",value:function e(t){var r=t.pageX-this.$volumeBarContainer.offset().left;var n=r/this.$volumeBarContainer.width()*100;return n}},{key:"toggleMute",value:function e(){this.setVolume(this.muted?100:0)}},{key:"setVolume",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;t=Math.min(100,Math.max(t,0));this.intendedVolume=t;this.persistConfig&&!n&&Fn.persist("volume",t);var i=function e(){if(r.container&&r.container.isReady)r.container.setVolume(t);else r.listenToOnce(r.container,k.CONTAINER_READY,function(){r.container.setVolume(t)})};if(!this.container)this.listenToOnce(this,k.MEDIACONTROL_CONTAINERCHANGED,function(){return i()});else i()}},{key:"toggleFullscreen",value:function e(){this.trigger(k.MEDIACONTROL_FULLSCREEN,this.name);this.container.fullscreen();this.core.toggleFullscreen();this.resetUserKeepVisible()}},{key:"onActiveContainerChanged",value:function e(){this.fullScreenOnVideoTagSupported=null;this.bindEvents();this.setInitialVolume();this.changeTogglePlay();this.bindContainerEvents();this.settingsUpdate();this.container&&this.container.trigger(k.CONTAINER_PLAYBACKDVRSTATECHANGED,this.container.isDvrInUse());this.container&&this.container.mediaControlDisabled&&this.disable();this.trigger(k.MEDIACONTROL_CONTAINERCHANGED)}},{key:"showVolumeBar",value:function e(){this.hideVolumeId&&clearTimeout(this.hideVolumeId);this.$volumeBarContainer.removeClass("volume-bar-hide")}},{key:"hideVolumeBar",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:400;if(!this.$volumeBarContainer)return;if(this.draggingVolumeBar)this.hideVolumeId=setTimeout(function(){return t.hideVolumeBar()},r);else{this.hideVolumeId&&clearTimeout(this.hideVolumeId);this.hideVolumeId=setTimeout(function(){return t.$volumeBarContainer.addClass("volume-bar-hide")},r)}}},{key:"ended",value:function e(){this.changeTogglePlay()}},{key:"updateProgressBar",value:function e(t){var r=t.start/t.total*100;var n=t.current/t.total*100;this.$seekBarLoaded.css({left:"".concat(r,"%"),width:"".concat(n-r,"%")})}},{key:"onTimeUpdate",value:function e(t){if(this.draggingSeekBar)return;var r=t.current<0?t.total:t.current;this.currentPositionValue=r;this.currentDurationValue=t.total;this.renderSeekBar()}},{key:"renderSeekBar",value:function e(){if(this.currentPositionValue===null||this.currentDurationValue===null)return;this.currentSeekBarPercentage=100;if(this.container&&(this.container.getPlaybackType()!==S.LIVE||this.container.isDvrInUse()))this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100;this.setSeekPercentage(this.currentSeekBarPercentage);var t=Un(this.currentPositionValue);var r=Un(this.currentDurationValue);if(t!==this.displayedPosition){this.$position.text(t);this.displayedPosition=t}if(r!==this.displayedDuration){this.$duration.text(r);this.displayedDuration=r}}},{key:"seek",value:function e(t){if(!this.settings.seekEnabled)return;var r=t.pageX-this.$seekBarContainer.offset().left;var n=r/this.$seekBarContainer.width()*100;n=Math.min(100,Math.max(n,0));this.container&&this.container.seekPercentage(n);this.setSeekPercentage(n);return false}},{key:"setKeepVisible",value:function e(){this.keepVisible=true}},{key:"resetKeepVisible",value:function e(){this.keepVisible=false}},{key:"setUserKeepVisible",value:function e(){this.userKeepVisible=true}},{key:"resetUserKeepVisible",value:function e(){this.userKeepVisible=false}},{key:"isVisible",value:function e(){return!this.$el.hasClass("media-control-hide")}},{key:"show",value:function e(t){var r=this;if(this.disabled)return;var n=2e3;var i=t&&t.clientX!==this.lastMouseX&&t.clientY!==this.lastMouseY;if(!t||i||navigator.userAgent.match(/firefox/i)){clearTimeout(this.hideId);this.$el.show();this.trigger(k.MEDIACONTROL_SHOW,this.name);this.container&&this.container.trigger(k.CONTAINER_MEDIACONTROL_SHOW,this.name);this.$el.removeClass("media-control-hide");this.hideId=setTimeout(function(){return r.hide()},n);if(t){this.lastMouseX=t.clientX;this.lastMouseY=t.clientY}}var a=true;this.updateCursorStyle(a)}},{key:"hide",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(!this.isVisible())return;var n=r||2e3;clearTimeout(this.hideId);if(!this.disabled&&this.options.hideMediaControl===false)return;var i=this.userKeepVisible||this.keepVisible;var a=this.draggingSeekBar||this.draggingVolumeBar;if(!this.disabled&&(r||i||a))this.hideId=setTimeout(function(){return t.hide()},n);else{this.trigger(k.MEDIACONTROL_HIDE,this.name);this.container&&this.container.trigger(k.CONTAINER_MEDIACONTROL_HIDE,this.name);this.$el.addClass("media-control-hide");this.hideVolumeBar(0);var s=false;this.updateCursorStyle(s)}}},{key:"updateCursorStyle",value:function e(t){if(t)this.core.$el.removeClass("nocursor");else if(this.core.isFullscreen())this.core.$el.addClass("nocursor")}},{key:"settingsUpdate",value:function e(){var t=this.getSettings();if(t&&!this.fullScreenOnVideoTagSupported&&!Bn.fullscreenEnabled()){t["default"]&&Vn(t["default"],"fullscreen");t.left&&Vn(t.left,"fullscreen");t.right&&Vn(t.right,"fullscreen")}var r=JSON.stringify(this.settings)!==JSON.stringify(t);if(r){this.settings=t;this.render()}}},{key:"getSettings",value:function e(){return y.extend(true,{},this.container&&this.container.settings)}},{key:"highDefinitionUpdate",value:function e(t){this.isHD=t;var r=t?"addClass":"removeClass";this.$hdIndicator[r]("enabled")}},{key:"createCachedElements",value:function e(){var t=this.$el.find(".media-control-layer");this.$duration=t.find(".media-control-indicator[data-duration]");this.$fullscreenToggle=t.find("button.media-control-button[data-fullscreen]");this.$playPauseToggle=t.find("button.media-control-button[data-playpause]");this.$playStopToggle=t.find("button.media-control-button[data-playstop]");this.$position=t.find(".media-control-indicator[data-position]");this.$seekBarContainer=t.find(".bar-container[data-seekbar]");this.$seekBarHover=t.find(".bar-hover[data-seekbar]");this.$seekBarLoaded=t.find(".bar-fill-1[data-seekbar]");this.$seekBarPosition=t.find(".bar-fill-2[data-seekbar]");this.$seekBarScrubber=t.find(".bar-scrubber[data-seekbar]");this.$volumeBarContainer=t.find(".bar-container[data-volume]");this.$volumeContainer=t.find(".drawer-container[data-volume]");this.$volumeIcon=t.find(".drawer-icon[data-volume]");this.$volumeBarBackground=this.$el.find(".bar-background[data-volume]");this.$volumeBarFill=this.$el.find(".bar-fill-1[data-volume]");this.$volumeBarScrubber=this.$el.find(".bar-scrubber[data-volume]");this.$hdIndicator=this.$el.find("button.media-control-button[data-hd-indicator]");this.resetIndicators();this.initializeIcons()}},{key:"resetIndicators",value:function e(){this.displayedPosition=this.$position.text();this.displayedDuration=this.$duration.text()}},{key:"initializeIcons",value:function e(){var t=this.$el.find(".media-control-layer");t.find("button.media-control-button[data-play]").append(kn);t.find("button.media-control-button[data-pause]").append(_n);t.find("button.media-control-button[data-stop]").append(In);this.$playPauseToggle.append(kn);this.$playStopToggle.append(kn);this.$volumeIcon.append(Dn);this.$fullscreenToggle.append(Nn);this.$hdIndicator.append(Mn)}},{key:"setSeekPercentage",value:function e(t){t=Math.max(Math.min(t,100),0);if(this.displayedSeekBarPercentage===t)return;this.displayedSeekBarPercentage=t;this.$seekBarPosition.removeClass("media-control-notransition");this.$seekBarScrubber.removeClass("media-control-notransition");this.$seekBarPosition.css({width:"".concat(t,"%")});this.$seekBarScrubber.css({left:"".concat(t,"%")})}},{key:"seekRelative",value:function e(t){if(!this.settings.seekEnabled)return;var r=this.container.getCurrentTime();var n=this.container.getDuration();var i=Math.min(Math.max(r+t,0),n);i=Math.min(i*100/n,100);this.container.seekPercentage(i)}},{key:"bindKeyAndShow",value:function e(t,r){var n=this;this.kibo.down(t,function(){n.show();return r()})}},{key:"bindKeyEvents",value:function e(){var t=this;if(E.isMobile||this.options.disableKeyboardShortcuts)return;this.unbindKeyEvents();this.kibo=new D(this.options.focusElement||this.options.parentElement);this.bindKeyAndShow("space",function(){return t.togglePlayPause()});this.bindKeyAndShow("left",function(){return t.seekRelative(-5)});this.bindKeyAndShow("right",function(){return t.seekRelative(5)});this.bindKeyAndShow("shift left",function(){return t.seekRelative(-10)});this.bindKeyAndShow("shift right",function(){return t.seekRelative(10)});this.bindKeyAndShow("shift ctrl left",function(){return t.seekRelative(-15)});this.bindKeyAndShow("shift ctrl right",function(){return t.seekRelative(15)});var r=["1","2","3","4","5","6","7","8","9","0"];r.forEach(function(e){t.bindKeyAndShow(e,function(){t.settings.seekEnabled&&t.container&&t.container.seekPercentage(e*10)})})}},{key:"unbindKeyEvents",value:function e(){if(this.kibo){this.kibo.off("space");this.kibo.off("left");this.kibo.off("right");this.kibo.off("shift left");this.kibo.off("shift right");this.kibo.off("shift ctrl left");this.kibo.off("shift ctrl right");this.kibo.off(["1","2","3","4","5","6","7","8","9","0"])}}},{key:"parseColors",value:function e(){if(this.options.mediacontrol){this.buttonsColor=this.options.mediacontrol.buttons;var t=this.options.mediacontrol.seekbar;this.$el.find(".bar-fill-2[data-seekbar]").css("background-color",t);this.$el.find(".media-control-icon svg path").css("fill",this.buttonsColor);this.$el.find(".segmented-bar-element[data-volume]").css("boxShadow","inset 2px 0 0 "+this.buttonsColor)}}},{key:"applyButtonStyle",value:function e(t){this.buttonsColor&&t&&y(t).find("svg path").css("fill",this.buttonsColor)}},{key:"destroy",value:function e(){y(document).unbind("mouseup",this.stopDragHandler);y(document).unbind("mousemove",this.updateDragHandler);this.unbindKeyEvents();this.stopListening();on(en(n.prototype),"destroy",this).call(this)}},{key:"configure",value:function e(t){if(this.options.chromeless||t.source||t.sources)this.disable();else this.enable();this.trigger(k.MEDIACONTROL_OPTIONS_CHANGE)}},{key:"render",value:function e(){var t=this;var r=this.options.hideMediaControlDelay||2e3;this.settings&&this.$el.html(this.template({settings:this.settings}));this.createCachedElements();this.$playPauseToggle.addClass("paused");this.$playStopToggle.addClass("stopped");this.changeTogglePlay();if(this.container){this.hideId=setTimeout(function(){return t.hide()},r);this.disabled&&this.hide()}if(E.isSafari&&E.isMobile)if(E.version<10)this.$volumeContainer.css("display","none");else this.$volumeBarContainer.css("display","none");this.$seekBarPosition.addClass("media-control-notransition");this.$seekBarScrubber.addClass("media-control-notransition");var n=0;if(this.displayedSeekBarPercentage)n=this.displayedSeekBarPercentage;this.displayedSeekBarPercentage=null;this.setSeekPercentage(n);setTimeout(function(){!t.settings.seekEnabled&&t.$seekBarContainer.addClass("seek-disabled");!E.isMobile&&!t.options.disableKeyboardShortcuts&&t.bindKeyEvents();t.playerResize({width:t.options.width,height:t.options.height});t.hideVolumeBar(0)},0);this.parseColors();this.highDefinitionUpdate(this.isHD);this.core.$el.append(this.el);this.rendered=true;this.updateVolumeUI();this.trigger(k.MEDIACONTROL_RENDERED);return this}}]);return n}(i),Kn=(Gn.extend=function(e){return jn(Gn,e)},'<div class="play-wrapper" data-poster></div>\n'),Yn,Hn=(dn(".player-poster[data-poster] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  z-index: 998;\n  top: 0;\n  left: 0;\n  background-color: transparent;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: 50% 50%; }\n  .player-poster[data-poster].clickable {\n    cursor: pointer; }\n  .player-poster[data-poster]:hover .play-wrapper[data-poster] {\n    opacity: 1; }\n  .player-poster[data-poster] .play-wrapper[data-poster] {\n    width: 100%;\n    height: 25%;\n    margin: 0 auto;\n    opacity: 0.75;\n    transition: opacity 0.1s ease; }\n    .player-poster[data-poster] .play-wrapper[data-poster] svg {\n      height: 100%; }\n      .player-poster[data-poster] .play-wrapper[data-poster] svg path {\n        fill: #fff; }\n"),function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.hasStartedPlaying=false;t.playRequested=false;t.render();setTimeout(function(){return t.update()},0);return t}O(n,[{key:"name",get:function e(){return"poster"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"template",get:function e(){return _(Kn)}},{key:"shouldRender",get:function e(){var t=!!(this.options.poster&&this.options.poster.showForNoOp);return this.container.playback.name!=="html_img"&&(this.container.playback.getPlaybackType()!==S.NO_OP||t)}},{key:"attributes",get:function e(){return{class:"player-poster","data-poster":""}}},{key:"events",get:function e(){return{click:"clicked"}}},{key:"showOnVideoEnd",get:function e(){return!this.options.poster||this.options.poster.showOnVideoEnd||this.options.poster.showOnVideoEnd===undefined}},{key:"bindEvents",value:function e(){this.listenTo(this.container,k.CONTAINER_STOP,this.onStop);this.listenTo(this.container,k.CONTAINER_PLAY,this.onPlay);this.listenTo(this.container,k.CONTAINER_STATE_BUFFERING,this.update);this.listenTo(this.container,k.CONTAINER_STATE_BUFFERFULL,this.update);this.listenTo(this.container,k.CONTAINER_OPTIONS_CHANGE,this.render);this.listenTo(this.container,k.CONTAINER_ERROR,this.onError);this.showOnVideoEnd&&this.listenTo(this.container,k.CONTAINER_ENDED,this.onStop)}},{key:"onError",value:function e(t){this.hasFatalError=t.level===T.Levels.FATAL;if(this.hasFatalError){this.hasStartedPlaying=false;this.playRequested=false;this.showPlayButton()}}},{key:"onPlay",value:function e(){this.hasStartedPlaying=true;this.update()}},{key:"onStop",value:function e(){this.hasStartedPlaying=false;this.playRequested=false;this.update()}},{key:"updatePlayButton",value:function e(t){if(t&&(!this.options.chromeless||this.options.allowUserInteraction))this.showPlayButton();else this.hidePlayButton()}},{key:"showPlayButton",value:function e(){if(this.hasFatalError&&!this.options.disableErrorScreen)return;this.$playButton.show();this.$el.addClass("clickable")}},{key:"hidePlayButton",value:function e(){this.$playButton.hide();this.$el.removeClass("clickable")}},{key:"clicked",value:function e(){if(!this.hasStartedPlaying){if(!this.options.chromeless||this.options.allowUserInteraction){this.playRequested=true;this.update();this.container.playback&&(this.container.playback._consented=true);this.container.play()}return false}}},{key:"shouldHideOnPlay",value:function e(){return!this.container.playback.isAudioOnly}},{key:"update",value:function e(){if(!this.shouldRender)return;var t=!this.playRequested&&!this.hasStartedPlaying&&!this.container.buffering;this.updatePlayButton(t);this.updatePoster()}},{key:"updatePoster",value:function e(){if(!this.hasStartedPlaying)this.showPoster();else this.hidePoster()}},{key:"showPoster",value:function e(){this.container.disableMediaControl();this.$el.show()}},{key:"hidePoster",value:function e(){this.container.enableMediaControl();if(this.shouldHideOnPlay())this.$el.hide()}},{key:"render",value:function e(){if(!this.shouldRender)return;this.$el.html(this.template());var t=this.options.poster&&this.options.poster.custom===undefined;if(t){var r=this.options.poster.url||this.options.poster;this.$el.css({"background-image":"url("+r+")"});this.removeVideoElementPoster()}else if(this.options.poster){this.$el.css({background:this.options.poster.custom});this.removeVideoElementPoster()}this.container.$el.append(this.el);this.$playWrapper=this.$el.find(".play-wrapper");this.$playWrapper.append(kn);this.$playButton=this.$playWrapper.find("svg");this.$playButton.addClass("poster-icon");this.$playButton.attr("data-poster","");var n=this.options.mediacontrol&&this.options.mediacontrol.buttons;if(n)this.$el.find("svg path").css("fill",n);if(this.options.mediacontrol&&this.options.mediacontrol.buttons){n=this.options.mediacontrol.buttons;this.$playButton.css("color",n)}this.update();return this}},{key:"removeVideoElementPoster",value:function e(){this.container.playback&&this.container.playback.$el&&this.container.playback.$el[0]&&this.container.playback.$el[0].removeAttribute&&this.container.playback.$el[0].removeAttribute("poster")}}]);return n}(C)),zn="<span data-seek-time></span>\n<span data-duration></span>\n",$n,Wn=(dn('.seek-time[data-seek-time] {\n  position: absolute;\n  white-space: nowrap;\n  height: 20px;\n  line-height: 20px;\n  font-size: 0;\n  left: -100%;\n  bottom: 55px;\n  background-color: rgba(2, 2, 2, 0.5);\n  z-index: 9999;\n  transition: opacity 0.1s ease; }\n  .seek-time[data-seek-time].hidden[data-seek-time] {\n    opacity: 0; }\n  .seek-time[data-seek-time] [data-seek-time] {\n    display: inline-block;\n    color: white;\n    font-size: 10px;\n    padding-left: 7px;\n    padding-right: 7px;\n    vertical-align: top; }\n  .seek-time[data-seek-time] [data-duration] {\n    display: inline-block;\n    color: rgba(255, 255, 255, 0.5);\n    font-size: 10px;\n    padding-right: 7px;\n    vertical-align: top; }\n    .seek-time[data-seek-time] [data-duration]:before {\n      content: "|";\n      margin-right: 7px; }\n'),t.formatTime),qn=function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.hoveringOverSeekBar=false;t.hoverPosition=null;t.duration=null;t.firstFragDateTime=null;t.actualLiveTime=!!t.mediaControl.options.actualLiveTime;if(t.actualLiveTime)if(t.mediaControl.options.actualLiveServerTime)t.actualLiveServerTimeDiff=(new Date).getTime()-new Date(t.mediaControl.options.actualLiveServerTime).getTime();else t.actualLiveServerTimeDiff=0;return t}O(n,[{key:"name",get:function e(){return"seek_time"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"template",get:function e(){return _(zn)}},{key:"attributes",get:function e(){return{class:"seek-time","data-seek-time":""}}},{key:"mediaControl",get:function e(){return this.core.mediaControl}},{key:"mediaControlContainer",get:function e(){return this.mediaControl.container}},{key:"isLiveStreamWithDvr",get:function e(){return this.mediaControlContainer&&this.mediaControlContainer.getPlaybackType()===S.LIVE&&this.mediaControlContainer.isDvrEnabled()}},{key:"durationShown",get:function e(){return this.isLiveStreamWithDvr&&!this.actualLiveTime}},{key:"useActualLiveTime",get:function e(){return this.actualLiveTime&&this.isLiveStreamWithDvr}},{key:"bindEvents",value:function e(){this.listenTo(this.mediaControl,k.MEDIACONTROL_RENDERED,this.render);this.listenTo(this.mediaControl,k.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.showTime);this.listenTo(this.mediaControl,k.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.hideTime);this.listenTo(this.mediaControl,k.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged);if(this.mediaControlContainer){this.listenTo(this.mediaControlContainer,k.CONTAINER_PLAYBACKDVRSTATECHANGED,this.update);this.listenTo(this.mediaControlContainer,k.CONTAINER_TIMEUPDATE,this.updateDuration)}}},{key:"onContainerChanged",value:function e(){this.stopListening();this.bindEvents()}},{key:"updateDuration",value:function e(t){this.duration=t.total;this.firstFragDateTime=t.firstFragDateTime;this.update()}},{key:"showTime",value:function e(t){this.hoveringOverSeekBar=true;this.calculateHoverPosition(t);this.update()}},{key:"hideTime",value:function e(){this.hoveringOverSeekBar=false;this.update()}},{key:"calculateHoverPosition",value:function e(t){var r=t.pageX-this.mediaControl.$seekBarContainer.offset().left;this.hoverPosition=Math.min(1,Math.max(r/this.mediaControl.$seekBarContainer.width(),0))}},{key:"getSeekTime",value:function e(){var t,r,n,i;if(this.useActualLiveTime){if(this.firstFragDateTime){i=new Date(this.firstFragDateTime);n=new Date(this.firstFragDateTime);n.setHours(0,0,0,0);r=(i.getTime()-n.getTime())/1e3+this.duration}else{n=new Date((new Date).getTime()-this.actualLiveServerTimeDiff);i=new Date(n);r=(i-n.setHours(0,0,0,0))/1e3}t=r-this.duration+this.hoverPosition*this.duration;if(t<0)t+=86400}else t=this.hoverPosition*this.duration;return{seekTime:t,secondsSinceMidnight:r}}},{key:"update",value:function e(){if(!this.rendered)return;if(!this.shouldBeVisible()){this.$el.hide();this.$el.css("left","-100%")}else{var t=this.getSeekTime();var r=Wn(t.seekTime,this.useActualLiveTime);if(r!==this.displayedSeekTime){this.$seekTimeEl.text(r);this.displayedSeekTime=r}if(this.durationShown){this.$durationEl.show();var n=Wn(this.actualLiveTime?t.secondsSinceMidnight:this.duration,this.actualLiveTime);if(n!==this.displayedDuration){this.$durationEl.text(n);this.displayedDuration=n}}else this.$durationEl.hide();this.$el.show();var i=this.mediaControl.$seekBarContainer.width();var a=this.$el.width();var s=this.hoverPosition*i;s-=a/2;s=Math.max(0,Math.min(s,i-a));this.$el.css("left",s)}}},{key:"shouldBeVisible",value:function e(){return this.mediaControlContainer&&this.mediaControlContainer.settings.seekEnabled&&this.hoveringOverSeekBar&&this.hoverPosition!==null&&this.duration!==null}},{key:"render",value:function e(){this.rendered=true;this.displayedDuration=null;this.displayedSeekTime=null;this.$el.html(this.template());this.$el.hide();this.mediaControl.$el.append(this.el);this.$seekTimeEl=this.$el.find("[data-seek-time]");this.$durationEl=this.$el.find("[data-duration]");this.$durationEl.hide();this.update()}}]);return n}(i),Xn="<div data-bounce1></div><div data-bounce2></div><div data-bounce3></div>\n",Zn,Qn=(dn(".spinner-three-bounce[data-spinner] {\n  position: absolute;\n  margin: 0 auto;\n  width: 70px;\n  text-align: center;\n  z-index: 999;\n  left: 0;\n  right: 0;\n  margin-left: auto;\n  margin-right: auto;\n  /* center vertically */\n  top: 50%;\n  transform: translateY(-50%); }\n  .spinner-three-bounce[data-spinner] > div {\n    width: 18px;\n    height: 18px;\n    background-color: #FFFFFF;\n    border-radius: 100%;\n    display: inline-block;\n    -webkit-animation: bouncedelay 1.4s infinite ease-in-out;\n            animation: bouncedelay 1.4s infinite ease-in-out;\n    /* Prevent first frame from flickering when animation starts */\n    -webkit-animation-fill-mode: both;\n            animation-fill-mode: both; }\n  .spinner-three-bounce[data-spinner] [data-bounce1] {\n    -webkit-animation-delay: -0.32s;\n            animation-delay: -0.32s; }\n  .spinner-three-bounce[data-spinner] [data-bounce2] {\n    -webkit-animation-delay: -0.16s;\n            animation-delay: -0.16s; }\n\n@-webkit-keyframes bouncedelay {\n  0%, 80%, 100% {\n    transform: scale(0); }\n  40% {\n    transform: scale(1); } }\n\n@keyframes bouncedelay {\n  0%, 80%, 100% {\n    transform: scale(0); }\n  40% {\n    transform: scale(1); } }\n"),function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.template=_(Xn);t.showTimeout=null;t.listenTo(t.container,k.CONTAINER_STATE_BUFFERING,t.onBuffering);t.listenTo(t.container,k.CONTAINER_STATE_BUFFERFULL,t.onBufferFull);t.listenTo(t.container,k.CONTAINER_STOP,t.onStop);t.listenTo(t.container,k.CONTAINER_ENDED,t.onStop);t.listenTo(t.container,k.CONTAINER_ERROR,t.onStop);t.render();return t}O(n,[{key:"name",get:function e(){return"spinner"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"attributes",get:function e(){return{"data-spinner":"",class:"spinner-three-bounce"}}},{key:"onBuffering",value:function e(){this.show()}},{key:"onBufferFull",value:function e(){this.hide()}},{key:"onStop",value:function e(){this.hide()}},{key:"show",value:function e(){var t=this;if(this.showTimeout===null)this.showTimeout=setTimeout(function(){return t.$el.show()},300)}},{key:"hide",value:function e(){if(this.showTimeout!==null){clearTimeout(this.showTimeout);this.showTimeout=null}this.$el.hide()}},{key:"render",value:function e(){this.$el.html(this.template());this.container.$el.append(this.$el);this.$el.hide();if(this.container.buffering)this.onBuffering();return this}}]);return n}(C)),Jn=function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.setInitialAttrs();t.reportInterval=t.options.reportInterval||5e3;t.state="IDLE";return t}O(n,[{key:"name",get:function e(){return"stats"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"bindEvents",value:function e(){this.listenTo(this.container.playback,k.PLAYBACK_PLAY,this.onPlay);this.listenTo(this.container,k.CONTAINER_STOP,this.onStop);this.listenTo(this.container,k.CONTAINER_ENDED,this.onStop);this.listenTo(this.container,k.CONTAINER_DESTROYED,this.onStop);this.listenTo(this.container,k.CONTAINER_STATE_BUFFERING,this.onBuffering);this.listenTo(this.container,k.CONTAINER_STATE_BUFFERFULL,this.onBufferFull);this.listenTo(this.container,k.CONTAINER_STATS_ADD,this.onStatsAdd);this.listenTo(this.container,k.CONTAINER_BITRATE,this.onStatsAdd);this.listenTo(this.container.playback,k.PLAYBACK_STATS_ADD,this.onStatsAdd)}},{key:"setInitialAttrs",value:function e(){this.firstPlay=true;this.startupTime=0;this.rebufferingTime=0;this.watchingTime=0;this.rebuffers=0;this.externalMetrics={}}},{key:"onPlay",value:function e(){this.state="PLAYING";this.watchingTimeInit=Date.now();if(!this.intervalId)this.intervalId=setInterval(this.report.bind(this),this.reportInterval)}},{key:"onStop",value:function e(){clearInterval(this.intervalId);this.report();this.intervalId=undefined;this.state="STOPPED"}},{key:"onBuffering",value:function e(){if(this.firstPlay)this.startupTimeInit=Date.now();else this.rebufferingTimeInit=Date.now();this.state="BUFFERING";this.rebuffers++}},{key:"onBufferFull",value:function e(){if(this.firstPlay&&this.startupTimeInit){this.firstPlay=false;this.startupTime=Date.now()-this.startupTimeInit;this.watchingTimeInit=Date.now()}else if(this.rebufferingTimeInit)this.rebufferingTime+=this.getRebufferingTime();this.rebufferingTimeInit=undefined;this.state="PLAYING"}},{key:"getRebufferingTime",value:function e(){return Date.now()-this.rebufferingTimeInit}},{key:"getWatchingTime",value:function e(){var t=Date.now()-this.watchingTimeInit;return t-this.rebufferingTime}},{key:"isRebuffering",value:function e(){return!!this.rebufferingTimeInit}},{key:"onStatsAdd",value:function e(t){y.extend(this.externalMetrics,t)}},{key:"getStats",value:function e(){var t={startupTime:this.startupTime,rebuffers:this.rebuffers,rebufferingTime:this.isRebuffering()?this.rebufferingTime+this.getRebufferingTime():this.rebufferingTime,watchingTime:this.isRebuffering()?this.getWatchingTime()-this.getRebufferingTime():this.getWatchingTime()};y.extend(t,this.externalMetrics);return t}},{key:"report",value:function e(){this.container.statsReport(this.getStats())}}]);return n}(a),ei='<div class="clappr-watermark" data-watermark data-watermark-<%=position %>>\n<% if(typeof imageLink !== \'undefined\') { %>\n<a target="_blank" href="<%= imageLink %>">\n<% } %>\n<img src="<%= imageUrl %>">\n<% if(typeof imageLink !== \'undefined\') { %>\n</a>\n<% } %>\n</div>\n',ti;dn(".clappr-watermark[data-watermark] {\n  position: absolute;\n  min-width: 70px;\n  max-width: 200px;\n  width: 12%;\n  text-align: center;\n  z-index: 10; }\n\n.clappr-watermark[data-watermark] a {\n  outline: none;\n  cursor: pointer; }\n\n.clappr-watermark[data-watermark] img {\n  max-width: 100%; }\n\n.clappr-watermark[data-watermark-bottom-left] {\n  bottom: 10px;\n  left: 10px; }\n\n.clappr-watermark[data-watermark-bottom-right] {\n  bottom: 10px;\n  right: 42px; }\n\n.clappr-watermark[data-watermark-top-left] {\n  top: 10px;\n  left: 10px; }\n\n.clappr-watermark[data-watermark-top-right] {\n  top: 10px;\n  right: 37px; }\n");for(var ri,P={ClickToPause:ln,ClosedCaptions:hn,DVRControls:gn,EndVideo:An,ErrorScreen:bn,Favicon:Sn,GoogleAnalytics:Cn,MediaControl:Gn,Poster:Hn,SeekTime:qn,SpinnerThreeBounce:Qn,Stats:Jn,WaterMark:function(e){L(n,e);var r=I(n);function n(e){var t;w(this,n);t=r.call(this,e);t.configure();return t}O(n,[{key:"name",get:function e(){return"watermark"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"template",get:function e(){return _(ei)}},{key:"bindEvents",value:function e(){this.listenTo(this.container,k.CONTAINER_PLAY,this.onPlay);this.listenTo(this.container,k.CONTAINER_STOP,this.onStop);this.listenTo(this.container,k.CONTAINER_OPTIONS_CHANGE,this.configure)}},{key:"configure",value:function e(){this.position=this.options.position||"bottom-right";if(this.options.watermark){this.imageUrl=this.options.watermark;this.imageLink=this.options.watermarkLink;this.render()}else this.$el.remove()}},{key:"onPlay",value:function e(){if(!this.hidden)this.$el.show()}},{key:"onStop",value:function e(){this.$el.hide()}},{key:"render",value:function e(){this.$el.hide();var t={position:this.position,imageUrl:this.imageUrl,imageLink:this.imageLink};this.$el.html(this.template(t));this.container.$el.append(this.$el);return this}}]);return n}(C)},ni="0.4.6",ii=0,ai=Object.values(P);ii<ai.length;ii++){var si=ai[ii];o.registerPlugin(si)}var oi=P.ClickToPause,li=P.ClosedCaptions,ui=P.DVRControls,ci=P.EndVideo,di=P.ErrorScreen,fi=P.Favicon,hi=P.GoogleAnalytics,pi=P.MediaControl,vi=P.Poster,gi=P.SeekTime,Ai=P.SpinnerThreeBounce,mi=P.Stats,yi=P.WaterMark,Ei=F(F({},Qr),{},{ClickToPause:oi,ClosedCaptions:li,DVRControls:ui,EndVideo:ci,ErrorScreen:di,Favicon:fi,GoogleAnalytics:hi,MediaControl:pi,Poster:vi,SeekTime:gi,SpinnerThreeBounce:Ai,Stats:mi,WaterMark:yi,Vendor:wn,Plugins:P,version:ni});function bi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function ki(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2)bi(Object(r),true).forEach(function(e){Ci(t,e,r[e])});else if(Object.getOwnPropertyDescriptors)Object.defineProperties(t,Object.getOwnPropertyDescriptors(r));else bi(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ti(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function Si(e,t,r){if(t)Ti(e.prototype,t);if(r)Ti(e,r);return e}function Ci(e,t,r){if(t in e)Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});else e[t]=r;return e}function Ri(e,t){if(typeof t!=="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)wi(e,t)}function N(e){N=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return N(e)}function wi(e,t){wi=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return wi(e,t)}function Oi(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function Li(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ii(e,t){if(t&&(typeof t==="object"||typeof t==="function"))return t;return Li(e)}function Di(i){var a=Oi();return function e(){var t=N(i),r;if(a){var n=N(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return Ii(this,r)}}function Pi(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=N(e);if(e===null)break}return e}function Ni(e,t,r){if(typeof Reflect!=="undefined"&&Reflect.get)Ni=Reflect.get;else Ni=function e(t,r,n){var i=Pi(t,r);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,r);if(a.get)return a.get.call(n);return a.value};return Ni(e,t,r||e)}function xi(e){return Mi(e)||Fi(e)||Bi(e)||ji()}function Mi(e){if(Array.isArray(e))return Ui(e)}function Fi(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bi(e,t){if(!e)return;if(typeof e==="string")return Ui(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ui(e,t)}function Ui(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ji(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Vi=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof Qi!=="undefined"?Qi:typeof self!=="undefined"?self:{};function Gi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var Ki={exports:{}},Yi=Ki,Hi=void 0,x=(typeof window!=="undefined"&&function e(t,r){Yi.exports=r()}(Vi,function(){return function(r){var n={};function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=r;i.c=n;i.d=function(e,t,r){if(!i.o(e,t))Object.defineProperty(e,t,{enumerable:true,get:r})};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag)Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);i.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="/dist/";return i(i.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
    !*** ./node_modules/eventemitter3/index.js ***!
    \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,r){var i=Object.prototype.hasOwnProperty,p="~";function n(){}if(Object.create){n.prototype=Object.create(null);if(!(new n).__proto__)p=false}function o(e,t,r){this.fn=e;this.context=t;this.once=r||false}function a(e,t,r,n,i){if(typeof r!=="function")throw new TypeError("The listener must be a function");var a=new o(r,n||e,i),s=p?p+t:t;if(!e._events[s])e._events[s]=a,e._eventsCount++;else if(!e._events[s].fn)e._events[s].push(a);else e._events[s]=[e._events[s],a];return e}function c(e,t){if(--e._eventsCount===0)e._events=new n;else delete e._events[t]}function s(){this._events=new n;this._eventsCount=0}s.prototype.eventNames=function e(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)if(i.call(r,n))t.push(p?n.slice(1):n);if(Object.getOwnPropertySymbols)return t.concat(Object.getOwnPropertySymbols(r));return t};s.prototype.listeners=function e(t){var r=p?p+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,s=new Array(a);i<a;i++)s[i]=n[i].fn;return s};s.prototype.listenerCount=function e(t){var r=p?p+t:t,n=this._events[r];if(!n)return 0;if(n.fn)return 1;return n.length};s.prototype.emit=function e(t,r,n,i,a,s){var o=p?p+t:t;if(!this._events[o])return false;var l=this._events[o],u=arguments.length,c,d;if(l.fn){if(l.once)this.removeListener(t,l.fn,undefined,true);switch(u){case 1:return l.fn.call(l.context),true;case 2:return l.fn.call(l.context,r),true;case 3:return l.fn.call(l.context,r,n),true;case 4:return l.fn.call(l.context,r,n,i),true;case 5:return l.fn.call(l.context,r,n,i,a),true;case 6:return l.fn.call(l.context,r,n,i,a,s),true}for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];l.fn.apply(l.context,c)}else{var f=l.length,h;for(d=0;d<f;d++){if(l[d].once)this.removeListener(t,l[d].fn,undefined,true);switch(u){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,r);break;case 3:l[d].fn.call(l[d].context,r,n);break;case 4:l[d].fn.call(l[d].context,r,n,i);break;default:if(!c)for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];l[d].fn.apply(l[d].context,c)}}}return true};s.prototype.on=function e(t,r,n){return a(this,t,r,n,false)};s.prototype.once=function e(t,r,n){return a(this,t,r,n,true)};s.prototype.removeListener=function e(t,r,n,i){var a=p?p+t:t;if(!this._events[a])return this;if(!r){c(this,a);return this}var s=this._events[a];if(s.fn){if(s.fn===r&&(!i||s.once)&&(!n||s.context===n))c(this,a)}else{for(var o=0,l=[],u=s.length;o<u;o++)if(s[o].fn!==r||i&&!s[o].once||n&&s[o].context!==n)l.push(s[o]);if(l.length)this._events[a]=l.length===1?l[0]:l;else c(this,a)}return this};s.prototype.removeAllListeners=function e(t){var r;if(t){r=p?p+t:t;if(this._events[r])c(this,r)}else{this._events=new n;this._eventsCount=0}return this};s.prototype.off=s.prototype.removeListener;s.prototype.addListener=s.prototype.on;s.prefixed=p;s.EventEmitter=s;e.exports=s},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
    !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
    \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(i,e,t){(function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/;var c=/^([^\/?#]*)(.*)$/;var t=/(?:\/|^)\.(?=\/)/g;var n=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g;var d={buildAbsoluteURL:function(e,t,r){r=r||{};e=e.trim();t=t.trim();if(!t){if(!r.alwaysNormalize)return e;var n=d.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");n.path=d.normalizePath(n.path);return d.buildURLFromParts(n)}var i=d.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme){if(!r.alwaysNormalize)return t;i.path=d.normalizePath(i.path);return d.buildURLFromParts(i)}var a=d.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&a.path[0]!=="/"){var s=c.exec(a.path);a.netLoc=s[1];a.path=s[2]}if(a.netLoc&&!a.path)a.path="/";var o={scheme:a.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc){o.netLoc=a.netLoc;if(i.path[0]!=="/")if(!i.path){o.path=a.path;if(!i.params){o.params=a.params;if(!i.query)o.query=a.query}}else{var l=a.path;var u=l.substring(0,l.lastIndexOf("/")+1)+i.path;o.path=d.normalizePath(u)}}if(o.path===null)o.path=r.alwaysNormalize?d.normalizePath(i.path):i.path;return d.buildURLFromParts(o)},parseURL:function(e){var t=r.exec(e);if(!t)return null;return{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(t,"");while(e.length!==(e=e.replace(n,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};i.exports=d})()},"./node_modules/webworkify-webpack/index.js":
/*!**************************************************!*\
    !*** ./node_modules/webworkify-webpack/index.js ***!
    \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,f){function u(r){var n={};function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=r;i.c=n;i.i=function(e){return e};i.d=function(e,t,r){if(!i.o(e,t))Object.defineProperty(e,t,{configurable:false,enumerable:true,get:r})};i.r=function(e){Object.defineProperty(e,"__esModule",{value:true})};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="/";i.oe=function(e){console.error(e);throw e};var e=i(i.s=ENTRY_MODULE);return e.default||e}var h="[\\.|\\-|\\+|\\w|/|@]+";var p="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+h+").*?\\)";function v(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function g(e){return!isNaN(1*e)}function A(e,t,r){var n={};n[r]=[];var i=t.toString();var a=i.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!a)return n;var s=a[1];var o=new RegExp("(\\\\n|\\W)"+v(s)+p,"g");var l;while(l=o.exec(i)){if(l[3]==="dll-reference")continue;n[r].push(l[3])}o=new RegExp("\\("+v(s)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+p,"g");while(l=o.exec(i)){if(!e[l[2]]){n[r].push(l[1]);e[l[2]]=f(l[1]).m}n[l[2]]=n[l[2]]||[];n[l[2]].push(l[4])}var u=Object.keys(n);for(var c=0;c<u.length;c++)for(var d=0;d<n[u[c]].length;d++)if(g(n[u[c]][d]))n[u[c]][d]=1*n[u[c]][d];return n}function m(r){var e=Object.keys(r);return e.reduce(function(e,t){return e||r[t].length>0},false)}function c(e,t){var r={main:[t]};var n={main:[]};var i={main:{}};while(m(r)){var a=Object.keys(r);for(var s=0;s<a.length;s++){var o=a[s];var l=r[o];var u=l.pop();i[o]=i[o]||{};if(i[o][u]||!e[o][u])continue;i[o][u]=true;n[o]=n[o]||[];n[o].push(u);var c=A(e,e[o][u],o);var d=Object.keys(c);for(var f=0;f<d.length;f++){r[d[f]]=r[d[f]]||[];r[d[f]]=r[d[f]].concat(c[d[f]])}}}return n}e.exports=function(e,t){t=t||{};var r={main:f.m};var n=t.all?{main:Object.keys(r.main)}:c(r,e);var i="";Object.keys(n).filter(function(e){return e!=="main"}).forEach(function(t){var e=0;while(n[t][e])e++;n[t].push(e);r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";i=i+"var "+t+" = ("+u.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n[t].map(function(e){return""+JSON.stringify(e)+": "+r[t][e].toString()}).join(",")+"});\n"});i=i+"new (("+u.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n.main.map(function(e){return""+JSON.stringify(e)+": "+r.main[e].toString()}).join(",")+"}))(self);";var a=new window.Blob([i],{type:"text/javascript"});if(t.bare)return a;var s=window.URL||window.webkitURL||window.mozURL||window.msURL;var o=s.createObjectURL(a);var l=new window.Worker(o);l.objectURL=o;return l}},"./src/crypt/decrypter.js":
/*!********************************************!*\
    !*** ./src/crypt/decrypter.js + 3 modules ***!
    \********************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(e,t,r){r.r(t);var l=function(){function e(e,t){this.subtle=e;this.aesIV=t}var t=e.prototype;t.decrypt=function e(t,r){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},r,t)};return e}();var n=function(){function e(e,t){this.subtle=e;this.key=t}var t=e.prototype;t.expandKey=function e(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},false,["encrypt","decrypt"])};return e}();var u=n;function x(e){var t=e.byteLength;var r=t&&new DataView(e).getUint8(t-1);if(r)return e.slice(0,t-r);else return e}var i=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}var t=e.prototype;t.uint8ArrayToUint32Array_=function e(t){var r=new DataView(t);var n=new Uint32Array(4);for(var i=0;i<4;i++)n[i]=r.getUint32(i*4);return n};t.initTable=function e(){var t=this.sBox;var r=this.invSBox;var n=this.subMix;var i=n[0];var a=n[1];var s=n[2];var o=n[3];var l=this.invSubMix;var u=l[0];var c=l[1];var d=l[2];var f=l[3];var h=new Uint32Array(256);var p=0;var v=0;var g=0;for(g=0;g<256;g++)if(g<128)h[g]=g<<1;else h[g]=g<<1^283;for(g=0;g<256;g++){var A=v^v<<1^v<<2^v<<3^v<<4;A=A>>>8^A&255^99;t[p]=A;r[A]=p;var m=h[p];var y=h[m];var E=h[y];var b=h[A]*257^A*16843008;i[p]=b<<24|b>>>8;a[p]=b<<16|b>>>16;s[p]=b<<8|b>>>24;o[p]=b;b=E*16843009^y*65537^m*257^p*16843008;u[A]=b<<24|b>>>8;c[A]=b<<16|b>>>16;d[A]=b<<8|b>>>24;f[A]=b;if(!p)p=v=1;else{p=m^h[h[h[E^m]]];v^=h[h[v]]}}};t.expandKey=function e(t){var r=this.uint8ArrayToUint32Array_(t);var n=true;var i=0;while(i<r.length&&n){n=r[i]===this.key[i];i++}if(n)return;this.key=r;var a=this.keySize=r.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);var s=this.ksRows=(a+6+1)*4;var o;var l;var u=this.keySchedule=new Uint32Array(s);var c=this.invKeySchedule=new Uint32Array(s);var d=this.sBox;var f=this.rcon;var h=this.invSubMix;var p=h[0];var v=h[1];var g=h[2];var A=h[3];var m;var y;for(o=0;o<s;o++){if(o<a){m=u[o]=r[o];continue}y=m;if(o%a===0){y=y<<8|y>>>24;y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[y&255];y^=f[o/a|0]<<24}else if(a>6&&o%a===4)y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[y&255];u[o]=m=(u[o-a]^y)>>>0}for(l=0;l<s;l++){o=s-l;if(l&3)y=u[o];else y=u[o-4];if(l<4||o<=4)c[l]=y;else c[l]=p[d[y>>>24]]^v[d[y>>>16&255]]^g[d[y>>>8&255]]^A[d[y&255]];c[l]=c[l]>>>0}};t.networkToHostOrderSwap=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};t.decrypt=function e(t,r,n,i){var a=this.keySize+6;var s=this.invKeySchedule;var o=this.invSBox;var l=this.invSubMix;var u=l[0];var c=l[1];var d=l[2];var f=l[3];var h=this.uint8ArrayToUint32Array_(n);var p=h[0];var v=h[1];var g=h[2];var A=h[3];var m=new Int32Array(t);var y=new Int32Array(m.length);var E,b,k,_;var T,S,C,R;var w,O,L,I;var D,P;var N=this.networkToHostOrderSwap;while(r<m.length){w=N(m[r]);O=N(m[r+1]);L=N(m[r+2]);I=N(m[r+3]);T=w^s[0];S=I^s[1];C=L^s[2];R=O^s[3];D=4;for(P=1;P<a;P++){E=u[T>>>24]^c[S>>16&255]^d[C>>8&255]^f[R&255]^s[D];b=u[S>>>24]^c[C>>16&255]^d[R>>8&255]^f[T&255]^s[D+1];k=u[C>>>24]^c[R>>16&255]^d[T>>8&255]^f[S&255]^s[D+2];_=u[R>>>24]^c[T>>16&255]^d[S>>8&255]^f[C&255]^s[D+3];T=E;S=b;C=k;R=_;D=D+4}E=o[T>>>24]<<24^o[S>>16&255]<<16^o[C>>8&255]<<8^o[R&255]^s[D];b=o[S>>>24]<<24^o[C>>16&255]<<16^o[R>>8&255]<<8^o[T&255]^s[D+1];k=o[C>>>24]<<24^o[R>>16&255]<<16^o[T>>8&255]<<8^o[S&255]^s[D+2];_=o[R>>>24]<<24^o[T>>16&255]<<16^o[S>>8&255]<<8^o[C&255]^s[D+3];D=D+3;y[r]=N(E^p);y[r+1]=N(_^v);y[r+2]=N(k^g);y[r+3]=N(b^A);p=w;v=O;g=L;A=I;r=r+4}return i?x(y.buffer):y.buffer};t.destroy=function e(){this.key=undefined;this.keySize=undefined;this.ksRows=undefined;this.sBox=undefined;this.invSBox=undefined;this.subMix=undefined;this.invSubMix=undefined;this.keySchedule=undefined;this.invKeySchedule=undefined;this.rcon=undefined};return e}();var c=i;var s=r("./src/errors.ts");var d=r("./src/utils/logger.js");var o=r("./src/events.js");var a=r("./src/utils/get-self-scope.js");var f=Object(a["getSelfScope"])();var h=function(){function e(e,t,r){var n=r===void 0?{}:r,i=n.removePKCS7Padding,a=i===void 0?true:i;this.logEnabled=true;this.observer=e;this.config=t;this.removePKCS7Padding=a;if(a)try{var s=f.crypto;if(s)this.subtle=s.subtle||s.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;t.isSync=function e(){return this.disableWebCrypto&&this.config.enableSoftwareAES};t.decrypt=function e(r,n,i,a){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){if(this.logEnabled){d["logger"].log("JS AES decrypt");this.logEnabled=false}var t=this.decryptor;if(!t)this.decryptor=t=new c;t.expandKey(n);a(t.decrypt(r,0,i,this.removePKCS7Padding))}else{if(this.logEnabled){d["logger"].log("WebCrypto AES decrypt");this.logEnabled=false}var o=this.subtle;if(this.key!==n){this.key=n;this.fastAesKey=new u(o,n)}this.fastAesKey.expandKey().then(function(e){var t=new l(o,i);t.decrypt(r,e).catch(function(e){s.onWebCryptoError(e,r,n,i,a)}).then(function(e){a(e)})}).catch(function(e){s.onWebCryptoError(e,r,n,i,a)})}};t.onWebCryptoError=function e(t,r,n,i,a){if(this.config.enableSoftwareAES){d["logger"].log("WebCrypto Error, disable WebCrypto API");this.disableWebCrypto=true;this.logEnabled=true;this.decrypt(r,n,i,a)}else{d["logger"].error("decrypting error : "+t.message);this.observer.trigger(o["default"].ERROR,{type:s["ErrorTypes"].MEDIA_ERROR,details:s["ErrorDetails"].FRAG_DECRYPT_ERROR,fatal:true,reason:t.message})}};t.destroy=function e(){var t=this.decryptor;if(t){t.destroy();this.decryptor=undefined}};return e}();t["default"]=h},"./src/demux/demuxer-inline.js":
/*!**************************************************!*\
    !*** ./src/demux/demuxer-inline.js + 12 modules ***!
    \**************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(S,e,t){t.r(e);var oe=t("./src/events.js");var le=t("./src/errors.ts");var g=t("./src/crypt/decrypter.js");var v=t("./src/polyfills/number.js");var ue=t("./src/utils/logger.js");var r=t("./src/utils/get-self-scope.js");function s(e,t,r,n){var i,a,s,o,l,u=navigator.userAgent.toLowerCase(),c=n,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((t[r+2]&192)>>>6)+1;a=(t[r+2]&60)>>>2;if(a>d.length-1){e.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MEDIA_ERROR,details:le["ErrorDetails"].FRAG_PARSING_ERROR,fatal:true,reason:"invalid ADTS sampling index:"+a});return}o=(t[r+2]&1)<<2;o|=(t[r+3]&192)>>>6;ue["logger"].log("manifest codec:"+n+",ADTS data:type:"+i+",sampleingIndex:"+a+"["+d[a]+"Hz],channelConfig:"+o);if(/firefox/i.test(u))if(a>=6){i=5;l=new Array(4);s=a-3}else{i=2;l=new Array(2);s=a}else if(u.indexOf("android")!==-1){i=2;l=new Array(2);s=a}else{i=5;l=new Array(4);if(n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&a>=6)s=a-3;else{if(n&&n.indexOf("mp4a.40.2")!==-1&&(a>=6&&o===1||/vivaldi/i.test(u))||!n&&o===1){i=2;l=new Array(2)}s=a}}l[0]=i<<3;l[0]|=(a&14)>>1;l[1]|=(a&1)<<7;l[1]|=o<<3;if(i===5){l[1]|=(s&14)>>1;l[2]=(s&1)<<7;l[2]|=2<<2;l[3]=0}return{config:l,samplerate:d[a],channelCount:o,codec:"mp4a.40."+i,manifestCodec:c}}function a(e,t){return e[t]===255&&(e[t+1]&246)===240}function u(e,t){return e[t+1]&1?7:9}function c(e,t){return(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5}function m(e,t){if(t+1<e.length&&a(e,t))return true;return false}function o(e,t){if(m(e,t)){var r=u(e,t);if(t+r>=e.length)return false;var n=c(e,t);if(n<=r)return false;var i=t+n;if(i===e.length||i+1<e.length&&a(e,i))return true}return false}function y(e,t,r,n,i){if(!e.samplerate){var a=s(t,r,n,i);e.config=a.config;e.samplerate=a.samplerate;e.channelCount=a.channelCount;e.codec=a.codec;e.manifestCodec=a.manifestCodec;ue["logger"].log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function E(e){return 1024*9e4/e}function d(e,t,r,n,i){var a,s,o;var l=e.length;a=u(e,t);s=c(e,t);s-=a;if(s>0&&t+a+s<=l){o=r+n*i;return{headerLength:a,frameLength:s,stamp:o}}return undefined}function b(e,t,r,n,i){var a=E(e.samplerate);var s=d(t,r,n,i,a);if(s){var o=s.stamp;var l=s.headerLength;var u=s.frameLength;var c={unit:t.subarray(r+l,r+l+u),pts:o,dts:o};e.samples.push(c);return{sample:c,length:u+l}}return undefined}var N=t("./src/demux/id3.js");var n=function(){function e(e,t,r){this.observer=e;this.config=r;this.remuxer=t}var t=e.prototype;t.resetInitSegment=function e(t,r,n,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:true,samples:[],len:0,manifestCodec:r,duration:i,inputTimeScale:9e4}};t.resetTimeStamp=function e(){};e.probe=function e(t){if(!t)return false;var r=N["default"].getID3Data(t,0)||[];var n=r.length;for(var i=t.length;n<i;n++)if(o(t,n)){ue["logger"].log("ADTS sync word found !");return true}return false};t.append=function e(t,r,n,i){var a=this._audioTrack;var s=N["default"].getID3Data(t,0)||[];var o=N["default"].getTimeStamp(s);var l=Object(v["isFiniteNumber"])(o)?o*90:r*9e4;var u=0;var c=l;var d=t.length;var f=s.length;var h=[{pts:c,dts:c,data:s}];while(f<d-1)if(m(t,f)&&f+5<d){y(a,this.observer,t,f,a.manifestCodec);var p=b(a,t,f,l,u);if(p){f+=p.length;c=p.sample.pts;u++}else{ue["logger"].log("Unable to parse AAC frame");break}}else if(N["default"].isHeader(t,f)){s=N["default"].getID3Data(t,f);h.push({pts:c,dts:c,data:s});f+=s.length}else f++;this.remuxer.remux(a,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},r,n,i)};t.destroy=function e(){};return e}();var C=n;var R=t("./src/demux/mp4demuxer.js");var A={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function e(t,r,n,i,a){if(n+24>r.length)return undefined;var s=this.parseHeader(r,n);if(s&&n+s.frameLength<=r.length){var o=s.samplesPerFrame*9e4/s.sampleRate;var l=i+a*o;var u={unit:r.subarray(n,n+s.frameLength),pts:l,dts:l};t.config=[];t.channelCount=s.channelCount;t.samplerate=s.sampleRate;t.samples.push(u);return{sample:u,length:s.frameLength}}return undefined},parseHeader:function e(t,r){var n=t[r+1]>>3&3;var i=t[r+1]>>1&3;var a=t[r+2]>>4&15;var s=t[r+2]>>2&3;var o=t[r+2]>>1&1;if(n!==1&&a!==0&&a!==15&&s!==3){var l=n===3?3-i:i===3?3:4;var u=A.BitratesMap[l*14+a-1]*1e3;var c=n===3?0:n===2?1:2;var d=A.SamplingRateMap[c*3+s];var f=t[r+3]>>6===3?1:2;var h=A.SamplesCoefficients[n][i];var p=A.BytesInSlot[i];var v=h*8*p;var g=parseInt(h*u/d+o,10)*p;return{sampleRate:d,channelCount:f,frameLength:g,samplesPerFrame:v}}return undefined},isHeaderPattern:function e(t,r){return t[r]===255&&(t[r+1]&224)===224&&(t[r+1]&6)!==0},isHeader:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r))return true;return false},probe:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){var n=4;var i=this.parseHeader(t,r);var a=n;if(i&&i.frameLength)a=i.frameLength;var s=r+a;if(s===t.length||s+1<t.length&&this.isHeaderPattern(t,s))return true}return false}};var k=A;var w=function(){function e(e){this.data=e;this.bytesAvailable=e.byteLength;this.word=0;this.bitsAvailable=0}var t=e.prototype;t.loadWord=function e(){var t=this.data,r=this.bytesAvailable,n=t.byteLength-r,i=new Uint8Array(4),a=Math.min(4,r);if(a===0)throw new Error("no bytes available");i.set(t.subarray(n,n+a));this.word=new DataView(i.buffer).getUint32(0);this.bitsAvailable=a*8;this.bytesAvailable-=a};t.skipBits=function e(t){var r;if(this.bitsAvailable>t){this.word<<=t;this.bitsAvailable-=t}else{t-=this.bitsAvailable;r=t>>3;t-=r>>3;this.bytesAvailable-=r;this.loadWord();this.word<<=t;this.bitsAvailable-=t}};t.readBits=function e(t){var r=Math.min(this.bitsAvailable,t),n=this.word>>>32-r;if(t>32)ue["logger"].error("Cannot read more than 32 bits at a time");this.bitsAvailable-=r;if(this.bitsAvailable>0)this.word<<=r;else if(this.bytesAvailable>0)this.loadWord();r=t-r;if(r>0&&this.bitsAvailable)return n<<r|this.readBits(r);else return n};t.skipLZ=function e(){var t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!==0){this.word<<=t;this.bitsAvailable-=t;return t}this.loadWord();return t+this.skipLZ()};t.skipUEG=function e(){this.skipBits(1+this.skipLZ())};t.skipEG=function e(){this.skipBits(1+this.skipLZ())};t.readUEG=function e(){var t=this.skipLZ();return this.readBits(t+1)-1};t.readEG=function e(){var t=this.readUEG();if(1&t)return 1+t>>>1;else return-1*(t>>>1)};t.readBoolean=function e(){return this.readBits(1)===1};t.readUByte=function e(){return this.readBits(8)};t.readUShort=function e(){return this.readBits(16)};t.readUInt=function e(){return this.readBits(32)};t.skipScalingList=function e(t){var r=8,n=8,i,a;for(i=0;i<t;i++){if(n!==0){a=this.readEG();n=(r+a+256)%256}r=n===0?r:n}};t.readSPS=function e(){var t=0,r=0,n=0,i=0,a,s,o,l,u,c,d,f=this.readUByte.bind(this),h=this.readBits.bind(this),p=this.readUEG.bind(this),v=this.readBoolean.bind(this),g=this.skipBits.bind(this),A=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);f();a=f();h(5);g(3);f();m();if(a===100||a===110||a===122||a===244||a===44||a===83||a===86||a===118||a===128){var E=p();if(E===3)g(1);m();m();g(1);if(v()){c=E!==3?8:12;for(d=0;d<c;d++)if(v())if(d<6)y(16);else y(64)}}m();var b=p();if(b===0)p();else if(b===1){g(1);A();A();s=p();for(d=0;d<s;d++)A()}m();g(1);o=p();l=p();u=h(1);if(u===0)g(1);g(1);if(v()){t=p();r=p();n=p();i=p()}var k=[1,1];if(v())if(v()){var _=f();switch(_){case 1:k=[1,1];break;case 2:k=[12,11];break;case 3:k=[10,11];break;case 4:k=[16,11];break;case 5:k=[40,33];break;case 6:k=[24,11];break;case 7:k=[20,11];break;case 8:k=[32,11];break;case 9:k=[80,33];break;case 10:k=[18,11];break;case 11:k=[15,11];break;case 12:k=[64,33];break;case 13:k=[160,99];break;case 14:k=[4,3];break;case 15:k=[3,2];break;case 16:k=[2,1];break;case 255:{k=[f()<<8|f(),f()<<8|f()];break}}}return{width:Math.ceil((o+1)*16-t*2-r*2),height:(2-u)*(l+1)*16-(u?2:4)*(n+i),pixelRatio:k}};t.readSliceType=function e(){this.readUByte();this.readUEG();return this.readUEG()};return e}();var x=w;var O=function(){function e(e,t,r,n){this.decryptdata=r;this.discardEPB=n;this.decrypter=new g["default"](e,t,{removePKCS7Padding:false})}var t=e.prototype;t.decryptBuffer=function e(t,r){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,r)};t.decryptAacSample=function e(t,r,n,i){var a=t[r].unit;var s=a.subarray(16,a.length-a.length%16);var o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);var l=this;this.decryptBuffer(o,function(e){e=new Uint8Array(e);a.set(e,16);if(!i)l.decryptAacSamples(t,r+1,n)})};t.decryptAacSamples=function e(t,r,n){for(;;r++){if(r>=t.length){n();return}if(t[r].unit.length<32)continue;var i=this.decrypter.isSync();this.decryptAacSample(t,r,n,i);if(!i)return}};t.getAvcEncryptedData=function e(t){var r=Math.floor((t.length-48)/160)*16+16;var n=new Int8Array(r);var i=0;for(var a=32;a<=t.length-16;a+=160,i+=16)n.set(t.subarray(a,a+16),i);return n};t.getAvcDecryptedUnit=function e(t,r){r=new Uint8Array(r);var n=0;for(var i=32;i<=t.length-16;i+=160,n+=16)t.set(r.subarray(n,n+16),i);return t};t.decryptAvcSample=function e(t,r,n,i,a,s){var o=this.discardEPB(a.data);var l=this.getAvcEncryptedData(o);var u=this;this.decryptBuffer(l.buffer,function(e){a.data=u.getAvcDecryptedUnit(o,e);if(!s)u.decryptAvcSamples(t,r,n+1,i)})};t.decryptAvcSamples=function e(t,r,n,i){for(;;r++,n=0){if(r>=t.length){i();return}var a=t[r].units;for(;;n++){if(n>=a.length)break;var s=a[n];if(s.data.length<=48||s.type!==1&&s.type!==5)continue;var o=this.decrypter.isSync();this.decryptAvcSample(t,r,n,i,s,o);if(!o)return}}};return e}();var L=O;var I={video:1,audio:2,id3:3,text:4};var D=function(){function P(e,t,r,n){this.observer=e;this.config=r;this.typeSupported=n;this.remuxer=t;this.sampleAes=null;this.pmtUnknownTypes={}}var e=P.prototype;e.setDecryptData=function e(t){if(t!=null&&t.key!=null&&t.method==="SAMPLE-AES")this.sampleAes=new L(this.observer,this.config,t,this.discardEPB);else this.sampleAes=null};P.probe=function e(t){var r=P._syncOffset(t);if(r<0)return false;else{if(r)ue["logger"].warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?");return true}};P._syncOffset=function e(t){var r=Math.min(1e3,t.length-3*188);var n=0;while(n<r)if(t[n]===71&&t[n+188]===71&&t[n+2*188]===71)return n;else n++;return-1};P.createTrack=function e(t,r){return{container:t==="video"||t==="audio"?"video/mp2t":undefined,type:t,id:I[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:t==="video"?0:undefined,isAAC:t==="audio"?true:undefined,duration:t==="audio"?r:undefined}};e.resetInitSegment=function e(t,r,n,i){this.pmtParsed=false;this._pmtId=-1;this.pmtUnknownTypes={};this._avcTrack=P.createTrack("video",i);this._audioTrack=P.createTrack("audio",i);this._id3Track=P.createTrack("id3",i);this._txtTrack=P.createTrack("text",i);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=r;this.videoCodec=n;this._duration=i};e.resetTimeStamp=function e(){};e.append=function e(t,r,n,i){var a,s=t.length,o,l,u,c,d,f=false;this.pmtUnknownTypes={};this.contiguous=n;var h=this.pmtParsed,p=this._avcTrack,v=this._audioTrack,g=this._id3Track,A=p.pid,m=v.pid,y=g.pid,E=this._pmtId,b=p.pesData,k=v.pesData,_=g.pesData,T=this._parsePAT,S=this._parsePMT.bind(this),C=this._parsePES,R=this._parseAVCPES.bind(this),w=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),L=this._parseID3PES.bind(this);var I=P._syncOffset(t);s-=(s+I)%188;for(a=I;a<s;a+=188)if(t[a]===71){o=!!(t[a+1]&64);l=((t[a+1]&31)<<8)+t[a+2];u=(t[a+3]&48)>>4;if(u>1){c=a+5+t[a+4];if(c===a+188)continue}else c=a+4;switch(l){case A:if(o){if(b&&(d=C(b)))R(d,false);b={data:[],size:0}}if(b){b.data.push(t.subarray(c,a+188));b.size+=a+188-c}break;case m:if(o){if(k&&(d=C(k)))if(v.isAAC)w(d);else O(d);k={data:[],size:0}}if(k){k.data.push(t.subarray(c,a+188));k.size+=a+188-c}break;case y:if(o){if(_&&(d=C(_)))L(d);_={data:[],size:0}}if(_){_.data.push(t.subarray(c,a+188));_.size+=a+188-c}break;case 0:if(o)c+=t[c]+1;E=this._pmtId=T(t,c);break;case E:if(o)c+=t[c]+1;var D=S(t,c,this.typeSupported.mpeg===true||this.typeSupported.mp3===true,this.sampleAes!=null);A=D.avc;if(A>0)p.pid=A;m=D.audio;if(m>0){v.pid=m;v.isAAC=D.isAAC}y=D.id3;if(y>0)g.pid=y;if(f&&!h){ue["logger"].log("reparse from beginning");f=false;a=I-188}h=this.pmtParsed=true;break;case 17:case 8191:break;default:f=true;break}}else this.observer.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MEDIA_ERROR,details:le["ErrorDetails"].FRAG_PARSING_ERROR,fatal:false,reason:"TS packet did not start with 0x47"});if(b&&(d=C(b))){R(d,true);p.pesData=null}else p.pesData=b;if(k&&(d=C(k))){if(v.isAAC)w(d);else O(d);v.pesData=null}else{if(k&&k.size)ue["logger"].log("last AAC PES packet truncated,might overlap between fragments");v.pesData=k}if(_&&(d=C(_))){L(d);g.pesData=null}else g.pesData=_;if(this.sampleAes==null)this.remuxer.remux(v,p,g,this._txtTrack,r,n,i);else this.decryptAndRemux(v,p,g,this._txtTrack,r,n,i)};e.decryptAndRemux=function e(t,r,n,i,a,s,o){if(t.samples&&t.isAAC){var l=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){l.decryptAndRemuxAvc(t,r,n,i,a,s,o)})}else this.decryptAndRemuxAvc(t,r,n,i,a,s,o)};e.decryptAndRemuxAvc=function e(t,r,n,i,a,s,o){if(r.samples){var l=this;this.sampleAes.decryptAvcSamples(r.samples,0,0,function(){l.remuxer.remux(t,r,n,i,a,s,o)})}else this.remuxer.remux(t,r,n,i,a,s,o)};e.destroy=function e(){this._initPTS=this._initDTS=undefined;this._duration=0};e._parsePAT=function e(t,r){return(t[r+10]&31)<<8|t[r+11]};e._trackUnknownPmt=function e(t,r,n){var i=this.pmtUnknownTypes[t]||0;if(i===0){this.pmtUnknownTypes[t]=0;r.call(ue["logger"],n)}this.pmtUnknownTypes[t]++;return i};e._parsePMT=function e(t,r,n,i){var a,s,o,l,u={audio:-1,avc:-1,id3:-1,isAAC:true};a=(t[r+1]&15)<<8|t[r+2];s=r+3+a-4;o=(t[r+10]&15)<<8|t[r+11];r+=12+o;while(r<s){l=(t[r+1]&31)<<8|t[r+2];switch(t[r]){case 207:if(!i){this._trackUnknownPmt(t[r],ue["logger"].warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:if(u.audio===-1)u.audio=l;break;case 21:if(u.id3===-1)u.id3=l;break;case 219:if(!i){this._trackUnknownPmt(t[r],ue["logger"].warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:if(u.avc===-1)u.avc=l;break;case 3:case 4:if(!n)this._trackUnknownPmt(t[r],ue["logger"].warn,"MPEG audio found, not supported in this browser");else if(u.audio===-1){u.audio=l;u.isAAC=false}break;case 36:this._trackUnknownPmt(t[r],ue["logger"].warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(t[r],ue["logger"].log,"Unknown stream type:"+t[r]);break}r+=((t[r+3]&15)<<8|t[r+4])+5}return u};e._parsePES=function e(t){var r=0,n,i,a,s,o,l,u,c,d,f=t.data;if(!t||t.size===0)return null;while(f[0].length<19&&f.length>1){var h=new Uint8Array(f[0].length+f[1].length);h.set(f[0]);h.set(f[1],f[0].length);f[0]=h;f.splice(1,1)}n=f[0];a=(n[0]<<16)+(n[1]<<8)+n[2];if(a===1){s=(n[4]<<8)+n[5];if(s&&s>t.size-6)return null;i=n[7];if(i&192){u=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2;if(i&64){c=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2;if(u-c>60*9e4){ue["logger"].warn(Math.round((u-c)/9e4)+"s delta between PTS and DTS, align them");u=c}}else c=u}o=n[8];d=o+9;if(t.size<=d)return null;t.size-=d;l=new Uint8Array(t.size);for(var p=0,v=f.length;p<v;p++){n=f[p];var g=n.byteLength;if(d)if(d>g){d-=g;continue}else{n=n.subarray(d);g-=d;d=0}l.set(n,r);r+=g}if(s)s-=o+3;return{data:l,pts:u,dts:c,len:s}}else return null};e.pushAccesUnit=function e(t,r){if(t.units.length&&t.frame){var n=r.samples;var i=n.length;if(isNaN(t.pts))if(i){var a=n[i-1];t.pts=a.pts;t.dts=a.dts}else{r.dropped++;return}if(!this.config.forceKeyFrameOnDiscontinuity||t.key===true||r.sps&&(i||this.contiguous)){t.id=i;n.push(t)}else r.dropped++}if(t.debug.length)ue["logger"].log(t.pts+"/"+t.dts+":"+t.debug)};e._parseAVCPES=function e(_,t){var T=this;var S=this._avcTrack,r=this._parseAVCNALu(_.data),C,R=this.avcSample,w,O=false,L,I=this.pushAccesUnit.bind(this),D=function e(t,r,n,i){return{key:t,pts:r,dts:n,units:[],debug:i}};_.data=null;if(R&&r.length&&!S.audFound){I(R,S);R=this.avcSample=D(false,_.pts,_.dts,"")}r.forEach(function(e){switch(e.type){case 1:w=true;if(!R)R=T.avcSample=D(true,_.pts,_.dts,"");R.frame=true;var t=e.data;if(O&&t.length>4){var r=new x(t).readSliceType();if(r===2||r===4||r===7||r===9)R.key=true}break;case 5:w=true;if(!R)R=T.avcSample=D(true,_.pts,_.dts,"");R.key=true;R.frame=true;break;case 6:w=true;C=new x(T.discardEPB(e.data));C.readUByte();var n=0;var i=0;var a=false;var s=0;while(!a&&C.bytesAvailable>1){n=0;do{s=C.readUByte();n+=s}while(s===255);i=0;do{s=C.readUByte();i+=s}while(s===255);if(n===4&&C.bytesAvailable!==0){a=true;var o=C.readUByte();if(o===181){var l=C.readUShort();if(l===49){var u=C.readUInt();if(u===1195456820){var c=C.readUByte();if(c===3){var d=C.readUByte();var f=C.readUByte();var h=31&d;var p=[d,f];for(L=0;L<h;L++){p.push(C.readUByte());p.push(C.readUByte());p.push(C.readUByte())}T._insertSampleInOrder(T._txtTrack.samples,{type:3,pts:_.pts,bytes:p})}}}}}else if(n===5&&C.bytesAvailable!==0){a=true;if(i>16){var v=[];for(L=0;L<16;L++){v.push(C.readUByte().toString(16));if(L===3||L===5||L===7||L===9)v.push("-")}var g=i-16;var A=new Uint8Array(g);for(L=0;L<g;L++)A[L]=C.readUByte();T._insertSampleInOrder(T._txtTrack.samples,{pts:_.pts,payloadType:n,uuid:v.join(""),userDataBytes:A,userData:Object(N["utf8ArrayToStr"])(A.buffer)})}}else if(i<C.bytesAvailable)for(L=0;L<i;L++)C.readUByte()}break;case 7:w=true;O=true;if(!S.sps){C=new x(e.data);var m=C.readSPS();S.width=m.width;S.height=m.height;S.pixelRatio=m.pixelRatio;S.sps=[e.data];S.duration=T._duration;var y=e.data.subarray(1,4);var E="avc1.";for(L=0;L<3;L++){var b=y[L].toString(16);if(b.length<2)b="0"+b;E+=b}S.codec=E}break;case 8:w=true;if(!S.pps)S.pps=[e.data];break;case 9:w=false;S.audFound=true;if(R)I(R,S);R=T.avcSample=D(false,_.pts,_.dts,"");break;case 12:w=false;break;default:w=false;if(R)R.debug+="unknown NAL "+e.type+" ";break}if(R&&w){var k=R.units;k.push(e)}});if(t&&R){I(R,S);this.avcSample=null}};e._insertSampleInOrder=function e(t,r){var n=t.length;if(n>0){if(r.pts>=t[n-1].pts)t.push(r);else for(var i=n-1;i>=0;i--)if(r.pts<t[i].pts){t.splice(i,0,r);break}}else t.push(r)};e._getLastNalUnit=function e(){var t=this.avcSample,r;if(!t||t.units.length===0){var n=this._avcTrack,i=n.samples;t=i[i.length-1]}if(t){var a=t.units;r=a[a.length-1]}return r};e._parseAVCNALu=function e(t){var r=0,n=t.byteLength,i,a,s=this._avcTrack,o=s.naluState||0,l=o;var u=[],c,d,f=-1,h;if(o===-1){f=0;h=t[0]&31;o=0;r=1}while(r<n){i=t[r++];if(!o){o=i?0:1;continue}if(o===1){o=i?0:2;continue}if(!i)o=3;else if(i===1){if(f>=0){c={data:t.subarray(f,r-o-1),type:h};u.push(c)}else{var p=this._getLastNalUnit();if(p){if(l&&r<=4-l)if(p.state)p.data=p.data.subarray(0,p.data.byteLength-l);a=r-o-1;if(a>0){var v=new Uint8Array(p.data.byteLength+a);v.set(p.data,0);v.set(t.subarray(0,a),p.data.byteLength);p.data=v}}}if(r<n){d=t[r]&31;f=r;h=d;o=0}else o=-1}else o=0}if(f>=0&&o>=0){c={data:t.subarray(f,n),type:h,state:o};u.push(c)}if(u.length===0){var g=this._getLastNalUnit();if(g){var A=new Uint8Array(g.data.byteLength+t.byteLength);A.set(g.data,0);A.set(t,g.data.byteLength);g.data=A}}s.naluState=o;return u};e.discardEPB=function e(t){var r=t.byteLength,n=[],i=1,a,s;while(i<r-2)if(t[i]===0&&t[i+1]===0&&t[i+2]===3){n.push(i+2);i+=2}else i++;if(n.length===0)return t;a=r-n.length;s=new Uint8Array(a);var o=0;for(i=0;i<a;o++,i++){if(o===n[0]){o++;n.shift()}s[i]=t[o]}return s};e._parseAACPES=function e(t){var r=this._audioTrack,n=t.data,i=t.pts,a=0,s=this.aacOverFlow,o=this.aacLastPTS,l,u,c,d,f;if(s){var h=new Uint8Array(s.byteLength+n.byteLength);h.set(s,0);h.set(n,s.byteLength);n=h}for(c=a,f=n.length;c<f-1;c++)if(m(n,c))break;if(c){var p,v;if(c<f-1){p="AAC PES did not start with ADTS header,offset:"+c;v=false}else{p="no ADTS header found in AAC PES";v=true}ue["logger"].warn("parsing error:"+p);this.observer.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MEDIA_ERROR,details:le["ErrorDetails"].FRAG_PARSING_ERROR,fatal:v,reason:p});if(v)return}y(r,this.observer,n,c,this.audioCodec);u=0;l=E(r.samplerate);if(s&&o){var g=o+l;if(Math.abs(g-i)>1){ue["logger"].log("AAC: align PTS for overlapping frames by "+Math.round((g-i)/90));i=g}}while(c<f)if(m(n,c)){if(c+5<f){var A=b(r,n,c,i,u);if(A){c+=A.length;d=A.sample.pts;u++;continue}}break}else c++;if(c<f)s=n.subarray(c,f);else s=null;this.aacOverFlow=s;this.aacLastPTS=d};e._parseMPEGPES=function e(t){var r=t.data;var n=r.length;var i=0;var a=0;var s=t.pts;while(a<n)if(k.isHeader(r,a)){var o=k.appendFrame(this._audioTrack,r,a,s,i);if(o){a+=o.length;i++}else break}else a++};e._parseID3PES=function e(t){this._id3Track.samples.push(t)};return P}();var P=D;var M=function(){function e(e,t,r){this.observer=e;this.config=r;this.remuxer=t}var t=e.prototype;t.resetInitSegment=function e(t,r,n,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:false,samples:[],len:0,manifestCodec:r,duration:i,inputTimeScale:9e4}};t.resetTimeStamp=function e(){};e.probe=function e(t){var r,n;var i=N["default"].getID3Data(t,0);if(i&&N["default"].getTimeStamp(i)!==undefined)for(r=i.length,n=Math.min(t.length-1,r+100);r<n;r++)if(k.probe(t,r)){ue["logger"].log("MPEG Audio sync word found !");return true}return false};t.append=function e(t,r,n,i){var a=N["default"].getID3Data(t,0)||[];var s=N["default"].getTimeStamp(a);var o=s!==undefined?90*s:r*9e4;var l=a.length;var u=t.length;var c=0,d=0;var f=this._audioTrack;var h=[{pts:o,dts:o,data:a}];while(l<u)if(k.isHeader(t,l)){var p=k.appendFrame(f,t,l,o,c);if(p){l+=p.length;d=p.sample.pts;c++}else break}else if(N["default"].isHeader(t,l)){a=N["default"].getID3Data(t,l);h.push({pts:d,dts:d,data:a});l+=a.length}else l++;this.remuxer.remux(f,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},r,n,i)};t.destroy=function e(){};return e}();var F=M;var B=function(){function e(){}e.getSilentFrame=function e(t,r){switch(t){case"mp4a.40.2":if(r===1)return new Uint8Array([0,200,0,128,35,128]);else if(r===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);else if(r===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);else if(r===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);else if(r===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);else if(r===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(r===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);else if(r===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);else if(r===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}return null};return e}();var $=B;var l=Math.pow(2,32)-1;var U=function(){function h(){}h.init=function e(){h.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in h.types)if(h.types.hasOwnProperty(t))h.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)];var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);h.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);var a=new Uint8Array([0,0,0,0,0,0,0,0]);h.STTS=h.STSC=h.STCO=a;h.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);h.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);h.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);h.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]);var o=new Uint8Array([97,118,99,49]);var l=new Uint8Array([0,0,0,1]);h.FTYP=h.box(h.types.ftyp,s,l,s,o);h.DINF=h.box(h.types.dinf,h.box(h.types.dref,i))};h.box=function e(t){var r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i,s;while(i--)n+=r[i].byteLength;s=new Uint8Array(n);s[0]=n>>24&255;s[1]=n>>16&255;s[2]=n>>8&255;s[3]=n&255;s.set(t,4);for(i=0,n=8;i<a;i++){s.set(r[i],n);n+=r[i].byteLength}return s};h.hdlr=function e(t){return h.box(h.types.hdlr,h.HDLR_TYPES[t])};h.mdat=function e(t){return h.box(h.types.mdat,t)};h.mdhd=function e(t,r){r*=t;var n=Math.floor(r/(l+1));var i=Math.floor(r%(l+1));return h.box(h.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))};h.mdia=function e(t){return h.box(h.types.mdia,h.mdhd(t.timescale,t.duration),h.hdlr(t.type),h.minf(t))};h.mfhd=function e(t){return h.box(h.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))};h.minf=function e(t){if(t.type==="audio")return h.box(h.types.minf,h.box(h.types.smhd,h.SMHD),h.DINF,h.stbl(t));else return h.box(h.types.minf,h.box(h.types.vmhd,h.VMHD),h.DINF,h.stbl(t))};h.moof=function e(t,r,n){return h.box(h.types.moof,h.mfhd(t),h.traf(n,r))};h.moov=function e(t){var r=t.length,n=[];while(r--)n[r]=h.trak(t[r]);return h.box.apply(null,[h.types.moov,h.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(h.mvex(t)))};h.mvex=function e(t){var r=t.length,n=[];while(r--)n[r]=h.trex(t[r]);return h.box.apply(null,[h.types.mvex].concat(n))};h.mvhd=function e(t,r){r*=t;var n=Math.floor(r/(l+1));var i=Math.floor(r%(l+1));var a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h.box(h.types.mvhd,a)};h.sdtp=function e(t){var r=t.samples||[],n=new Uint8Array(4+r.length),i,a;for(a=0;a<r.length;a++){i=r[a].flags;n[a+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy}return h.box(h.types.sdtp,n)};h.stbl=function e(t){return h.box(h.types.stbl,h.stsd(t),h.box(h.types.stts,h.STTS),h.box(h.types.stsc,h.STSC),h.box(h.types.stsz,h.STSZ),h.box(h.types.stco,h.STCO))};h.avc1=function e(t){var r=[],n=[],i,a,s;for(i=0;i<t.sps.length;i++){a=t.sps[i];s=a.byteLength;r.push(s>>>8&255);r.push(s&255);r=r.concat(Array.prototype.slice.call(a))}for(i=0;i<t.pps.length;i++){a=t.pps[i];s=a.byteLength;n.push(s>>>8&255);n.push(s&255);n=n.concat(Array.prototype.slice.call(a))}var o=h.box(h.types.avcC,new Uint8Array([1,r[3],r[4],r[5],252|3,224|t.sps.length].concat(r).concat([t.pps.length]).concat(n))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return h.box(h.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,h.box(h.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),h.box(h.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,d>>24,d>>16&255,d>>8&255,d&255])))};h.esds=function e(t){var r=t.config.length;return new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t.config).concat([6,1,2]))};h.mp4a=function e(t){var r=t.samplerate;return h.box(h.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,r&255,0,0]),h.box(h.types.esds,h.esds(t)))};h.mp3=function e(t){var r=t.samplerate;return h.box(h.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,r&255,0,0]))};h.stsd=function e(t){if(t.type==="audio"){if(!t.isAAC&&t.codec==="mp3")return h.box(h.types.stsd,h.STSD,h.mp3(t));return h.box(h.types.stsd,h.STSD,h.mp4a(t))}else return h.box(h.types.stsd,h.STSD,h.avc1(t))};h.tkhd=function e(t){var r=t.id,n=t.duration*t.timescale,i=t.width,a=t.height,s=Math.floor(n/(l+1)),o=Math.floor(n%(l+1));return h.box(h.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,a>>8&255,a&255,0,0]))};h.traf=function e(t,r){var n=h.sdtp(t),i=t.id,a=Math.floor(r/(l+1)),s=Math.floor(r%(l+1));return h.box(h.types.traf,h.box(h.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),h.box(h.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,s>>24,s>>16&255,s>>8&255,s&255])),h.trun(t,n.length+16+20+8+16+8+8),n)};h.trak=function e(t){t.duration=t.duration||4294967295;return h.box(h.types.trak,h.tkhd(t),h.mdia(t))};h.trex=function e(t){var r=t.id;return h.box(h.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))};h.trun=function e(t,r){var n=t.samples||[],i=n.length,a=12+16*i,s=new Uint8Array(a),o,l,u,c,d,f;r+=8+a;s.set([0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255],0);for(o=0;o<i;o++){l=n[o];u=l.duration;c=l.size;d=l.flags;f=l.cts;s.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&240<<8,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*o)}return h.box(h.types.trun,s)};h.initSegment=function e(t){if(!h.types)h.init();var r=h.moov(t),n;n=new Uint8Array(h.FTYP.byteLength+r.byteLength);n.set(h.FTYP);n.set(r,h.FTYP.byteLength);return n};return h}();var ce=U;var i=9e4;function f(e,t,r,n){if(r===void 0)r=1;if(n===void 0)n=false;var i=e*t*r;return n?Math.round(i):i}function de(e,t){if(t===void 0)t=false;return f(e,1e3,1/i,t)}function h(e,t){if(t===void 0)t=1;return f(e,i,1/t)}var W=h(10);var pe=h(.2);var fe=null;var j=function(){function e(e,t,r,n){this.observer=e;this.config=t;this.typeSupported=r;this.ISGenerated=false;if(fe===null){var i=navigator.userAgent.match(/Chrome\/(\d+)/i);fe=i?parseInt(i[1]):0}}var t=e.prototype;t.destroy=function e(){};t.resetTimeStamp=function e(t){this._initPTS=this._initDTS=t};t.resetInitSegment=function e(){this.ISGenerated=false};t.getVideoStartPts=function e(t){var n=false;var r=t.reduce(function(e,t){var r=t.pts-e;if(r<-4294967296){n=true;return he(e,t.pts)}else if(r>0)return e;else return t.pts},t[0].pts);if(n)ue["logger"].debug("PTS rollover detected");return r};t.remux=function e(t,r,n,i,a,s,o){if(!this.ISGenerated)this.generateIS(t,r,a);if(this.ISGenerated){var l=t.samples.length;var u=r.samples.length;var c=a;var d=a;if(l&&u){var f=this.getVideoStartPts(r.samples);var h=he(t.samples[0].pts,f)-f;var p=h/r.inputTimeScale;c+=Math.max(0,p);d+=Math.max(0,-p)}if(l){if(!t.timescale){ue["logger"].warn("regenerate InitSegment as audio detected");this.generateIS(t,r,a)}var v=this.remuxAudio(t,c,s,o);if(u){var g;if(v)g=v.endPTS-v.startPTS;if(!r.timescale){ue["logger"].warn("regenerate InitSegment as video detected");this.generateIS(t,r,a)}this.remuxVideo(r,d,s,g)}}else if(u){var A=this.remuxVideo(r,d,s,0,o);if(A&&t.codec)this.remuxEmptyAudio(t,c,s,A)}}if(n.samples.length)this.remuxID3(n,a);if(i.samples.length)this.remuxText(i,a);this.observer.trigger(oe["default"].FRAG_PARSED)};t.generateIS=function e(t,r,n){var i=this.observer,a=t.samples,s=r.samples,o=this.typeSupported,l="audio/mp4",u={},c={tracks:u},d=this._initPTS===undefined,f,h;if(d)f=h=Infinity;if(t.config&&a.length){t.timescale=t.samplerate;ue["logger"].log("audio sampling rate : "+t.samplerate);if(!t.isAAC)if(o.mpeg){l="audio/mpeg";t.codec=""}else if(o.mp3)t.codec="mp3";u.audio={container:l,codec:t.codec,initSegment:!t.isAAC&&o.mpeg?new Uint8Array:ce.initSegment([t]),metadata:{channelCount:t.channelCount}};if(d)f=h=a[0].pts-Math.round(t.inputTimeScale*n)}if(r.sps&&r.pps&&s.length){var p=r.inputTimeScale;r.timescale=p;u.video={container:"video/mp4",codec:r.codec,initSegment:ce.initSegment([r]),metadata:{width:r.width,height:r.height}};if(d){var v=this.getVideoStartPts(s);var g=Math.round(p*n);h=Math.min(h,he(s[0].dts,v)-g);f=Math.min(f,v-g);this.observer.trigger(oe["default"].INIT_PTS_FOUND,{initPTS:f})}}else if(d&&u.audio)this.observer.trigger(oe["default"].INIT_PTS_FOUND,{initPTS:f});if(Object.keys(u).length){i.trigger(oe["default"].FRAG_PARSING_INIT_SEGMENT,c);this.ISGenerated=true;if(d){this._initPTS=f;this._initDTS=h}}else i.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MEDIA_ERROR,details:le["ErrorDetails"].FRAG_PARSING_ERROR,fatal:false,reason:"no audio/video samples found"})};t.remuxVideo=function M(e,F,t,r){var n=e.timescale;var i=e.samples;var a=[];var s=i.length;var o=this._initPTS;var l=8;var u;var c;var d;var f;var h;var p=Number.POSITIVE_INFINITY;var v=Number.NEGATIVE_INFINITY;var g=0;var B=false;var A=this.nextAvcDts;if(s===0)return;if(!t){var U=F*n;var j=i[0].pts-he(i[0].dts,i[0].pts);A=U-j}for(var m=0;m<s;m++){var y=i[m];y.pts=he(y.pts-o,A);y.dts=he(y.dts-o,A);if(y.dts>y.pts)g=Math.max(Math.min(g,y.pts-y.dts),-1*pe);if(y.dts<i[m>0?m-1:m].dts)B=true}if(B)i.sort(function(e,t){var r=e.dts-t.dts;var n=e.pts-t.pts;return r||n||e.id-t.id});f=i[0].dts;h=i[s-1].dts;var E=Math.round((h-f)/(s-1));if(g<0){if(g<E*-2){ue["logger"].warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+de(-E,true)+" ms");var b=g;for(var k=0;k<s;k++){i[k].dts=b=Math.max(b,i[k].pts-E);i[k].pts=Math.max(b,i[k].pts)}}else{ue["logger"].warn("PTS < DTS detected in video samples, shifting DTS by "+de(g,true)+" ms to overcome this issue");for(var _=0;_<s;_++)i[_].dts=i[_].dts+g}f=i[0].dts;h=i[s-1].dts}if(t){var T=f-A;var V=T>E;var G=T<-1;if(V||G){if(V)ue["logger"].warn("AVC: "+de(T,true)+" ms ("+T+"dts) hole between fragments detected, filling it");else ue["logger"].warn("AVC: "+de(-T,true)+" ms ("+T+"dts) overlapping between fragments detected");f=A;var K=i[0].pts-T;i[0].dts=f;i[0].pts=K;ue["logger"].log("Video: First PTS/DTS adjusted: "+de(K,true)+"/"+de(f,true)+", delta: "+de(T,true)+" ms")}}if(fe&&fe<75)f=Math.max(0,f);var Y=0;var H=0;for(var S=0;S<s;S++){var C=i[S];var z=C.units;var $=z.length;var R=0;for(var w=0;w<$;w++)R+=z[w].data.length;H+=R;Y+=$;C.length=R;C.dts=Math.max(C.dts,f);C.pts=Math.max(C.pts,C.dts,0);p=Math.min(C.pts,p);v=Math.max(C.pts,v)}h=i[s-1].dts;var O=H+4*Y+8;try{c=new Uint8Array(O)}catch(e){this.observer.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MUX_ERROR,details:le["ErrorDetails"].REMUX_ALLOC_ERROR,fatal:false,bytes:O,reason:"fail allocating video mdat "+O});return}var W=new DataView(c.buffer);W.setUint32(0,O);c.set(ce.types.mdat,4);for(var L=0;L<s;L++){var I=i[L];var q=I.units;var X=0;var Z=void 0;for(var D=0,Q=q.length;D<Q;D++){var J=q[D];var ee=J.data;var P=J.data.byteLength;W.setUint32(l,P);l+=4;c.set(ee,l);l+=P;X+=4+P}if(L<s-1)u=i[L+1].dts-I.dts;else{var te=this.config;var N=I.dts-i[L>0?L-1:L].dts;if(te.stretchShortVideoTrack){var re=te.maxBufferHole;var ne=Math.floor(re*n);var x=(r?p+r*n:this.nextAudioPts)-I.pts;if(x>ne){u=x-N;if(u<0)u=N;ue["logger"].log("It is approximately "+de(x,false)+" ms to the next segment; using duration "+de(u,false)+" ms for the last video frame.")}else u=N}else u=N}Z=Math.round(I.pts-I.dts);a.push({size:X,duration:u,cts:Z,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:I.key?2:1,isNonSync:I.key?0:1}})}this.nextAvcDts=h+u;var ie=e.dropped;e.nbNalu=0;e.dropped=0;if(a.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ae=a[0].flags;ae.dependsOn=2;ae.isNonSync=0}e.samples=a;d=ce.moof(e.sequenceNumber++,f,e);e.samples=[];var se={data1:d,data2:c,startPTS:p/n,endPTS:(v+u)/n,startDTS:f/n,endDTS:this.nextAvcDts/n,type:"video",hasAudio:false,hasVideo:true,nb:a.length,dropped:ie};this.observer.trigger(oe["default"].FRAG_PARSING_DATA,se);return se};t.remuxAudio=function M(e,t,r,n){var i=e.inputTimeScale;var F=e.timescale;var a=i/F;var B=e.isAAC?1024:1152;var s=B*a;var o=this._initPTS;var l=!e.isAAC&&this.typeSupported.mpeg;var u;var c;var d;var f;var h;var p;var v=l?0:8;var g=e.samples;var A=[];var m=this.nextAudioPts;r|=g.length&&m&&(n&&Math.abs(t-m/i)<.1||Math.abs(g[0].pts-m-o)<20*s);g.forEach(function(e){e.pts=e.dts=he(e.pts-o,t*i)});g=g.filter(function(e){return e.pts>=0});if(g.length===0)return;if(!r)if(!n)m=g[0].pts;else m=Math.max(0,t*i);if(e.isAAC){var y=this.config.maxAudioFramesDrift;for(var E=0,b=m;E<g.length;){var k=g[E];var _=k.pts;var T=_-b;if(T<=-y*s)if(r||E>0){ue["logger"].warn("Dropping 1 audio frame @ "+de(b,true)/1e3+"s due to "+de(T,true)+" ms overlap.");g.splice(E,1)}else{ue["logger"].warn("Audio frame @ "+de(_,true)/1e3+"s overlaps nextAudioPts by "+de(T,true)+" ms.");b=_+s;E++}else if(T>=y*s&&T<W&&b){var S=Math.round(T/s);ue["logger"].warn("Injecting "+S+" audio frames @ "+de(b,true)/1e3+"s due to "+de(T,true)+" ms gap.");for(var C=0;C<S;C++){var R=Math.max(b,0);c=$.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(!c){ue["logger"].log("Unable to get silent frame for given audio codec; duplicating last frame instead.");c=k.unit.subarray()}g.splice(E,0,{unit:c,pts:R,dts:R});b+=s;E++}k.pts=k.dts=b;b+=s;E++}else{k.pts=k.dts=b;b+=s;E++}}}var w=g.length;var O=0;while(w--)O+=g[w].unit.byteLength;for(var L=0,U=g.length;L<U;L++){var j=g[L];var I=j.unit;var D=j.pts;if(p!==undefined&&u)u.duration=Math.round((D-p)/a);else{var P=D-m;var N=0;if(r&&e.isAAC)if(P){if(P>0&&P<W){N=Math.round((D-m)/s);ue["logger"].log(de(P,true)+" ms hole between AAC samples detected,filling it");if(N>0){c=$.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(!c)c=I.subarray();O+=N*c.length}}else if(P<-12){ue["logger"].log("drop overlapping AAC sample, expected/parsed/delta: "+de(m,true)+" ms / "+de(D,true)+" ms / "+de(-P,true)+" ms");O-=I.byteLength;continue}D=m}h=D;if(O>0){O+=v;try{d=new Uint8Array(O)}catch(e){this.observer.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MUX_ERROR,details:le["ErrorDetails"].REMUX_ALLOC_ERROR,fatal:false,bytes:O,reason:"fail allocating audio mdat "+O});return}if(!l){var V=new DataView(d.buffer);V.setUint32(0,O);d.set(ce.types.mdat,4)}}else return;for(var G=0;G<N;G++){c=$.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(!c){ue["logger"].log("Unable to get silent frame for given audio codec; duplicating this frame instead.");c=I.subarray()}d.set(c,v);v+=c.byteLength;u={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};A.push(u)}}d.set(I,v);var K=I.byteLength;v+=K;u={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};A.push(u);p=D}var x=0;w=A.length;if(w>=2){x=A[w-2].duration;u.duration=x}if(w){this.nextAudioPts=m=p+a*x;e.samples=A;if(l)f=new Uint8Array;else f=ce.moof(e.sequenceNumber++,h/a,e);e.samples=[];var Y=h/i;var H=m/i;var z={data1:f,data2:d,startPTS:Y,endPTS:H,startDTS:Y,endDTS:H,type:"audio",hasAudio:true,hasVideo:false,nb:w};this.observer.trigger(oe["default"].FRAG_PARSING_DATA,z);return z}return null};t.remuxEmptyAudio=function e(t,r,n,i){var a=t.inputTimeScale;var s=t.samplerate?t.samplerate:a;var o=a/s;var l=this.nextAudioPts;var u=(l!==undefined?l:i.startDTS*a)+this._initDTS;var c=i.endDTS*a+this._initDTS;var d=1024;var f=o*d;var h=Math.ceil((c-u)/f);var p=$.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);ue["logger"].warn("remux empty Audio");if(!p){ue["logger"].trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}var v=[];for(var g=0;g<h;g++){var A=u+g*f;v.push({unit:p,pts:A,dts:A})}t.samples=v;this.remuxAudio(t,r,n)};t.remuxID3=function e(t,r){var n=t.samples.length;if(!n)return;var i=t.inputTimeScale;var a=this._initPTS;var s=this._initDTS;for(var o=0;o<n;o++){var l=t.samples[o];l.pts=he(l.pts-a,r*i)/i;l.dts=he(l.dts-s,r*i)/i}this.observer.trigger(oe["default"].FRAG_PARSING_METADATA,{samples:t.samples});t.samples=[]};t.remuxText=function e(t,r){var n=t.samples.length;var i=t.inputTimeScale;var a=this._initPTS;if(n){for(var s=0;s<n;s++){var o=t.samples[s];o.pts=he(o.pts-a,r*i)/i}t.samples.sort(function(e,t){return e.pts-t.pts});this.observer.trigger(oe["default"].FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]};return e}();function he(e,t){var r;if(t===undefined)return e;if(t<e)r=-8589934592;else r=8589934592;while(Math.abs(e-t)>4294967296)e+=r;return e}var _=j;var V=function(){function e(e){this.observer=e}var t=e.prototype;t.destroy=function e(){};t.resetTimeStamp=function e(){};t.resetInitSegment=function e(){};t.remux=function e(t,r,n,i,a,s,o,l){var u=this.observer;var c="";if(t)c+="audio";if(r)c+="video";u.trigger(oe["default"].FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:c,hasAudio:!!t,hasVideo:!!r,nb:1,dropped:0});u.trigger(oe["default"].FRAG_PARSED)};return e}();var G=V;var p=Object(r["getSelfScope"])();var T;try{T=p.performance.now.bind(p.performance)}catch(e){ue["logger"].debug("Unable to use Performance API on this environment");T=p.Date.now}var K=function(){function e(e,t,r,n){this.observer=e;this.typeSupported=t;this.config=r;this.vendor=n}var t=e.prototype;t.destroy=function e(){var t=this.demuxer;if(t)t.destroy()};t.push=function e(t,r,n,i,a,s,o,l,u,c,d,f){var h=this;if(t.byteLength>0&&r!=null&&r.key!=null&&r.method==="AES-128"){var p=this.decrypter;if(p==null)p=this.decrypter=new g["default"](this.observer,this.config);var v=T();p.decrypt(t,r.key.buffer,r.iv.buffer,function(e){var t=T();h.observer.trigger(oe["default"].FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:t}});h.pushDecrypted(new Uint8Array(e),r,new Uint8Array(n),i,a,s,o,l,u,c,d,f)})}else this.pushDecrypted(new Uint8Array(t),r,new Uint8Array(n),i,a,s,o,l,u,c,d,f)};t.pushDecrypted=function e(t,r,n,i,a,s,o,l,u,c,d,f){var h=this.demuxer;var p=this.remuxer;if(!h||o||l){var v=this.observer;var g=this.typeSupported;var A=this.config;var m=[{demux:P,remux:_},{demux:R["default"],remux:G},{demux:C,remux:_},{demux:F,remux:_}];var y;for(var E=0,b=m.length;E<b;E++){y=m[E];if(y.demux.probe(t))break}if(!y){v.trigger(oe["default"].ERROR,{type:le["ErrorTypes"].MEDIA_ERROR,details:le["ErrorDetails"].FRAG_PARSING_ERROR,fatal:true,reason:"no demux matching with content found"});return}if(!p||!(p instanceof y.remux))p=new y.remux(v,A,g,this.vendor);if(!h||!(h instanceof y.demux)){h=new y.demux(v,p,A,g);this.probe=y.demux.probe}this.demuxer=h;this.remuxer=p}if(o||l){h.resetInitSegment(n,i,a,c);p.resetInitSegment()}if(o){h.resetTimeStamp(f);p.resetTimeStamp(f)}if(typeof h.setDecryptData==="function")h.setDecryptData(r);h.append(t,s,u,d)};return e}();e["default"]=K},"./src/demux/demuxer-worker.js":
/*!*************************************!*\
    !*** ./src/demux/demuxer-worker.js ***!
    \*************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/demux/demuxer.js (referenced with require.resolve) */function(e,t,r){r.r(t);var s=r(/*! ../demux/demuxer-inline */"./src/demux/demuxer-inline.js");var o=r(/*! ../events */"./src/events.js");var l=r(/*! ../utils/logger */"./src/utils/logger.js");var u=r(/*! eventemitter3 */"./node_modules/eventemitter3/index.js");var n=function e(i){var a=new u["EventEmitter"];a.trigger=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];a.emit.apply(a,[t,t].concat(n))};a.off=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];a.removeListener.apply(a,[t].concat(n))};var n=function e(t,r){i.postMessage({event:t,data:r})};i.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var r=JSON.parse(t.config);i.demuxer=new s["default"](a,t.typeSupported,r,t.vendor);Object(l["enableLogs"])(r.debug);n("init",null);break;case"demux":i.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS);break}});a.on(o["default"].FRAG_DECRYPTED,n);a.on(o["default"].FRAG_PARSING_INIT_SEGMENT,n);a.on(o["default"].FRAG_PARSED,n);a.on(o["default"].ERROR,n);a.on(o["default"].FRAG_PARSING_METADATA,n);a.on(o["default"].FRAG_PARSING_USERDATA,n);a.on(o["default"].INIT_PTS_FOUND,n);a.on(o["default"].FRAG_PARSING_DATA,function(e,t){var r=[];var n={event:e,data:t};if(t.data1){n.data1=t.data1.buffer;r.push(t.data1.buffer);delete t.data1}if(t.data2){n.data2=t.data2.buffer;r.push(t.data2.buffer);delete t.data2}i.postMessage(n,r)})};t["default"]=n},"./src/demux/id3.js":
/*!**************************!*\
    !*** ./src/demux/id3.js ***!
    \**************************/
/*! exports provided: default, utf8ArrayToStr */function(e,t,r){r.r(t);r.d(t,"utf8ArrayToStr",function(){return s});var n=r(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js");var i=function(){function l(){}l.isHeader=function e(t,r){if(r+10<=t.length)if(t[r]===73&&t[r+1]===68&&t[r+2]===51)if(t[r+3]<255&&t[r+4]<255)if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128)return true;return false};l.isFooter=function e(t,r){if(r+10<=t.length)if(t[r]===51&&t[r+1]===68&&t[r+2]===73)if(t[r+3]<255&&t[r+4]<255)if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128)return true;return false};l.getID3Data=function e(t,r){var n=r;var i=0;while(l.isHeader(t,r)){i+=10;var a=l._readSize(t,r+6);i+=a;if(l.isFooter(t,r+10))i+=10;r+=i}if(i>0)return t.subarray(n,n+i);return undefined};l._readSize=function e(t,r){var n=0;n=(t[r]&127)<<21;n|=(t[r+1]&127)<<14;n|=(t[r+2]&127)<<7;n|=t[r+3]&127;return n};l.getTimeStamp=function e(t){var r=l.getID3Frames(t);for(var n=0;n<r.length;n++){var i=r[n];if(l.isTimeStampFrame(i))return l._readTimeStamp(i)}return undefined};l.isTimeStampFrame=function e(t){return t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp"};l._getFrameData=function e(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]);var n=l._readSize(t,4);var i=10;return{type:r,size:n,data:t.subarray(i,i+n)}};l.getID3Frames=function e(t){var r=0;var n=[];while(l.isHeader(t,r)){var i=l._readSize(t,r+6);r+=10;var a=r+i;while(r+8<a){var s=l._getFrameData(t.subarray(r));var o=l._decodeFrame(s);if(o)n.push(o);r+=s.size+10}if(l.isFooter(t,r))r+=10}return n};l._decodeFrame=function e(t){if(t.type==="PRIV")return l._decodePrivFrame(t);else if(t.type[0]==="W")return l._decodeURLFrame(t);return l._decodeTextFrame(t)};l._readTimeStamp=function e(t){if(t.data.byteLength===8){var r=new Uint8Array(t.data);var n=r[3]&1;var i=(r[4]<<23)+(r[5]<<15)+(r[6]<<7)+r[7];i/=45;if(n)i+=47721858.84;return Math.round(i)}return undefined};l._decodePrivFrame=function e(t){if(t.size<2)return undefined;var r=l._utf8ArrayToStr(t.data,true);var n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}};l._decodeTextFrame=function e(t){if(t.size<2)return undefined;if(t.type==="TXXX"){var r=1;var n=l._utf8ArrayToStr(t.data.subarray(r),true);r+=n.length+1;var i=l._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}else{var a=l._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}};l._decodeURLFrame=function e(t){if(t.type==="WXXX"){if(t.size<2)return undefined;var r=1;var n=l._utf8ArrayToStr(t.data.subarray(r),true);r+=n.length+1;var i=l._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}else{var a=l._utf8ArrayToStr(t.data);return{key:t.type,data:a}}};l._utf8ArrayToStr=function e(t,r){if(r===void 0)r=false;var n=f();if(n){var i=n.decode(t);if(r){var a=i.indexOf("\0");return a!==-1?i.substring(0,a):i}return i.replace(/\0/g,"")}var s=t.length;var o;var l;var u;var c="";var d=0;while(d<s){o=t[d++];if(o===0&&r)return c;else if(o===0||o===3)continue;switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(o);break;case 12:case 13:l=t[d++];c+=String.fromCharCode((o&31)<<6|l&63);break;case 14:l=t[d++];u=t[d++];c+=String.fromCharCode((o&15)<<12|(l&63)<<6|(u&63)<<0);break}}return c};return l}();var a;function f(){var e=Object(n["getSelfScope"])();if(!a&&typeof e.TextDecoder!=="undefined")a=new e.TextDecoder("utf-8");return a}var s=i._utf8ArrayToStr;t["default"]=i},"./src/demux/mp4demuxer.js":
/*!*********************************!*\
    !*** ./src/demux/mp4demuxer.js ***!
    \*********************************/
/*! exports provided: default */function(e,t,r){r.r(t);var h=r(/*! ../utils/logger */"./src/utils/logger.js");var u=r(/*! ../events */"./src/events.js");var o=Math.pow(2,32)-1;var n=function(){function y(e,t){this.observer=e;this.remuxer=t}var e=y.prototype;e.resetTimeStamp=function e(t){this.initPTS=t};e.resetInitSegment=function e(t,r,n,i){if(t&&t.byteLength){var a=this.initData=y.parseInitSegment(t);if(r==null)r="mp4a.40.5";if(n==null)n="avc1.42e01e";var s={};if(a.audio&&a.video)s.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:i?t:null};else{if(a.audio)s.audio={container:"audio/mp4",codec:r,initSegment:i?t:null};if(a.video)s.video={container:"video/mp4",codec:n,initSegment:i?t:null}}this.observer.trigger(u["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else{if(r)this.audioCodec=r;if(n)this.videoCodec=n}};y.probe=function e(t){return y.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0};y.bin2str=function e(t){return String.fromCharCode.apply(null,t)};y.readUint16=function e(t,r){if(t.data){r+=t.start;t=t.data}var n=t[r]<<8|t[r+1];return n<0?65536+n:n};y.readUint32=function e(t,r){if(t.data){r+=t.start;t=t.data}var n=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3];return n<0?4294967296+n:n};y.writeUint32=function e(t,r,n){if(t.data){r+=t.start;t=t.data}t[r]=n>>24;t[r+1]=n>>16&255;t[r+2]=n>>8&255;t[r+3]=n&255};y.findBox=function e(t,r){var n=[],i,a,s,o,l,u,c;if(t.data){u=t.start;o=t.end;t=t.data}else{u=0;o=t.byteLength}if(!r.length)return null;for(i=u;i<o;){a=y.readUint32(t,i);s=y.bin2str(t.subarray(i+4,i+8));c=a>1?i+a:o;if(s===r[0])if(r.length===1)n.push({data:t,start:i+8,end:c});else{l=y.findBox({data:t,start:i+8,end:c},r.slice(1));if(l.length)n=n.concat(l)}i=c}return n};y.parseSegmentIndex=function e(t){var r=y.findBox(t,["moov"])[0];var n=r?r.end:null;var i=0;var a=y.findBox(t,["sidx"]);var s;if(!a||!a[0])return null;s=[];a=a[0];var o=a.data[0];i=o===0?8:16;var l=y.readUint32(a,i);i+=4;var u=0;var c=0;if(o===0)i+=8;else i+=16;i+=2;var d=a.end+c;var f=y.readUint16(a,i);i+=2;for(var h=0;h<f;h++){var p=i;var v=y.readUint32(a,p);p+=4;var g=v&2147483647;var A=(v&2147483648)>>>31;if(A===1){console.warn("SIDX has hierarchical references (not supported)");return}var m=y.readUint32(a,p);p+=4;s.push({referenceSize:g,subsegmentDuration:m,info:{duration:m/l,start:d,end:d+g-1}});d+=g;p+=4;i=p}return{earliestPresentationTime:u,timescale:l,version:o,referencesCount:f,references:s,moovEndOffset:n}};y.parseInitSegment=function e(t){var f=[];var r=y.findBox(t,["moov","trak"]);r.forEach(function(e){var t=y.findBox(e,["tkhd"])[0];if(t){var r=t.data[t.start];var n=r===0?12:20;var i=y.readUint32(t,n);var a=y.findBox(e,["mdia","mdhd"])[0];if(a){r=a.data[a.start];n=r===0?12:20;var s=y.readUint32(a,n);var o=y.findBox(e,["mdia","hdlr"])[0];if(o){var l=y.bin2str(o.data.subarray(o.start+8,o.start+12));var u={soun:"audio",vide:"video"}[l];if(u){var c=y.findBox(e,["mdia","minf","stbl","stsd"]);if(c.length){c=c[0];var d=y.bin2str(c.data.subarray(c.start+12,c.start+16));h["logger"].log("MP4Demuxer:"+u+":"+d+" found")}f[i]={timescale:s,type:u};f[u]={timescale:s,id:i}}}}}});return f};y.getStartDTS=function e(a,t){var r,n,i;r=y.findBox(t,["moof","traf"]);n=[].concat.apply([],r.map(function(i){return y.findBox(i,["tfhd"]).map(function(e){var t,r,n;t=y.readUint32(e,4);r=a[t].timescale||9e4;n=y.findBox(i,["tfdt"]).map(function(e){var t,r;t=e.data[e.start];r=y.readUint32(e,4);if(t===1){r*=Math.pow(2,32);r+=y.readUint32(e,8)}return r})[0];return n/r})}));i=Math.min.apply(null,n);return isFinite(i)?i:0};y.offsetStartDTS=function e(n,t,s){y.findBox(t,["moof","traf"]).map(function(r){return y.findBox(r,["tfhd"]).map(function(e){var t=y.readUint32(e,4);var a=n[t].timescale||9e4;y.findBox(r,["tfdt"]).map(function(e){var t=e.data[e.start];var r=y.readUint32(e,4);if(t===0)y.writeUint32(e,4,r-s*a);else{r*=Math.pow(2,32);r+=y.readUint32(e,8);r-=s*a;r=Math.max(r,0);var n=Math.floor(r/(o+1));var i=Math.floor(r%(o+1));y.writeUint32(e,4,n);y.writeUint32(e,8,i)}})})})};e.append=function e(t,r,n,i){var a=this.initData;if(!a){this.resetInitSegment(t,this.audioCodec,this.videoCodec,false);a=this.initData}var s,o=this.initPTS;if(o===undefined){var l=y.getStartDTS(a,t);this.initPTS=o=l-r;this.observer.trigger(u["default"].INIT_PTS_FOUND,{initPTS:o})}y.offsetStartDTS(a,t,o);s=y.getStartDTS(a,t);this.remuxer.remux(a.audio,a.video,null,null,s,n,i,t)};e.destroy=function e(){};return y}();t["default"]=n},"./src/errors.ts":
/*!***********************!*\
    !*** ./src/errors.ts ***!
    \***********************/
/*! exports provided: ErrorTypes, ErrorDetails */function(e,t,r){r.r(t);r.d(t,"ErrorTypes",function(){return n});r.d(t,"ErrorDetails",function(){return i});var n;(function(e){e["NETWORK_ERROR"]="networkError";e["MEDIA_ERROR"]="mediaError";e["KEY_SYSTEM_ERROR"]="keySystemError";e["MUX_ERROR"]="muxError";e["OTHER_ERROR"]="otherError"})(n||(n={}));var i;(function(e){e["KEY_SYSTEM_NO_KEYS"]="keySystemNoKeys";e["KEY_SYSTEM_NO_ACCESS"]="keySystemNoAccess";e["KEY_SYSTEM_NO_SESSION"]="keySystemNoSession";e["KEY_SYSTEM_LICENSE_REQUEST_FAILED"]="keySystemLicenseRequestFailed";e["KEY_SYSTEM_NO_INIT_DATA"]="keySystemNoInitData";e["MANIFEST_LOAD_ERROR"]="manifestLoadError";e["MANIFEST_LOAD_TIMEOUT"]="manifestLoadTimeOut";e["MANIFEST_PARSING_ERROR"]="manifestParsingError";e["MANIFEST_INCOMPATIBLE_CODECS_ERROR"]="manifestIncompatibleCodecsError";e["LEVEL_EMPTY_ERROR"]="levelEmptyError";e["LEVEL_LOAD_ERROR"]="levelLoadError";e["LEVEL_LOAD_TIMEOUT"]="levelLoadTimeOut";e["LEVEL_SWITCH_ERROR"]="levelSwitchError";e["AUDIO_TRACK_LOAD_ERROR"]="audioTrackLoadError";e["AUDIO_TRACK_LOAD_TIMEOUT"]="audioTrackLoadTimeOut";e["FRAG_LOAD_ERROR"]="fragLoadError";e["FRAG_LOAD_TIMEOUT"]="fragLoadTimeOut";e["FRAG_DECRYPT_ERROR"]="fragDecryptError";e["FRAG_PARSING_ERROR"]="fragParsingError";e["REMUX_ALLOC_ERROR"]="remuxAllocError";e["KEY_LOAD_ERROR"]="keyLoadError";e["KEY_LOAD_TIMEOUT"]="keyLoadTimeOut";e["BUFFER_ADD_CODEC_ERROR"]="bufferAddCodecError";e["BUFFER_APPEND_ERROR"]="bufferAppendError";e["BUFFER_APPENDING_ERROR"]="bufferAppendingError";e["BUFFER_STALLED_ERROR"]="bufferStalledError";e["BUFFER_FULL_ERROR"]="bufferFullError";e["BUFFER_SEEK_OVER_HOLE"]="bufferSeekOverHole";e["BUFFER_NUDGE_ON_STALL"]="bufferNudgeOnStall";e["INTERNAL_EXCEPTION"]="internalException"})(i||(i={}))},"./src/events.js":
/*!***********************!*\
    !*** ./src/events.js ***!
    \***********************/
/*! exports provided: default */function(e,t,r){r.r(t);var n={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};t["default"]=n},"./src/hls.ts":
/*!*********************************!*\
    !*** ./src/hls.ts + 50 modules ***!
    \*********************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/demuxer-inline.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/eventemitter3/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/url-toolkit/src/url-toolkit.js (<- Module is not an ECMAScript module) */function(r,S,e){e.r(S);e.d(S,"default",function(){return Ln});var t={};e.r(t);e.d(t,"newCue",function(){return Er});var n=e("./node_modules/url-toolkit/src/url-toolkit.js");var A=e("./src/errors.ts");var x=e("./src/polyfills/number.js");var M=e("./src/events.js");var F=e("./src/utils/logger.js");var C={hlsEventGeneric:true,hlsHandlerDestroying:true,hlsHandlerDestroyed:true};var R=function(){function e(e){this.hls=void 0;this.handledEvents=void 0;this.useGenericHandler=void 0;this.hls=e;this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.handledEvents=r;this.useGenericHandler=true;this.registerListeners()}var t=e.prototype;t.destroy=function e(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()};t.onHandlerDestroying=function e(){};t.onHandlerDestroyed=function e(){};t.isEventHandler=function e(){return typeof this.handledEvents==="object"&&this.handledEvents.length&&typeof this.onEvent==="function"};t.registerListeners=function e(){if(this.isEventHandler())this.handledEvents.forEach(function(e){if(C[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)};t.unregisterListeners=function e(){if(this.isEventHandler())this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)};t.onEvent=function e(t,r){this.onEventGeneric(t,r)};t.onEventGeneric=function e(t,r){var n=function e(t,r){var n="on"+t.replace("hls","");if(typeof this[n]!=="function")throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,r)};try{n.call(this,t,r).call()}catch(e){F["logger"].error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e);this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].OTHER_ERROR,details:A["ErrorDetails"].INTERNAL_EXCEPTION,fatal:false,event:t,err:e})}};return e}();var i=R;var m;(function(e){e["MANIFEST"]="manifest";e["LEVEL"]="level";e["AUDIO_TRACK"]="audioTrack";e["SUBTITLE_TRACK"]="subtitleTrack"})(m||(m={}));var a;(function(e){e["MAIN"]="main";e["AUDIO"]="audio";e["SUBTITLE"]="subtitle"})(a||(a={}));var w=e("./src/demux/mp4demuxer.js");function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function L(e,t,r){if(t)O(e.prototype,t);if(r)O(e,r);return e}var P=function(){function e(e,t){this._uri=null;this.baseuri=void 0;this.reluri=void 0;this.method=null;this.key=null;this.iv=null;this.baseuri=e;this.reluri=t}L(e,[{key:"uri",get:function e(){if(!this._uri&&this.reluri)this._uri=Object(n["buildAbsoluteURL"])(this.baseuri,this.reluri,{alwaysNormalize:true});return this._uri}}]);return e}();function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function H(e,t,r){if(t)N(e.prototype,t);if(r)N(e,r);return e}var f;(function(e){e["AUDIO"]="audio";e["VIDEO"]="video"})(f||(f={}));var I=function(){function e(){var e;this._url=null;this._byteRange=null;this._decryptdata=null;this._elementaryStreams=(e={},e[f.AUDIO]=false,e[f.VIDEO]=false,e);this.deltaPTS=0;this.rawProgramDateTime=null;this.programDateTime=null;this.title=null;this.tagList=[];this.cc=void 0;this.type=void 0;this.relurl=void 0;this.baseurl=void 0;this.duration=void 0;this.start=void 0;this.sn=0;this.urlId=0;this.level=0;this.levelkey=void 0;this.loader=void 0}var t=e.prototype;t.setByteRange=function e(t,r){var n=t.split("@",2);var i=[];if(n.length===1)i[0]=r?r.byteRangeEndOffset:0;else i[0]=parseInt(n[1]);i[1]=parseInt(n[0])+i[0];this._byteRange=i};t.addElementaryStream=function e(t){this._elementaryStreams[t]=true};t.hasElementaryStream=function e(t){return this._elementaryStreams[t]===true};t.createInitializationVector=function e(t){var r=new Uint8Array(16);for(var n=12;n<16;n++)r[n]=t>>8*(15-n)&255;return r};t.setDecryptDataFromLevelKey=function e(t,r){var n=t;if((t===null||t===void 0?void 0:t.method)&&t.uri&&!t.iv){n=new P(t.baseuri,t.reluri);n.method=t.method;n.iv=this.createInitializationVector(r)}return n};H(e,[{key:"url",get:function e(){if(!this._url&&this.relurl)this._url=Object(n["buildAbsoluteURL"])(this.baseurl,this.relurl,{alwaysNormalize:true});return this._url},set:function e(t){this._url=t}},{key:"byteRange",get:function e(){if(!this._byteRange)return[];return this._byteRange}},{key:"byteRangeStartOffset",get:function e(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function e(){return this.byteRange[1]}},{key:"decryptdata",get:function e(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var t=this.sn;if(typeof t!=="number"){if(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv)F["logger"].warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue');t=0}this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"endProgramDateTime",get:function e(){if(this.programDateTime===null)return null;if(!Object(x["isFiniteNumber"])(this.programDateTime))return null;var t=!Object(x["isFiniteNumber"])(this.duration)?0:this.duration;return this.programDateTime+t*1e3}},{key:"encrypted",get:function e(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]);return e}();function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function $(e,t,r){if(t)z(e.prototype,t);if(r)z(e,r);return e}var W=function(){function e(e){this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=true;this.needSidxRanges=false;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=e;this.version=null}$(e,[{key:"hasProgramDateTime",get:function e(){return!!(this.fragments[0]&&Object(x["isFiniteNumber"])(this.fragments[0].programDateTime))}}]);return e}();var q=/^(\d+)x(\d+)$/;var X=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;var Z=function(){function r(e){if(typeof e==="string")e=r.parseAttrList(e);for(var t in e)if(e.hasOwnProperty(t))this[t]=e[t]}var e=r.prototype;e.decimalInteger=function e(t){var r=parseInt(this[t],10);if(r>Number.MAX_SAFE_INTEGER)return Infinity;return r};e.hexadecimalInteger=function e(t){if(this[t]){var r=(this[t]||"0x").slice(2);r=(r.length&1?"0":"")+r;var n=new Uint8Array(r.length/2);for(var i=0;i<r.length/2;i++)n[i]=parseInt(r.slice(i*2,i*2+2),16);return n}else return null};e.hexadecimalIntegerAsNumber=function e(t){var r=parseInt(this[t],16);if(r>Number.MAX_SAFE_INTEGER)return Infinity;return r};e.decimalFloatingPoint=function e(t){return parseFloat(this[t])};e.enumeratedString=function e(t){return this[t]};e.decimalResolution=function e(t){var r=q.exec(this[t]);if(r===null)return undefined;return{width:parseInt(r[1],10),height:parseInt(r[2],10)}};r.parseAttrList=function e(t){var r,n={};X.lastIndex=0;while((r=X.exec(t))!==null){var i=r[2],a='"';if(i.indexOf(a)===0&&i.lastIndexOf(a)===i.length-1)i=i.slice(1,-1);n[r[1]]=i}return n};return r}();var D=Z;var Q={audio:{a3ds:true,"ac-3":true,"ac-4":true,alac:true,alaw:true,dra1:true,"dts+":true,"dts-":true,dtsc:true,dtse:true,dtsh:true,"ec-3":true,enca:true,g719:true,g726:true,m4ae:true,mha1:true,mha2:true,mhm1:true,mhm2:true,mlpa:true,mp4a:true,"raw ":true,Opus:true,samr:true,sawb:true,sawp:true,sevc:true,sqcp:true,ssmv:true,twos:true,ulaw:true},video:{avc1:true,avc2:true,avc3:true,avc4:true,avcp:true,drac:true,dvav:true,dvhe:true,encv:true,hev1:true,hvc1:true,mjp2:true,mp4v:true,mvc1:true,mvc2:true,mvc3:true,mvc4:true,resv:true,rv60:true,s263:true,svc1:true,svc2:true,"vc-1":true,vp08:true,vp09:true}};function J(e,t){var r=Q[t];return!!r&&r[e.slice(0,4)]===true}function d(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var ee=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g;var te=/#EXT-X-MEDIA:(.*)/g;var re=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g");var ne=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-("0.4.6"):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/;var ie=/\.(mp4|m4s|m4v|m4a)$/i;var y=function(){function f(){}f.findGroup=function e(t,r){for(var n=0;n<t.length;n++){var i=t[n];if(i.id===r)return i}};f.convertAVC1ToAVCOTI=function e(t){var r=t.split(".");var n;if(r.length>2){n=r.shift()+".";n+=parseInt(r.shift()).toString(16);n+=("000"+parseInt(r.shift()).toString(16)).substr(-4)}else n=t;return n};f.resolve=function e(t,r){return n["buildAbsoluteURL"](r,t,{alwaysNormalize:true})};f.parseMasterPlaylist=function e(t,r){var n=[];var i={};var a=false;ee.lastIndex=0;function s(n,i){["video","audio"].forEach(function(t){var r=n.filter(function(e){return J(e,t)});if(r.length){var e=r.filter(function(e){return e.lastIndexOf("avc1",0)===0||e.lastIndexOf("mp4a",0)===0});i[t+"Codec"]=e.length>0?e[0]:r[0];n=n.filter(function(e){return r.indexOf(e)===-1})}});i.unknownCodecs=n}var o;while((o=ee.exec(t))!=null)if(o[1]){var l={};var u=l.attrs=new D(o[1]);l.url=f.resolve(o[2],r);var c=u.decimalResolution("RESOLUTION");if(c){l.width=c.width;l.height=c.height}l.bitrate=u.decimalInteger("AVERAGE-BANDWIDTH")||u.decimalInteger("BANDWIDTH");l.name=u.NAME;s([].concat((u.CODECS||"").split(/[ ,]+/)),l);if(l.videoCodec&&l.videoCodec.indexOf("avc1")!==-1)l.videoCodec=f.convertAVC1ToAVCOTI(l.videoCodec);n.push(l)}else if(o[3]){var d=new D(o[3]);if(d["DATA-ID"]){a=true;i[d["DATA-ID"]]=d}}return{levels:n,sessionData:a?i:null}};f.parseMasterPlaylistMedia=function e(t,r,n,i){if(i===void 0)i=[];var a;var s=[];var o=0;te.lastIndex=0;while((a=te.exec(t))!==null){var l=new D(a[1]);if(l.TYPE===n){var u={attrs:l,id:o++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE,type:n,default:l.DEFAULT==="YES",autoselect:l.AUTOSELECT==="YES",forced:l.FORCED==="YES",lang:l.LANGUAGE};if(l.URI)u.url=f.resolve(l.URI,r);if(i.length){var c=f.findGroup(i,u.groupId);u.audioCodec=c?c.codec:i[0].codec}s.push(u)}}return s};f.parseLevelPlaylist=function e(t,r,n,i,a){var s=0;var o=0;var l=new W(r);var u=0;var c=null;var d=new I;var f;var h;var p;var v=null;re.lastIndex=0;while((f=re.exec(t))!==null){var g=f[1];if(g){d.duration=parseFloat(g);var A=(" "+f[2]).slice(1);d.title=A||null;d.tagList.push(A?["INF",g,A]:["INF",g])}else if(f[3]){if(Object(x["isFiniteNumber"])(d.duration)){var m=s++;d.type=i;d.start=o;if(p)d.levelkey=p;d.sn=m;d.level=n;d.cc=u;d.urlId=a;d.baseurl=r;d.relurl=(" "+f[3]).slice(1);se(d,c);l.fragments.push(d);c=d;o+=d.duration;d=new I}}else if(f[4]){var y=(" "+f[4]).slice(1);if(c)d.setByteRange(y,c);else d.setByteRange(y)}else if(f[5]){d.rawProgramDateTime=(" "+f[5]).slice(1);d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]);if(v===null)v=l.fragments.length}else{f=f[0].match(ne);if(!f){F["logger"].warn("No matches on slow regex match for level playlist!");continue}for(h=1;h<f.length;h++)if(typeof f[h]!=="undefined")break;var E=(" "+f[h+1]).slice(1);var b=(" "+f[h+2]).slice(1);switch(f[h]){case"#":d.tagList.push(b?[E,b]:[E]);break;case"PLAYLIST-TYPE":l.type=E.toUpperCase();break;case"MEDIA-SEQUENCE":s=l.startSN=parseInt(E);break;case"TARGETDURATION":l.targetduration=parseFloat(E);break;case'"0.4.6"':l.version=parseInt(E);break;case"EXTM3U":break;case"ENDLIST":l.live=false;break;case"DIS":u++;d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":u=parseInt(E);break;case"KEY":{var k=E;var _=new D(k);var T=_.enumeratedString("METHOD");var S=_.URI;var C=_.hexadecimalInteger("IV");var R=_.KEYFORMAT||"identity";if(R==="com.apple.streamingkeydelivery"){F["logger"].warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}if(T){p=new P(r,S);if(S&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(T)>=0){p.method=T;p.key=null;p.iv=C}}break}case"START":{var w=new D(E);var O=w.decimalFloatingPoint("TIME-OFFSET");if(Object(x["isFiniteNumber"])(O))l.startTimeOffset=O;break}case"MAP":{var L=new D(E);d.relurl=L.URI;if(L.BYTERANGE)d.setByteRange(L.BYTERANGE);d.baseurl=r;d.level=n;d.type=i;d.sn="initSegment";l.initSegment=d;d=new I;d.rawProgramDateTime=l.initSegment.rawProgramDateTime;break}default:F["logger"].warn("line parsed but not handled: "+f);break}}}d=c;if(d&&!d.relurl){l.fragments.pop();o-=d.duration}l.totalduration=o;l.averagetargetduration=o/l.fragments.length;l.endSN=s-1;l.startCC=l.fragments[0]?l.fragments[0].cc:0;l.endCC=u;if(!l.initSegment&&l.fragments.length)if(l.fragments.every(function(e){return ie.test(e.relurl)})){F["logger"].warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX");d=new I;d.relurl=l.fragments[0].relurl;d.baseurl=r;d.level=n;d.type=i;d.sn="initSegment";l.initSegment=d;l.needSidxRanges=true}if(v)ae(l.fragments,v);return l};return f}();function ae(e,t){var r=e[t];for(var n=t-1;n>=0;n--){var i=e[n];i.programDateTime=r.programDateTime-i.duration*1e3;r=i}}function se(e,t){if(e.rawProgramDateTime)e.programDateTime=Date.parse(e.rawProgramDateTime);else if(t===null||t===void 0?void 0:t.programDateTime)e.programDateTime=t.endProgramDateTime;if(!Object(x["isFiniteNumber"])(e.programDateTime)){e.programDateTime=null;e.rawProgramDateTime=null}}function oe(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var le=window,ue=le.performance;var ce=function(r){oe(g,r);function g(e){var t;t=r.call(this,e,M["default"].MANIFEST_LOADING,M["default"].LEVEL_LOADING,M["default"].AUDIO_TRACK_LOADING,M["default"].SUBTITLE_TRACK_LOADING)||this;t.loaders={};return t}g.canHaveQualityLevels=function e(t){return t!==m.AUDIO_TRACK&&t!==m.SUBTITLE_TRACK};g.mapContextToLevelType=function e(t){var r=t.type;switch(r){case m.AUDIO_TRACK:return a.AUDIO;case m.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}};g.getResponseUrl=function e(t,r){var n=t.url;if(n===undefined||n.indexOf("data:")===0)n=r.url;return n};var e=g.prototype;e.createInternalLoader=function e(t){var r=this.hls.config;var n=r.pLoader;var i=r.loader;var a=n||i;var s=new a(r);t.loader=s;this.loaders[t.type]=s;return s};e.getInternalLoader=function e(t){return this.loaders[t.type]};e.resetInternalLoader=function e(t){if(this.loaders[t])delete this.loaders[t]};e.destroyInternalLoaders=function e(){for(var t in this.loaders){var r=this.loaders[t];if(r)r.destroy();this.resetInternalLoader(t)}};e.destroy=function e(){this.destroyInternalLoaders();r.prototype.destroy.call(this)};e.onManifestLoading=function e(t){this.load({url:t.url,type:m.MANIFEST,level:0,id:null,responseType:"text"})};e.onLevelLoading=function e(t){this.load({url:t.url,type:m.LEVEL,level:t.level,id:t.id,responseType:"text"})};e.onAudioTrackLoading=function e(t){this.load({url:t.url,type:m.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})};e.onSubtitleTrackLoading=function e(t){this.load({url:t.url,type:m.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})};e.load=function e(t){var r=this.hls.config;F["logger"].debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var n=this.getInternalLoader(t);if(n){var i=n.context;if(i&&i.url===t.url){F["logger"].trace("playlist request ongoing");return false}else{F["logger"].warn("aborting previous loader for type: "+t.type);n.abort()}}var a;var s;var o;var l;switch(t.type){case m.MANIFEST:a=r.manifestLoadingMaxRetry;s=r.manifestLoadingTimeOut;o=r.manifestLoadingRetryDelay;l=r.manifestLoadingMaxRetryTimeout;break;case m.LEVEL:a=0;l=0;o=0;s=r.levelLoadingTimeOut;break;default:a=r.levelLoadingMaxRetry;s=r.levelLoadingTimeOut;o=r.levelLoadingRetryDelay;l=r.levelLoadingMaxRetryTimeout;break}n=this.createInternalLoader(t);var u={timeout:s,maxRetry:a,retryDelay:o,maxRetryDelay:l};var c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};F["logger"].debug("Calling internal loader delegate for URL: "+t.url);n.load(t,u,c);return true};e.loadsuccess=function e(t,r,n,i){if(i===void 0)i=null;if(n.isSidxRequest){this._handleSidxRequest(t,n);this._handlePlaylistLoaded(t,r,n,i);return}this.resetInternalLoader(n.type);if(typeof t.data!=="string")throw new Error('expected responseType of "text" for PlaylistLoader');var a=t.data;r.tload=ue.now();if(a.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(t,n,"no EXTM3U delimiter",i);return}if(a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0)this._handleTrackOrLevelPlaylist(t,r,n,i);else this._handleMasterPlaylist(t,r,n,i)};e.loaderror=function e(t,r,n){if(n===void 0)n=null;this._handleNetworkError(r,n,false,t)};e.loadtimeout=function e(t,r,n){if(n===void 0)n=null;this._handleNetworkError(r,n,true)};e._handleMasterPlaylist=function e(t,r,n,i){var a=this.hls;var s=t.data;var o=g.getResponseUrl(t,n);var l=y.parseMasterPlaylist(s,o),u=l.levels,c=l.sessionData;if(!u.length){this._handleManifestParsingError(t,n,"no level found in manifest",i);return}var d=u.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}});var f=y.parseMasterPlaylistMedia(s,o,"AUDIO",d);var h=y.parseMasterPlaylistMedia(s,o,"SUBTITLES");var p=y.parseMasterPlaylistMedia(s,o,"CLOSED-CAPTIONS");if(f.length){var v=false;f.forEach(function(e){if(!e.url)v=true});if(v===false&&u[0].audioCodec&&!u[0].attrs.AUDIO){F["logger"].log("audio codec signaled in quality level, but no embedded audio track signaled, create one");f.unshift({type:"main",name:"main",default:false,autoselect:false,forced:false,id:-1,attrs:{},url:""})}}a.trigger(M["default"].MANIFEST_LOADED,{levels:u,audioTracks:f,subtitles:h,captions:p,url:o,stats:r,networkDetails:i,sessionData:c})};e._handleTrackOrLevelPlaylist=function e(t,r,n,i){var a=this.hls;var s=n.id,o=n.level,l=n.type;var u=g.getResponseUrl(t,n);var c=Object(x["isFiniteNumber"])(s)?s:0;var d=Object(x["isFiniteNumber"])(o)?o:c;var f=g.mapContextToLevelType(n);var h=y.parseLevelPlaylist(t.data,u,d,f,c);h.tload=r.tload;if(!h.fragments.length){a.trigger(M["default"].ERROR,{type:A["ErrorTypes"].NETWORK_ERROR,details:A["ErrorDetails"].LEVEL_EMPTY_ERROR,fatal:false,url:u,reason:"no fragments found in level",level:typeof n.level==="number"?n.level:undefined});return}if(l===m.MANIFEST){var p={url:u,details:h};a.trigger(M["default"].MANIFEST_LOADED,{levels:[p],audioTracks:[],url:u,stats:r,networkDetails:i,sessionData:null})}r.tparsed=ue.now();if(h.needSidxRanges){var v=h.initSegment.url;this.load({url:v,isSidxRequest:true,type:l,level:o,levelDetails:h,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}n.levelDetails=h;this._handlePlaylistLoaded(t,r,n,i)};e._handleSidxRequest=function e(t,r){if(typeof t.data==="string")throw new Error("sidx request must be made with responseType of array buffer");var n=w["default"].parseSegmentIndex(new Uint8Array(t.data));if(!n)return;var i=n.references;var a=r.levelDetails;i.forEach(function(e,t){var r=e.info;if(!a)return;var n=a.fragments[t];if(n.byteRange.length===0)n.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))});if(a)a.initSegment.setByteRange(String(n.moovEndOffset)+"@0")};e._handleManifestParsingError=function e(t,r,n,i){this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].NETWORK_ERROR,details:A["ErrorDetails"].MANIFEST_PARSING_ERROR,fatal:true,url:t.url,reason:n,networkDetails:i})};e._handleNetworkError=function e(t,r,n,i){if(n===void 0)n=false;if(i===void 0)i=null;F["logger"].info("A network error occured while loading a "+t.type+"-type playlist");var a;var s;var o=this.getInternalLoader(t);switch(t.type){case m.MANIFEST:a=n?A["ErrorDetails"].MANIFEST_LOAD_TIMEOUT:A["ErrorDetails"].MANIFEST_LOAD_ERROR;s=true;break;case m.LEVEL:a=n?A["ErrorDetails"].LEVEL_LOAD_TIMEOUT:A["ErrorDetails"].LEVEL_LOAD_ERROR;s=false;break;case m.AUDIO_TRACK:a=n?A["ErrorDetails"].AUDIO_TRACK_LOAD_TIMEOUT:A["ErrorDetails"].AUDIO_TRACK_LOAD_ERROR;s=false;break;default:s=false}if(o){o.abort();this.resetInternalLoader(t.type)}var l={type:A["ErrorTypes"].NETWORK_ERROR,details:a,fatal:s,url:t.url,loader:o,context:t,networkDetails:r};if(i)l.response=i;this.hls.trigger(M["default"].ERROR,l)};e._handlePlaylistLoaded=function e(t,r,n,i){var a=n.type,s=n.level,o=n.id,l=n.levelDetails;if(!l||!l.targetduration){this._handleManifestParsingError(t,n,"invalid target duration",i);return}var u=g.canHaveQualityLevels(n.type);if(u)this.hls.trigger(M["default"].LEVEL_LOADED,{details:l,level:s||0,id:o||0,stats:r,networkDetails:i});else switch(a){case m.AUDIO_TRACK:this.hls.trigger(M["default"].AUDIO_TRACK_LOADED,{details:l,id:o,stats:r,networkDetails:i});break;case m.SUBTITLE_TRACK:this.hls.trigger(M["default"].SUBTITLE_TRACK_LOADED,{details:l,id:o,stats:r,networkDetails:i});break}};return g}(i);var de=ce;function fe(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var he=function(i){fe(e,i);function e(e){var t;t=i.call(this,e,M["default"].FRAG_LOADING)||this;t.loaders={};return t}var t=e.prototype;t.destroy=function e(){var t=this.loaders;for(var r in t){var n=t[r];if(n)n.destroy()}this.loaders={};i.prototype.destroy.call(this)};t.onFragLoading=function e(t){var r=t.frag,n=r.type,i=this.loaders,a=this.hls.config,s=a.fLoader,o=a.loader;r.loaded=0;var l=i[n];if(l){F["logger"].warn("abort previous fragment loader for type: "+n);l.abort()}l=i[n]=r.loader=a.fLoader?new s(a):new o(a);var u,c,d;u={url:r.url,frag:r,responseType:"arraybuffer",progressData:false};var f=r.byteRangeStartOffset,h=r.byteRangeEndOffset;if(Object(x["isFiniteNumber"])(f)&&Object(x["isFiniteNumber"])(h)){u.rangeStart=f;u.rangeEnd=h}c={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout};d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};l.load(u,c,d)};t.loadsuccess=function e(t,r,n,i){if(i===void 0)i=null;var a=t.data,s=n.frag;s.loader=undefined;this.loaders[s.type]=undefined;this.hls.trigger(M["default"].FRAG_LOADED,{payload:a,frag:s,stats:r,networkDetails:i})};t.loaderror=function e(t,r,n){if(n===void 0)n=null;var i=r.frag;var a=i.loader;if(a)a.abort();this.loaders[i.type]=undefined;this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].NETWORK_ERROR,details:A["ErrorDetails"].FRAG_LOAD_ERROR,fatal:false,frag:r.frag,response:t,networkDetails:n})};t.loadtimeout=function e(t,r,n){if(n===void 0)n=null;var i=r.frag;var a=i.loader;if(a)a.abort();this.loaders[i.type]=undefined;this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].NETWORK_ERROR,details:A["ErrorDetails"].FRAG_LOAD_TIMEOUT,fatal:false,frag:r.frag,networkDetails:n})};t.loadprogress=function e(t,r,n,i){if(i===void 0)i=null;var a=r.frag;a.loaded=t.loaded;this.hls.trigger(M["default"].FRAG_LOAD_PROGRESS,{frag:a,stats:t,networkDetails:i})};return e}(i);var pe=he;function ve(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var ge=function(n){ve(e,n);function e(e){var t;t=n.call(this,e,M["default"].KEY_LOADING)||this;t.loaders={};t.decryptkey=null;t.decrypturl=null;return t}var t=e.prototype;t.destroy=function e(){for(var t in this.loaders){var r=this.loaders[t];if(r)r.destroy()}this.loaders={};n.prototype.destroy.call(this)};t.onKeyLoading=function e(t){var r=t.frag;var n=r.type;var i=this.loaders[n];if(!r.decryptdata){F["logger"].warn("Missing decryption data on fragment in onKeyLoading");return}var a=r.decryptdata.uri;if(a!==this.decrypturl||this.decryptkey===null){var s=this.hls.config;if(i){F["logger"].warn("abort previous key loader for type:"+n);i.abort()}if(!a){F["logger"].warn("key uri is falsy");return}r.loader=this.loaders[n]=new s.loader(s);this.decrypturl=a;this.decryptkey=null;var o={url:a,frag:r,responseType:"arraybuffer"};var l={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout};var u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};r.loader.load(o,l,u)}else if(this.decryptkey){r.decryptdata.key=this.decryptkey;this.hls.trigger(M["default"].KEY_LOADED,{frag:r})}};t.loadsuccess=function e(t,r,n){var i=n.frag;if(!i.decryptdata){F["logger"].error("after key load, decryptdata unset");return}this.decryptkey=i.decryptdata.key=new Uint8Array(t.data);i.loader=undefined;delete this.loaders[i.type];this.hls.trigger(M["default"].KEY_LOADED,{frag:i})};t.loaderror=function e(t,r){var n=r.frag;var i=n.loader;if(i)i.abort();delete this.loaders[n.type];this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].NETWORK_ERROR,details:A["ErrorDetails"].KEY_LOAD_ERROR,fatal:false,frag:n,response:t})};t.loadtimeout=function e(t,r){var n=r.frag;var i=n.loader;if(i)i.abort();delete this.loaders[n.type];this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].NETWORK_ERROR,details:A["ErrorDetails"].KEY_LOAD_TIMEOUT,fatal:false,frag:n})};return e}(i);var Ae=ge;function me(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var B={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var ye=function(r){me(e,r);function e(e){var t;t=r.call(this,e,M["default"].BUFFER_APPENDED,M["default"].FRAG_BUFFERED,M["default"].FRAG_LOADED)||this;t.bufferPadding=.2;t.fragments=Object.create(null);t.timeRanges=Object.create(null);t.config=e.config;return t}var t=e.prototype;t.destroy=function e(){this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.config=null;i.prototype.destroy.call(this);r.prototype.destroy.call(this)};t.getBufferedFrag=function e(n,i){var a=this.fragments;var t=Object.keys(a).filter(function(e){var t=a[e];if(t.body.type!==i)return false;if(!t.buffered)return false;var r=t.body;return r.startPTS<=n&&n<=r.endPTS});if(t.length===0)return null;else{var r=t.pop();return a[r].body}};t.detectEvictedFragments=function e(s,o){var l=this;Object.keys(this.fragments).forEach(function(e){var t=l.fragments[e];if(!t||!t.buffered)return;var r=t.range[s];if(!r)return;var n=r.time;for(var i=0;i<n.length;i++){var a=n[i];if(!l.isTimeBuffered(a.startPTS,a.endPTS,o)){l.removeFragment(t.body);break}}})};t.detectPartialFragments=function e(r){var n=this;var t=this.getFragmentKey(r);var i=this.fragments[t];if(i){i.buffered=true;Object.keys(this.timeRanges).forEach(function(e){if(r.hasElementaryStream(e)){var t=n.timeRanges[e];i.range[e]=n.getBufferedTimes(r.startPTS,r.endPTS,t)}})}};t.getBufferedTimes=function e(t,r,n){var i=[];var a,s;var o=false;for(var l=0;l<n.length;l++){a=n.start(l)-this.bufferPadding;s=n.end(l)+this.bufferPadding;if(t>=a&&r<=s){i.push({startPTS:Math.max(t,n.start(l)),endPTS:Math.min(r,n.end(l))});break}else if(t<s&&r>a){i.push({startPTS:Math.max(t,n.start(l)),endPTS:Math.min(r,n.end(l))});o=true}else if(r<=a)break}return{time:i,partial:o}};t.getFragmentKey=function e(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn};t.getPartialFragment=function e(r){var n=this;var i,a,s;var o=null;var l=0;Object.keys(this.fragments).forEach(function(e){var t=n.fragments[e];if(n.isPartial(t)){a=t.body.startPTS-n.bufferPadding;s=t.body.endPTS+n.bufferPadding;if(r>=a&&r<=s){i=Math.min(r-a,s-r);if(l<=i){o=t.body;l=i}}}});return o};t.getState=function e(t){var r=this.getFragmentKey(t);var n=this.fragments[r];var i=B.NOT_LOADED;if(n!==undefined)if(!n.buffered)i=B.APPENDING;else if(this.isPartial(n)===true)i=B.PARTIAL;else i=B.OK;return i};t.isPartial=function e(t){return t.buffered===true&&(t.range.video!==undefined&&t.range.video.partial===true||t.range.audio!==undefined&&t.range.audio.partial===true)};t.isTimeBuffered=function e(t,r,n){var i,a;for(var s=0;s<n.length;s++){i=n.start(s)-this.bufferPadding;a=n.end(s)+this.bufferPadding;if(t>=i&&r<=a)return true;if(r<=i)return false}return false};t.onFragLoaded=function e(t){var r=t.frag;if(!Object(x["isFiniteNumber"])(r.sn)||r.bitrateTest)return;this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:false}};t.onBufferAppended=function e(t){var r=this;this.timeRanges=t.timeRanges;Object.keys(this.timeRanges).forEach(function(e){var t=r.timeRanges[e];r.detectEvictedFragments(e,t)})};t.onFragBuffered=function e(t){this.detectPartialFragments(t.frag)};t.hasFragment=function e(t){var r=this.getFragmentKey(t);return this.fragments[r]!==undefined};t.removeFragment=function e(t){var r=this.getFragmentKey(t);delete this.fragments[r]};t.removeAllFragments=function e(){this.fragments=Object.create(null)};return e}(i);var Ee={search:function e(t,r){var n=0;var i=t.length-1;var a=null;var s=null;while(n<=i){a=(n+i)/2|0;s=t[a];var o=r(s);if(o>0)n=a+1;else if(o<0)i=a-1;else return s}return null}};var U=Ee;var j=function(){function e(){}e.isBuffered=function e(t,r){try{if(t){var n=t.buffered;for(var i=0;i<n.length;i++)if(r>=n.start(i)&&r<=n.end(i))return true}}catch(e){}return false};e.bufferInfo=function e(t,r,n){try{if(t){var i=t.buffered;var a=[];var s;for(s=0;s<i.length;s++)a.push({start:i.start(s),end:i.end(s)});return this.bufferedInfo(a,r,n)}}catch(e){}return{len:0,start:r,end:r,nextStart:undefined}};e.bufferedInfo=function e(t,r,n){t.sort(function(e,t){var r=e.start-t.start;if(r)return r;else return t.end-e.end});var i=[];if(n)for(var a=0;a<t.length;a++){var s=i.length;if(s){var o=i[s-1].end;if(t[a].start-o<n){if(t[a].end>o)i[s-1].end=t[a].end}else i.push(t[a])}else i.push(t[a])}else i=t;var l=0;var u;var c=r;var d=r;for(var f=0;f<i.length;f++){var h=i[f].start,p=i[f].end;if(r+n>=h&&r<p){c=h;d=p;l=d-r}else if(r+n<h){u=h;break}}return{len:l,start:c,end:d,nextStart:u}};return e}();var be=e("./node_modules/eventemitter3/index.js");var ke=e("./node_modules/webworkify-webpack/index.js");var _e=e("./src/demux/demuxer-inline.js");function s(){return window.MediaSource||window.WebKitMediaSource}var Te=e("./src/utils/get-self-scope.js");function Se(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Ce=function(e){Se(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.trigger=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.emit.apply(this,[t,t].concat(n))};return t}(be["EventEmitter"]);var Re=Object(Te["getSelfScope"])();var u=s()||{isTypeSupported:function e(){return false}};var we=function(){function e(n,e){var i=this;this.hls=n;this.id=e;var t=this.observer=new Ce;var r=n.config;var a=function e(t,r){r=r||{};r.frag=i.frag;r.id=i.id;n.trigger(t,r)};t.on(M["default"].FRAG_DECRYPTED,a);t.on(M["default"].FRAG_PARSING_INIT_SEGMENT,a);t.on(M["default"].FRAG_PARSING_DATA,a);t.on(M["default"].FRAG_PARSED,a);t.on(M["default"].ERROR,a);t.on(M["default"].FRAG_PARSING_METADATA,a);t.on(M["default"].FRAG_PARSING_USERDATA,a);t.on(M["default"].INIT_PTS_FOUND,a);var s={mp4:u.isTypeSupported("video/mp4"),mpeg:u.isTypeSupported("audio/mpeg"),mp3:u.isTypeSupported('audio/mp4; codecs="mp3"')};var o=navigator.vendor;if(r.enableWorker&&typeof Worker!=="undefined"){F["logger"].log("demuxing in webworker");var l;try{l=this.w=ke(/*! ../demux/demuxer-worker.js */"./src/demux/demuxer-worker.js");this.onwmsg=this.onWorkerMessage.bind(this);l.addEventListener("message",this.onwmsg);l.onerror=function(e){n.trigger(M["default"].ERROR,{type:A["ErrorTypes"].OTHER_ERROR,details:A["ErrorDetails"].INTERNAL_EXCEPTION,fatal:true,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})};l.postMessage({cmd:"init",typeSupported:s,vendor:o,id:e,config:JSON.stringify(r)})}catch(e){F["logger"].warn("Error in worker:",e);F["logger"].error("Error while initializing DemuxerWorker, fallback on DemuxerInline");if(l)Re.URL.revokeObjectURL(l.objectURL);this.demuxer=new _e["default"](t,s,r,o);this.w=undefined}}else this.demuxer=new _e["default"](t,s,r,o)}var t=e.prototype;t.destroy=function e(){var t=this.w;if(t){t.removeEventListener("message",this.onwmsg);t.terminate();this.w=null}else{var r=this.demuxer;if(r){r.destroy();this.demuxer=null}}var n=this.observer;if(n){n.removeAllListeners();this.observer=null}};t.push=function e(t,r,n,i,a,s,o,l){var u=this.w;var c=Object(x["isFiniteNumber"])(a.startPTS)?a.startPTS:a.start;var d=a.decryptdata;var f=this.frag;var h=!(f&&a.cc===f.cc);var p=!(f&&a.level===f.level);var v=f&&a.sn===f.sn+1;var g=!p&&v;if(h)F["logger"].log(this.id+":discontinuity detected");if(p)F["logger"].log(this.id+":switch detected");this.frag=a;if(u)u.postMessage({cmd:"demux",data:t,decryptdata:d,initSegment:r,audioCodec:n,videoCodec:i,timeOffset:c,discontinuity:h,trackSwitch:p,contiguous:g,duration:s,accurateTimeOffset:o,defaultInitPTS:l},t instanceof ArrayBuffer?[t]:[]);else{var A=this.demuxer;if(A)A.push(t,d,r,n,i,c,h,p,g,s,o,l)}};t.onWorkerMessage=function e(t){var r=t.data,n=this.hls;switch(r.event){case"init":Re.URL.revokeObjectURL(this.w.objectURL);break;case M["default"].FRAG_PARSING_DATA:r.data.data1=new Uint8Array(r.data1);if(r.data2)r.data.data2=new Uint8Array(r.data2);default:r.data=r.data||{};r.data.frag=this.frag;r.data.id=this.id;n.trigger(r.event,r.data);break}};return e}();var v=we;function Oe(e,t,r){switch(t){case"audio":if(!e.audioGroupIds)e.audioGroupIds=[];e.audioGroupIds.push(r);break;case"text":if(!e.textGroupIds)e.textGroupIds=[];e.textGroupIds.push(r);break}}function Le(e,t,r){var n=e[t],i=e[r],a=i.startPTS;if(Object(x["isFiniteNumber"])(a))if(r>t){n.duration=a-n.start;if(n.duration<0)F["logger"].warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")}else{i.duration=n.start-a;if(i.duration<0)F["logger"].warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")}else if(r>t){var s=n.cc===i.cc;i.start=n.start+(s&&n.minEndPTS?n.minEndPTS-n.start:n.duration)}else i.start=Math.max(n.start-i.duration,0)}function Ie(e,t,r,n,i,a){var s=r;var o=n;if(Object(x["isFiniteNumber"])(t.startPTS)){var l=Math.abs(t.startPTS-r);if(!Object(x["isFiniteNumber"])(t.deltaPTS))t.deltaPTS=l;else t.deltaPTS=Math.max(l,t.deltaPTS);s=Math.max(r,t.startPTS);r=Math.min(r,t.startPTS);o=Math.min(n,t.endPTS);n=Math.max(n,t.endPTS);i=Math.min(i,t.startDTS);a=Math.max(a,t.endDTS)}var u=r-t.start;t.start=t.startPTS=r;t.maxStartPTS=s;t.endPTS=n;t.minEndPTS=o;t.startDTS=i;t.endDTS=a;t.duration=n-r;var c=t.sn;if(!e||c<e.startSN||c>e.endSN)return 0;var d,f,h;d=c-e.startSN;f=e.fragments;f[d]=t;for(h=d;h>0;h--)Le(f,h,h-1);for(h=d;h<f.length-1;h++)Le(f,h,h+1);e.PTSKnown=true;return u}function De(e,r){if(r.initSegment&&e.initSegment)r.initSegment=e.initSegment;var n=0;var i;Ne(e,r,function(e,t){n=e.cc-t.cc;if(Object(x["isFiniteNumber"])(e.startPTS)){t.start=t.startPTS=e.startPTS;t.endPTS=e.endPTS;t.duration=e.duration;t.backtracked=e.backtracked;t.dropped=e.dropped;i=t}r.PTSKnown=true});if(!r.PTSKnown)return;if(n){F["logger"].log("discontinuity sliding from playlist, take drift into account");var t=r.fragments;for(var a=0;a<t.length;a++)t[a].cc+=n}if(i)Ie(r,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else xe(e,r);r.PTSKnown=e.PTSKnown}function Pe(e,t,r){if(r===void 0)r=0;var n=-1;Ne(e,t,function(e,t,r){t.start=e.start;n=r});var i=t.fragments;if(n<0){i.forEach(function(e){e.start+=r});return}for(var a=n+1;a<i.length;a++)i[a].start=i[a-1].start+i[a-1].duration}function Ne(e,t,r){if(!e||!t)return;var n=Math.max(e.startSN,t.startSN)-t.startSN;var i=Math.min(e.endSN,t.endSN)-t.startSN;var a=t.startSN-e.startSN;for(var s=n;s<=i;s++){var o=e.fragments[a+s];var l=t.fragments[s];if(!o||!l)break;r(o,l,s)}}function xe(e,t){var r=t.startSN-e.startSN;var n=e.fragments;var i=t.fragments;if(r<0||r>n.length)return;for(var a=0;a<i.length;a++)i[a].start+=n[r].start}function Me(e,t,r){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration);var i=n/2;if(e&&t.endSN===e.endSN)n=i;if(r)n=Math.max(i,n-(window.performance.now()-r));return Math.round(n)}var Fe={toString:function e(t){var r="";var n=t.length;for(var i=0;i<n;i++)r+="["+t.start(i).toFixed(3)+","+t.end(i).toFixed(3)+"]";return r}};var Be=Fe;function Ue(e,t){var r=null;for(var n=0;n<e.length;n+=1){var i=e[n];if(i&&i.cc===t){r=i;break}}return r}function je(e,t){return U.search(e,function(e){if(e.cc<t)return 1;else if(e.cc>t)return-1;else return 0})}function Ve(e,t,r){var n=false;if(t&&t.details&&r)if(r.endCC>r.startCC||e&&e.cc<r.startCC)n=true;return n}function Ge(e,t){var r=e.fragments;var n=t.fragments;if(!n.length||!r.length){F["logger"].log("No fragments to align");return}var i=Ue(r,n[0].cc);if(!i||i&&!i.startPTS){F["logger"].log("No frag in previous level to align on");return}return i}function Ke(r,e){e.fragments.forEach(function(e){if(e){var t=e.start+r;e.start=e.startPTS=t;e.endPTS=t+e.duration}});e.PTSKnown=true}function Ye(e,t,r){He(e,r,t);if(!r.PTSKnown&&t)ze(r,t.details)}function He(e,t,r){if(Ve(e,r,t)){var n=Ge(r.details,t);if(n){F["logger"].log("Adjusting PTS using last level due to CC increase within current level");Ke(n.start,t)}}}function ze(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime;var n=e.fragments[0].programDateTime;var i=(n-r)/1e3+t.fragments[0].start;if(Object(x["isFiniteNumber"])(i)){F["logger"].log("adjusting PTS using programDateTime delta, sliding:"+i.toFixed(3));Ke(i,e)}}}function $e(e,t,r){if(t===null||!Array.isArray(e)||!e.length||!Object(x["isFiniteNumber"])(t))return null;var n=e[0].programDateTime;if(t<(n||0))return null;var i=e[e.length-1].endProgramDateTime;if(t>=(i||0))return null;r=r||0;for(var a=0;a<e.length;++a){var s=e[a];if(qe(t,r,s))return s}return null}function We(e,t,r,n){if(r===void 0)r=0;if(n===void 0)n=0;var i=null;if(e)i=t[e.sn-t[0].sn+1];else if(r===0&&t[0].start===0)i=t[0];if(i&&V(r,n,i)===0)return i;var a=U.search(t,V.bind(null,r,n));if(a)return a;return i}function V(e,t,r){if(e===void 0)e=0;if(t===void 0)t=0;var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));if(r.start+r.duration-n<=e)return 1;else if(r.start-n>e&&r.start)return-1;return 0}function qe(e,t,r){var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0))*1e3;var i=r.endProgramDateTime||0;return i-n>e}var Xe=250;var G=2;var Ze=.1;var Qe=.05;var Je=function(){function e(e,t,r,n){this.config=e;this.media=t;this.fragmentTracker=r;this.hls=n;this.nudgeRetry=0;this.stallReported=false;this.stalled=null;this.moved=false;this.seeking=false}var t=e.prototype;t.poll=function e(t){var r=this.config,n=this.media,i=this.stalled;var a=n.currentTime,s=n.seeking;var o=this.seeking&&!s;var l=!this.seeking&&s;this.seeking=s;if(a!==t){this.moved=true;if(i!==null){if(this.stallReported){var u=self.performance.now()-i;F["logger"].warn("playback not stuck anymore @"+a+", after "+Math.round(u)+"ms");this.stallReported=false}this.stalled=null;this.nudgeRetry=0}return}if(l||o)this.stalled=null;if(n.paused||n.ended||n.playbackRate===0||!n.buffered.length)return;var c=j.bufferInfo(n,a,0);var d=c.len>0;var f=c.nextStart||0;if(!d&&!f)return;if(s){var h=c.len>G;var p=!f||f-a>G&&!this.fragmentTracker.getPartialFragment(a);if(h||p)return;this.moved=false}if(!this.moved&&this.stalled){var v=Math.max(f,c.start||0)-a;if(v>0&&v<=G){this._trySkipBufferHole(null);return}}var g=self.performance.now();if(i===null){this.stalled=g;return}var A=g-i;if(!s&&A>=Xe)this._reportStall(c.len);var m=j.bufferInfo(n,a,r.maxBufferHole);this._tryFixBufferStall(m,A)};t._tryFixBufferStall=function e(t,r){var n=this.config,i=this.fragmentTracker,a=this.media;var s=a.currentTime;var o=i.getPartialFragment(s);if(o){var l=this._trySkipBufferHole(o);if(l)return}if(t.len>n.maxBufferHole&&r>n.highBufferWatchdogPeriod*1e3){F["logger"].warn("Trying to nudge playhead over buffer-hole");this.stalled=null;this._tryNudgeBuffer()}};t._reportStall=function e(t){var r=this.hls,n=this.media,i=this.stallReported;if(!i){this.stallReported=true;F["logger"].warn("Playback stalling at @"+n.currentTime+" due to low buffer (buffer="+t+")");r.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].BUFFER_STALLED_ERROR,fatal:false,buffer:t})}};t._trySkipBufferHole=function e(t){var r=this.config,n=this.hls,i=this.media;var a=i.currentTime;var s=0;for(var o=0;o<i.buffered.length;o++){var l=i.buffered.start(o);if(a+r.maxBufferHole>=s&&a<l){var u=Math.max(l+Qe,i.currentTime+Ze);F["logger"].warn("skipping hole, adjusting currentTime from "+a+" to "+u);this.moved=true;this.stalled=null;i.currentTime=u;if(t)n.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].BUFFER_SEEK_OVER_HOLE,fatal:false,reason:"fragment loaded with buffer holes, seeking from "+a+" to "+u,frag:t});return u}s=i.buffered.end(o)}return 0};t._tryNudgeBuffer=function e(){var t=this.config,r=this.hls,n=this.media;var i=n.currentTime;var a=(this.nudgeRetry||0)+1;this.nudgeRetry=a;if(a<t.nudgeMaxRetry){var s=i+a*t.nudgeOffset;F["logger"].warn("Nudging 'currentTime' from "+i+" to "+s);n.currentTime=s;r.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].BUFFER_NUDGE_ON_STALL,fatal:false})}else{F["logger"].error("Playhead still not moving while enough data buffered @"+i+" after "+t.nudgeMaxRetry+" nudges");r.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].BUFFER_STALLED_ERROR,fatal:true})}};return e}();function et(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var rt=function(a){tt(e,a);function e(e){var t;for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t=a.call.apply(a,[this,e].concat(n))||this;t._boundTick=void 0;t._tickTimer=null;t._tickInterval=null;t._tickCallCount=0;t._boundTick=t.tick.bind(et(t));return t}var t=e.prototype;t.onHandlerDestroying=function e(){this.clearNextTick();this.clearInterval()};t.hasInterval=function e(){return!!this._tickInterval};t.hasNextTick=function e(){return!!this._tickTimer};t.setInterval=function e(t){if(!this._tickInterval){this._tickInterval=self.setInterval(this._boundTick,t);return true}return false};t.clearInterval=function e(){if(this._tickInterval){self.clearInterval(this._tickInterval);this._tickInterval=null;return true}return false};t.clearNextTick=function e(){if(this._tickTimer){self.clearTimeout(this._tickTimer);this._tickTimer=null;return true}return false};t.tick=function e(){this._tickCallCount++;if(this._tickCallCount===1){this.doTick();if(this._tickCallCount>1){this.clearNextTick();this._tickTimer=self.setTimeout(this._boundTick,0)}this._tickCallCount=0}};t.doTick=function e(){};return e}(i);function nt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var K={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var it=function(t){nt(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;r.doTick=function e(){};r.startLoad=function e(){};r.stopLoad=function e(){var t=this.fragCurrent;if(t){if(t.loader)t.loader.abort();this.fragmentTracker.removeFragment(t)}if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.fragCurrent=null;this.fragPrevious=null;this.clearInterval();this.clearNextTick();this.state=K.STOPPED};r._streamEnded=function e(t,r){var n=this.fragCurrent,i=this.fragmentTracker;if(!r.live&&n&&!n.backtracked&&n.sn===r.endSN&&!t.nextStart){var a=i.getState(n);return a===B.PARTIAL||a===B.OK}return false};r.onMediaSeeking=function e(){var t=this.config,r=this.media,n=this.mediaBuffer,i=this.state;var a=r?r.currentTime:null;var s=j.bufferInfo(n||r,a,this.config.maxBufferHole);F["logger"].log("media seeking to "+(Object(x["isFiniteNumber"])(a)?a.toFixed(3):a));if(i===K.FRAG_LOADING){var o=this.fragCurrent;if(s.len===0&&o){var l=t.maxFragLookUpTolerance;var u=o.start-l;var c=o.start+o.duration+l;if(a<u||a>c){if(o.loader){F["logger"].log("seeking outside of buffer while fragment load in progress, cancel fragment load");o.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;this.state=K.IDLE}else F["logger"].log("seeking outside of buffer but within currently loaded fragment range")}}else if(i===K.ENDED){if(s.len===0){this.fragPrevious=null;this.fragCurrent=null}this.state=K.IDLE}if(r)this.lastCurrentTime=a;if(!this.loadedmetadata)this.nextLoadPosition=this.startPosition=a;this.tick()};r.onMediaEnded=function e(){this.startPosition=this.lastCurrentTime=0};r.onHandlerDestroying=function e(){this.stopLoad();t.prototype.onHandlerDestroying.call(this)};r.onHandlerDestroyed=function e(){this.state=K.STOPPED;this.fragmentTracker=null};r.computeLivePosition=function e(t,r){var n=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*r.targetduration;return t+Math.max(0,r.totalduration-n)};return e}(rt);function at(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function st(e,t,r){if(t)at(e.prototype,t);if(r)at(e,r);return e}function ot(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var lt=100;var ut=function(n){ot(e,n);function e(e,t){var r;r=n.call(this,e,M["default"].MEDIA_ATTACHED,M["default"].MEDIA_DETACHING,M["default"].MANIFEST_LOADING,M["default"].MANIFEST_PARSED,M["default"].LEVEL_LOADED,M["default"].LEVELS_UPDATED,M["default"].KEY_LOADED,M["default"].FRAG_LOADED,M["default"].FRAG_LOAD_EMERGENCY_ABORTED,M["default"].FRAG_PARSING_INIT_SEGMENT,M["default"].FRAG_PARSING_DATA,M["default"].FRAG_PARSED,M["default"].ERROR,M["default"].AUDIO_TRACK_SWITCHING,M["default"].AUDIO_TRACK_SWITCHED,M["default"].BUFFER_CREATED,M["default"].BUFFER_APPENDED,M["default"].BUFFER_FLUSHED)||this;r.fragmentTracker=t;r.config=e.config;r.audioCodecSwap=false;r._state=K.STOPPED;r.stallReported=false;r.gapController=null;r.altAudio=false;r.audioOnly=false;r.bitrateTest=false;return r}var t=e.prototype;t.startLoad=function e(t){if(this.levels){var r=this.lastCurrentTime,n=this.hls;this.stopLoad();this.setInterval(lt);this.level=-1;this.fragLoadError=0;if(!this.startFragRequested){var i=n.startLevel;if(i===-1)if(n.config.testBandwidth){i=0;this.bitrateTest=true}else i=n.nextAutoLevel;this.level=n.nextLoadLevel=i;this.loadedmetadata=false}if(r>0&&t===-1){F["logger"].log("override startPosition with lastCurrentTime @"+r.toFixed(3));t=r}this.state=K.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t;this.tick()}else{this.forceStartLoad=true;this.state=K.STOPPED}};t.stopLoad=function e(){this.forceStartLoad=false;n.prototype.stopLoad.call(this)};t.doTick=function e(){switch(this.state){case K.BUFFER_FLUSHING:this.fragLoadError=0;break;case K.IDLE:this._doTickIdle();break;case K.WAITING_LEVEL:var t=this.levels[this.level];if(t&&t.details)this.state=K.IDLE;break;case K.FRAG_LOADING_WAITING_RETRY:var r=window.performance.now();var n=this.retryDate;if(!n||r>=n||this.media&&this.media.seeking){F["logger"].log("mediaController: retryDate reached, switch back to IDLE state");this.state=K.IDLE}break}this._checkBuffer();this._checkFragmentChanged()};t._doTickIdle=function e(){var t=this.hls,r=t.config,n=this.media;if(this.levelLastLoaded===undefined||!n&&(this.startFragRequested||!r.startFragPrefetch))return;if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var i;if(this.loadedmetadata)i=n.currentTime;else i=this.nextLoadPosition;var a=t.nextLoadLevel,s=this.levels[a];if(!s)return;var o=s.bitrate,l;if(o)l=Math.max(8*r.maxBufferSize/o,r.maxBufferLength);else l=r.maxBufferLength;l=Math.min(l,r.maxMaxBufferLength);var u=i<r.maxBufferHole?Math.max(G,r.maxBufferHole):r.maxBufferHole;var c=j.bufferInfo(this.mediaBuffer?this.mediaBuffer:n,i,u);var d=c.len;if(d>=l)return;F["logger"].trace("buffer length of "+d.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ...");this.level=t.nextLoadLevel=a;var f=s.details;if(!f||f.live&&this.levelLastLoaded!==a){this.state=K.WAITING_LEVEL;return}if(this._streamEnded(c,f)){var h={};if(this.altAudio)h.type="video";this.hls.trigger(M["default"].BUFFER_EOS,h);this.state=K.ENDED;return}this._fetchPayloadOrEos(i,c,f)};t._fetchPayloadOrEos=function e(t,r,n){var i=this.fragPrevious;this.level;var a=n.fragments,s=a.length;if(s===0)return;var o=a[0].start,l=a[s-1].start+a[s-1].duration,u=r.end,c;if(n.initSegment&&!n.initSegment.data)c=n.initSegment;else if(n.live){var d=this.config.initialLiveManifestSize;if(s<d){F["logger"].warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+d);return}c=this._ensureFragmentAtLivePoint(n,u,o,l,i,a);if(c===null)return}else if(u<o)c=a[0];if(!c)c=this._findFragment(o,i,s,a,u,l,n);if(c)if(c.encrypted)this._loadKey(c,n);else this._loadFragment(c,n,t,u)};t._ensureFragmentAtLivePoint=function e(t,r,n,i,a,s){var o=this.hls.config,l=this.media;var u;var c=Infinity;if(o.liveMaxLatencyDuration!==undefined)c=o.liveMaxLatencyDuration;else if(Object(x["isFiniteNumber"])(o.liveMaxLatencyDurationCount))c=o.liveMaxLatencyDurationCount*t.targetduration;if(r<Math.max(n-o.maxFragLookUpTolerance,i-c)){var d=this.liveSyncPosition=this.computeLivePosition(n,t);r=d;if(l&&!l.paused&&l.readyState&&l.duration>d&&d>l.currentTime){F["logger"].log("buffer end: "+r.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+d.toFixed(3));l.currentTime=d}this.nextLoadPosition=d}if(t.PTSKnown&&r>i&&l&&l.readyState)return null;if(this.startFragRequested&&!t.PTSKnown)if(a)if(t.hasProgramDateTime){F["logger"].log("live playlist, switching playlist, load frag with same PDT: "+a.programDateTime);u=$e(s,a.endProgramDateTime,o.maxFragLookUpTolerance)}else{var f=a.sn+1;if(f>=t.startSN&&f<=t.endSN){var h=s[f-t.startSN];if(a.cc===h.cc){u=h;F["logger"].log("live playlist, switching playlist, load frag with next SN: "+u.sn)}}if(!u){u=U.search(s,function(e){return a.cc-e.cc});if(u)F["logger"].log("live playlist, switching playlist, load frag with same CC: "+u.sn)}}return u};t._findFragment=function e(t,r,n,i,a,s,o){var l=this.hls.config;var u;if(a<s){var c=a>s-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;u=We(r,i,a,c)}else u=i[n-1];if(u){var d=u.sn-o.startSN;var f=r&&u.level===r.level;var h=i[d-1];var p=i[d+1];if(r&&u.sn===r.sn)if(f&&!u.backtracked)if(u.sn<o.endSN){var v=r.deltaPTS;if(v&&v>l.maxBufferHole&&r.dropped&&d){u=h;F["logger"].warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")}else{u=p;if(this.fragmentTracker.getState(u)!==B.OK)F["logger"].log("Re-loading fragment with SN: "+u.sn)}}else u=null;else if(u.backtracked)if(p&&p.backtracked){F["logger"].warn("Already backtracked from fragment "+p.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+p.sn);u=p}else{F["logger"].warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe");u.dropped=0;if(h){u=h;u.backtracked=true}else if(d)u=null}}return u};t._loadKey=function e(t,r){F["logger"].log("Loading key for "+t.sn+" of ["+r.startSN+"-"+r.endSN+"], level "+this.level);this.state=K.KEY_LOADING;this.hls.trigger(M["default"].KEY_LOADING,{frag:t})};t._loadFragment=function e(t,r,n,i){var a=this.fragmentTracker.getState(t);this.fragCurrent=t;if(t.sn!=="initSegment")this.startFragRequested=true;if(Object(x["isFiniteNumber"])(t.sn)&&!t.bitrateTest)this.nextLoadPosition=t.start+t.duration;if(t.backtracked||a===B.NOT_LOADED||a===B.PARTIAL){t.autoLevel=this.hls.autoLevelEnabled;t.bitrateTest=this.bitrateTest;F["logger"].log("Loading "+t.sn+" of ["+r.startSN+"-"+r.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(n.toFixed(3))+", bufferEnd: "+parseFloat(i.toFixed(3)));this.hls.trigger(M["default"].FRAG_LOADING,{frag:t});if(!this.demuxer)this.demuxer=new v(this.hls,"main");this.state=K.FRAG_LOADING}else if(a===B.APPENDING)if(this._reduceMaxBufferLength(t.duration))this.fragmentTracker.removeFragment(t)};t.getBufferedFrag=function e(t){return this.fragmentTracker.getBufferedFrag(t,a.MAIN)};t.followingBufferedFrag=function e(t){if(t)return this.getBufferedFrag(t.endPTS+.5);return null};t._checkFragmentChanged=function e(){var t,r,n=this.media;if(n&&n.readyState&&n.seeking===false){r=n.currentTime;if(r>this.lastCurrentTime)this.lastCurrentTime=r;if(j.isBuffered(n,r))t=this.getBufferedFrag(r);else if(j.isBuffered(n,r+.1))t=this.getBufferedFrag(r+.1);if(t){var i=t;if(i!==this.fragPlaying){this.hls.trigger(M["default"].FRAG_CHANGED,{frag:i});var a=i.level;if(!this.fragPlaying||this.fragPlaying.level!==a)this.hls.trigger(M["default"].LEVEL_SWITCHED,{level:a});this.fragPlaying=i}}}};t.immediateLevelSwitch=function e(){F["logger"].log("immediateLevelSwitch");if(!this.immediateSwitch){this.immediateSwitch=true;var t=this.media,r;if(t){r=t.paused;if(!r)t.pause()}else r=true;this.previouslyPaused=r}var n=this.fragCurrent;if(n&&n.loader)n.loader.abort();this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)};t.immediateLevelSwitchEnd=function e(){var t=this.media;if(t&&t.buffered.length){this.immediateSwitch=false;if(t.currentTime>0&&j.isBuffered(t,t.currentTime))t.currentTime-=1e-4;if(!this.previouslyPaused)t.play()}};t.nextLevelSwitch=function e(){var t=this.media;if(t&&t.readyState){var r;var n=this.getBufferedFrag(t.currentTime);if(n&&n.startPTS>1)this.flushMainBuffer(0,n.startPTS-1);if(!t.paused){var i=this.hls.nextLoadLevel,a=this.levels[i],s=this.fragLastKbps;if(s&&this.fragCurrent)r=this.fragCurrent.duration*a.bitrate/(1e3*s)+1;else r=0}else r=0;var o=this.getBufferedFrag(t.currentTime+r);if(o){var l=this.followingBufferedFrag(o);if(l){var u=this.fragCurrent;if(u&&u.loader)u.loader.abort();this.fragCurrent=null;var c=Math.max(o.endPTS,l.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,l.duration));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}};t.flushMainBuffer=function e(t,r){this.state=K.BUFFER_FLUSHING;var n={startOffset:t,endOffset:r};if(this.altAudio)n.type="video";this.hls.trigger(M["default"].BUFFER_FLUSHING,n)};t.onMediaAttached=function e(t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("seeked",this.onvseeked);r.addEventListener("ended",this.onvended);var n=this.config;if(this.levels&&n.autoStartLoad)this.hls.startLoad(n.startPosition);this.gapController=new Je(n,r,this.fragmentTracker,this.hls)};t.onMediaDetaching=function e(){var t=this.media;if(t&&t.ended){F["logger"].log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}var r=this.levels;if(r)r.forEach(function(e){if(e.details)e.details.fragments.forEach(function(e){e.backtracked=undefined})});if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("seeked",this.onvseeked);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.fragmentTracker.removeAllFragments();this.media=this.mediaBuffer=null;this.loadedmetadata=false;this.stopLoad()};t.onMediaSeeked=function e(){var t=this.media;var r=t?t.currentTime:undefined;if(Object(x["isFiniteNumber"])(r))F["logger"].log("media seeked to "+r.toFixed(3));this.tick()};t.onManifestLoading=function e(){F["logger"].log("trigger BUFFER_RESET");this.hls.trigger(M["default"].BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=false;this.startPosition=this.lastCurrentTime=0};t.onManifestParsed=function e(t){var r=false,n=false,i;t.levels.forEach(function(e){i=e.audioCodec;if(i){if(i.indexOf("mp4a.40.2")!==-1)r=true;if(i.indexOf("mp4a.40.5")!==-1)n=true}});this.audioCodecSwitch=r&&n;if(this.audioCodecSwitch)F["logger"].log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.altAudio=t.altAudio;this.levels=t.levels;this.startFragRequested=false;var a=this.config;if(a.autoStartLoad||this.forceStartLoad)this.hls.startLoad(a.startPosition)};t.onLevelLoaded=function e(t){var r=t.details;var n=t.level;var i=this.levels[this.levelLastLoaded];var a=this.levels[n];var s=r.totalduration;var o=0;F["logger"].log("level "+n+" loaded ["+r.startSN+","+r.endSN+"],duration:"+s);if(r.live||a.details&&a.details.live){var l=a.details;if(l&&r.fragments.length>0){De(l,r);o=r.fragments[0].start;this.liveSyncPosition=this.computeLivePosition(o,l);if(r.PTSKnown&&Object(x["isFiniteNumber"])(o))F["logger"].log("live playlist sliding:"+o.toFixed(3));else{F["logger"].log("live playlist - outdated PTS, unknown sliding");Ye(this.fragPrevious,i,r)}}else{F["logger"].log("live playlist - first load, unknown sliding");r.PTSKnown=false;Ye(this.fragPrevious,i,r)}}else r.PTSKnown=false;a.details=r;this.levelLastLoaded=n;this.hls.trigger(M["default"].LEVEL_UPDATED,{details:r,level:n});if(this.startFragRequested===false){if(this.startPosition===-1||this.lastCurrentTime===-1){var u=r.startTimeOffset;if(Object(x["isFiniteNumber"])(u)){if(u<0){F["logger"].log("negative start time offset "+u+", count from end of last fragment");u=o+s+u}F["logger"].log("start time offset found in playlist, adjust startPosition to "+u);this.startPosition=u}else if(r.live){this.startPosition=this.computeLivePosition(o,r);F["logger"].log("configure startPosition to "+this.startPosition)}else this.startPosition=0;this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}if(this.state===K.WAITING_LEVEL)this.state=K.IDLE;this.tick()};t.onKeyLoaded=function e(){if(this.state===K.KEY_LOADING){this.state=K.IDLE;this.tick()}};t.onFragLoaded=function e(t){var r=this.fragCurrent,n=this.hls,i=this.levels,a=this.media;var s=t.frag;if(this.state===K.FRAG_LOADING&&r&&s.type==="main"&&s.level===r.level&&s.sn===r.sn){var o=t.stats;var l=i[r.level];var u=l.details;this.bitrateTest=false;this.stats=o;F["logger"].log("Loaded "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+r.level);if(s.bitrateTest&&n.nextLoadLevel){this.state=K.IDLE;this.startFragRequested=false;o.tparsed=o.tbuffered=window.performance.now();n.trigger(M["default"].FRAG_BUFFERED,{stats:o,frag:r,id:"main"});this.tick()}else if(s.sn==="initSegment"){this.state=K.IDLE;o.tparsed=o.tbuffered=window.performance.now();u.initSegment.data=t.payload;n.trigger(M["default"].FRAG_BUFFERED,{stats:o,frag:r,id:"main"});this.tick()}else{F["logger"].log("Parsing "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+r.level+", cc "+r.cc);this.state=K.PARSING;this.pendingBuffering=true;this.appended=false;if(s.bitrateTest){s.bitrateTest=false;this.fragmentTracker.onFragLoaded({frag:s})}var c=!(a&&a.seeking)&&(u.PTSKnown||!u.live);var d=u.initSegment?u.initSegment.data:[];var f=this._getAudioCodec(l);var h=this.demuxer=this.demuxer||new v(this.hls,"main");h.push(t.payload,d,f,l.videoCodec,r,u.totalduration,c)}}this.fragLoadError=0};t.onFragParsingInitSegment=function e(t){var r=this.fragCurrent;var n=t.frag;if(r&&t.id==="main"&&n.sn===r.sn&&n.level===r.level&&this.state===K.PARSING){var i=t.tracks,a,s;this.audioOnly=i.audio&&!i.video;if(this.altAudio&&!this.audioOnly)delete i.audio;s=i.audio;if(s){var o=this.levels[this.level].audioCodec,l=navigator.userAgent.toLowerCase();if(o&&this.audioCodecSwap){F["logger"].log("swapping playlist audio codec");if(o.indexOf("mp4a.40.5")!==-1)o="mp4a.40.2";else o="mp4a.40.5"}if(this.audioCodecSwitch)if(s.metadata.channelCount!==1&&l.indexOf("firefox")===-1)o="mp4a.40.5";if(l.indexOf("android")!==-1&&s.container!=="audio/mpeg"){o="mp4a.40.2";F["logger"].log("Android: force audio codec to "+o)}s.levelCodec=o;s.id=t.id}s=i.video;if(s){s.levelCodec=this.levels[this.level].videoCodec;s.id=t.id}this.hls.trigger(M["default"].BUFFER_CODECS,i);for(a in i){s=i[a];F["logger"].log("main track:"+a+",container:"+s.container+",codecs[level/parsed]=["+s.levelCodec+"/"+s.codec+"]");var u=s.initSegment;if(u){this.appended=true;this.pendingBuffering=true;this.hls.trigger(M["default"].BUFFER_APPENDING,{type:a,data:u,parent:"main",content:"initSegment"})}}this.tick()}};t.onFragParsingData=function e(t){var r=this;var n=this.fragCurrent;var i=t.frag;if(n&&t.id==="main"&&i.sn===n.sn&&i.level===n.level&&!(t.type==="audio"&&this.altAudio)&&this.state===K.PARSING){var a=this.levels[this.level],s=n;if(!Object(x["isFiniteNumber"])(t.endPTS)){t.endPTS=t.startPTS+n.duration;t.endDTS=t.startDTS+n.duration}if(t.hasAudio===true)s.addElementaryStream(f.AUDIO);if(t.hasVideo===true)s.addElementaryStream(f.VIDEO);F["logger"].log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0));if(t.type==="video"){s.dropped=t.dropped;if(s.dropped)if(!s.backtracked){var o=a.details;if(o&&s.sn===o.startSN)F["logger"].warn("missing video frame(s) on first frag, appending with gap",s.sn);else{F["logger"].warn("missing video frame(s), backtracking fragment",s.sn);this.fragmentTracker.removeFragment(s);s.backtracked=true;this.nextLoadPosition=t.startPTS;this.state=K.IDLE;this.fragPrevious=s;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.tick();return}}else F["logger"].warn("Already backtracked on this fragment, appending with the gap",s.sn);else s.backtracked=false}var l=Ie(a.details,s,t.startPTS,t.endPTS,t.startDTS,t.endDTS),u=this.hls;u.trigger(M["default"].LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:l,type:t.type,start:t.startPTS,end:t.endPTS});[t.data1,t.data2].forEach(function(e){if(e&&e.length&&r.state===K.PARSING){r.appended=true;r.pendingBuffering=true;u.trigger(M["default"].BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"})}});this.tick()}};t.onFragParsed=function e(t){var r=this.fragCurrent;var n=t.frag;if(r&&t.id==="main"&&n.sn===r.sn&&n.level===r.level&&this.state===K.PARSING){this.stats.tparsed=window.performance.now();this.state=K.PARSED;this._checkAppendedParsed()}};t.onAudioTrackSwitching=function e(t){var r=this.altAudio;var n=!!t.url;var i=t.id;if(!n){if(this.mediaBuffer!==this.media){F["logger"].log("switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var a=this.fragCurrent;if(a.loader){F["logger"].log("switching to main audio track, cancel main fragment load");a.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=K.IDLE}var s=this.hls;if(r)s.trigger(M["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"});s.trigger(M["default"].AUDIO_TRACK_SWITCHED,{id:i})}};t.onAudioTrackSwitched=function e(t){var r=t.id,n=!!this.hls.audioTracks[r].url;if(n){var i=this.videoBuffer;if(i&&this.mediaBuffer!==i){F["logger"].log("switching on alternate audio, use video.buffered to schedule main fragment loading");this.mediaBuffer=i}}this.altAudio=n;this.tick()};t.onBufferCreated=function e(t){var r=t.tracks,n,i,a=false;for(var s in r){var o=r[s];if(o.id==="main"){i=s;n=o;if(s==="video")this.videoBuffer=r[s].buffer}else a=true}if(a&&n){F["logger"].log("alternate track found, use "+i+".buffered to schedule main fragment loading");this.mediaBuffer=n.buffer}else this.mediaBuffer=this.media};t.onBufferAppended=function e(t){if(t.parent==="main"){var r=this.state;if(r===K.PARSING||r===K.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};t._checkAppendedParsed=function e(){if(this.state===K.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var r=this.mediaBuffer?this.mediaBuffer:this.media;F["logger"].log("main buffered : "+Be.toString(r.buffered));this.fragPrevious=t;var n=this.stats;n.tbuffered=window.performance.now();this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst));this.hls.trigger(M["default"].FRAG_BUFFERED,{stats:n,frag:t,id:"main"});this.state=K.IDLE}if(this.loadedmetadata||this.startPosition<=0)this.tick()}};t.onError=function e(t){var r=t.frag||this.fragCurrent;if(r&&r.type!=="main")return;var n=!!this.media&&j.isBuffered(this.media,this.media.currentTime)&&j.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case A["ErrorDetails"].FRAG_LOAD_ERROR:case A["ErrorDetails"].FRAG_LOAD_TIMEOUT:case A["ErrorDetails"].KEY_LOAD_ERROR:case A["ErrorDetails"].KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);F["logger"].warn("mediaController: frag loading failed, retry in "+i+" ms");this.retryDate=window.performance.now()+i;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.fragLoadError++;this.state=K.FRAG_LOADING_WAITING_RETRY}else{F["logger"].error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ...");t.fatal=true;this.state=K.ERROR}break;case A["ErrorDetails"].LEVEL_LOAD_ERROR:case A["ErrorDetails"].LEVEL_LOAD_TIMEOUT:if(this.state!==K.ERROR)if(t.fatal){this.state=K.ERROR;F["logger"].warn("streamController: "+t.details+",switch to "+this.state+" state ...")}else if(!t.levelRetry&&this.state===K.WAITING_LEVEL)this.state=K.IDLE;break;case A["ErrorDetails"].BUFFER_FULL_ERROR:if(t.parent==="main"&&(this.state===K.PARSING||this.state===K.PARSED))if(n){this._reduceMaxBufferLength(this.config.maxBufferLength);this.state=K.IDLE}else{F["logger"].warn("buffer full error also media.currentTime is not buffered, flush everything");this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}break}};t._reduceMaxBufferLength=function e(t){var r=this.config;if(r.maxMaxBufferLength>=t){r.maxMaxBufferLength/=2;F["logger"].warn("main:reduce max buffer length to "+r.maxMaxBufferLength+"s");return true}return false};t._checkBuffer=function e(){var t=this.media;if(!t||t.readyState===0)return;var r=this.mediaBuffer?this.mediaBuffer:t;var n=r.buffered;if(!this.loadedmetadata&&n.length){this.loadedmetadata=true;this._seekToStartPos()}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else this.gapController.poll(this.lastCurrentTime,n)};t.onFragLoadEmergencyAborted=function e(){this.state=K.IDLE;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.tick()};t.onBufferFlushed=function e(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var r=this.audioOnly?f.AUDIO:f.VIDEO;this.fragmentTracker.detectEvictedFragments(r,t.buffered)}this.state=K.IDLE;this.fragPrevious=null};t.onLevelsUpdated=function e(t){this.levels=t.levels};t.swapAudioCodec=function e(){this.audioCodecSwap=!this.audioCodecSwap};t._seekToStartPos=function e(){var t=this.media;var r=t.currentTime;var n=this.startPosition;if(r!==n&&n>=0){if(t.seeking){F["logger"].log("could not seek to "+n+", already seeking at "+r);return}var i=t.buffered.length?t.buffered.start(0):0;var a=i-n;if(a>0&&a<this.config.maxBufferHole){F["logger"].log("adjusting start position by "+a+" to match buffer start");n+=a;this.startPosition=n}F["logger"].log("seek to target start position "+n+" from current time "+r+". ready state "+t.readyState);t.currentTime=n}};t._getAudioCodec=function e(t){var r=this.config.defaultAudioCodec||t.audioCodec;if(this.audioCodecSwap){F["logger"].log("swapping playlist audio codec");if(r)if(r.indexOf("mp4a.40.5")!==-1)r="mp4a.40.2";else r="mp4a.40.5"}return r};st(e,[{key:"state",set:function e(t){if(this.state!==t){var r=this.state;this._state=t;F["logger"].log("main stream-controller: "+r+"->"+t);this.hls.trigger(M["default"].STREAM_STATE_TRANSITION,{previousState:r,nextState:t})}},get:function e(){return this._state}},{key:"currentLevel",get:function e(){var t=this.media;if(t){var r=this.getBufferedFrag(t.currentTime);if(r)return r.level}return-1}},{key:"nextBufferedFrag",get:function e(){var t=this.media;if(t)return this.followingBufferedFrag(this.getBufferedFrag(t.currentTime));else return null}},{key:"nextLevel",get:function e(){var t=this.nextBufferedFrag;if(t)return t.level;else return-1}},{key:"liveSyncPosition",get:function e(){return this._liveSyncPosition},set:function e(t){this._liveSyncPosition=t}}]);return e}(it);var ct=ut;function dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function ft(e,t,r){if(t)dt(e.prototype,t);if(r)dt(e,r);return e}function ht(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var pt;var vt=function(r){ht(e,r);function e(e){var t;t=r.call(this,e,M["default"].MANIFEST_LOADED,M["default"].LEVEL_LOADED,M["default"].AUDIO_TRACK_SWITCHED,M["default"].FRAG_LOADED,M["default"].ERROR)||this;t.canload=false;t.currentLevelIndex=null;t.manualLevelIndex=-1;t.timer=null;pt=/chrome|firefox/.test(navigator.userAgent.toLowerCase());return t}var t=e.prototype;t.onHandlerDestroying=function e(){this.clearTimer();this.manualLevelIndex=-1};t.clearTimer=function e(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null}};t.startLoad=function e(){var t=this._levels;this.canload=true;this.levelRetryCount=0;if(t)t.forEach(function(e){e.loadError=0;var t=e.details;if(t&&t.live)e.details=undefined});if(this.timer!==null)this.loadLevel()};t.stopLoad=function e(){this.canload=false};t.onManifestLoaded=function e(t){var r=[];var n=[];var i;var a={};var s=null;var o=false;var l=false;t.levels.forEach(function(e){var t=e.attrs;e.loadError=0;e.fragmentError=false;o=o||!!e.videoCodec;l=l||!!e.audioCodec;if(pt&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1)e.audioCodec=undefined;s=a[e.bitrate];if(!s){e.url=[e.url];e.urlId=0;a[e.bitrate]=e;r.push(e)}else s.url.push(e.url);if(t){if(t.AUDIO)Oe(s||e,"audio",t.AUDIO);if(t.SUBTITLES)Oe(s||e,"text",t.SUBTITLES)}});if(o&&l)r=r.filter(function(e){var t=e.videoCodec;return!!t});r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||d(t,"audio"))&&(!r||d(r,"video"))});if(t.audioTracks){n=t.audioTracks.filter(function(e){return!e.audioCodec||d(e.audioCodec,"audio")});n.forEach(function(e,t){e.id=t})}if(r.length>0){i=r[0].bitrate;r.sort(function(e,t){return e.bitrate-t.bitrate});this._levels=r;for(var u=0;u<r.length;u++)if(r[u].bitrate===i){this._firstLevel=u;F["logger"].log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+i);break}var c=l&&!o;this.hls.trigger(M["default"].MANIFEST_PARSED,{levels:r,audioTracks:n,firstLevel:this._firstLevel,stats:t.stats,audio:l,video:o,altAudio:!c&&n.some(function(e){return!!e.url})})}else this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:true,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})};t.setLevelInternal=function e(t){var r=this._levels;var n=this.hls;if(t>=0&&t<r.length){this.clearTimer();if(this.currentLevelIndex!==t){F["logger"].log("switching to level "+t);this.currentLevelIndex=t;var i=r[t];i.level=t;n.trigger(M["default"].LEVEL_SWITCHING,i)}var a=r[t];var s=a.details;if(!s||s.live){var o=a.urlId;n.trigger(M["default"].LEVEL_LOADING,{url:a.url[o],level:t,id:o})}}else n.trigger(M["default"].ERROR,{type:A["ErrorTypes"].OTHER_ERROR,details:A["ErrorDetails"].LEVEL_SWITCH_ERROR,level:t,fatal:false,reason:"invalid level idx"})};t.onError=function e(t){if(t.fatal){if(t.type===A["ErrorTypes"].NETWORK_ERROR)this.clearTimer();return}var r=false,n=false;var i;switch(t.details){case A["ErrorDetails"].FRAG_LOAD_ERROR:case A["ErrorDetails"].FRAG_LOAD_TIMEOUT:case A["ErrorDetails"].KEY_LOAD_ERROR:case A["ErrorDetails"].KEY_LOAD_TIMEOUT:i=t.frag.level;n=true;break;case A["ErrorDetails"].LEVEL_LOAD_ERROR:case A["ErrorDetails"].LEVEL_LOAD_TIMEOUT:i=t.context.level;r=true;break;case A["ErrorDetails"].REMUX_ALLOC_ERROR:i=t.level;r=true;break}if(i!==undefined)this.recoverLevel(t,i,r,n)};t.recoverLevel=function e(t,r,n,i){var a=this;var s=this.hls.config;var o=t.details;var l=this._levels[r];var u,c,d;l.loadError++;l.fragmentError=i;if(n)if(this.levelRetryCount+1<=s.levelLoadingMaxRetry){c=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return a.loadLevel()},c);t.levelRetry=true;this.levelRetryCount++;F["logger"].warn("level controller, "+o+", retry in "+c+" ms, current retry count is "+this.levelRetryCount)}else{F["logger"].error("level controller, cannot recover from "+o+" error");this.currentLevelIndex=null;this.clearTimer();t.fatal=true;return}if(n||i){u=l.url.length;if(u>1&&l.loadError<u){l.urlId=(l.urlId+1)%u;l.details=undefined;F["logger"].warn("level controller, "+o+" for level "+r+": switching to redundant URL-id "+l.urlId)}else if(this.manualLevelIndex===-1){d=r===0?this._levels.length-1:r-1;F["logger"].warn("level controller, "+o+": switch to "+d);this.hls.nextAutoLevel=this.currentLevelIndex=d}else if(i){F["logger"].warn("level controller, "+o+": reload a fragment");this.currentLevelIndex=null}}};t.onFragLoaded=function e(t){var r=t.frag;if(r!==undefined&&r.type==="main"){var n=this._levels[r.level];if(n!==undefined){n.fragmentError=false;n.loadError=0;this.levelRetryCount=0}}};t.onLevelLoaded=function e(t){var r=this;var n=t.level,i=t.details;if(n!==this.currentLevelIndex)return;var a=this._levels[n];if(!a.fragmentError){a.loadError=0;this.levelRetryCount=0}if(i.live){var s=Me(a.details,i,t.stats.trequest);F["logger"].log("live playlist, reload in "+Math.round(s)+" ms");this.timer=setTimeout(function(){return r.loadLevel()},s)}else this.clearTimer()};t.onAudioTrackSwitched=function e(t){var r=this.hls.audioTracks[t.id].groupId;var n=this.hls.levels[this.currentLevelIndex];if(!n)return;if(n.audioGroupIds){var i=-1;for(var a=0;a<n.audioGroupIds.length;a++)if(n.audioGroupIds[a]===r){i=a;break}if(i!==n.urlId){n.urlId=i;this.startLoad()}}};t.loadLevel=function e(){F["logger"].debug("call to loadLevel");if(this.currentLevelIndex!==null&&this.canload){var t=this._levels[this.currentLevelIndex];if(typeof t==="object"&&t.url.length>0){var r=this.currentLevelIndex;var n=t.urlId;var i=t.url[n];F["logger"].log("Attempt loading level index "+r+" with URL-id "+n);this.hls.trigger(M["default"].LEVEL_LOADING,{url:i,level:r,id:n})}}};t.removeLevel=function e(r,n){var t=this.levels.filter(function(e,t){if(t!==r)return true;if(e.url.length>1&&n!==undefined){e.url=e.url.filter(function(e,t){return t!==n});e.urlId=0;return true}return false}).map(function(e,t){var r=e.details;if(r&&r.fragments)r.fragments.forEach(function(e){e.level=t});return e});this._levels=t;this.hls.trigger(M["default"].LEVELS_UPDATED,{levels:t})};ft(e,[{key:"levels",get:function e(){return this._levels}},{key:"level",get:function e(){return this.currentLevelIndex},set:function e(t){var r=this._levels;if(r){t=Math.min(t,r.length-1);if(this.currentLevelIndex!==t||!r[t].details)this.setLevelInternal(t)}}},{key:"manualLevel",get:function e(){return this.manualLevelIndex},set:function e(t){this.manualLevelIndex=t;if(this._startLevel===undefined)this._startLevel=t;if(t!==-1)this.level=t}},{key:"firstLevel",get:function e(){return this._firstLevel},set:function e(t){this._firstLevel=t}},{key:"startLevel",get:function e(){if(this._startLevel===undefined){var t=this.hls.config.startLevel;if(t!==undefined)return t;else return this._firstLevel}else return this._startLevel},set:function e(t){this._startLevel=t}},{key:"nextLoadLevel",get:function e(){if(this.manualLevelIndex!==-1)return this.manualLevelIndex;else return this.hls.nextAutoLevel},set:function e(t){this.level=t;if(this.manualLevelIndex===-1)this.hls.nextAutoLevel=t}}]);return e}(i);var gt=e("./src/demux/id3.js");function At(e,t){var r;try{r=new Event("addtrack")}catch(e){r=document.createEvent("Event");r.initEvent("addtrack",false,false)}r.track=e;t.dispatchEvent(r)}function c(e){if(e===null||e===void 0?void 0:e.cues)while(e.cues.length>0)e.removeCue(e.cues[0])}function mt(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];var r=0;var n=e.length-1;while(r<=n){var i=Math.floor((n+r)/2);if(t<e[i].endTime)n=i-1;else if(t>e[i].endTime)r=i+1;else return e[i]}return e[r].endTime-t<t-e[n].endTime?e[r]:e[n]}function yt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Et=.25;var bt=function(r){yt(e,r);function e(e){var t;t=r.call(this,e,M["default"].MEDIA_ATTACHED,M["default"].MEDIA_DETACHING,M["default"].FRAG_PARSING_METADATA,M["default"].LIVE_BACK_BUFFER_REACHED)||this;t.id3Track=undefined;t.media=undefined;return t}var t=e.prototype;t.destroy=function e(){i.prototype.destroy.call(this)};t.onMediaAttached=function e(t){this.media=t.media;if(!this.media);};t.onMediaDetaching=function e(){c(this.id3Track);this.id3Track=undefined;this.media=undefined};t.getID3Track=function e(t){for(var r=0;r<t.length;r++){var n=t[r];if(n.kind==="metadata"&&n.label==="id3"){At(n,this.media);return n}}return this.media.addTextTrack("metadata","id3")};t.onFragParsingMetadata=function e(t){var r=t.frag;var n=t.samples;if(!this.id3Track){this.id3Track=this.getID3Track(this.media.textTracks);this.id3Track.mode="hidden"}var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue;for(var a=0;a<n.length;a++){var s=gt["default"].getID3Frames(n[a].data);if(s){var o=Math.max(n[a].pts,0);var l=a<n.length-1?n[a+1].pts:r.endPTS;if(!l)l=r.start+r.duration;var u=l-o;if(u<=0)l=o+Et;for(var c=0;c<s.length;c++){var d=s[c];if(!gt["default"].isTimeStampFrame(d)){var f=new i(o,l,"");f.value=d;this.id3Track.addCue(f)}}}}};t.onLiveBackBufferReached=function e(t){var r=t.bufferEnd;var n=this.id3Track;if(!n||!n.cues||!n.cues.length)return;var i=mt(n.cues,r);if(!i)return;while(n.cues[0]!==i)n.removeCue(n.cues[0])};return e}(i);var kt=bt;function _t(){var e=s();if(!e)return false;var t=self.SourceBuffer||self.WebKitSourceBuffer;var r=e&&typeof e.isTypeSupported==="function"&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');var n=!t||t.prototype&&typeof t.prototype.appendBuffer==="function"&&typeof t.prototype.remove==="function";return!!r&&!!n}var Tt=function(){function e(e){this.alpha_=void 0;this.estimate_=void 0;this.totalWeight_=void 0;this.alpha_=e?Math.exp(Math.log(.5)/e):0;this.estimate_=0;this.totalWeight_=0}var t=e.prototype;t.sample=function e(t,r){var n=Math.pow(this.alpha_,t);this.estimate_=r*(1-n)+n*this.estimate_;this.totalWeight_+=t};t.getTotalWeight=function e(){return this.totalWeight_};t.getEstimate=function e(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}else return this.estimate_};return e}();var St=Tt;var Ct=function(){function e(e,t,r,n){this.hls=void 0;this.defaultEstimate_=void 0;this.minWeight_=void 0;this.minDelayMs_=void 0;this.slow_=void 0;this.fast_=void 0;this.hls=e;this.defaultEstimate_=n;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new St(t);this.fast_=new St(r)}var t=e.prototype;t.sample=function e(t,r){t=Math.max(t,this.minDelayMs_);var n=8*r,i=t/1e3,a=n/i;this.fast_.sample(i,a);this.slow_.sample(i,a)};t.canEstimate=function e(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_};t.getEstimate=function e(){if(this.canEstimate())return Math.min(this.fast_.getEstimate(),this.slow_.getEstimate());else return this.defaultEstimate_};t.destroy=function e(){};return e}();var Rt=Ct;function wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function Ot(e,t,r){if(t)wt(e.prototype,t);if(r)wt(e,r);return e}function Lt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function It(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Dt=window,Pt=Dt.performance;var Nt=function(r){It(e,r);function e(e){var t;t=r.call(this,e,M["default"].FRAG_LOADING,M["default"].FRAG_LOADED,M["default"].FRAG_BUFFERED,M["default"].ERROR)||this;t.lastLoadedFragLevel=0;t._nextAutoLevel=-1;t.hls=e;t.timer=null;t._bwEstimator=null;t.onCheck=t._abandonRulesCheck.bind(Lt(t));return t}var t=e.prototype;t.destroy=function e(){this.clearTimer();i.prototype.destroy.call(this)};t.onFragLoading=function e(t){var r=t.frag;if(r.type==="main"){if(!this.timer){this.fragCurrent=r;this.timer=setInterval(this.onCheck,100)}if(!this._bwEstimator){var n=this.hls;var i=n.config;var a=r.level;var s=n.levels[a].details.live;var o;var l;if(s){o=i.abrEwmaFastLive;l=i.abrEwmaSlowLive}else{o=i.abrEwmaFastVoD;l=i.abrEwmaSlowVoD}this._bwEstimator=new Rt(n,l,o,i.abrEwmaDefaultEstimate)}}};t._abandonRulesCheck=function e(){var t=this.hls;var r=t.media;var n=this.fragCurrent;if(!n)return;var i=n.loader;if(!i||i.stats&&i.stats.aborted){F["logger"].warn("frag loader destroy or aborted, disarm abandonRules");this.clearTimer();this._nextAutoLevel=-1;return}var a=i.stats;if(r&&a&&(!r.paused&&r.playbackRate!==0||!r.readyState)&&n.autoLevel&&n.level){var s=Pt.now()-a.trequest;var o=Math.abs(r.playbackRate);if(s>500*n.duration/o){var l=t.levels;var u=Math.max(1,a.bw?a.bw/8:a.loaded*1e3/s);var c=l[n.level];if(!c)return;var d=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate;var f=a.total?a.total:Math.max(a.loaded,Math.round(n.duration*d/8));var h=r.currentTime;var p=(f-a.loaded)/u;var v=(j.bufferInfo(r,h,t.config.maxBufferHole).end-h)/o;if(v<2*n.duration/o&&p>v){var g=t.minAutoLevel;var A;var m;for(m=n.level-1;m>g;m--){var y=l[m].realBitrate?Math.max(l[m].realBitrate,l[m].bitrate):l[m].bitrate;var E=n.duration*y/(8*.8*u);if(E<v)break}if(A<p){F["logger"].warn("loading too slow, abort fragment loading and switch to level "+m+":fragLoadedDelay["+m+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+A.toFixed(1)+"<"+p.toFixed(1)+":"+v.toFixed(1));t.nextLoadLevel=m;this._bwEstimator.sample(s,a.loaded);i.abort();this.clearTimer();t.trigger(M["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:a})}}}}};t.onFragLoaded=function e(t){var r=t.frag;if(r.type==="main"&&Object(x["isFiniteNumber"])(r.sn)){this.clearTimer();this.lastLoadedFragLevel=r.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){var n=this.hls.levels[r.level];var i=(n.loaded?n.loaded.bytes:0)+t.stats.loaded;var a=(n.loaded?n.loaded.duration:0)+t.frag.duration;n.loaded={bytes:i,duration:a};n.realBitrate=Math.round(8*i/a)}if(t.frag.bitrateTest){var s=t.stats;s.tparsed=s.tbuffered=s.tload;this.onFragBuffered(t)}}};t.onFragBuffered=function e(t){var r=t.stats;var n=t.frag;if(r.aborted!==true&&n.type==="main"&&Object(x["isFiniteNumber"])(n.sn)&&(!n.bitrateTest||r.tload===r.tbuffered)){var i=r.tparsed-r.trequest;F["logger"].log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest)));this._bwEstimator.sample(i,r.loaded);r.bwEstimate=this._bwEstimator.getEstimate();if(n.bitrateTest)this.bitrateTestDelay=i/1e3;else this.bitrateTestDelay=0}};t.onError=function e(t){switch(t.details){case A["ErrorDetails"].FRAG_LOAD_ERROR:case A["ErrorDetails"].FRAG_LOAD_TIMEOUT:this.clearTimer();break}};t.clearTimer=function e(){clearInterval(this.timer);this.timer=null};t._findBestLevel=function e(t,r,n,i,a,s,o,l,u){for(var c=a;c>=i;c--){var d=u[c];if(!d)continue;var f=d.details;var h=f?f.totalduration/f.fragments.length:r;var p=f?f.live:false;var v=void 0;if(c<=t)v=o*n;else v=l*n;var g=u[c].realBitrate?Math.max(u[c].realBitrate,u[c].bitrate):u[c].bitrate;var A=g*h/v;F["logger"].trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(v)+"/"+g+"/"+h+"/"+s+"/"+A);if(v>g&&(!A||p&&!this.bitrateTestDelay||A<s))return c}return-1};Ot(e,[{key:"nextAutoLevel",get:function e(){var t=this._nextAutoLevel;var r=this._bwEstimator;if(t!==-1&&(!r||!r.canEstimate()))return t;var n=this._nextABRAutoLevel;if(t!==-1)n=Math.min(t,n);return n},set:function e(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function e(){var t=this.hls;var r=t.maxAutoLevel,n=t.levels,i=t.config,a=t.minAutoLevel;var s=t.media;var o=this.lastLoadedFragLevel;var l=this.fragCurrent?this.fragCurrent.duration:0;var u=s?s.currentTime:0;var c=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1;var d=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate;var f=(j.bufferInfo(s,u,i.maxBufferHole).end-u)/c;var h=this._findBestLevel(o,l,d,a,r,f,i.abrBandWidthFactor,i.abrBandWidthUpFactor,n);if(h>=0)return h;else{F["logger"].trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=l?Math.min(l,i.maxStarvationDelay):i.maxStarvationDelay;var v=i.abrBandWidthFactor;var g=i.abrBandWidthUpFactor;if(f===0){var A=this.bitrateTestDelay;if(A){var m=l?Math.min(l,i.maxLoadingDelay):i.maxLoadingDelay;p=m-A;F["logger"].trace("bitrate test took "+Math.round(1e3*A)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms");v=g=1}}h=this._findBestLevel(o,l,d,a,r,f+p,v,g,n);return Math.max(h,0)}}}]);return e}(i);var xt=Nt;function Mt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Ft=s();var Bt=function(t){Mt(e,t);function e(e){var o;o=t.call(this,e,M["default"].MEDIA_ATTACHING,M["default"].MEDIA_DETACHING,M["default"].MANIFEST_PARSED,M["default"].BUFFER_RESET,M["default"].BUFFER_APPENDING,M["default"].BUFFER_CODECS,M["default"].BUFFER_EOS,M["default"].BUFFER_FLUSHING,M["default"].LEVEL_PTS_UPDATED,M["default"].LEVEL_UPDATED)||this;o._msDuration=null;o._levelDuration=null;o._levelTargetDuration=10;o._live=null;o._objectUrl=null;o._needsFlush=false;o._needsEos=false;o.config=void 0;o.audioTimestampOffset=void 0;o.bufferCodecEventsExpected=0;o._bufferCodecEventsTotal=0;o.media=null;o.mediaSource=null;o.segments=[];o.parent=void 0;o.appending=false;o.appended=0;o.appendError=0;o.flushBufferCounter=0;o.tracks={};o.pendingTracks={};o.sourceBuffer={};o.flushRange=[];o._onMediaSourceOpen=function(){F["logger"].log("media source opened");o.hls.trigger(M["default"].MEDIA_ATTACHED,{media:o.media});var e=o.mediaSource;if(e)e.removeEventListener("sourceopen",o._onMediaSourceOpen);o.checkPendingTracks()};o._onMediaSourceClose=function(){F["logger"].log("media source closed")};o._onMediaSourceEnded=function(){F["logger"].log("media source ended")};o._onSBUpdateEnd=function(){if(o.audioTimestampOffset&&o.sourceBuffer.audio){var e=o.sourceBuffer.audio;F["logger"].warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+o.audioTimestampOffset);e.timestampOffset=o.audioTimestampOffset;delete o.audioTimestampOffset}if(o._needsFlush)o.doFlush();if(o._needsEos)o.checkEos();o.appending=false;var r=o.parent;var t=o.segments.reduce(function(e,t){return t.parent===r?e+1:e},0);var n={};var i=o.sourceBuffer;for(var a in i){var s=i[a];if(!s)throw Error("handling source buffer update end error: source buffer for "+a+" uninitilized and unable to update buffered TimeRanges.");n[a]=s.buffered}o.hls.trigger(M["default"].BUFFER_APPENDED,{parent:r,pending:t,timeRanges:n});if(!o._needsFlush)o.doAppending();o.updateMediaElementDuration();if(t===0)o.flushLiveBackBuffer()};o._onSBUpdateError=function(e){F["logger"].error("sourceBuffer error:",e);o.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].BUFFER_APPENDING_ERROR,fatal:false})};o.config=e.config;return o}var r=e.prototype;r.destroy=function e(){i.prototype.destroy.call(this)};r.onLevelPtsUpdated=function e(t){var r=t.type;var n=this.tracks.audio;if(r==="audio"&&n&&n.container==="audio/mpeg"){var i=this.sourceBuffer.audio;if(!i)throw Error("Level PTS Updated and source buffer for audio uninitalized");var a=Math.abs(i.timestampOffset-t.start);if(a>.1){var s=i.updating;try{i.abort()}catch(e){F["logger"].warn("can not abort audio buffer: "+e)}if(!s){F["logger"].warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+t.start);i.timestampOffset=t.start}else this.audioTimestampOffset=t.start}}};r.onManifestParsed=function e(t){var r=2;if(t.audio&&!t.video||!t.altAudio)r=1;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r;F["logger"].log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")};r.onMediaAttaching=function e(t){var r=this.media=t.media;if(r&&Ft){var n=this.mediaSource=new Ft;n.addEventListener("sourceopen",this._onMediaSourceOpen);n.addEventListener("sourceended",this._onMediaSourceEnded);n.addEventListener("sourceclose",this._onMediaSourceClose);r.src=window.URL.createObjectURL(n);this._objectUrl=r.src}};r.onMediaDetaching=function e(){F["logger"].log("media source detaching");var t=this.mediaSource;if(t){if(t.readyState==="open")try{t.endOfStream()}catch(e){F["logger"].warn("onMediaDetaching:"+e.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen);t.removeEventListener("sourceended",this._onMediaSourceEnded);t.removeEventListener("sourceclose",this._onMediaSourceClose);if(this.media){if(this._objectUrl)window.URL.revokeObjectURL(this._objectUrl);if(this.media.src===this._objectUrl){this.media.removeAttribute("src");this.media.load()}else F["logger"].warn("media.src was changed by a third party - skip cleanup")}this.mediaSource=null;this.media=null;this._objectUrl=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.hls.trigger(M["default"].MEDIA_DETACHED)};r.checkPendingTracks=function e(){var t=this.bufferCodecEventsExpected,r=this.pendingTracks;var n=Object.keys(r).length;if(n&&!t||n===2){this.createSourceBuffers(r);this.pendingTracks={};this.doAppending()}};r.onBufferReset=function e(){var t=this.sourceBuffer;for(var r in t){var n=t[r];try{if(n){if(this.mediaSource)this.mediaSource.removeSourceBuffer(n);n.removeEventListener("updateend",this._onSBUpdateEnd);n.removeEventListener("error",this._onSBUpdateError)}}catch(e){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0};r.onBufferCodecs=function e(t){var r=this;if(Object.keys(this.sourceBuffer).length)return;Object.keys(t).forEach(function(e){r.pendingTracks[e]=t[e]});this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0);if(this.mediaSource&&this.mediaSource.readyState==="open")this.checkPendingTracks()};r.createSourceBuffers=function e(t){var r=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(var i in t)if(!r[i]){var a=t[i];if(!a)throw Error("source buffer exists for track "+i+", however track does not");var s=a.levelCodec||a.codec;var o=a.container+";codecs="+s;F["logger"].log("creating sourceBuffer("+o+")");try{var l=r[i]=n.addSourceBuffer(o);l.addEventListener("updateend",this._onSBUpdateEnd);l.addEventListener("error",this._onSBUpdateError);this.tracks[i]={buffer:l,codec:s,id:a.id,container:a.container,levelCodec:a.levelCodec}}catch(e){F["logger"].error("error while trying to add sourceBuffer:"+e.message);this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].BUFFER_ADD_CODEC_ERROR,fatal:false,err:e,mimeType:o})}}this.hls.trigger(M["default"].BUFFER_CREATED,{tracks:this.tracks})};r.onBufferAppending=function e(t){if(!this._needsFlush){if(!this.segments)this.segments=[t];else this.segments.push(t);this.doAppending()}};r.onBufferEos=function e(t){for(var r in this.sourceBuffer)if(!t.type||t.type===r){var n=this.sourceBuffer[r];if(n&&!n.ended){n.ended=true;F["logger"].log(r+" sourceBuffer now EOS")}}this.checkEos()};r.checkEos=function e(){var t=this.sourceBuffer,r=this.mediaSource;if(!r||r.readyState!=="open"){this._needsEos=false;return}for(var n in t){var i=t[n];if(!i)continue;if(!i.ended)return;if(i.updating){this._needsEos=true;return}}F["logger"].log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{r.endOfStream()}catch(e){F["logger"].warn("exception while calling mediaSource.endOfStream()")}this._needsEos=false};r.onBufferFlushing=function e(t){if(t.type)this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type});else{this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"});this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})}this.flushBufferCounter=0;this.doFlush()};r.flushLiveBackBuffer=function e(){if(!this._live)return;var t=this.config.liveBackBufferLength;if(!isFinite(t)||t<0)return;if(!this.media){F["logger"].error("flushLiveBackBuffer called without attaching media");return}var r=this.media.currentTime;var n=this.sourceBuffer;var i=Object.keys(n);var a=r-Math.max(t,this._levelTargetDuration);for(var s=i.length-1;s>=0;s--){var o=i[s];var l=n[o];if(l){var u=l.buffered;if(u.length>0&&a>u.start(0))if(this.removeBufferRange(o,l,0,a))this.hls.trigger(M["default"].LIVE_BACK_BUFFER_REACHED,{bufferEnd:a})}}};r.onLevelUpdated=function e(t){var r=t.details;if(r.fragments.length>0){this._levelDuration=r.totalduration+r.fragments[0].start;this._levelTargetDuration=r.averagetargetduration||r.targetduration||10;this._live=r.live;this.updateMediaElementDuration()}};r.updateMediaElementDuration=function e(){var t=this.config;var r;if(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open")return;for(var n in this.sourceBuffer){var i=this.sourceBuffer[n];if(i&&i.updating===true)return}r=this.media.duration;if(this._msDuration===null)this._msDuration=this.mediaSource.duration;if(this._live===true&&t.liveDurationInfinity===true){F["logger"].log("Media Source duration is set to Infinity");this._msDuration=this.mediaSource.duration=Infinity}else if(this._levelDuration>this._msDuration&&this._levelDuration>r||!Object(x["isFiniteNumber"])(r)){F["logger"].log("Updating Media Source duration to "+this._levelDuration.toFixed(3));this._msDuration=this.mediaSource.duration=this._levelDuration}};r.doFlush=function e(){while(this.flushRange.length){var t=this.flushRange[0];if(this.flushBuffer(t.start,t.end,t.type)){this.flushRange.shift();this.flushBufferCounter=0}else{this._needsFlush=true;return}}if(this.flushRange.length===0){this._needsFlush=false;var r=0;var n=this.sourceBuffer;try{for(var i in n){var a=n[i];if(a)r+=a.buffered.length}}catch(e){F["logger"].error("error while accessing sourceBuffer.buffered")}this.appended=r;this.hls.trigger(M["default"].BUFFER_FLUSHED)}};r.doAppending=function e(){var t=this.config,r=this.hls,n=this.segments,i=this.sourceBuffer;if(!Object.keys(i).length)return;if(!this.media||this.media.error){this.segments=[];F["logger"].error("trying to append although a media error occured, flush segment and abort");return}if(this.appending)return;var a=n.shift();if(!a)return;try{var s=i[a.type];if(!s){this._onSBUpdateEnd();return}if(s.updating){n.unshift(a);return}s.ended=false;this.parent=a.parent;s.appendBuffer(a.data);this.appendError=0;this.appended++;this.appending=true}catch(e){F["logger"].error("error while trying to append buffer:"+e.message);n.unshift(a);var o={type:A["ErrorTypes"].MEDIA_ERROR,parent:a.parent,details:"",fatal:false};if(e.code===22){this.segments=[];o.details=A["ErrorDetails"].BUFFER_FULL_ERROR}else{this.appendError++;o.details=A["ErrorDetails"].BUFFER_APPEND_ERROR;if(this.appendError>t.appendErrorMaxRetry){F["logger"].log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer");this.segments=[];o.fatal=true}}r.trigger(M["default"].ERROR,o)}};r.flushBuffer=function e(t,r,n){var i=this.sourceBuffer;if(!Object.keys(i).length)return true;var a="null";if(this.media)a=this.media.currentTime.toFixed(3);F["logger"].log("flushBuffer,pos/start/end: "+a+"/"+t+"/"+r);if(this.flushBufferCounter>=this.appended){F["logger"].warn("abort flushing too many retries");return true}var s=i[n];if(s){s.ended=false;if(!s.updating){if(this.removeBufferRange(n,s,t,r)){this.flushBufferCounter++;return false}}else{F["logger"].warn("cannot flush, sb updating in progress");return false}}F["logger"].log("buffer flushed");return true};r.removeBufferRange=function e(t,r,n,i){try{for(var a=0;a<r.buffered.length;a++){var s=r.buffered.start(a);var o=r.buffered.end(a);var l=Math.max(s,n);var u=Math.min(o,i);if(Math.min(u,o)-l>.5){var c="null";if(this.media)c=this.media.currentTime.toString();F["logger"].log("sb remove "+t+" ["+l+","+u+"], of ["+s+","+o+"], pos:"+c);r.remove(l,u);return true}}}catch(e){F["logger"].warn("removeBufferRange failed",e)}return false};return e}(i);var Ut=Bt;function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function Vt(e,t,r){if(t)jt(e.prototype,t);if(r)jt(e,r);return e}function Gt(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Kt=function(r){Gt(i,r);function i(e){var t;t=r.call(this,e,M["default"].FPS_DROP_LEVEL_CAPPING,M["default"].MEDIA_ATTACHING,M["default"].MANIFEST_PARSED,M["default"].LEVELS_UPDATED,M["default"].BUFFER_CODECS,M["default"].MEDIA_DETACHING)||this;t.autoLevelCapping=Number.POSITIVE_INFINITY;t.firstLevel=null;t.levels=[];t.media=null;t.restrictedLevels=[];t.timer=null;t.clientRect=null;return t}var e=i.prototype;e.destroy=function e(){if(this.hls.config.capLevelToPlayerSize){this.media=null;this.clientRect=null;this.stopCapping()}};e.onFpsDropLevelCapping=function e(t){if(i.isLevelAllowed(t.droppedLevel,this.restrictedLevels))this.restrictedLevels.push(t.droppedLevel)};e.onMediaAttaching=function e(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null};e.onManifestParsed=function e(t){var r=this.hls;this.restrictedLevels=[];this.levels=t.levels;this.firstLevel=t.firstLevel;if(r.config.capLevelToPlayerSize&&t.video)this.startCapping()};e.onBufferCodecs=function e(t){var r=this.hls;if(r.config.capLevelToPlayerSize&&t.video)this.startCapping()};e.onLevelsUpdated=function e(t){this.levels=t.levels};e.onMediaDetaching=function e(){this.stopCapping()};e.detectPlayerSize=function e(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var r=this.hls;r.autoLevelCapping=this.getMaxLevel(t-1);if(r.autoLevelCapping>this.autoLevelCapping)r.streamController.nextLevelSwitch();this.autoLevelCapping=r.autoLevelCapping}}};e.getMaxLevel=function e(r){var n=this;if(!this.levels)return-1;var t=this.levels.filter(function(e,t){return i.isLevelAllowed(t,n.restrictedLevels)&&t<=r});this.clientRect=null;return i.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)};e.startCapping=function e(){if(this.timer)return;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.hls.firstLevel=this.getMaxLevel(this.firstLevel);clearInterval(this.timer);this.timer=setInterval(this.detectPlayerSize.bind(this),1e3);this.detectPlayerSize()};e.stopCapping=function e(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;if(this.timer){this.timer=clearInterval(this.timer);this.timer=null}};e.getDimensions=function e(){if(this.clientRect)return this.clientRect;var t=this.media;var r={width:0,height:0};if(t){var n=t.getBoundingClientRect();r.width=n.width;r.height=n.height;if(!r.width&&!r.height){r.width=n.right-n.left||t.width||0;r.height=n.bottom-n.top||t.height||0}}this.clientRect=r;return r};i.isLevelAllowed=function e(t,r){if(r===void 0)r=[];return r.indexOf(t)===-1};i.getMaxLevelByMediaSize=function e(t,r,n){if(!t||t&&!t.length)return-1;var i=function e(t,r){if(!r)return true;return t.width!==r.width||t.height!==r.height};var a=t.length-1;for(var s=0;s<t.length;s+=1){var o=t[s];if((o.width>=r||o.height>=n)&&i(o,t[s+1])){a=s;break}}return a};Vt(i,[{key:"mediaWidth",get:function e(){return this.getDimensions().width*i.contentScaleFactor}},{key:"mediaHeight",get:function e(){return this.getDimensions().height*i.contentScaleFactor}}],[{key:"contentScaleFactor",get:function e(){var t=1;try{t=window.devicePixelRatio}catch(e){}return t}}]);return i}(i);var Yt=Kt;function Ht(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var zt=window,$t=zt.performance;var Wt=function(t){Ht(e,t);function e(e){return t.call(this,e,M["default"].MEDIA_ATTACHING)||this}var r=e.prototype;r.destroy=function e(){if(this.timer)clearInterval(this.timer);this.isVideoPlaybackQualityAvailable=false};r.onMediaAttaching=function e(t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=this.video=t.media instanceof window.HTMLVideoElement?t.media:null;if(typeof n.getVideoPlaybackQuality==="function")this.isVideoPlaybackQualityAvailable=true;clearInterval(this.timer);this.timer=setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}};r.checkFPS=function e(t,r,n){var i=$t.now();if(r){if(this.lastTime){var a=i-this.lastTime,s=n-this.lastDroppedFrames,o=r-this.lastDecodedFrames,l=1e3*s/a,u=this.hls;u.trigger(M["default"].FPS_DROP,{currentDropped:s,currentDecoded:o,totalDroppedFrames:n});if(l>0)if(s>u.config.fpsDroppedMonitoringThreshold*o){var c=u.currentLevel;F["logger"].warn("drop FPS ratio greater than max allowed value for currentLevel: "+c);if(c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)){c=c-1;u.trigger(M["default"].FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel});u.autoLevelCapping=c;u.streamController.nextLevelSwitch()}}}this.lastTime=i;this.lastDroppedFrames=n;this.lastDecodedFrames=r}};r.checkFPSInterval=function e(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var r=t.getVideoPlaybackQuality();this.checkFPS(t,r.totalVideoFrames,r.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)};return e}(i);var qt=Wt;var Xt=function(){function e(e){if(e&&e.xhrSetup)this.xhrSetup=e.xhrSetup}var t=e.prototype;t.destroy=function e(){this.abort();this.loader=null};t.abort=function e(){var t=this.loader;if(t&&t.readyState!==4){this.stats.aborted=true;t.abort()}window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null};t.load=function e(t,r,n){this.context=t;this.config=r;this.callbacks=n;this.stats={trequest:window.performance.now(),retry:0};this.retryDelay=r.retryDelay;this.loadInternal()};t.loadInternal=function e(){var t,r=this.context;t=this.loader=new window.XMLHttpRequest;var n=this.stats;n.tfirst=0;n.loaded=0;var i=this.xhrSetup;try{if(i)try{i(t,r.url)}catch(e){t.open("GET",r.url,true);i(t,r.url)}if(!t.readyState)t.open("GET",r.url,true)}catch(e){this.callbacks.onError({code:t.status,text:e.message},r,t);return}if(r.rangeEnd)t.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1));t.onreadystatechange=this.readystatechange.bind(this);t.onprogress=this.loadprogress.bind(this);t.responseType=r.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);t.send()};t.readystatechange=function e(t){var r=t.currentTarget,n=r.readyState,i=this.stats,a=this.context,s=this.config;if(i.aborted)return;if(n>=2){window.clearTimeout(this.requestTimeout);if(i.tfirst===0)i.tfirst=Math.max(window.performance.now(),i.trequest);if(n===4){var o=r.status;if(o>=200&&o<300){i.tload=Math.max(i.tfirst,window.performance.now());var l,u;if(a.responseType==="arraybuffer"){l=r.response;u=l.byteLength}else{l=r.responseText;u=l.length}i.loaded=i.total=u;var c={url:r.responseURL,data:l};this.callbacks.onSuccess(c,i,a,r)}else if(i.retry>=s.maxRetry||o>=400&&o<499){F["logger"].error(o+" while loading "+a.url);this.callbacks.onError({code:o,text:r.statusText},a,r)}else{F["logger"].warn(o+" while loading "+a.url+", retrying in "+this.retryDelay+"...");this.destroy();this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay);this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay);i.retry++}}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)}};t.loadtimeout=function e(){F["logger"].warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)};t.loadprogress=function e(t){var r=t.currentTarget,n=this.stats;n.loaded=t.loaded;if(t.lengthComputable)n.total=t.total;var i=this.callbacks.onProgress;if(i)i(n,this.context,null,r)};return e}();var Zt=Xt;function Qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function Jt(e,t,r){if(t)Qt(e.prototype,t);if(r)Qt(e,r);return e}function er(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var tr=function(r){er(e,r);function e(e){var t;t=r.call(this,e,M["default"].MANIFEST_LOADING,M["default"].MANIFEST_PARSED,M["default"].AUDIO_TRACK_LOADED,M["default"].AUDIO_TRACK_SWITCHED,M["default"].LEVEL_LOADED,M["default"].ERROR)||this;t._trackId=-1;t._selectDefaultTrack=true;t.tracks=[];t.trackIdBlacklist=Object.create(null);t.audioGroupId=null;return t}var t=e.prototype;t.onManifestLoading=function e(){this.tracks=[];this._trackId=-1;this._selectDefaultTrack=true};t.onManifestParsed=function e(t){var r=this.tracks=t.audioTracks||[];this.hls.trigger(M["default"].AUDIO_TRACKS_UPDATED,{audioTracks:r});this._selectAudioGroup(this.hls.nextLoadLevel)};t.onAudioTrackLoaded=function e(t){if(t.id>=this.tracks.length){F["logger"].warn("Invalid audio track id:",t.id);return}F["logger"].log("audioTrack "+t.id+" loaded");this.tracks[t.id].details=t.details;if(t.details.live&&!this.hasInterval()){var r=t.details.targetduration*1e3;this.setInterval(r)}if(!t.details.live&&this.hasInterval())this.clearInterval()};t.onAudioTrackSwitched=function e(t){var r=this.tracks[t.id].groupId;if(r&&this.audioGroupId!==r)this.audioGroupId=r};t.onLevelLoaded=function e(t){this._selectAudioGroup(t.level)};t.onError=function e(t){if(t.type!==A["ErrorTypes"].NETWORK_ERROR)return;if(t.fatal)this.clearInterval();if(t.details!==A["ErrorDetails"].AUDIO_TRACK_LOAD_ERROR)return;F["logger"].warn("Network failure on audio-track id:",t.context.id);this._handleLoadError()};t._setAudioTrack=function e(t){if(this._trackId===t&&this.tracks[this._trackId].details){F["logger"].debug("Same id as current audio-track passed, and track details available -> no-op");return}if(t<0||t>=this.tracks.length){F["logger"].warn("Invalid id passed to audio-track controller");return}var r=this.tracks[t];F["logger"].log("Now switching to audio-track index "+t);this.clearInterval();this._trackId=t;var n=r.url,i=r.type,a=r.id;this.hls.trigger(M["default"].AUDIO_TRACK_SWITCHING,{id:a,type:i,url:n});this._loadTrackDetailsIfNeeded(r)};t.doTick=function e(){this._updateTrack(this._trackId)};t._selectAudioGroup=function e(t){var r=this.hls.levels[t];if(!r||!r.audioGroupIds)return;var n=r.audioGroupIds[r.urlId];if(this.audioGroupId!==n){this.audioGroupId=n;this._selectInitialAudioTrack()}};t._selectInitialAudioTrack=function e(){var t=this;var r=this.tracks;if(!r.length)return;var n=this.tracks[this._trackId];var i=null;if(n)i=n.name;if(this._selectDefaultTrack){var a=r.filter(function(e){return e.default});if(a.length)r=a;else F["logger"].warn("No default audio tracks defined")}var s=false;var o=function e(){r.forEach(function(e){if(s)return;if((!t.audioGroupId||e.groupId===t.audioGroupId)&&(!i||i===e.name)){t._setAudioTrack(e.id);s=true}})};o();if(!s){i=null;o()}if(!s){F["logger"].error("No track found for running audio group-ID: "+this.audioGroupId);this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:A["ErrorDetails"].AUDIO_TRACK_LOAD_ERROR,fatal:true})}};t._needsTrackLoading=function e(t){var r=t.details,n=t.url;if(!r||r.live)return!!n;return false};t._loadTrackDetailsIfNeeded=function e(t){if(this._needsTrackLoading(t)){var r=t.url,n=t.id;F["logger"].log("loading audio-track playlist for id: "+n);this.hls.trigger(M["default"].AUDIO_TRACK_LOADING,{url:r,id:n})}};t._updateTrack=function e(t){if(t<0||t>=this.tracks.length)return;this.clearInterval();this._trackId=t;F["logger"].log("trying to update audio-track "+t);var r=this.tracks[t];this._loadTrackDetailsIfNeeded(r)};t._handleLoadError=function e(){this.trackIdBlacklist[this._trackId]=true;var t=this._trackId;var r=this.tracks[t],n=r.name,i=r.language,a=r.groupId;F["logger"].warn("Loading failed on audio track id: "+t+", group-id: "+a+', name/language: "'+n+'" / "'+i+'"');var s=t;for(var o=0;o<this.tracks.length;o++){if(this.trackIdBlacklist[o])continue;var l=this.tracks[o];if(l.name===n){s=o;break}}if(s===t){F["logger"].warn('No fallback audio-track found for name/language: "'+n+'" / "'+i+'"');return}F["logger"].log("Attempting audio-track fallback id:",s,"group-id:",this.tracks[s].groupId);this._setAudioTrack(s)};Jt(e,[{key:"audioTracks",get:function e(){return this.tracks}},{key:"audioTrack",get:function e(){return this._trackId},set:function e(t){this._setAudioTrack(t);this._selectDefaultTrack=false}}]);return e}(rt);var rr=tr;function nr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function ir(e,t,r){if(t)nr(e.prototype,t);if(r)nr(e,r);return e}function ar(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var sr=window,Y=sr.performance;var or=100;var lr=function(n){ar(e,n);function e(e,t){var r;r=n.call(this,e,M["default"].MEDIA_ATTACHED,M["default"].MEDIA_DETACHING,M["default"].AUDIO_TRACKS_UPDATED,M["default"].AUDIO_TRACK_SWITCHING,M["default"].AUDIO_TRACK_LOADED,M["default"].KEY_LOADED,M["default"].FRAG_LOADED,M["default"].FRAG_PARSING_INIT_SEGMENT,M["default"].FRAG_PARSING_DATA,M["default"].FRAG_PARSED,M["default"].ERROR,M["default"].BUFFER_RESET,M["default"].BUFFER_CREATED,M["default"].BUFFER_APPENDED,M["default"].BUFFER_FLUSHED,M["default"].INIT_PTS_FOUND)||this;r.fragmentTracker=t;r.config=e.config;r.audioCodecSwap=false;r._state=K.STOPPED;r.initPTS=[];r.waitingFragment=null;r.videoTrackCC=null;r.waitingVideoCC=null;return r}var t=e.prototype;t.onInitPtsFound=function e(t){var r=t.id,n=t.frag.cc,i=t.initPTS;if(r==="main"){this.initPTS[n]=i;this.videoTrackCC=n;F["logger"].log("InitPTS for cc: "+n+" found from main: "+i);if(this.state===K.WAITING_INIT_PTS)this.tick()}};t.startLoad=function e(t){if(this.tracks){var r=this.lastCurrentTime;this.stopLoad();this.setInterval(or);this.fragLoadError=0;if(r>0&&t===-1){F["logger"].log("audio:override startPosition with lastCurrentTime @"+r.toFixed(3));this.state=K.IDLE}else{this.lastCurrentTime=this.startPosition?this.startPosition:t;this.state=K.STARTING}this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else{this.startPosition=t;this.state=K.STOPPED}};t.doTick=function e(){var t,r,n,i=this.hls,a=i.config;switch(this.state){case K.ERROR:case K.PAUSED:case K.BUFFER_FLUSHING:break;case K.STARTING:this.state=K.WAITING_TRACK;this.loadedmetadata=false;break;case K.IDLE:var s=this.tracks;if(!s)break;if(!this.media&&(this.startFragRequested||!a.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else{t=this.nextLoadPosition;if(t===undefined)break}var o=this.mediaBuffer?this.mediaBuffer:this.media;var l=this.videoBuffer?this.videoBuffer:this.media;var u=t<a.maxBufferHole?Math.max(G,a.maxBufferHole):a.maxBufferHole;var c=j.bufferInfo(o,t,u);var d=j.bufferInfo(l,t,u);var f=c.len;var h=c.end;var p=this.fragPrevious;var v=Math.min(a.maxBufferLength,a.maxMaxBufferLength);var g=Math.max(v,d.len);var A=this.audioSwitch;var m=this.trackId;if((f<g||A)&&m<s.length){n=s[m].details;if(typeof n==="undefined"){this.state=K.WAITING_TRACK;break}if(!A&&this._streamEnded(c,n)){this.hls.trigger(M["default"].BUFFER_EOS,{type:"audio"});this.state=K.ENDED;return}var y=n.fragments,E=y.length,b=y[0].start,k=y[E-1].start+y[E-1].duration,_;if(A)if(n.live&&!n.PTSKnown){F["logger"].log("switching audiotrack, live stream, unknown PTS,load first fragment");h=0}else{h=t;if(n.PTSKnown&&t<b)if(c.end>b||c.nextStart){F["logger"].log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=b+.05}else return}if(n.initSegment&&!n.initSegment.data)_=n.initSegment;else if(h<=b){_=y[0];if(this.videoTrackCC!==null&&_.cc!==this.videoTrackCC)_=je(y,this.videoTrackCC);if(n.live&&_.loadIdx&&_.loadIdx===this.fragLoadIdx){var T=c.nextStart?c.nextStart:b;F["logger"].log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(T+.05));this.media.currentTime=T+.05;return}}else{var S;var C=a.maxFragLookUpTolerance;var R=p?y[p.sn-y[0].sn+1]:undefined;if(h<k){if(h>k-C)C=0;if(R&&!V(h,C,R))S=R;else S=U.search(y,function(e){return V(h,C,e)})}else S=y[E-1];if(S){_=S;b=S.start;if(p&&_.level===p.level&&_.sn===p.sn)if(_.sn<n.endSN){_=y[_.sn+1-n.startSN];if(this.fragmentTracker.getState(_)!==B.OK)F["logger"].log("SN just loaded, load next one: "+_.sn)}else _=null}}if(_)if(_.encrypted){F["logger"].log("Loading key for "+_.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+m);this.state=K.KEY_LOADING;i.trigger(M["default"].KEY_LOADING,{frag:_})}else{this.fragCurrent=_;if(A||this.fragmentTracker.getState(_)===B.NOT_LOADED){F["logger"].log("Loading "+_.sn+", cc: "+_.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+m+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+t+", bufferEnd: "+h.toFixed(3));if(_.sn!=="initSegment")this.startFragRequested=true;if(Object(x["isFiniteNumber"])(_.sn))this.nextLoadPosition=_.start+_.duration;i.trigger(M["default"].FRAG_LOADING,{frag:_});this.state=K.FRAG_LOADING}}}break;case K.WAITING_TRACK:r=this.tracks[this.trackId];if(r&&r.details)this.state=K.IDLE;break;case K.FRAG_LOADING_WAITING_RETRY:var w=Y.now();var O=this.retryDate;o=this.media;var L=o&&o.seeking;if(!O||w>=O||L){F["logger"].log("audioStreamController: retryDate reached, switch back to IDLE state");this.state=K.IDLE}break;case K.WAITING_INIT_PTS:var I=this.waitingFragment;if(I){var D=I.frag.cc;if(this.initPTS[D]!==undefined){this.waitingFragment=null;this.state=K.FRAG_LOADING;this.onFragLoaded(I)}else if(this.videoTrackCC!==this.waitingVideoCC){F["logger"].log("Waiting fragment cc ("+D+") cancelled because video is at cc "+this.videoTrackCC);this.clearWaitingFragment()}else{var P=j.bufferInfo(this.mediaBuffer,this.media.currentTime,a.maxBufferHole);var N=V(P.end,a.maxFragLookUpTolerance,I.frag);if(N<0){F["logger"].log("Waiting fragment cc ("+D+") @ "+I.frag.start+" cancelled because another fragment at "+P.end+" is needed");this.clearWaitingFragment()}}}else this.state=K.IDLE;break}};t.clearWaitingFragment=function e(){var t=this.waitingFragment;if(t){this.fragmentTracker.removeFragment(t.frag);this.waitingFragment=null;this.waitingVideoCC=null;this.state=K.IDLE}};t.onMediaAttached=function e(t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("ended",this.onvended);var n=this.config;if(this.tracks&&n.autoStartLoad)this.startLoad(n.startPosition)};t.onMediaDetaching=function e(){var t=this.media;if(t&&t.ended){F["logger"].log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=false;this.fragmentTracker.removeAllFragments();this.stopLoad()};t.onAudioTracksUpdated=function e(t){F["logger"].log("audio tracks updated");this.tracks=t.audioTracks};t.onAudioTrackSwitching=function e(t){var r=!!t.url;this.trackId=t.id;this.fragCurrent=null;this.clearWaitingFragment();this.state=K.PAUSED;if(!r){if(this.demuxer){this.demuxer.destroy();this.demuxer=null}}else this.setInterval(or);if(r){this.audioSwitch=true;this.state=K.IDLE}this.tick()};t.onAudioTrackLoaded=function e(t){var r=t.details,n=t.id,i=this.tracks[n],a=i.details,s=r.totalduration,o=0;F["logger"].log("track "+n+" loaded ["+r.startSN+","+r.endSN+"],duration:"+s);if(r.live||a&&a.live)if(a&&r.fragments.length>0){De(a,r);o=r.fragments[0].start;if(r.PTSKnown)F["logger"].log("live audio playlist sliding:"+o.toFixed(3));else F["logger"].log("live audio playlist - outdated PTS, unknown sliding")}else{r.PTSKnown=false;F["logger"].log("live audio playlist - first load, unknown sliding")}else r.PTSKnown=false;i.details=r;if(!this.startFragRequested){if(this.startPosition===-1){var l=r.startTimeOffset;if(Object(x["isFiniteNumber"])(l)){F["logger"].log("start time offset found in playlist, adjust startPosition to "+l);this.startPosition=l}else if(r.live){this.startPosition=this.computeLivePosition(o,r);F["logger"].log("compute startPosition for audio-track to "+this.startPosition)}else this.startPosition=0}this.nextLoadPosition=this.startPosition}if(this.state===K.WAITING_TRACK)this.state=K.IDLE;this.tick()};t.onKeyLoaded=function e(){if(this.state===K.KEY_LOADING){this.state=K.IDLE;this.tick()}};t.onFragLoaded=function e(t){var r=this.fragCurrent,n=t.frag;if(this.state===K.FRAG_LOADING&&r&&n.type==="audio"&&n.level===r.level&&n.sn===r.sn){var i=this.tracks[this.trackId],a=i.details,s=a.totalduration,o=r.level,l=r.sn,u=r.cc,c=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",d=this.stats=t.stats;if(l==="initSegment"){this.state=K.IDLE;d.tparsed=d.tbuffered=Y.now();a.initSegment.data=t.payload;this.hls.trigger(M["default"].FRAG_BUFFERED,{stats:d,frag:r,id:"audio"});this.tick()}else{this.state=K.PARSING;this.appended=false;if(!this.demuxer)this.demuxer=new v(this.hls,"audio");var f=this.initPTS[u];var h=a.initSegment?a.initSegment.data:[];if(f!==undefined){this.pendingBuffering=true;F["logger"].log("Demuxing "+l+" of ["+a.startSN+" ,"+a.endSN+"],track "+o);var p=false;this.demuxer.push(t.payload,h,c,null,r,s,p,f)}else{F["logger"].log("Unknown video PTS for cc "+u+", waiting for video PTS before demuxing audio frag "+l+" of ["+a.startSN+" ,"+a.endSN+"],track "+o);this.waitingFragment=t;this.waitingVideoCC=this.videoTrackCC;this.state=K.WAITING_INIT_PTS}}}this.fragLoadError=0};t.onFragParsingInitSegment=function e(t){var r=this.fragCurrent;var n=t.frag;if(r&&t.id==="audio"&&n.sn===r.sn&&n.level===r.level&&this.state===K.PARSING){var i=t.tracks,a;if(i.video)delete i.video;a=i.audio;if(a){a.levelCodec=a.codec;a.id=t.id;this.hls.trigger(M["default"].BUFFER_CODECS,i);F["logger"].log("audio track:audio,container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var s=a.initSegment;if(s){var o={type:"audio",data:s,parent:"audio",content:"initSegment"};if(this.audioSwitch)this.pendingData=[o];else{this.appended=true;this.pendingBuffering=true;this.hls.trigger(M["default"].BUFFER_APPENDING,o)}}this.tick()}}};t.onFragParsingData=function e(t){var r=this;var n=this.fragCurrent;var i=t.frag;if(n&&t.id==="audio"&&t.type==="audio"&&i.sn===n.sn&&i.level===n.level&&this.state===K.PARSING){var a=this.trackId,s=this.tracks[a],o=this.hls;if(!Object(x["isFiniteNumber"])(t.endPTS)){t.endPTS=t.startPTS+n.duration;t.endDTS=t.startDTS+n.duration}n.addElementaryStream(f.AUDIO);F["logger"].log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb);Ie(s.details,n,t.startPTS,t.endPTS);var l=this.media;var u=false;if(this.audioSwitch)if(l&&l.readyState){var c=l.currentTime;F["logger"].log("switching audio track : currentTime:"+c);if(c>=t.startPTS){F["logger"].log("switching audio track : flushing all audio");this.state=K.BUFFER_FLUSHING;o.trigger(M["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"});u=true;this.audioSwitch=false;o.trigger(M["default"].AUDIO_TRACK_SWITCHED,{id:a})}}else{this.audioSwitch=false;o.trigger(M["default"].AUDIO_TRACK_SWITCHED,{id:a})}var d=this.pendingData;if(!d){F["logger"].warn("Apparently attempt to enqueue media payload without codec initialization data upfront");o.trigger(M["default"].ERROR,{type:A["ErrorTypes"].MEDIA_ERROR,details:null,fatal:true});return}if(!this.audioSwitch){[t.data1,t.data2].forEach(function(e){if(e&&e.length)d.push({type:t.type,data:e,parent:"audio",content:"data"})});if(!u&&d.length){d.forEach(function(e){if(r.state===K.PARSING){r.pendingBuffering=true;r.hls.trigger(M["default"].BUFFER_APPENDING,e)}});this.pendingData=[];this.appended=true}}this.tick()}};t.onFragParsed=function e(t){var r=this.fragCurrent;var n=t.frag;if(r&&t.id==="audio"&&n.sn===r.sn&&n.level===r.level&&this.state===K.PARSING){this.stats.tparsed=Y.now();this.state=K.PARSED;this._checkAppendedParsed()}};t.onBufferReset=function e(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=false};t.onBufferCreated=function e(t){var r=t.tracks.audio;if(r){this.mediaBuffer=r.buffer;this.loadedmetadata=true}if(t.tracks.video)this.videoBuffer=t.tracks.video.buffer};t.onBufferAppended=function e(t){if(t.parent==="audio"){var r=this.state;if(r===K.PARSING||r===K.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};t._checkAppendedParsed=function e(){if(this.state===K.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent,r=this.stats,n=this.hls;if(t){this.fragPrevious=t;r.tbuffered=Y.now();n.trigger(M["default"].FRAG_BUFFERED,{stats:r,frag:t,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;if(i)F["logger"].log("audio buffered : "+Be.toString(i.buffered));if(this.audioSwitch&&this.appended){this.audioSwitch=false;n.trigger(M["default"].AUDIO_TRACK_SWITCHED,{id:this.trackId})}this.state=K.IDLE}this.tick()}};t.onError=function e(t){var r=t.frag;if(r&&r.type!=="audio")return;switch(t.details){case A["ErrorDetails"].FRAG_LOAD_ERROR:case A["ErrorDetails"].FRAG_LOAD_TIMEOUT:var n=t.frag;if(n&&n.type!=="audio")break;if(!t.fatal){var i=this.fragLoadError;if(i)i++;else i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry){this.fragLoadError=i;var s=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);F["logger"].warn("AudioStreamController: frag loading failed, retry in "+s+" ms");this.retryDate=Y.now()+s;this.state=K.FRAG_LOADING_WAITING_RETRY}else{F["logger"].error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ...");t.fatal=true;this.state=K.ERROR}}break;case A["ErrorDetails"].AUDIO_TRACK_LOAD_ERROR:case A["ErrorDetails"].AUDIO_TRACK_LOAD_TIMEOUT:case A["ErrorDetails"].KEY_LOAD_ERROR:case A["ErrorDetails"].KEY_LOAD_TIMEOUT:if(this.state!==K.ERROR){this.state=t.fatal?K.ERROR:K.IDLE;F["logger"].warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ...")}break;case A["ErrorDetails"].BUFFER_FULL_ERROR:if(t.parent==="audio"&&(this.state===K.PARSING||this.state===K.PARSED)){var o=this.mediaBuffer,l=this.media.currentTime,u=o&&j.isBuffered(o,l)&&j.isBuffered(o,l+.5);if(u){var c=this.config;if(c.maxMaxBufferLength>=c.maxBufferLength){c.maxMaxBufferLength/=2;F["logger"].warn("AudioStreamController: reduce max buffer length to "+c.maxMaxBufferLength+"s")}this.state=K.IDLE}else{F["logger"].warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer");this.fragCurrent=null;this.state=K.BUFFER_FLUSHING;this.hls.trigger(M["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}break}};t.onBufferFlushed=function e(){var t=this;var r=this.pendingData;if(r&&r.length){F["logger"].log("AudioStreamController: appending pending audio data after buffer flushed");r.forEach(function(e){t.hls.trigger(M["default"].BUFFER_APPENDING,e)});this.appended=true;this.pendingData=[];this.state=K.PARSED}else{this.state=K.IDLE;this.fragPrevious=null;this.tick()}};ir(e,[{key:"state",set:function e(t){if(this.state!==t){var r=this.state;this._state=t;F["logger"].log("audio stream:"+r+"->"+t)}},get:function e(){return this._state}}]);return e}(it);var ur=lr;var cr=function(){if(typeof window!=="undefined"&&window.VTTCue)return window.VTTCue;var y="auto";var r={"":true,lr:true,rl:true};var n={start:true,middle:true,end:true,left:true,right:true};function E(e){if(typeof e!=="string")return false;var t=r[e.toLowerCase()];return t?e.toLowerCase():false}function b(e){if(typeof e!=="string")return false;var t=n[e.toLowerCase()];return t?e.toLowerCase():false}function k(e){var t=1;for(;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}function e(e,t,r){var n=this;var i={};i.enumerable=true;n.hasBeenReset=false;var a="";var s=false;var o=e;var l=t;var u=r;var c=null;var d="";var f=true;var h="auto";var p="start";var v=50;var g="middle";var A=50;var m="middle";Object.defineProperty(n,"id",k({},i,{get:function e(){return a},set:function e(t){a=""+t}}));Object.defineProperty(n,"pauseOnExit",k({},i,{get:function e(){return s},set:function e(t){s=!!t}}));Object.defineProperty(n,"startTime",k({},i,{get:function e(){return o},set:function e(t){if(typeof t!=="number")throw new TypeError("Start time must be set to a number.");o=t;this.hasBeenReset=true}}));Object.defineProperty(n,"endTime",k({},i,{get:function e(){return l},set:function e(t){if(typeof t!=="number")throw new TypeError("End time must be set to a number.");l=t;this.hasBeenReset=true}}));Object.defineProperty(n,"text",k({},i,{get:function e(){return u},set:function e(t){u=""+t;this.hasBeenReset=true}}));Object.defineProperty(n,"region",k({},i,{get:function e(){return c},set:function e(t){c=t;this.hasBeenReset=true}}));Object.defineProperty(n,"vertical",k({},i,{get:function e(){return d},set:function e(t){var r=E(t);if(r===false)throw new SyntaxError("An invalid or illegal string was specified.");d=r;this.hasBeenReset=true}}));Object.defineProperty(n,"snapToLines",k({},i,{get:function e(){return f},set:function e(t){f=!!t;this.hasBeenReset=true}}));Object.defineProperty(n,"line",k({},i,{get:function e(){return h},set:function e(t){if(typeof t!=="number"&&t!==y)throw new SyntaxError("An invalid number or illegal string was specified.");h=t;this.hasBeenReset=true}}));Object.defineProperty(n,"lineAlign",k({},i,{get:function e(){return p},set:function e(t){var r=b(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");p=r;this.hasBeenReset=true}}));Object.defineProperty(n,"position",k({},i,{get:function e(){return v},set:function e(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");v=t;this.hasBeenReset=true}}));Object.defineProperty(n,"positionAlign",k({},i,{get:function e(){return g},set:function e(t){var r=b(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");g=r;this.hasBeenReset=true}}));Object.defineProperty(n,"size",k({},i,{get:function e(){return A},set:function e(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");A=t;this.hasBeenReset=true}}));Object.defineProperty(n,"align",k({},i,{get:function e(){return m},set:function e(t){var r=b(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");m=r;this.hasBeenReset=true}}));n.displayState=void 0}e.prototype.getCueAsHTML=function(){var e=window.WebVTT;return e.convertCueToDOMTree(window,this.text)};return e}();var dr=function e(){return{decode:function e(t){if(!t)return"";if(typeof t!=="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};function fr(){this.window=window;this.state="INITIAL";this.buffer="";this.decoder=new dr;this.regionList=[]}function hr(e){function t(e,t,r,n){return(e|0)*3600+(t|0)*60+(r|0)+(n|0)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!r)return null;if(r[3])return t(r[1],r[2],r[3].replace(":",""),r[4]);else if(r[1]>59)return t(r[1],r[2],0,r[4]);else return t(0,r[1],r[2],r[4])}function pr(){this.values=Object.create(null)}pr.prototype={set:function e(t,r){if(!this.get(t)&&r!=="")this.values[t]=r},get:function e(t,r,n){if(n)return this.has(t)?this.values[t]:r[n];return this.has(t)?this.values[t]:r},has:function e(t){return t in this.values},alt:function e(t,r,n){for(var i=0;i<n.length;++i)if(r===n[i]){this.set(t,r);break}},integer:function e(t,r){if(/^-?\d+$/.test(r))this.set(t,parseInt(r,10))},percent:function e(t,r){if(r.match(/^([\d]{1,3})(\.[\d]*)?%$/)){r=parseFloat(r);if(r>=0&&r<=100){this.set(t,r);return true}}return false}};function vr(e,t,r,n){var i=n?e.split(n):[e];for(var a in i){if(typeof i[a]!=="string")continue;var s=i[a].split(r);if(s.length!==2)continue;var o=s[0];var l=s[1];t(o,l)}}var gr=new cr(0,0,0);var o=gr.align==="middle"?"middle":"center";function Ar(t,e,s){var r=t;function n(){var e=hr(t);if(e===null)throw new Error("Malformed timestamp: "+r);t=t.replace(/^[^\sa-zA-Z-]+/,"");return e}function i(e,t){var a=new pr;vr(e,function(e,t){switch(e){case"region":for(var r=s.length-1;r>=0;r--)if(s[r].id===t){a.set(e,s[r].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),i=n[0];a.integer(e,i);if(a.percent(e,i))a.set("snapToLines",false);a.alt(e,i,["auto"]);if(n.length===2)a.alt("lineAlign",n[1],["start",o,"end"]);break;case"position":n=t.split(",");a.percent(e,n[0]);if(n.length===2)a.alt("positionAlign",n[1],["start",o,"end","line-left","line-right","auto"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start",o,"end","left","right"]);break}},/:/,/\s/);t.region=a.get("region",null);t.vertical=a.get("vertical","");var r=a.get("line","auto");if(r==="auto"&&gr.line===-1)r=-1;t.line=r;t.lineAlign=a.get("lineAlign","start");t.snapToLines=a.get("snapToLines",true);t.size=a.get("size",100);t.align=a.get("align",o);var n=a.get("position","auto");if(n==="auto"&&gr.position===50)n=t.align==="start"||t.align==="left"?0:t.align==="end"||t.align==="right"?100:50;t.position=n}function a(){t=t.replace(/^\s+/,"")}a();e.startTime=n();a();if(t.substr(0,3)!=="--\x3e")throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);t=t.substr(3);a();e.endTime=n();a();i(t,e)}function mr(e){return e.replace(/<br(?: \/)?>/gi,"\n")}fr.prototype={parse:function e(t){var n=this;if(t)n.buffer+=n.decoder.decode(t,{stream:true});function r(){var e=n.buffer;var t=0;e=mr(e);while(t<e.length&&e[t]!=="\r"&&e[t]!=="\n")++t;var r=e.substr(0,t);if(e[t]==="\r")++t;if(e[t]==="\n")++t;n.buffer=e.substr(t);return r}function i(e){vr(e,function(e,t){},/:/)}try{var a;if(n.state==="INITIAL"){if(!/\r\n|\n/.test(n.buffer))return this;a=r();var s=a.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!s||!s[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}var o=false;while(n.buffer){if(!/\r\n|\n/.test(n.buffer))return this;if(!o)a=r();else o=false;switch(n.state){case"HEADER":if(/:/.test(a))i(a);else if(!a)n.state="ID";continue;case"NOTE":if(!a)n.state="ID";continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){n.state="NOTE";break}if(!a)continue;n.cue=new cr(0,0,"");n.state="CUE";if(a.indexOf("--\x3e")===-1){n.cue.id=a;continue}case"CUE":try{Ar(a,n.cue,n.regionList)}catch(e){n.cue=null;n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var l=a.indexOf("--\x3e")!==-1;if(!a||l&&(o=true)){if(n.oncue)n.oncue(n.cue);n.cue=null;n.state="ID";continue}if(n.cue.text)n.cue.text+="\n";n.cue.text+=a;continue;case"BADCUE":if(!a)n.state="ID";continue}}}catch(e){if(n.state==="CUETEXT"&&n.cue&&n.oncue)n.oncue(n.cue);n.cue=null;n.state=n.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function e(){var t=this;try{t.buffer+=t.decoder.decode();if(t.cue||t.state==="HEADER"){t.buffer+="\n\n";t.parse()}if(t.state==="INITIAL")throw new Error("Malformed WebVTT signature.")}catch(e){throw e}if(t.onflush)t.onflush();return this}};var yr=fr;function Er(e,t,r,n){var i=[];var a;var s;var o;var l;var u;var c=window.VTTCue||TextTrackCue;for(var d=0;d<n.rows.length;d++){a=n.rows[d];o=true;l=0;u="";if(!a.isEmpty()){for(var f=0;f<a.chars.length;f++)if(a.chars[f].uchar.match(/\s/)&&o)l++;else{u+=a.chars[f].uchar;o=false}a.cueStartTime=t;if(t===r)r+=1e-4;s=new c(t,r,mr(u.trim()));if(l>=16)l--;else l++;if(navigator.userAgent.match(/Firefox\//))s.line=d+1;else s.line=d>7?d-2:d+1;s.align="left";s.position=Math.max(0,Math.min(100,100*(l/32)));i.push(s);if(e)e.addCue(s)}}return i}var br={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499};var kr=function e(t){var r=t;if(br.hasOwnProperty(t))r=br[t];return String.fromCharCode(r)};var h=15;var l=100;var _r={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14};var Tr={17:2,18:4,21:6,22:8,23:10,19:13,20:15};var Sr={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14};var Cr={25:2,26:4,29:6,30:8,31:10,27:13,28:15};var Rr=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];var p;(function(e){e[e["ERROR"]=0]="ERROR";e[e["TEXT"]=1]="TEXT";e[e["WARNING"]=2]="WARNING";e[e["INFO"]=2]="INFO";e[e["DEBUG"]=3]="DEBUG";e[e["DATA"]=3]="DATA"})(p||(p={}));var wr=function(){function e(){this.time=null;this.verboseLevel=p.ERROR}var t=e.prototype;t.log=function e(t,r){if(this.verboseLevel>=t)F["logger"].log(this.time+" ["+t+"] "+r)};return e}();var g=function e(t){var r=[];for(var n=0;n<t.length;n++)r.push(t[n].toString(16));return r};var Or=function(){function e(e,t,r,n,i){this.foreground=void 0;this.underline=void 0;this.italics=void 0;this.background=void 0;this.flash=void 0;this.foreground=e||"white";this.underline=t||false;this.italics=r||false;this.background=n||"black";this.flash=i||false}var t=e.prototype;t.reset=function e(){this.foreground="white";this.underline=false;this.italics=false;this.background="black";this.flash=false};t.setStyles=function e(t){var r=["foreground","underline","italics","background","flash"];for(var n=0;n<r.length;n++){var i=r[n];if(t.hasOwnProperty(i))this[i]=t[i]}};t.isDefault=function e(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash};t.equals=function e(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash};t.copy=function e(t){this.foreground=t.foreground;this.underline=t.underline;this.italics=t.italics;this.background=t.background;this.flash=t.flash};t.toString=function e(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash};return e}();var Lr=function(){function e(e,t,r,n,i,a){this.uchar=void 0;this.penState=void 0;this.uchar=e||" ";this.penState=new Or(t,r,n,i,a)}var t=e.prototype;t.reset=function e(){this.uchar=" ";this.penState.reset()};t.setChar=function e(t,r){this.uchar=t;this.penState.copy(r)};t.setPenState=function e(t){this.penState.copy(t)};t.equals=function e(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)};t.copy=function e(t){this.uchar=t.uchar;this.penState.copy(t.penState)};t.isEmpty=function e(){return this.uchar===" "&&this.penState.isDefault()};return e}();var Ir=function(){function e(e){this.chars=void 0;this.pos=void 0;this.currPenState=void 0;this.cueStartTime=void 0;this.logger=void 0;this.chars=[];for(var t=0;t<l;t++)this.chars.push(new Lr);this.logger=e;this.pos=0;this.currPenState=new Or}var t=e.prototype;t.equals=function e(t){var r=true;for(var n=0;n<l;n++)if(!this.chars[n].equals(t.chars[n])){r=false;break}return r};t.copy=function e(t){for(var r=0;r<l;r++)this.chars[r].copy(t.chars[r])};t.isEmpty=function e(){var t=true;for(var r=0;r<l;r++)if(!this.chars[r].isEmpty()){t=false;break}return t};t.setCursor=function e(t){if(this.pos!==t)this.pos=t;if(this.pos<0){this.logger.log(p.DEBUG,"Negative cursor position "+this.pos);this.pos=0}else if(this.pos>l){this.logger.log(p.DEBUG,"Too large cursor position "+this.pos);this.pos=l}};t.moveCursor=function e(t){var r=this.pos+t;if(t>1)for(var n=this.pos+1;n<r+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(r)};t.backSpace=function e(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)};t.insertChar=function e(t){if(t>=144)this.backSpace();var r=kr(t);if(this.pos>=l){this.logger.log(p.ERROR,"Cannot insert "+t.toString(16)+" ("+r+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(r,this.currPenState);this.moveCursor(1)};t.clearFromPos=function e(t){var r;for(r=t;r<l;r++)this.chars[r].reset()};t.clear=function e(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()};t.clearToEndOfRow=function e(){this.clearFromPos(this.pos)};t.getTextString=function e(){var t=[];var r=true;for(var n=0;n<l;n++){var i=this.chars[n].uchar;if(i!==" ")r=false;t.push(i)}if(r)return"";else return t.join("")};t.setPenStyles=function e(t){this.currPenState.setStyles(t);var r=this.chars[this.pos];r.setPenState(this.currPenState)};return e}();var Dr=function(){function e(e){this.rows=void 0;this.currRow=void 0;this.nrRollUpRows=void 0;this.lastOutputScreen=void 0;this.logger=void 0;this.rows=[];for(var t=0;t<h;t++)this.rows.push(new Ir(e));this.logger=e;this.currRow=h-1;this.nrRollUpRows=null;this.lastOutputScreen=null;this.reset()}var t=e.prototype;t.reset=function e(){for(var t=0;t<h;t++)this.rows[t].clear();this.currRow=h-1};t.equals=function e(t){var r=true;for(var n=0;n<h;n++)if(!this.rows[n].equals(t.rows[n])){r=false;break}return r};t.copy=function e(t){for(var r=0;r<h;r++)this.rows[r].copy(t.rows[r])};t.isEmpty=function e(){var t=true;for(var r=0;r<h;r++)if(!this.rows[r].isEmpty()){t=false;break}return t};t.backSpace=function e(){var t=this.rows[this.currRow];t.backSpace()};t.clearToEndOfRow=function e(){var t=this.rows[this.currRow];t.clearToEndOfRow()};t.insertChar=function e(t){var r=this.rows[this.currRow];r.insertChar(t)};t.setPen=function e(t){var r=this.rows[this.currRow];r.setPenStyles(t)};t.moveCursor=function e(t){var r=this.rows[this.currRow];r.moveCursor(t)};t.setCursor=function e(t){this.logger.log(p.INFO,"setCursor: "+t);var r=this.rows[this.currRow];r.setCursor(t)};t.setPAC=function e(t){this.logger.log(p.INFO,"pacData = "+JSON.stringify(t));var r=t.row-1;if(this.nrRollUpRows&&r<this.nrRollUpRows-1)r=this.nrRollUpRows-1;if(this.nrRollUpRows&&this.currRow!==r){for(var n=0;n<h;n++)this.rows[n].clear();var i=this.currRow+1-this.nrRollUpRows;var a=this.lastOutputScreen;if(a){var s=a.rows[i].cueStartTime;var o=this.logger.time;if(s&&o!==null&&s<o)for(var l=0;l<this.nrRollUpRows;l++)this.rows[r-this.nrRollUpRows+l+1].copy(a.rows[i+l])}}this.currRow=r;var u=this.rows[this.currRow];if(t.indent!==null){var c=t.indent;var d=Math.max(c-1,0);u.setCursor(t.indent);t.color=u.chars[d].penState.foreground}var f={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:false};this.setPen(f)};t.setBkgData=function e(t){this.logger.log(p.INFO,"bkgData = "+JSON.stringify(t));this.backSpace();this.setPen(t);this.insertChar(32)};t.setRollUpRows=function e(t){this.nrRollUpRows=t};t.rollUp=function e(){if(this.nrRollUpRows===null){this.logger.log(p.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(p.TEXT,this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows;var r=this.rows.splice(t,1)[0];r.clear();this.rows.splice(this.currRow,0,r);this.logger.log(p.INFO,"Rolling up")};t.getDisplayText=function e(t){t=t||false;var r=[];var n="";var i=-1;for(var a=0;a<h;a++){var s=this.rows[a].getTextString();if(s){i=a+1;if(t)r.push("Row "+i+": '"+s+"'");else r.push(s.trim())}}if(r.length>0)if(t)n="["+r.join(" | ")+"]";else n=r.join("\n");return n};t.getTextAndFormat=function e(){return this.rows};return e}();var Pr=function(){function e(e,t,r){this.chNr=void 0;this.outputFilter=void 0;this.mode=void 0;this.verbose=void 0;this.displayedMemory=void 0;this.nonDisplayedMemory=void 0;this.lastOutputScreen=void 0;this.currRollUpRow=void 0;this.writeScreen=void 0;this.cueStartTime=void 0;this.logger=void 0;this.chNr=e;this.outputFilter=t;this.mode=null;this.verbose=0;this.displayedMemory=new Dr(r);this.nonDisplayedMemory=new Dr(r);this.lastOutputScreen=new Dr(r);this.currRollUpRow=this.displayedMemory.rows[h-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.logger=r}var t=e.prototype;t.reset=function e(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.outputFilter.reset();this.currRollUpRow=this.displayedMemory.rows[h-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null};t.getHandler=function e(){return this.outputFilter};t.setHandler=function e(t){this.outputFilter=t};t.setPAC=function e(t){this.writeScreen.setPAC(t)};t.setBkgData=function e(t){this.writeScreen.setBkgData(t)};t.setMode=function e(t){if(t===this.mode)return;this.mode=t;this.logger.log(p.INFO,"MODE="+t);if(this.mode==="MODE_POP-ON")this.writeScreen=this.nonDisplayedMemory;else{this.writeScreen=this.displayedMemory;this.writeScreen.reset()}if(this.mode!=="MODE_ROLL-UP"){this.displayedMemory.nrRollUpRows=null;this.nonDisplayedMemory.nrRollUpRows=null}this.mode=t};t.insertChars=function e(t){for(var r=0;r<t.length;r++)this.writeScreen.insertChar(t[r]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(p.INFO,n+": "+this.writeScreen.getDisplayText(true));if(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP"){this.logger.log(p.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(true));this.outputDataUpdate()}};t.ccRCL=function e(){this.logger.log(p.INFO,"RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")};t.ccBS=function e(){this.logger.log(p.INFO,"BS - BackSpace");if(this.mode==="MODE_TEXT")return;this.writeScreen.backSpace();if(this.writeScreen===this.displayedMemory)this.outputDataUpdate()};t.ccAOF=function e(){};t.ccAON=function e(){};t.ccDER=function e(){this.logger.log(p.INFO,"DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()};t.ccRU=function e(t){this.logger.log(p.INFO,"RU("+t+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(t)};t.ccFON=function e(){this.logger.log(p.INFO,"FON - Flash On");this.writeScreen.setPen({flash:true})};t.ccRDC=function e(){this.logger.log(p.INFO,"RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")};t.ccTR=function e(){this.logger.log(p.INFO,"TR");this.setMode("MODE_TEXT")};t.ccRTD=function e(){this.logger.log(p.INFO,"RTD");this.setMode("MODE_TEXT")};t.ccEDM=function e(){this.logger.log(p.INFO,"EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(true)};t.ccCR=function e(){this.logger.log(p.INFO,"CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(true)};t.ccENM=function e(){this.logger.log(p.INFO,"ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()};t.ccEOC=function e(){this.logger.log(p.INFO,"EOC - End Of Caption");if(this.mode==="MODE_POP-ON"){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=t;this.writeScreen=this.nonDisplayedMemory;this.logger.log(p.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(true)};t.ccTO=function e(t){this.logger.log(p.INFO,"TO("+t+") - Tab Offset");this.writeScreen.moveCursor(t)};t.ccMIDROW=function e(t){var r={flash:false};r.underline=t%2===1;r.italics=t>=46;if(!r.italics){var n=Math.floor(t/2)-16;var i=["white","green","blue","cyan","red","yellow","magenta"];r.foreground=i[n]}else r.foreground="white";this.logger.log(p.INFO,"MIDROW: "+JSON.stringify(r));this.writeScreen.setPen(r)};t.outputDataUpdate=function e(t){if(t===void 0)t=false;var r=this.logger.time;if(r===null)return;if(this.outputFilter){if(this.cueStartTime===null&&!this.displayedMemory.isEmpty())this.cueStartTime=r;else if(!this.displayedMemory.equals(this.lastOutputScreen)){this.outputFilter.newCue(this.cueStartTime,r,this.lastOutputScreen);if(t&&this.outputFilter.dispatchCue)this.outputFilter.dispatchCue();this.cueStartTime=this.displayedMemory.isEmpty()?null:r}this.lastOutputScreen.copy(this.displayedMemory)}};t.cueSplitAtTime=function e(t){if(this.outputFilter)if(!this.displayedMemory.isEmpty()){if(this.outputFilter.newCue)this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory);this.cueStartTime=t}};return e}();var Nr=function(){function e(e,t,r){this.channels=void 0;this.currentChannel=0;this.cmdHistory=void 0;this.logger=void 0;var n=new wr;this.channels=[null,new Pr(e,t,n),new Pr(e+1,r,n)];this.cmdHistory=Mr();this.logger=n}var t=e.prototype;t.getHandler=function e(t){return this.channels[t].getHandler()};t.setHandler=function e(t,r){this.channels[t].setHandler(r)};t.addData=function e(t,r){var n;var i;var a;var s=false;this.logger.time=t;for(var o=0;o<r.length;o+=2){i=r[o]&127;a=r[o+1]&127;if(i===0&&a===0)continue;else this.logger.log(p.DATA,"["+g([r[o],r[o+1]])+"] -> ("+g([i,a])+")");n=this.parseCmd(i,a);if(!n)n=this.parseMidrow(i,a);if(!n)n=this.parsePAC(i,a);if(!n)n=this.parseBackgroundAttributes(i,a);if(!n){s=this.parseChars(i,a);if(s){var l=this.currentChannel;if(l&&l>0){var u=this.channels[l];u.insertChars(s)}else this.logger.log(p.WARNING,"No channel found yet. TEXT-MODE?")}}if(!n&&!s)this.logger.log(p.WARNING,"Couldn't parse cleaned data "+g([i,a])+" orig: "+g([r[o],r[o+1]]))}};t.parseCmd=function e(t,r){var n=this.cmdHistory;var i=(t===20||t===28||t===21||t===29)&&r>=32&&r<=47;var a=(t===23||t===31)&&r>=33&&r<=35;if(!(i||a))return false;if(xr(t,r,n)){E(null,null,n);this.logger.log(p.DEBUG,"Repeated command ("+g([t,r])+") is dropped");return true}var s=t===20||t===21||t===23?1:2;var o=this.channels[s];if(t===20||t===21||t===28||t===29){if(r===32)o.ccRCL();else if(r===33)o.ccBS();else if(r===34)o.ccAOF();else if(r===35)o.ccAON();else if(r===36)o.ccDER();else if(r===37)o.ccRU(2);else if(r===38)o.ccRU(3);else if(r===39)o.ccRU(4);else if(r===40)o.ccFON();else if(r===41)o.ccRDC();else if(r===42)o.ccTR();else if(r===43)o.ccRTD();else if(r===44)o.ccEDM();else if(r===45)o.ccCR();else if(r===46)o.ccENM();else if(r===47)o.ccEOC()}else o.ccTO(r-32);E(t,r,n);this.currentChannel=s;return true};t.parseMidrow=function e(t,r){var n=0;if((t===17||t===25)&&r>=32&&r<=47){if(t===17)n=1;else n=2;if(n!==this.currentChannel){this.logger.log(p.ERROR,"Mismatch channel in midrow parsing");return false}var i=this.channels[n];if(!i)return false;i.ccMIDROW(r);this.logger.log(p.DEBUG,"MIDROW ("+g([t,r])+")");return true}return false};t.parsePAC=function e(t,r){var n;var i=this.cmdHistory;var a=(t>=17&&t<=23||t>=25&&t<=31)&&r>=64&&r<=127;var s=(t===16||t===24)&&r>=64&&r<=95;if(!(a||s))return false;if(xr(t,r,i)){E(null,null,i);return true}var o=t<=23?1:2;if(r>=64&&r<=95)n=o===1?_r[t]:Sr[t];else n=o===1?Tr[t]:Cr[t];var l=this.channels[o];if(!l)return false;l.setPAC(this.interpretPAC(n,r));E(t,r,i);this.currentChannel=o;return true};t.interpretPAC=function e(t,r){var n=r;var i={color:null,italics:false,indent:null,underline:false,row:t};if(r>95)n=r-96;else n=r-64;i.underline=(n&1)===1;if(n<=13)i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)];else if(n<=15){i.italics=true;i.color="white"}else i.indent=Math.floor((n-16)/2)*4;return i};t.parseChars=function e(t,r){var n;var i=null;var a=null;if(t>=25){n=2;a=t-8}else{n=1;a=t}if(a>=17&&a<=19){var s=r;if(a===17)s=r+80;else if(a===18)s=r+112;else s=r+144;this.logger.log(p.INFO,"Special char '"+kr(s)+"' in channel "+n);i=[s]}else if(t>=32&&t<=127)i=r===0?[t]:[t,r];if(i){var o=g(i);this.logger.log(p.DEBUG,"Char codes =  "+o.join(","));E(t,r,this.cmdHistory)}return i};t.parseBackgroundAttributes=function e(t,r){var n=(t===16||t===24)&&r>=32&&r<=47;var i=(t===23||t===31)&&r>=45&&r<=47;if(!(n||i))return false;var a;var s={};if(t===16||t===24){a=Math.floor((r-32)/2);s.background=Rr[a];if(r%2===1)s.background=s.background+"_semi"}else if(r===45)s.background="transparent";else{s.foreground="black";if(r===47)s.underline=true}var o=t<=23?1:2;var l=this.channels[o];l.setBkgData(s);E(t,r,this.cmdHistory);return true};t.reset=function e(){for(var t=0;t<Object.keys(this.channels).length;t++){var r=this.channels[t];if(r)r.reset()}this.cmdHistory=Mr()};t.cueSplitAtTime=function e(t){for(var r=0;r<this.channels.length;r++){var n=this.channels[r];if(n)n.cueSplitAtTime(t)}};return e}();function E(e,t,r){r.a=e;r.b=t}function xr(e,t,r){return r.a===e&&r.b===t}function Mr(){return{a:null,b:null}}var Fr=Nr;var b=function(){function e(e,t){this.timelineController=void 0;this.cueRanges=[];this.trackName=void 0;this.startTime=null;this.endTime=null;this.screen=null;this.timelineController=e;this.trackName=t}var t=e.prototype;t.dispatchCue=function e(){if(this.startTime===null)return;this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges);this.startTime=null};t.newCue=function e(t,r,n){if(this.startTime===null||this.startTime>t)this.startTime=t;this.endTime=r;this.screen=n;this.timelineController.createCaptionsTrack(this.trackName)};t.reset=function e(){this.cueRanges=[]};return e}();var Br=function e(t,r,n){return t.substr(n||0,r.length)===r};var Ur=function e(t){var r=parseInt(t.substr(-3));var n=parseInt(t.substr(-6,2));var i=parseInt(t.substr(-9,2));var a=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;if(!Object(x["isFiniteNumber"])(r)||!Object(x["isFiniteNumber"])(n)||!Object(x["isFiniteNumber"])(i)||!Object(x["isFiniteNumber"])(a))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t);r+=1e3*n;r+=60*1e3*i;r+=60*60*1e3*a;return r};var jr=function e(t){var e=5381;var r=t.length;while(r)e=e*33^t.charCodeAt(--r);return(e>>>0).toString()};var Vr=function e(t,r,n){var i=t[r];var a=t[i.prevCC];if(!a||!a.new&&i.new){t.ccOffset=t.presentationOffset=i.start;i.new=false;return}while(a&&a.new){t.ccOffset+=i.start-a.start;i.new=false;i=a;a=t[i.prevCC]}t.presentationOffset=n};var Gr={parse:function e(t,r,n,i,a,s){var o=/\r\n|\n\r|\n|\r/g;var l=Object(gt["utf8ArrayToStr"])(new Uint8Array(t)).trim().replace(o,"\n").split("\n");var u="00:00.000";var c=0;var d=0;var f=0;var h=[];var p;var v=true;var g=false;var A=new yr;A.oncue=function(e){var t=n[i];var r=n.ccOffset;if(t&&t.new)if(d!==undefined)r=n.ccOffset=t.start;else Vr(n,i,f);if(f)r=f-n.presentationOffset;if(g){e.startTime+=r-d;e.endTime+=r-d}e.id=jr(e.startTime.toString())+jr(e.endTime.toString())+jr(e.text);e.text=decodeURIComponent(encodeURIComponent(e.text));if(e.endTime>0)h.push(e)};A.onparsingerror=function(e){p=e};A.onflush=function(){if(p&&s){s(p);return}a(h)};l.forEach(function(e){if(v)if(Br(e,"X-TIMESTAMP-MAP=")){v=false;g=true;e.substr(16).split(",").forEach(function(e){if(Br(e,"LOCAL:"))u=e.substr(6);else if(Br(e,"MPEGTS:"))c=parseInt(e.substr(7))});try{if(r+(n[i].start*9e4||0)<0)r+=8589934592;c-=r;d=Ur(u)/1e3;f=c/9e4}catch(e){g=false;p=e}return}else if(e==="")v=false;A.parse(e+"\n")});A.flush()}};var Kr=Gr;function k(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yr(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Hr=function(s){Yr(e,s);function e(e){var t;t=s.call(this,e,M["default"].MEDIA_ATTACHING,M["default"].MEDIA_DETACHING,M["default"].FRAG_PARSING_USERDATA,M["default"].FRAG_DECRYPTED,M["default"].MANIFEST_LOADING,M["default"].MANIFEST_LOADED,M["default"].FRAG_LOADED,M["default"].INIT_PTS_FOUND)||this;t.media=null;t.config=void 0;t.enabled=true;t.Cues=void 0;t.textTracks=[];t.tracks=[];t.initPTS=[];t.unparsedVttFrags=[];t.captionsTracks={};t.nonNativeCaptionsTracks={};t.captionsProperties=void 0;t.cea608Parser1=void 0;t.cea608Parser2=void 0;t.lastSn=-1;t.prevCC=-1;t.vttCCs=Wr();t.hls=e;t.config=e.config;t.Cues=e.config.cueHandler;t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode},textTrack3:{label:t.config.captionsTextTrack3Label,languageCode:t.config.captionsTextTrack3LanguageCode},textTrack4:{label:t.config.captionsTextTrack4Label,languageCode:t.config.captionsTextTrack4LanguageCode}};if(t.config.enableCEA708Captions){var r=new b(k(t),"textTrack1");var n=new b(k(t),"textTrack2");var i=new b(k(t),"textTrack3");var a=new b(k(t),"textTrack4");t.cea608Parser1=new Fr(1,r,n);t.cea608Parser2=new Fr(3,i,a)}return t}var t=e.prototype;t.addCues=function e(t,r,n,i,a){var s=false;for(var o=a.length;o--;){var l=a[o];var u=$r(l[0],l[1],r,n);if(u>=0){l[0]=Math.min(l[0],r);l[1]=Math.max(l[1],n);s=true;if(u/(n-r)>.5)return}}if(!s)a.push([r,n]);if(this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[t],r,n,i);else{var c=this.Cues.newCue(null,r,n,i);this.hls.trigger(M["default"].CUES_PARSED,{type:"captions",cues:c,track:t})}};t.onInitPtsFound=function e(t){var r=this;var n=t.frag,i=t.id,a=t.initPTS;var s=this.unparsedVttFrags;if(i==="main")this.initPTS[n.cc]=a;if(s.length){this.unparsedVttFrags=[];s.forEach(function(e){r.onFragLoaded(e)})}};t.getExistingTrack=function e(t){var r=this.media;if(r)for(var n=0;n<r.textTracks.length;n++){var i=r.textTracks[n];if(i[t])return i}return null};t.createCaptionsTrack=function e(t){if(this.config.renderTextTracksNatively)this.createNativeTrack(t);else this.createNonNativeTrack(t)};t.createNativeTrack=function e(t){if(this.captionsTracks[t])return;var r=this.captionsProperties,n=this.captionsTracks,i=this.media;var a=r[t],s=a.label,o=a.languageCode;var l=this.getExistingTrack(t);if(!l){var u=this.createTextTrack("captions",s,o);if(u){u[t]=true;n[t]=u}}else{n[t]=l;c(n[t]);At(n[t],i)}};t.createNonNativeTrack=function e(t){if(this.nonNativeCaptionsTracks[t])return;var r=this.captionsProperties[t];if(!r)return;var n=r.label;var i={_id:t,label:n,kind:"captions",default:r.media?!!r.media.default:false,closedCaptions:r.media};this.nonNativeCaptionsTracks[t]=i;this.hls.trigger(M["default"].NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})};t.createTextTrack=function e(t,r,n){var i=this.media;if(!i)return;return i.addTextTrack(t,r,n)};t.destroy=function e(){s.prototype.destroy.call(this)};t.onMediaAttaching=function e(t){this.media=t.media;this._cleanTracks()};t.onMediaDetaching=function e(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){c(t[e]);delete t[e]});this.nonNativeCaptionsTracks={}};t.onManifestLoading=function e(){this.lastSn=-1;this.prevCC=-1;this.vttCCs=Wr();this._cleanTracks();this.tracks=[];this.captionsTracks={};this.nonNativeCaptionsTracks={}};t._cleanTracks=function e(){var t=this.media;if(!t)return;var r=t.textTracks;if(r)for(var n=0;n<r.length;n++)c(r[n])};t.onManifestLoaded=function e(t){var a=this;this.textTracks=[];this.unparsedVttFrags=this.unparsedVttFrags||[];this.initPTS=[];if(this.cea608Parser1&&this.cea608Parser2){this.cea608Parser1.reset();this.cea608Parser2.reset()}if(this.config.enableWebVTT){var r=t.subtitles||[];var n=this.tracks&&r&&this.tracks.length===r.length;this.tracks=t.subtitles||[];if(this.config.renderTextTracksNatively){var s=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var r;if(t<s.length){var n=null;for(var i=0;i<s.length;i++)if(zr(s[i],e)){n=s[i];break}if(n)r=n}if(!r)r=a.createTextTrack("subtitles",e.name,e.lang);if(e.default)r.mode=a.hls.subtitleDisplay?"showing":"hidden";else r.mode="disabled";a.textTracks.push(r)})}else if(!n&&this.tracks&&this.tracks.length){var i=this.tracks.map(function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}});this.hls.trigger(M["default"].NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:i})}}if(this.config.enableCEA708Captions&&t.captions)t.captions.forEach(function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;var r="textTrack"+t[1];var n=a.captionsProperties[r];if(!n)return;n.label=e.name;if(e.lang)n.languageCode=e.lang;n.media=e})};t.onFragLoaded=function e(t){var r=t.frag,n=t.payload;var i=this.cea608Parser1,a=this.cea608Parser2,s=this.initPTS,o=this.lastSn,l=this.unparsedVttFrags;if(r.type==="main"){var u=r.sn;if(r.sn!==o+1)if(i&&a){i.reset();a.reset()}this.lastSn=u}else if(r.type==="subtitle")if(n.byteLength){if(!Object(x["isFiniteNumber"])(s[r.cc])){l.push(t);if(s.length)this.hls.trigger(M["default"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:r});return}var c=r.decryptdata;if(c==null||c.key==null||c.method!=="AES-128")this._parseVTTs(r,n)}else this.hls.trigger(M["default"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:r})};t._parseVTTs=function e(r,t){var i=this;var a=this.hls,n=this.prevCC,s=this.textTracks,o=this.vttCCs;if(!o[r.cc]){o[r.cc]={start:r.start,prevCC:n,new:true};this.prevCC=r.cc}Kr.parse(t,this.initPTS[r.cc],o,r.cc,function(e){if(i.config.renderTextTracksNatively){var n=s[r.level];if(n.mode==="disabled"){a.trigger(M["default"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:r});return}e.forEach(function(t){if(!n.cues.getCueById(t.id))try{n.addCue(t);if(!n.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(e){F["logger"].debug("Failed occurred on adding cues: "+e);var r=new window.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id;n.addCue(r)}})}else{var t=i.tracks[r.level].default?"default":"subtitles"+r.level;a.trigger(M["default"].CUES_PARSED,{type:"subtitles",cues:e,track:t})}a.trigger(M["default"].SUBTITLE_FRAG_PROCESSED,{success:true,frag:r})},function(e){F["logger"].log("Failed to parse VTT cue: "+e);a.trigger(M["default"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:r})})};t.onFragDecrypted=function e(t){var r=t.frag,n=t.payload;if(r.type==="subtitle"){if(!Object(x["isFiniteNumber"])(this.initPTS[r.cc])){this.unparsedVttFrags.push(t);return}this._parseVTTs(r,n)}};t.onFragParsingUserdata=function e(t){var r=this.cea608Parser1,n=this.cea608Parser2;if(!this.enabled||!(r&&n))return;for(var i=0;i<t.samples.length;i++){var a=t.samples[i].bytes;if(a){var s=this.extractCea608Data(a);r.addData(t.samples[i].pts,s[0]);n.addData(t.samples[i].pts,s[1])}}};t.extractCea608Data=function e(t){var r=t[0]&31;var n=2;var i=[[],[]];for(var a=0;a<r;a++){var s=t[n++];var o=127&t[n++];var l=127&t[n++];var u=(4&s)!==0;var c=3&s;if(o===0&&l===0)continue;if(u)if(c===0||c===1){i[c].push(o);i[c].push(l)}}return i};return e}(i);function zr(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function $r(e,t,r,n){return Math.min(t,n)-Math.max(e,r)}function Wr(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:false}}}var qr=Hr;function Xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function Zr(e,t,r){if(t)Xr(e.prototype,t);if(r)Xr(e,r);return e}function Qr(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Jr=function(r){Qr(e,r);function e(e){var t;t=r.call(this,e,M["default"].MEDIA_ATTACHED,M["default"].MEDIA_DETACHING,M["default"].MANIFEST_LOADED,M["default"].SUBTITLE_TRACK_LOADED)||this;t.tracks=[];t.trackId=-1;t.media=null;t.stopped=true;t.subtitleDisplay=true;t.queuedDefaultTrack=null;return t}var t=e.prototype;t.destroy=function e(){i.prototype.destroy.call(this)};t.onMediaAttached=function e(t){var r=this;this.media=t.media;if(!this.media)return;if(Object(x["isFiniteNumber"])(this.queuedDefaultTrack)){this.subtitleTrack=this.queuedDefaultTrack;this.queuedDefaultTrack=null}this.trackChangeListener=this._onTextTracksChanged.bind(this);this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks);if(this.useTextTrackPolling)this.subtitlePollingInterval=setInterval(function(){r.trackChangeListener()},500);else this.media.textTracks.addEventListener("change",this.trackChangeListener)};t.onMediaDetaching=function e(){if(!this.media)return;if(this.useTextTrackPolling)clearInterval(this.subtitlePollingInterval);else this.media.textTracks.removeEventListener("change",this.trackChangeListener);if(Object(x["isFiniteNumber"])(this.subtitleTrack))this.queuedDefaultTrack=this.subtitleTrack;var t=en(this.media.textTracks);t.forEach(function(e){c(e)});this.subtitleTrack=-1;this.media=null};t.onManifestLoaded=function e(t){var r=this;var n=t.subtitles||[];this.tracks=n;this.hls.trigger(M["default"].SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n});n.forEach(function(e){if(e.default)if(r.media)r.subtitleTrack=e.id;else r.queuedDefaultTrack=e.id})};t.onSubtitleTrackLoaded=function e(t){var r=this;var n=t.id,i=t.details;var a=this.trackId,s=this.tracks;var o=s[a];if(n>=s.length||n!==a||!o||this.stopped){this._clearReloadTimer();return}F["logger"].log("subtitle track "+n+" loaded");if(i.live){var l=Me(o.details,i,t.stats.trequest);F["logger"].log("Reloading live subtitle playlist in "+l+"ms");this.timer=setTimeout(function(){r._loadCurrentTrack()},l)}else this._clearReloadTimer()};t.startLoad=function e(){this.stopped=false;this._loadCurrentTrack()};t.stopLoad=function e(){this.stopped=true;this._clearReloadTimer()};t._clearReloadTimer=function e(){if(this.timer){clearTimeout(this.timer);this.timer=null}};t._loadCurrentTrack=function e(){var t=this.trackId,r=this.tracks,n=this.hls;var i=r[t];if(t<0||!i||i.details&&!i.details.live)return;F["logger"].log("Loading subtitle track "+t);n.trigger(M["default"].SUBTITLE_TRACK_LOADING,{url:i.url,id:t})};t._toggleTrackModes=function e(t){var r=this.media,n=this.subtitleDisplay,i=this.trackId;if(!r)return;var a=en(r.textTracks);if(t===-1)[].slice.call(a).forEach(function(e){e.mode="disabled"});else{var s=a[i];if(s)s.mode="disabled"}var o=a[t];if(o)o.mode=n?"showing":"hidden"};t._setSubtitleTrackInternal=function e(t){var r=this.hls,n=this.tracks;if(!Object(x["isFiniteNumber"])(t)||t<-1||t>=n.length)return;this.trackId=t;F["logger"].log("Switching to subtitle track "+t);r.trigger(M["default"].SUBTITLE_TRACK_SWITCH,{id:t});this._loadCurrentTrack()};t._onTextTracksChanged=function e(){if(!this.media||!this.hls.config.renderTextTracksNatively)return;var t=-1;var r=en(this.media.textTracks);for(var n=0;n<r.length;n++)if(r[n].mode==="hidden")t=n;else if(r[n].mode==="showing"){t=n;break}this.subtitleTrack=t};Zr(e,[{key:"subtitleTracks",get:function e(){return this.tracks}},{key:"subtitleTrack",get:function e(){return this.trackId},set:function e(t){if(this.trackId!==t){this._toggleTrackModes(t);this._setSubtitleTrackInternal(t)}}}]);return e}(i);function en(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r];if(n.kind==="subtitles"&&n.label)t.push(e[r])}return t}var tn=Jr;var rn=e("./src/crypt/decrypter.js");function nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function an(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var sn=window,on=sn.performance;var ln=500;var un=function(n){an(e,n);function e(e,t){var r;r=n.call(this,e,M["default"].MEDIA_ATTACHED,M["default"].MEDIA_DETACHING,M["default"].ERROR,M["default"].KEY_LOADED,M["default"].FRAG_LOADED,M["default"].SUBTITLE_TRACKS_UPDATED,M["default"].SUBTITLE_TRACK_SWITCH,M["default"].SUBTITLE_TRACK_LOADED,M["default"].SUBTITLE_FRAG_PROCESSED,M["default"].LEVEL_UPDATED)||this;r.fragmentTracker=t;r.config=e.config;r.state=K.STOPPED;r.tracks=[];r.tracksBuffered=[];r.currentTrackId=-1;r.decrypter=new rn["default"](e,e.config);r.lastAVStart=0;r._onMediaSeeking=r.onMediaSeeking.bind(nn(r));return r}var t=e.prototype;t.startLoad=function e(){this.stopLoad();this.state=K.IDLE;var t=this.tracks[this.currentTrackId];if(t&&t.details){this.setInterval(ln);this.tick()}};t.onSubtitleFragProcessed=function e(t){var r=t.frag,n=t.success;this.fragPrevious=r;this.state=K.IDLE;if(!n)return;var i=this.tracksBuffered[this.currentTrackId];if(!i)return;var a;var s=r.start;for(var o=0;o<i.length;o++)if(s>=i[o].start&&s<=i[o].end){a=i[o];break}var l=r.start+r.duration;if(a)a.end=l;else{a={start:s,end:l};i.push(a)}};t.onMediaAttached=function e(t){var r=t.media;this.media=r;r.addEventListener("seeking",this._onMediaSeeking);this.state=K.IDLE};t.onMediaDetaching=function e(){var t=this;if(!this.media)return;this.media.removeEventListener("seeking",this._onMediaSeeking);this.fragmentTracker.removeAllFragments();this.currentTrackId=-1;this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]});this.media=null;this.state=K.STOPPED};t.onError=function e(t){var r=t.frag;if(!r||r.type!=="subtitle")return;if(this.fragCurrent&&this.fragCurrent.loader)this.fragCurrent.loader.abort();this.state=K.IDLE};t.onSubtitleTracksUpdated=function e(t){var r=this;F["logger"].log("subtitle tracks updated");this.tracksBuffered=[];this.tracks=t.subtitleTracks;this.tracks.forEach(function(e){r.tracksBuffered[e.id]=[]})};t.onSubtitleTrackSwitch=function e(t){this.currentTrackId=t.id;if(!this.tracks||!this.tracks.length||this.currentTrackId===-1){this.clearInterval();return}var r=this.tracks[this.currentTrackId];if(r&&r.details)this.setInterval(ln)};t.onSubtitleTrackLoaded=function e(t){var r=t.id,n=t.details;var i=this.currentTrackId,a=this.tracks;var s=a[i];if(r>=a.length||r!==i||!s)return;if(n.live)Pe(s.details,n,this.lastAVStart);s.details=n;this.setInterval(ln)};t.onKeyLoaded=function e(){if(this.state===K.KEY_LOADING)this.state=K.IDLE};t.onFragLoaded=function e(t){var r=this.fragCurrent;var n=t.frag.decryptdata;var i=t.frag;var a=this.hls;if(this.state===K.FRAG_LOADING&&r&&t.frag.type==="subtitle"&&r.sn===t.frag.sn)if(t.payload.byteLength>0&&n&&n.key&&n.method==="AES-128"){var s=on.now();this.decrypter.decrypt(t.payload,n.key.buffer,n.iv.buffer,function(e){var t=on.now();a.trigger(M["default"].FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:s,tdecrypt:t}})})}};t.onLevelUpdated=function e(t){var r=t.details;var n=r.fragments;this.lastAVStart=n.length?n[0].start:0};t.doTick=function e(){if(!this.media){this.state=K.IDLE;return}switch(this.state){case K.IDLE:{var t=this.config,r=this.currentTrackId,n=this.fragmentTracker,i=this.media,a=this.tracks;if(!a||!a[r]||!a[r].details)break;var s=t.maxBufferHole,o=t.maxFragLookUpTolerance;var l=Math.min(t.maxBufferLength,t.maxMaxBufferLength);var u=j.bufferedInfo(this._getBuffered(),i.currentTime,s);var c=u.end,d=u.len;var f=a[r].details;var h=f.fragments;var p=h.length;var v=h[p-1].start+h[p-1].duration;if(d>l)return;var g;var A=this.fragPrevious;if(c<v){if(A&&f.hasProgramDateTime)g=$e(h,A.endProgramDateTime,o);if(!g)g=We(A,h,c,o)}else g=h[p-1];if(g&&g.encrypted){F["logger"].log("Loading key for "+g.sn);this.state=K.KEY_LOADING;this.hls.trigger(M["default"].KEY_LOADING,{frag:g})}else if(g&&n.getState(g)===B.NOT_LOADED){this.fragCurrent=g;this.state=K.FRAG_LOADING;this.hls.trigger(M["default"].FRAG_LOADING,{frag:g})}}}};t.stopLoad=function e(){this.lastAVStart=0;this.fragPrevious=null;n.prototype.stopLoad.call(this)};t._getBuffered=function e(){return this.tracksBuffered[this.currentTrackId]||[]};t.onMediaSeeking=function e(){if(this.fragCurrent){var t=this.media?this.media.currentTime:0;var r=this.config.maxFragLookUpTolerance;var n=this.fragCurrent.start-r;var i=this.fragCurrent.start+this.fragCurrent.duration+r;if(t<n||t>i){if(this.fragCurrent.loader)this.fragCurrent.loader.abort();this.fragmentTracker.removeFragment(this.fragCurrent);this.fragCurrent=null;this.fragPrevious=null;this.state=K.IDLE;this.tick()}}};return e}(it);var _;(function(e){e["WIDEVINE"]="com.widevine.alpha";e["PLAYREADY"]="com.microsoft.playready"})(_||(_={}));var cn=function(){if(typeof window!=="undefined"&&window.navigator&&window.navigator.requestMediaKeySystemAccess)return window.navigator.requestMediaKeySystemAccess.bind(window.navigator);else return null}();function dn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function fn(e,t,r){if(t)dn(e.prototype,t);if(r)dn(e,r);return e}function hn(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var pn=3;var vn=function e(t,r,n){var i={audioCapabilities:[],videoCapabilities:[]};t.forEach(function(e){i.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:n.audioRobustness||""})});r.forEach(function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:n.videoRobustness||""})});return[i]};var gn=function e(t,r,n,i){switch(t){case _.WIDEVINE:return vn(r,n,i);default:throw new Error("Unknown key-system: "+t)}};var An=function(t){hn(e,t);function e(e){var n;n=t.call(this,e,M["default"].MEDIA_ATTACHED,M["default"].MEDIA_DETACHED,M["default"].MANIFEST_PARSED)||this;n._widevineLicenseUrl=void 0;n._licenseXhrSetup=void 0;n._emeEnabled=void 0;n._requestMediaKeySystemAccess=void 0;n._drmSystemOptions=void 0;n._config=void 0;n._mediaKeysList=[];n._media=null;n._hasSetMediaKeys=false;n._requestLicenseFailureCount=0;n.mediaKeysPromise=null;n._onMediaEncrypted=function(r){F["logger"].log('Media is encrypted using "'+r.initDataType+'" init data type');if(!n.mediaKeysPromise){F["logger"].error("Fatal: Media is encrypted but no CDM access or no keys have been requested");n.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_KEYS,fatal:true});return}var e=function e(t){if(!n._media)return;n._attemptSetMediaKeys(t);n._generateRequestWithPreferredKeySession(r.initDataType,r.initData)};n.mediaKeysPromise.then(e).catch(e)};n._config=e.config;n._widevineLicenseUrl=n._config.widevineLicenseUrl;n._licenseXhrSetup=n._config.licenseXhrSetup;n._emeEnabled=n._config.emeEnabled;n._requestMediaKeySystemAccess=n._config.requestMediaKeySystemAccessFunc;n._drmSystemOptions=e.config.drmSystemOptions;return n}var r=e.prototype;r.getLicenseServerUrl=function e(t){switch(t){case _.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')};r._attemptKeySystemAccess=function e(t,r,n){var i=this;var a=gn(t,r,n,this._drmSystemOptions);F["logger"].log("Requesting encrypted media key-system access");var s=this.requestMediaKeySystemAccess(t,a);this.mediaKeysPromise=s.then(function(e){return i._onMediaKeySystemAccessObtained(t,e)});s.catch(function(e){F["logger"].error('Failed to obtain key-system "'+t+'" access:',e)})};r._onMediaKeySystemAccessObtained=function e(t,r){var n=this;F["logger"].log('Access for key-system "'+t+'" obtained');var i={mediaKeysSessionInitialized:false,mediaKeySystemAccess:r,mediaKeySystemDomain:t};this._mediaKeysList.push(i);var a=Promise.resolve().then(function(){return r.createMediaKeys()}).then(function(e){i.mediaKeys=e;F["logger"].log('Media-keys created for key-system "'+t+'"');n._onMediaKeysCreated();return e});a.catch(function(e){F["logger"].error("Failed to create media-keys:",e)});return a};r._onMediaKeysCreated=function e(){var t=this;this._mediaKeysList.forEach(function(e){if(!e.mediaKeysSession){e.mediaKeysSession=e.mediaKeys.createSession();t._onNewMediaKeySession(e.mediaKeysSession)}})};r._onNewMediaKeySession=function e(t){var r=this;F["logger"].log("New key-system session "+t.sessionId);t.addEventListener("message",function(e){r._onKeySessionMessage(t,e.message)},false)};r._onKeySessionMessage=function e(t,r){F["logger"].log("Got EME message event, creating license request");this._requestLicense(r,function(e){F["logger"].log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session");t.update(e)})};r._attemptSetMediaKeys=function e(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var r=this._mediaKeysList[0];if(!r||!r.mediaKeys){F["logger"].error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet");this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_KEYS,fatal:true});return}F["logger"].log("Setting keys for encrypted media");this._media.setMediaKeys(r.mediaKeys);this._hasSetMediaKeys=true}};r._generateRequestWithPreferredKeySession=function e(t,r){var n=this;var i=this._mediaKeysList[0];if(!i){F["logger"].error("Fatal: Media is encrypted but not any key-system access has been obtained yet");this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_ACCESS,fatal:true});return}if(i.mediaKeysSessionInitialized){F["logger"].warn("Key-Session already initialized but requested again");return}var a=i.mediaKeysSession;if(!a){F["logger"].error("Fatal: Media is encrypted but no key-session existing");this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_SESSION,fatal:true});return}if(!r){F["logger"].warn("Fatal: initData required for generating a key session is null");this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_INIT_DATA,fatal:true});return}F["logger"].log('Generating key-session request for "'+t+'" init data type');i.mediaKeysSessionInitialized=true;a.generateRequest(t,r).then(function(){F["logger"].debug("Key-session generation succeeded")}).catch(function(e){F["logger"].error("Error generating key-session request:",e);n.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_SESSION,fatal:false})})};r._createLicenseXhr=function e(t,r,n){var i=new XMLHttpRequest;var a=this._licenseXhrSetup;try{if(a)try{a(i,t)}catch(e){i.open("POST",t,true);a(i,t)}if(!i.readyState)i.open("POST",t,true)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}i.responseType="arraybuffer";i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,r,n);return i};r._onLicenseRequestReadyStageChange=function e(t,r,n,i){switch(t.readyState){case 4:if(t.status===200){this._requestLicenseFailureCount=0;F["logger"].log("License request succeeded");if(t.responseType!=="arraybuffer")F["logger"].warn("xhr response type was not set to the expected arraybuffer for license request");i(t.response)}else{F["logger"].error("License Request XHR failed ("+r+"). Status: "+t.status+" ("+t.statusText+")");this._requestLicenseFailureCount++;if(this._requestLicenseFailureCount>pn){this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:true});return}var a=pn-this._requestLicenseFailureCount+1;F["logger"].warn("Retrying license request, "+a+" attempts left");this._requestLicense(n,i)}break}};r._generateLicenseRequestChallenge=function e(t,r){switch(t.mediaKeySystemDomain){case _.WIDEVINE:return r}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)};r._requestLicense=function e(t,r){F["logger"].log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n){F["logger"].error("Fatal error: Media is encrypted but no key-system access has been obtained yet");this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_NO_ACCESS,fatal:true});return}try{var i=this.getLicenseServerUrl(n.mediaKeySystemDomain);var a=this._createLicenseXhr(i,t,r);F["logger"].log("Sending license request to URL: "+i);var s=this._generateLicenseRequestChallenge(n,t);a.send(s)}catch(e){F["logger"].error("Failure requesting DRM license: "+e);this.hls.trigger(M["default"].ERROR,{type:A["ErrorTypes"].KEY_SYSTEM_ERROR,details:A["ErrorDetails"].KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:true})}};r.onMediaAttached=function e(t){if(!this._emeEnabled)return;var r=t.media;this._media=r;r.addEventListener("encrypted",this._onMediaEncrypted)};r.onMediaDetached=function e(){var t=this._media;var r=this._mediaKeysList;if(!t)return;t.removeEventListener("encrypted",this._onMediaEncrypted);this._media=null;this._mediaKeysList=[];Promise.all(r.map(function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch(function(){})})).then(function(){return t.setMediaKeys(null)}).catch(function(){})};r.onManifestParsed=function e(t){if(!this._emeEnabled)return;var r=t.levels.map(function(e){return e.audioCodec});var n=t.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(_.WIDEVINE,r,n)};fn(e,[{key:"requestMediaKeySystemAccess",get:function e(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]);return e}(i);var mn=An;function yn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function En(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2)yn(Object(r),true).forEach(function(e){bn(t,e,r[e])});else if(Object.getOwnPropertyDescriptors)Object.defineProperties(t,Object.getOwnPropertyDescriptors(r));else yn(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function bn(e,t,r){if(t in e)Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});else e[t]=r;return e}var kn=En(En({autoStartLoad:true,startPosition:-1,defaultAudioCodec:void 0,debug:false,capLevelOnFPSDrop:false,capLevelToPlayerSize:false,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:false,liveBackBufferLength:Infinity,maxMaxBufferLength:600,enableWorker:true,enableSoftwareAES:true,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:false,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Zt,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:xt,bufferController:Ut,capLevelController:Yt,fpsController:qt,stretchShortVideoTrack:false,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:true,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:false,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:false,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:cn,testBandwidth:true},_n()),{},{subtitleStreamController:un,subtitleTrackController:tn,timelineController:qr,audioStreamController:ur,audioTrackController:rr,emeController:mn});function _n(){return{cueHandler:t,enableCEA708Captions:true,enableWebVTT:true,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:true}}function Tn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});r.push.apply(r,n)}return r}function Sn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};if(e%2)Tn(Object(r),true).forEach(function(e){Cn(t,e,r[e])});else if(Object.getOwnPropertyDescriptors)Object.defineProperties(t,Object.getOwnPropertyDescriptors(r));else Tn(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Cn(e,t,r){if(t in e)Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true});else e[t]=r;return e}function T(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function wn(e,t,r){if(t)Rn(e.prototype,t);if(r)Rn(e,r);return e}function On(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var Ln=function(k){On(_,k);_.isSupported=function e(){return _t()};wn(_,null,[{key:"version",get:function e(){return"0.14.17"}},{key:"Events",get:function e(){return M["default"]}},{key:"ErrorTypes",get:function e(){return A["ErrorTypes"]}},{key:"ErrorDetails",get:function e(){return A["ErrorDetails"]}},{key:"DefaultConfig",get:function e(){if(!_.defaultConfig)return kn;return _.defaultConfig},set:function e(t){_.defaultConfig=t}}]);function _(e){var t;if(e===void 0)e={};t=k.call(this)||this;t.config=void 0;t._autoLevelCapping=void 0;t.abrController=void 0;t.capLevelController=void 0;t.levelController=void 0;t.streamController=void 0;t.networkControllers=void 0;t.audioTrackController=void 0;t.subtitleTrackController=void 0;t.emeController=void 0;t.coreComponents=void 0;t.media=null;t.url=null;var r=_.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");t.config=Sn(Sn({},r),e);var n=T(t),i=n.config;if(i.liveMaxLatencyDurationCount!==void 0&&i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(i.liveMaxLatencyDuration!==void 0&&(i.liveSyncDuration===void 0||i.liveMaxLatencyDuration<=i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(F["enableLogs"])(i.debug);t._autoLevelCapping=-1;var a=t.abrController=new i.abrController(T(t));var s=new i.bufferController(T(t));var o=t.capLevelController=new i.capLevelController(T(t));var l=new i.fpsController(T(t));var u=new de(T(t));var c=new pe(T(t));var d=new Ae(T(t));var f=new kt(T(t));var h=t.levelController=new vt(T(t));var p=new ye(T(t));var v=t.streamController=new ct(T(t),p);var g=[h,v];var A=i.audioStreamController;if(A)g.push(new A(T(t),p));t.networkControllers=g;var m=[u,c,d,a,s,o,l,f,p];A=i.audioTrackController;if(A){var y=new A(T(t));t.audioTrackController=y;m.push(y)}A=i.subtitleTrackController;if(A){var E=new A(T(t));t.subtitleTrackController=E;g.push(E)}A=i.emeController;if(A){var b=new A(T(t));t.emeController=b;m.push(b)}A=i.subtitleStreamController;if(A)g.push(new A(T(t),p));A=i.timelineController;if(A)m.push(new A(T(t)));t.coreComponents=m;return t}var e=_.prototype;e.destroy=function e(){F["logger"].log("destroy");this.trigger(M["default"].DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()});this.url=null;this.removeAllListeners();this._autoLevelCapping=-1};e.attachMedia=function e(t){F["logger"].log("attachMedia");this.media=t;this.trigger(M["default"].MEDIA_ATTACHING,{media:t})};e.detachMedia=function e(){F["logger"].log("detachMedia");this.trigger(M["default"].MEDIA_DETACHING);this.media=null};e.loadSource=function e(t){t=n["buildAbsoluteURL"](window.location.href,t,{alwaysNormalize:true});F["logger"].log("loadSource:"+t);this.url=t;this.trigger(M["default"].MANIFEST_LOADING,{url:t})};e.startLoad=function e(t){if(t===void 0)t=-1;F["logger"].log("startLoad("+t+")");this.networkControllers.forEach(function(e){e.startLoad(t)})};e.stopLoad=function e(){F["logger"].log("stopLoad");this.networkControllers.forEach(function(e){e.stopLoad()})};e.swapAudioCodec=function e(){F["logger"].log("swapAudioCodec");this.streamController.swapAudioCodec()};e.recoverMediaError=function e(){F["logger"].log("recoverMediaError");var t=this.media;this.detachMedia();if(t)this.attachMedia(t)};e.removeLevel=function e(t,r){if(r===void 0)r=0;this.levelController.removeLevel(t,r)};wn(_,[{key:"levels",get:function e(){return this.levelController.levels}},{key:"currentLevel",get:function e(){return this.streamController.currentLevel},set:function e(t){F["logger"].log("set currentLevel:"+t);this.loadLevel=t;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function e(){return this.streamController.nextLevel},set:function e(t){F["logger"].log("set nextLevel:"+t);this.levelController.manualLevel=t;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function e(){return this.levelController.level},set:function e(t){F["logger"].log("set loadLevel:"+t);this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function e(){return this.levelController.nextLoadLevel},set:function e(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function e(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function e(t){F["logger"].log("set firstLevel:"+t);this.levelController.firstLevel=t}},{key:"startLevel",get:function e(){return this.levelController.startLevel},set:function e(t){F["logger"].log("set startLevel:"+t);if(t!==-1)t=Math.max(t,this.minAutoLevel);this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function e(t){var r=!!t;if(r!==this.config.capLevelToPlayerSize){if(r)this.capLevelController.startCapping();else{this.capLevelController.stopCapping();this.autoLevelCapping=-1;this.streamController.nextLevelSwitch()}this.config.capLevelToPlayerSize=r}}},{key:"autoLevelCapping",get:function e(){return this._autoLevelCapping},set:function e(t){F["logger"].log("set autoLevelCapping:"+t);this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function e(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function e(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function e(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function e(){var t=this.levels,r=this.config.minAutoBitrate;var n=t?t.length:0;for(var i=0;i<n;i++){var a=t[i].realBitrate?Math.max(t[i].realBitrate,t[i].bitrate):t[i].bitrate;if(a>r)return i}return 0}},{key:"maxAutoLevel",get:function e(){var t=this.levels,r=this.autoLevelCapping;var n;if(r===-1&&t&&t.length)n=t.length-1;else n=r;return n}},{key:"nextAutoLevel",get:function e(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function e(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function e(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function e(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function e(t){var r=this.audioTrackController;if(r)r.audioTrack=t}},{key:"liveSyncPosition",get:function e(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function e(t){var r=this.subtitleTrackController;if(r)r.subtitleTrack=t}},{key:"subtitleDisplay",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleDisplay:false},set:function e(t){var r=this.subtitleTrackController;if(r)r.subtitleDisplay=t}}]);return _}(Ce);Ln.defaultConfig=void 0},"./src/polyfills/number.js":
/*!*********************************!*\
    !*** ./src/polyfills/number.js ***!
    \*********************************/
/*! exports provided: isFiniteNumber, MAX_SAFE_INTEGER */function(e,t,r){r.r(t);r.d(t,"isFiniteNumber",function(){return n});r.d(t,"MAX_SAFE_INTEGER",function(){return i});var n=Number.isFinite||function(e){return typeof e==="number"&&isFinite(e)};var i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":
/*!*************************************!*\
    !*** ./src/utils/get-self-scope.js ***!
    \*************************************/
/*! exports provided: getSelfScope */function(e,t,r){r.r(t);r.d(t,"getSelfScope",function(){return n});function n(){if(typeof window==="undefined")return self;else return window}},"./src/utils/logger.js":
/*!*****************************!*\
    !*** ./src/utils/logger.js ***!
    \*****************************/
/*! exports provided: enableLogs, logger */function(e,t,r){r.r(t);r.d(t,"enableLogs",function(){return d});r.d(t,"logger",function(){return f});var n=r(/*! ./get-self-scope */"./src/utils/get-self-scope.js");function a(){}var i={trace:a,debug:a,log:a,warn:a,info:a,error:a};var s=i;function o(e,t){t="["+e+"] > "+t;return t}var l=Object(n["getSelfScope"])();function u(n){var i=l.console[n];if(i)return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t[0])t[0]=o(n,t[0]);i.apply(l.console,t)};return a}function c(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.forEach(function(e){s[e]=t[e]?t[e].bind(t):u(e)})}var d=function e(t){if(l.console&&t===true||typeof t==="object"){c(t,"debug","log","info","warn","error");try{s.log()}catch(e){s=i}}else s=i};var f=s}})["default"]}),Gi(Ki.exports)),zi=t.now,$i=t.assign,Wi=t.listContainsIgnoreCase,qi=-1,Xi=(k.register("PLAYBACK_FRAGMENT_CHANGED"),k.register("PLAYBACK_FRAGMENT_PARSING_METADATA"),function(e){Ri(a,e);var i=Di(a);function a(){var e;_i(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e=i.call.apply(i,[this].concat(r));e.options.playback=ki(ki({},e.options),e.options.playback);e.options.hlsPlayback=ki(ki({},e.defaultOptions),e.options.hlsPlayback);e._minDvrSize=typeof e.options.hlsMinimumDvrSize==="undefined"?60:e.options.hlsMinimumDvrSize;e._extrapolatedWindowNumSegments=!e.options.playback||typeof e.options.playback.extrapolatedWindowNumSegments==="undefined"?2:e.options.playback.extrapolatedWindowNumSegments;e._playbackType=S.VOD;e._lastTimeUpdate={current:0,total:0};e._lastDuration=null;e._playableRegionStartTime=0;e._localStartTimeCorrelation=null;e._localEndTimeCorrelation=null;e._playableRegionDuration=0;e._programDateTime=0;e._durationExcludesAfterLiveSyncPoint=false;e._segmentTargetDuration=null;e._playlistType=null;e._recoverAttemptsRemaining=e.options.hlsRecoverAttempts||16;return e}Si(a,[{key:"name",get:function e(){return"hls"}},{key:"supportedVersion",get:function e(){return{min:"0.4.18"}}},{key:"levels",get:function e(){return this._levels||[]}},{key:"currentLevel",get:function e(){if(this._currentLevel===null||this._currentLevel===undefined)return qi;else return this._currentLevel},set:function e(t){this._currentLevel=t;this.trigger(k.PLAYBACK_LEVEL_SWITCH_START);if(this.options.playback.hlsUseNextLevel)this._hls.nextLevel=this._currentLevel;else this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function e(){return this._isReadyState}},{key:"_startTime",get:function e(){if(this._playbackType===S.LIVE&&this._playlistType!=="EVENT")return this._extrapolatedStartTime;return this._playableRegionStartTime}},{key:"_now",get:function e(){return zi()}},{key:"_extrapolatedStartTime",get:function e(){if(!this._localStartTimeCorrelation)return this._playableRegionStartTime;var t=this._localStartTimeCorrelation;var r=this._now-t.local;var n=(t.remote+r)/1e3;return Math.min(n,this._playableRegionStartTime+this._extrapolatedWindowDuration)}},{key:"_extrapolatedEndTime",get:function e(){var t=this._playableRegionStartTime+this._playableRegionDuration;if(!this._localEndTimeCorrelation)return t;var r=this._localEndTimeCorrelation;var n=this._now-r.local;var i=(r.remote+n)/1e3;return Math.max(t-this._extrapolatedWindowDuration,Math.min(i,t))}},{key:"_duration",get:function e(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function e(){if(this._segmentTargetDuration===null)return 0;return this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function e(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function e(){return{preload:true}}},{key:"customListeners",get:function e(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"_setup",value:function e(){var r=this;this._manifestParsed=false;this._ccIsSetup=false;this._ccTracksUpdated=false;this._hls&&this._hls.destroy();this._hls=new x($i({},this.options.playback.hlsjsConfig));this._hls.once(x.Events.MEDIA_ATTACHED,function(){r.options.hlsPlayback.preload&&r._hls.loadSource(r.options.src)});this._hls.on(x.Events.MANIFEST_PARSED,function(){return r._manifestParsed=true});this._hls.on(x.Events.LEVEL_LOADED,function(e,t){return r._updatePlaybackType(e,t)});this._hls.on(x.Events.LEVEL_UPDATED,function(e,t){return r._onLevelUpdated(e,t)});this._hls.on(x.Events.LEVEL_SWITCHING,function(e,t){return r._onLevelSwitch(e,t)});this._hls.on(x.Events.FRAG_CHANGED,function(e,t){return r._onFragmentChanged(e,t)});this._hls.on(x.Events.FRAG_LOADED,function(e,t){return r._onFragmentLoaded(e,t)});this._hls.on(x.Events.FRAG_PARSING_METADATA,function(e,t){return r._onFragmentParsingMetadata(e,t)});this._hls.on(x.Events.ERROR,function(e,t){return r._onHLSJSError(e,t)});this._hls.on(x.Events.SUBTITLE_TRACK_LOADED,function(e,t){return r._onSubtitleLoaded(e,t)});this._hls.on(x.Events.SUBTITLE_TRACKS_UPDATED,function(){return r._ccTracksUpdated=true});this.bindCustomListeners();this._hls.attachMedia(this.el)}},{key:"bindCustomListeners",value:function e(){var n=this;this.customListeners.forEach(function(e){var t=e.eventName;var r=e.once?"once":"on";t&&n._hls["".concat(r)](t,e.callback)})}},{key:"unbindCustomListeners",value:function e(){var r=this;this.customListeners.forEach(function(e){var t=e.eventName;t&&r._hls.off(t,e.callback)})}},{key:"_onFragmentParsingMetadata",value:function e(t,r){this.trigger(k.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:t,data:r})}},{key:"render",value:function e(){this._ready();return Ni(N(a.prototype),"render",this).call(this)}},{key:"_ready",value:function e(){if(this._isReadyState)return;!this._hls&&this._setup();this._isReadyState=true;this.trigger(k.PLAYBACK_READY,this.name)}},{key:"_recover",value:function e(t,r,n){if(!this._recoveredDecodingError){this._recoveredDecodingError=true;this._hls.recoverMediaError()}else if(!this._recoveredAudioCodecError){this._recoveredAudioCodecError=true;this._hls.swapAudioCodec();this._hls.recoverMediaError()}else{b.error("hlsjs: failed to recover",{evt:t,data:r});n.level=T.Levels.FATAL;var i=this.createError(n);this.trigger(k.PLAYBACK_ERROR,i);this.stop()}}},{key:"_setupSrc",value:function e(t){}},{key:"_startTimeUpdateTimer",value:function e(){var t=this;if(this._timeUpdateTimer)return;this._timeUpdateTimer=setInterval(function(){t._onDurationChange();t._onTimeUpdate()},100)}},{key:"_stopTimeUpdateTimer",value:function e(){if(!this._timeUpdateTimer)return;clearInterval(this._timeUpdateTimer);this._timeUpdateTimer=null}},{key:"getProgramDateTime",value:function e(){return this._programDateTime}},{key:"getDuration",value:function e(){return this._duration}},{key:"getCurrentTime",value:function e(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function e(){return this._startTime}},{key:"seekPercentage",value:function e(t){var r=this._duration;if(t>0)r=this._duration*(t/100);this.seek(r)}},{key:"seek",value:function e(t){if(t<0){b.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point.");t=this.getDuration()}this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3);t+=this._startTime;this.el.currentTime=t}},{key:"seekToLivePoint",value:function e(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function e(t){this.trigger(k.PLAYBACK_DVR,t);this.trigger(k.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"_updateSettings",value:function e(){if(this._playbackType===S.VOD)this.settings.left=["playpause","position","duration"];else if(this.dvrEnabled)this.settings.left=["playpause"];else this.settings.left=["playstop"];this.settings.seekEnabled=this.isSeekEnabled();this.trigger(k.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function e(t,r){var n={code:"".concat(r.type,"_").concat(r.details),description:"".concat(this.name," error: type: ").concat(r.type,", details: ").concat(r.details),raw:r};var i;if(r.response)n.description+=", response: ".concat(JSON.stringify(r.response));if(r.fatal)if(this._recoverAttemptsRemaining>0){this._recoverAttemptsRemaining-=1;switch(r.type){case x.ErrorTypes.NETWORK_ERROR:switch(r.details){case x.ErrorDetails.MANIFEST_LOAD_ERROR:case x.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case x.ErrorDetails.MANIFEST_PARSING_ERROR:case x.ErrorDetails.LEVEL_LOAD_ERROR:case x.ErrorDetails.LEVEL_LOAD_TIMEOUT:b.error("hlsjs: unrecoverable network fatal error.",{evt:t,data:r});i=this.createError(n);this.trigger(k.PLAYBACK_ERROR,i);this.stop();break;default:b.warn("hlsjs: trying to recover from network error.",{evt:t,data:r});n.level=T.Levels.WARN;this._hls.startLoad();break}break;case x.ErrorTypes.MEDIA_ERROR:b.warn("hlsjs: trying to recover from media error.",{evt:t,data:r});n.level=T.Levels.WARN;this._recover(t,r,n);break;default:b.error("hlsjs: could not recover from error.",{evt:t,data:r});i=this.createError(n);this.trigger(k.PLAYBACK_ERROR,i);this.stop();break}}else{b.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:t,data:r});i=this.createError(n);this.trigger(k.PLAYBACK_ERROR,i);this.stop()}else{if(this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(r)){b.error("hlsjs: could not load decrypt key.",{evt:t,data:r});i=this.createError(n);this.trigger(k.PLAYBACK_ERROR,i);this.stop();return}n.level=T.Levels.WARN;b.warn("hlsjs: non-fatal error occurred",{evt:t,data:r})}}},{key:"_keyIsDenied",value:function e(t){return t.type===x.ErrorTypes.NETWORK_ERROR&&t.details===x.ErrorDetails.KEY_LOAD_ERROR&&t.response&&t.response.code>=400}},{key:"_onTimeUpdate",value:function e(){var t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()};var r=this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total;if(r)return;this._lastTimeUpdate=t;this.trigger(k.PLAYBACK_TIMEUPDATE,t,this.name)}},{key:"_onDurationChange",value:function e(){var t=this.getDuration();if(this._lastDuration===t)return;this._lastDuration=t;Ni(N(a.prototype),"_onDurationChange",this).call(this)}},{key:"_onProgress",value:function e(){if(!this.el.buffered.length)return;var t=[];var r=0;for(var n=0;n<this.el.buffered.length;n++){t=[].concat(xi(t),[{start:Math.max(0,this.el.buffered.start(n)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(n)-this._playableRegionStartTime)}]);if(this.el.currentTime>=t[n].start&&this.el.currentTime<=t[n].end)r=n}var i={start:t[r].start,current:t[r].end,total:this.getDuration()};this.trigger(k.PLAYBACK_PROGRESS,i,t)}},{key:"play",value:function e(){!this._hls&&this._setup();!this._manifestParsed&&!this.options.hlsPlayback.preload&&this._hls.loadSource(this.options.src);Ni(N(a.prototype),"play",this).call(this);this._startTimeUpdateTimer()}},{key:"pause",value:function e(){if(!this._hls)return;this.el.pause();if(this.dvrEnabled)this._updateDvr(true)}},{key:"stop",value:function e(){this._stopTimeUpdateTimer();if(this._hls){Ni(N(a.prototype),"stop",this).call(this);this._hls.destroy();delete this._hls}}},{key:"destroy",value:function e(){this._stopTimeUpdateTimer();if(this._hls){this._hls.destroy();delete this._hls}Ni(N(a.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function e(t,r){this._playbackType=r.details.live?S.LIVE:S.VOD;this._onLevelUpdated(t,r);if(this._ccTracksUpdated&&this._playbackType===S.LIVE&&this.hasClosedCaptionsTracks)this._onSubtitleLoaded()}},{key:"_fillLevels",value:function e(){this._levels=this._hls.levels.map(function(e,t){return{id:t,level:e,label:"".concat(e.bitrate/1e3,"Kbps")}});this.trigger(k.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function e(t,r){this._segmentTargetDuration=r.details.targetduration;this._playlistType=r.details.type||null;var n=false;var i=false;var a=r.details.fragments;var s=this._playableRegionStartTime;var o=this._playableRegionDuration;if(a.length===0)return;if(a[0].rawProgramDateTime)this._programDateTime=a[0].rawProgramDateTime;if(this._playableRegionStartTime!==a[0].start){n=true;this._playableRegionStartTime=a[0].start}if(n)if(!this._localStartTimeCorrelation)this._localStartTimeCorrelation={local:this._now,remote:(a[0].start+this._extrapolatedWindowDuration/2)*1e3};else{var l=this._localStartTimeCorrelation;var u=this._now-l.local;var c=(l.remote+u)/1e3;if(c<a[0].start)this._localStartTimeCorrelation={local:this._now,remote:a[0].start*1e3};else if(c>s+this._extrapolatedWindowDuration)this._localStartTimeCorrelation={local:this._now,remote:Math.max(a[0].start,s+this._extrapolatedWindowDuration)*1e3}}var d=r.details.totalduration;if(this._playbackType===S.LIVE){var f=r.details.targetduration;var h=this.options.playback.hlsjsConfig||{};var p=h.liveSyncDurationCount||x.DefaultConfig.liveSyncDurationCount;var v=f*p;if(v<=d){d-=v;this._durationExcludesAfterLiveSyncPoint=true}else this._durationExcludesAfterLiveSyncPoint=false}if(d!==this._playableRegionDuration){i=true;this._playableRegionDuration=d}var g=a[0].start+d;var A=s+o;var m=g!==A;if(m)if(!this._localEndTimeCorrelation)this._localEndTimeCorrelation={local:this._now,remote:g*1e3};else{var y=this._localEndTimeCorrelation;var E=this._now-y.local;var b=(y.remote+E)/1e3;if(b>g)this._localEndTimeCorrelation={local:this._now,remote:g*1e3};else if(b<g-this._extrapolatedWindowDuration)this._localEndTimeCorrelation={local:this._now,remote:(g-this._extrapolatedWindowDuration)*1e3};else if(b>A)this._localEndTimeCorrelation={local:this._now,remote:A*1e3}}i&&this._onDurationChange();n&&this._onProgress()}},{key:"_onFragmentChanged",value:function e(t,r){this.trigger(k.Custom.PLAYBACK_FRAGMENT_CHANGED,r)}},{key:"_onFragmentLoaded",value:function e(t,r){this.trigger(k.PLAYBACK_FRAGMENT_LOADED,r)}},{key:"_onSubtitleLoaded",value:function e(){if(!this._ccIsSetup){this.trigger(k.PLAYBACK_SUBTITLE_AVAILABLE);var t=this._playbackType===S.LIVE?-1:this.closedCaptionsTrackId;this.closedCaptionsTrackId=t;this._ccIsSetup=true}}},{key:"_onLevelSwitch",value:function e(t,r){if(!this.levels.length)this._fillLevels();this.trigger(k.PLAYBACK_LEVEL_SWITCH_END);this.trigger(k.PLAYBACK_LEVEL_SWITCH,r);var n=this._hls.levels[r.level];if(n){this.highDefinition=n.height>=720||n.bitrate/1e3>=2e3;this.trigger(k.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition);this.trigger(k.PLAYBACK_BITRATE,{height:n.height,width:n.width,bandwidth:n.bitrate,bitrate:n.bitrate,level:r.level})}}},{key:"dvrEnabled",get:function e(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===S.LIVE}},{key:"getPlaybackType",value:function e(){return this._playbackType}},{key:"isSeekEnabled",value:function e(){return this._playbackType===S.VOD||this.dvrEnabled}}],[{key:"HLSJS",get:function e(){return x}}]);return a}(R)),Zi;return Xi.canPlay=function(e,t){var r=e.split("?")[0].match(/.*\.(.*)$/)||[];var n=r.length>1&&r[1].toLowerCase()==="m3u8"||Wi(t,["application/vnd.apple.mpegurl","application/x-mpegURL"]);return!!(x.isSupported()&&n)},Ei.Loader.registerPlayback(Xi),F(F({},Ei),{},{HLS:Xi})}()}.call(this,r(31))},4:function(r,e,t){"use strict";function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){t&&B(e.prototype,t),r&&B(e,r)}function U(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function j(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?U(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,r=a(n);return e=i?(e=a(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments),r=this,!(t=e)||"object"!=typeof t&&"function"!=typeof t?G(r):t}}function K(e,t,r){return(K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(e)return(e=Object.getOwnPropertyDescriptor(e,t)).get?e.get.call(r):e.value})(e,t,r||e)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}}(e,t)||z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e){return function(e){if(Array.isArray(e))return $(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){var r;if(e)return"string"==typeof e?$(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W(e,t){var r,n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=z(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}t.d(e,"a",function(){return P}),t.d(e,"b",function(){return M}),t.d(e,"c",function(){return D}),t.d(e,"d",function(){return x}),t.d(e,"e",function(){return pr}),t.d(e,"f",function(){return Zt}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],i=0;i<r;){var a=t[i];if(e.call(n,a,i,t))return a;i++}}}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=new Array(r);r--;)n[r]=[t[r],e[t[r]]];return n}),Object.values||(Object.values=function(e){for(var t=Object.keys(e),r=t.length,n=new Array(r);r--;)n[r]=e[t[r]];return n}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r},writable:!0,configurable:!0}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],i=0;i<r;){var a=t[i];if(e.call(n,a,i,t))return i;i++}return-1},configurable:!0,writable:!0});var l,o,f,n,q,X,i,Z,Q,h,p,J,ee,te,re,ne,ie,ae,se,oe,le,ue,ce,de,fe,v,he,pe,g,A,ve,m,ge,Ae,me,ye,Ee,be,ke,_e,Te,Se,y,Ce,E,b,Re,we,Oe,Le,Ie,De,Pe,Ne,xe,Me,Fe,Be,Ue,k,je,Ve,Ge,Ke,Ye,He,ze={mp4:"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="},t=(Z=(i=[]).concat,Q=i.filter,h=i.slice,p=window.document,J={},ee={},te={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},re=/^\s*<(\w+|!)[^>]*>/,ne=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ie=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ae=/^(?:body|html)$/i,se=/([A-Z])/g,oe=["val","css","html","text","data","width","height","offset"],t=p.createElement("table"),e=p.createElement("tr"),le={tr:p.createElement("tbody"),tbody:t,thead:t,tfoot:t,td:e,th:e,"*":p.createElement("div")},ue=/complete|loaded|interactive/,ce=/^[\w-]*$/,fe=(de={}).toString,v={},he=p.createElement("div"),pe={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},g=Array.isArray||function(e){return e instanceof Array},v.matches=function(e,t){var r,n;return!(!t||!e||1!==e.nodeType)&&((r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector)?r.call(e,t):((n=!(r=e.parentNode))&&(r=he).appendChild(e),r=~v.qsa(r,t).indexOf(e),n&&he.removeChild(e),r))},q=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},X=function(r){return Q.call(r,function(e,t){return r.indexOf(e)==t})},v.fragment=function(e,t,r){var n,i,a;return(n=ne.test(e)?f(p.createElement(RegExp.$1)):n)||(e.replace&&(e=e.replace(ie,"<$1></$2>")),t===l&&(t=re.test(e)&&RegExp.$1),(a=le[t=t in le?t:"*"]).innerHTML=""+e,n=f.each(h.call(a.childNodes),function(){a.removeChild(this)})),Ze(r)&&(i=f(n),f.each(r,function(e,t){-1<oe.indexOf(e)?i[e](t):i.attr(e,t)})),n},v.Z=function(e,t){return new nt(e,t)},v.isZ=function(e){return e instanceof v.Z},v.init=function(e,t){var r,n;if(!e)return v.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&re.test(e))r=v.fragment(e,RegExp.$1,t),e=null;else{if(t!==l)return f(t).find(e);r=v.qsa(p,e)}else{if(_(e))return f(p).ready(e);if(v.isZ(e))return e;if(g(e))n=e,r=Q.call(n,function(e){return null!=e});else if(Xe(e))r=[e],e=null;else if(re.test(e))r=v.fragment(e.trim(),RegExp.$1,t),e=null;else{if(t!==l)return f(t).find(e);r=v.qsa(p,e)}}return v.Z(r,e)},(f=function(e,t){return v.init(e,t)}).extend=function(t){var r,e=h.call(arguments,1);return"boolean"==typeof t&&(r=t,t=e.shift()),e.forEach(function(e){!function e(t,r,n){for(o in r)n&&(Ze(r[o])||g(r[o]))?(Ze(r[o])&&!Ze(t[o])&&(t[o]={}),g(r[o])&&!g(t[o])&&(t[o]=[]),e(t[o],r[o],n)):r[o]!==l&&(t[o]=r[o])}(t,e,r)}),t},v.qsa=function(e,t){var r,n="#"==t[0],i=!n&&"."==t[0],a=n||i?t.slice(1):t,s=ce.test(a);return e.getElementById&&s&&n?(r=e.getElementById(a))?[r]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:h.call(s&&!n&&e.getElementsByClassName?i?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))},f.contains=p.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t=t&&t.parentNode;)if(t===e)return!0;return!1},f.type=$e,f.isFunction=_,f.isWindow=We,f.isArray=g,f.isPlainObject=Ze,f.isEmptyObject=function(e){for(var t in e)return!1;return!0},f.isNumeric=function(e){var t=Number(e),r=typeof e;return null!=e&&"boolean"!=r&&("string"!=r||e.length)&&!isNaN(t)&&isFinite(t)||!1},f.inArray=function(e,t,r){return i.indexOf.call(t,e,r)},f.camelCase=q,f.trim=function(e){return null==e?"":String.prototype.trim.call(e)},f.uuid=0,f.support={},f.expr={},f.noop=function(){},f.map=function(e,t){var r,n,i,a,s=[];if(Qe(e))for(n=0;n<e.length;n++)null!=(r=t(e[n],n))&&s.push(r);else for(i in e)null!=(r=t(e[i],i))&&s.push(r);return 0<(a=s).length?f.fn.concat.apply([],a):a},f.each=function(e,t){var r,n;if(Qe(e)){for(r=0;r<e.length;r++)if(!1===t.call(e[r],r,e[r]))return e}else for(n in e)if(!1===t.call(e[n],n,e[n]))return e;return e},f.grep=function(e,t){return Q.call(e,t)},window.JSON&&(f.parseJSON=JSON.parse),f.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){de["[object "+t+"]"]=t.toLowerCase()}),f.fn={constructor:v.Z,length:0,forEach:i.forEach,reduce:i.reduce,push:i.push,sort:i.sort,splice:i.splice,indexOf:i.indexOf,concat:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=v.isZ(e=arguments[r])?e.toArray():e;return Z.apply(v.isZ(this)?this.toArray():this,t)},map:function(r){return f(f.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return f(h.apply(this,arguments))},ready:function(e){return ue.test(p.readyState)&&p.body?e(f):p.addEventListener("DOMContentLoaded",function(){e(f)},!1),this},get:function(e){return e===l?h.call(this):this[0<=e?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(r){return i.every.call(this,function(e,t){return!1!==r.call(e,t,e)}),this},filter:function(t){return _(t)?this.not(this.not(t)):f(Q.call(this,function(e){return v.matches(e,t)}))},add:function(e,t){return f(X(this.concat(f(e,t))))},is:function(e){return 0<this.length&&v.matches(this[0],e)},not:function(t){var r,n=[];return _(t)&&t.call!==l?this.each(function(e){t.call(this,e)||n.push(this)}):(r="string"==typeof t?this.filter(t):Qe(t)&&_(t.item)?h.call(t):f(t),this.forEach(function(e){r.indexOf(e)<0&&n.push(e)})),f(n)},has:function(e){return this.filter(function(){return Xe(e)?f.contains(this,e):f(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!Xe(e)?e:f(e)},last:function(){var e=this[this.length-1];return e&&!Xe(e)?e:f(e)},find:function(e){var r=this,t=e?"object"==typeof e?f(e).filter(function(){var t=this;return i.some.call(r,function(e){return f.contains(e,t)})}):1==this.length?f(v.qsa(this[0],e)):this.map(function(){return v.qsa(this,e)}):f();return t},closest:function(r,n){var i=[],a="object"==typeof r&&f(r);return this.each(function(e,t){for(;t&&!(a?0<=a.indexOf(t):v.matches(t,r));)t=t!==n&&!qe(t)&&t.parentNode;t&&i.indexOf(t)<0&&i.push(t)}),f(i)},parents:function(e){for(var t=[],r=this;0<r.length;)r=f.map(r,function(e){if((e=e.parentNode)&&!qe(e)&&t.indexOf(e)<0)return t.push(e),e});return it(t,e)},parent:function(e){return it(X(this.pluck("parentNode")),e)},children:function(e){return it(this.map(function(){return rt(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||h.call(this.childNodes)})},siblings:function(e){return it(this.map(function(e,t){return Q.call(rt(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return f.map(this,function(e){return e[t]})},show:function(){return this.each(function(){var e,t,r;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,J[e]||(t=p.createElement(e),p.body.appendChild(t),r=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),J[e]=r="none"==r?"block":r),J[e]))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(t){var r,n,i=_(t);return this[0]&&!i&&(r=f(t).get(0),n=r.parentNode||1<this.length),this.each(function(e){f(this).wrapAll(i?t.call(this,e):n?r.cloneNode(!0):r)})},wrapAll:function(e){if(this[0]){var t;for(f(this[0]).before(e=f(e));(t=e.children()).length;)e=t.first();f(e).append(this)}return this},wrapInner:function(n){var i=_(n);return this.each(function(e){var t=f(this),r=t.contents(),e=i?n.call(this,e):n;r.length?r.wrapAll(e):t.append(e)})},unwrap:function(){return this.parent().each(function(){f(this).replaceWith(f(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=f(this);(t===l?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(e){return f(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return f(this.pluck("nextElementSibling")).filter(e||"*")},html:function(r){return 0 in arguments?this.each(function(e){var t=this.innerHTML;f(this).empty().append(T(this,r,e,t))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){e=T(this,t,e,this.textContent);this.textContent=null==e?"":""+e}):0 in this?this.pluck("textContent").join(""):null},attr:function(t,r){var e;return"string"!=typeof t||1 in arguments?this.each(function(e){if(1===this.nodeType)if(Xe(t))for(o in t)at(this,o,t[o]);else at(this,t,T(this,r,e,this.getAttribute(t)))}):0 in this&&1==this[0].nodeType&&null!=(e=this[0].getAttribute(t))?e:l},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){at(this,e)},this)})},prop:function(t,r){return t=pe[t]||t,1 in arguments?this.each(function(e){this[t]=T(this,r,e,this[t])}):this[0]&&this[0][t]},removeProp:function(e){return e=pe[e]||e,this.each(function(){delete this[e]})},data:function(e,t){e="data-"+e.replace(se,"-$1").toLowerCase(),t=1 in arguments?this.attr(e,t):this.attr(e);return null!==t?st(t):l},val:function(t){return 0 in arguments?(null==t&&(t=""),this.each(function(e){this.value=T(this,t,e,this.value)})):this[0]&&(this[0].multiple?f(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(n){var e;return n?this.each(function(e){var t=f(this),e=T(this,n,e,t.offset()),r=t.offsetParent().offset(),e={top:e.top-r.top,left:e.left-r.left};"static"==t.css("position")&&(e.position="relative"),t.css(e)}):this.length?p.documentElement===this[0]||f.contains(p.documentElement,this[0])?{left:(e=this[0].getBoundingClientRect()).left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}:{top:0,left:0}:null},css:function(e,t){if(arguments.length<2){var r,n,i=this[0];if("string"==typeof e)return i?i.style[q(e)]||getComputedStyle(i,"").getPropertyValue(e):void 0;if(g(e))return i?(r={},n=getComputedStyle(i,""),f.each(e,function(e,t){r[t]=i.style[q(t)]||n.getPropertyValue(t)}),r):void 0}var a="";if("string"==$e(e))t||0===t?a=Je(e)+":"+tt(e,t):this.each(function(){this.style.removeProperty(Je(e))});else for(o in e)e[o]||0===e[o]?a+=Je(o)+":"+tt(o,e[o])+";":this.each(function(){this.style.removeProperty(Je(o))});return this.each(function(){this.style.cssText+=";"+a})},index:function(e){return e?this.indexOf(f(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&i.some.call(this,function(e){return this.test(S(e))},et(e))},addClass:function(r){return r?this.each(function(e){var t;"className"in this&&(n=[],t=S(this),T(this,r,e,t).split(/\s+/g).forEach(function(e){f(this).hasClass(e)||n.push(e)},this),n.length)&&S(this,t+(t?" ":"")+n.join(" "))}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===l)return S(this,"");n=S(this),T(this,t,e,n).split(/\s+/g).forEach(function(e){n=n.replace(et(e)," ")}),S(this,n.trim())}})},toggleClass:function(r,n){return r?this.each(function(e){var t=f(this);T(this,r,e,S(this)).split(/\s+/g).forEach(function(e){(n===l?!t.hasClass(e):n)?t.addClass(e):t.removeClass(e)})}):this},scrollTop:function(e){var t;if(this.length)return t="scrollTop"in this[0],e===l?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})},scrollLeft:function(e){var t;if(this.length)return t="scrollLeft"in this[0],e===l?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})},position:function(){var e,t,r,n;if(this.length)return e=this[0],t=this.offsetParent(),r=this.offset(),n=ae.test(t[0].nodeName)?{top:0,left:0}:t.offset(),r.top-=parseFloat(f(e).css("margin-top"))||0,r.left-=parseFloat(f(e).css("margin-left"))||0,n.top+=parseFloat(f(t[0]).css("border-top-width"))||0,n.left+=parseFloat(f(t[0]).css("border-left-width"))||0,{top:r.top-n.top,left:r.left-n.left}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||p.body;e&&!ae.test(e.nodeName)&&"static"==f(e).css("position");)e=e.offsetParent;return e})}},f.fn.detach=f.fn.remove,["width","height"].forEach(function(n){var i=n.replace(/./,function(e){return e[0].toUpperCase()});f.fn[n]=function(t){var e,r=this[0];return t===l?We(r)?r["inner"+i]:qe(r)?r.documentElement["scroll"+i]:(e=this.offset())&&e[n]:this.each(function(e){(r=f(this)).css(n,T(this,t,e,r[n]()))})}}),["after","prepend","before","append"].forEach(function(t,s){var o=s%2;f.fn[t]=function(){var r,n,i=f.map(arguments,function(e){var t=[];return"array"==(r=$e(e))?(e.forEach(function(e){return e.nodeType!==l?t.push(e):f.zepto.isZ(e)?t=t.concat(e.get()):void(t=t.concat(v.fragment(e)))}),t):"object"==r||null==e?e:v.fragment(e)}),a=1<this.length;return i.length<1?this:this.each(function(e,t){n=o?t:t.parentNode,t=0==s?t.nextSibling:1==s?t.firstChild:2==s?t:null;var r=f.contains(p.documentElement,n);i.forEach(function(e){if(a)e=e.cloneNode(!0);else if(!n)return f(e).remove();n.insertBefore(e,t),r&&function e(t,r){r(t);for(var n=0,i=t.childNodes.length;n<i;n++)e(t.childNodes[n],r)}(e,function(e){var t;null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||(t=e.ownerDocument?e.ownerDocument.defaultView:window).eval.call(t,e.innerHTML)})})})},f.fn[o?t+"To":"insert"+(s?"Before":"After")]=function(e){return f(e)[t](this),this}}),v.Z.prototype=nt.prototype=f.fn,v.uniq=X,v.deserializeValue=st,f.zepto=v,f);function $e(e){return null==e?String(e):de[fe.call(e)]||"object"}function _(e){return"function"==$e(e)}function We(e){return null!=e&&e==e.window}function qe(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function Xe(e){return"object"==$e(e)}function Ze(e){return Xe(e)&&!We(e)&&Object.getPrototypeOf(e)==Object.prototype}function Qe(e){var t=!!e&&"length"in e&&e.length,r=f.type(e);return"function"!=r&&!We(e)&&("array"==r||0===t||"number"==typeof t&&0<t&&t-1 in e)}function Je(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function et(e){return e in ee?ee[e]:ee[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function tt(e,t){return"number"!=typeof t||te[Je(e)]?t:t+"px"}function rt(e){return"children"in e?h.call(e.children):f.map(e.childNodes,function(e){if(1==e.nodeType)return e})}function nt(e,t){for(var r=e?e.length:0,n=0;n<r;n++)this[n]=e[n];this.length=r,this.selector=t||""}function it(e,t){return null==t?f(e):f(e).filter(t)}function T(e,t,r,n){return _(t)?t.call(e,r,n):t}function at(e,t,r){null==r?e.removeAttribute(t):e.setAttribute(t,r)}function S(e,t){var r=e.className||"",n=r&&r.baseVal!==l;if(t===l)return n?r.baseVal:r;n?r.baseVal=t:e.className=t}function st(t){try{return t&&("true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?f.parseJSON(t):t))}catch(e){return t}}function C(e,t,r,n){if(e.global)return e=t||Ae,t=r,r=n,t=A.Event(t),A(e).trigger(t,r),!t.isDefaultPrevented()}function ot(e,t){var r=t.context;if(!1===t.beforeSend.call(r,e,t)||!1===C(t,r,"ajaxBeforeSend",[e,t]))return!1;C(t,r,"ajaxSend",[e,t])}function lt(e,t,r,n){var i=r.context,a="success";r.success.call(i,e,a,t),n&&n.resolveWith(i,[e,a,t]),C(r,i,"ajaxSuccess",[t,r,e]),ct(a,t,r)}function ut(e,t,r,n,i){var a=n.context;n.error.call(a,r,t,e),i&&i.rejectWith(a,[r,t,e]),C(n,a,"ajaxError",[r,n,e||t]),ct(t,r,n)}function ct(e,t,r){var n=r.context;r.complete.call(n,t,e),C(r,n,"ajaxComplete",[t,r]),(e=r).global&&!--A.active&&C(e,null,"ajaxStop")}function R(){}function dt(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function ft(e,t,r,n){return A.isFunction(t)&&(n=r,r=t,t=void 0),A.isFunction(r)||(n=r,r=void 0),{url:e,data:t,success:r,dataType:n}}function ht(e){var a=[["resolve","done",y.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",y.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",y.Callbacks({memory:1})]],i="pending",s={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ht(function(i){y.each(a,function(e,r){var n=y.isFunction(t[e])&&t[e];o[r[1]](function(){var e,t=n&&n.apply(this,arguments);t&&y.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):(e=this===s?i.promise():this,t=n?[t]:arguments,i[r[0]+"With"](e,t))})}),t=null}).promise()},promise:function(e){return null!=e?y.extend(e,s):s}},o={};return y.each(a,function(e,t){var r=t[2],n=t[3];s[t[1]]=r.add,n&&r.add(function(){i=n},a[1^e][2].disable,a[2][2].lock),o[t[0]]=function(){return o[t[0]+"With"](this===o?s:this,arguments),this},o[t[0]+"With"]=r.fireWith}),s.promise(o),e&&e.call(o,o),o}function w(e){return"string"==typeof e}function pt(e){return e._zid||(e._zid=Re++)}function vt(e,t,r,n){var i,a;return(t=gt(t)).ns&&(a=t.ns,i=new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")),(Le[pt(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||i.test(e.ns))&&(!r||pt(e.fn)===pt(r))&&(!n||e.sel==n)})}function gt(e){e=(""+e).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function At(e,t){return e.del&&!De&&e.e in Pe||!!t}function mt(e){return Ne[e]||De&&Pe[e]||e}function yt(n,e,i,a,s,o,l){var t=pt(n),u=Le[t]||(Le[t]=[]);e.split(/\s/).forEach(function(e){if("ready"==e)return E(document).ready(i);var t=gt(e),r=(t.fn=i,t.sel=s,t.e in Ne&&(i=function(e){e=e.relatedTarget;if(!e||e!==this&&!E.contains(this,e))return t.fn.apply(this,arguments)}),(t.del=o)||i);t.proxy=function(e){var t;if(!(e=bt(e)).isImmediatePropagationStopped())return e.data=a,!1===(t=r.apply(n,e._args==b?[e]:[e].concat(e._args)))&&(e.preventDefault(),e.stopPropagation()),t},t.i=u.length,u.push(t),"addEventListener"in n&&n.addEventListener(mt(t.e),t.proxy,At(t,l))})}function Et(t,e,r,n,i){var a=pt(t);(e||"").split(/\s/).forEach(function(e){vt(t,e,r,n).forEach(function(e){delete Le[a][e.i],"removeEventListener"in t&&t.removeEventListener(mt(e.e),e.proxy,At(e,i))})})}function bt(n,i){return(i||!n.isDefaultPrevented)&&(i=i||n,E.each(Be,function(e,t){var r=i[e];n[e]=function(){return this[t]=xe,r&&r.apply(i,arguments)},n[t]=Me}),n.timeStamp||(n.timeStamp=Date.now()),i.defaultPrevented!==b?i.defaultPrevented:"returnValue"in i?!1===i.returnValue:i.getPreventDefault&&i.getPreventDefault())&&(n.isDefaultPrevented=xe),n}function kt(e){var t,r={originalEvent:e};for(t in e)Fe.test(t)||e[t]===b||(r[t]=e[t]);return bt(r,e)}window.Zepto=t,void 0===window.$&&(window.$=t),A=t,ge=+new Date,Ae=window.document,me=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,ye=/^(?:text|application)\/javascript/i,Ee=/^(?:text|application)\/xml/i,be="application/json",ke=/^\s*$/,(_e=Ae.createElement("a")).href=window.location.href,A.active=0,A.ajaxJSONP=function(r,n){var e,i,a,s,o,t,l,u;return"type"in r?(e=r.jsonpCallback,i=(A.isFunction(e)?e():e)||"Zepto"+ge++,a=Ae.createElement("script"),s=window[i],l={abort:t=function(e){A(a).triggerHandler("error",e||"abort")}},n&&n.promise(l),A(a).on("load error",function(e,t){clearTimeout(u),A(a).off().remove(),"error"!=e.type&&o?lt(o[0],l,r,n):ut(null,t||"error",l,r,n),window[i]=s,o&&A.isFunction(s)&&s(o[0]),s=o=void 0}),!1===ot(l,r)?t("abort"):(window[i]=function(){o=arguments},a.src=r.url.replace(/\?(.+)=\?/,"?$1="+i),Ae.head.appendChild(a),0<r.timeout&&(u=setTimeout(function(){t("timeout")},r.timeout))),l):A.ajax(r)},A.ajaxSettings={type:"GET",beforeSend:R,success:R,error:R,complete:R,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:be,xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:R},A.ajax=function(e){var o=A.extend({},e||{}),l=A.Deferred&&A.Deferred();for(ve in A.ajaxSettings)void 0===o[ve]&&(o[ve]=A.ajaxSettings[ve]);(t=o).global&&0==A.active++&&C(t,null,"ajaxStart"),o.crossDomain||((t=Ae.createElement("a")).href=o.url,t.href=t.href,o.crossDomain=_e.protocol+"//"+_e.host!=t.protocol+"//"+t.host),o.url||(o.url=window.location.toString()),-1<(t=o.url.indexOf("#"))&&(o.url=o.url.slice(0,t)),(t=o).processData&&t.data&&"string"!=A.type(t.data)&&(t.data=A.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()&&"jsonp"!=t.dataType||(t.url=dt(t.url,t.data),t.data=void 0);var u=o.dataType,t=/\?.+=\?/.test(o.url);if(t&&(u="jsonp"),!1!==o.cache&&(e&&!0===e.cache||"script"!=u&&"jsonp"!=u)||(o.url=dt(o.url,"_="+Date.now())),"jsonp"==u)return t||(o.url=dt(o.url,o.jsonp?o.jsonp+"=?":!1===o.jsonp?"":"callback=?")),A.ajaxJSONP(o,l);function r(e,t){n[e.toLowerCase()]=[e,t]}var c,e=o.accepts[u],n={},d=/^([\w-]+:)\/\//.test(o.url)?RegExp.$1:window.location.protocol,f=o.xhr(),i=f.setRequestHeader;if(l&&l.promise(f),o.crossDomain||r("X-Requested-With","XMLHttpRequest"),r("Accept",e||"*/*"),(e=o.mimeType||e)&&(-1<e.indexOf(",")&&(e=e.split(",",2)[0]),f.overrideMimeType)&&f.overrideMimeType(e),(o.contentType||!1!==o.contentType&&o.data&&"GET"!=o.type.toUpperCase())&&r("Content-Type",o.contentType||"application/x-www-form-urlencoded"),o.headers)for(m in o.headers)r(m,o.headers[m]);if(f.setRequestHeader=r,!(f.onreadystatechange=function(){if(4==f.readyState){f.onreadystatechange=R,clearTimeout(c);var e,t=!1;if(200<=f.status&&f.status<300||304==f.status||0==f.status&&"file:"==d){if(u=u||(s=(s=o.mimeType||f.getResponseHeader("content-type"))&&s.split(";",2)[0])&&("text/html"==s?"html":s==be?"json":ye.test(s)?"script":Ee.test(s)&&"xml")||"text","arraybuffer"==f.responseType||"blob"==f.responseType)e=f.response;else{e=f.responseText;try{r=e,n=u,e=(i=o).dataFilter==R?r:(a=i.context,i.dataFilter.call(a,r,n)),"script"==u?(0,eval)(e):"xml"==u?e=f.responseXML:"json"==u&&(e=ke.test(e)?null:A.parseJSON(e))}catch(e){t=e}if(t)return ut(t,"parsererror",f,o,l)}lt(e,f,o,l)}else ut(f.statusText||null,f.status?"error":"abort",f,o,l)}var r,n,i,a,s})===ot(f,o))f.abort(),ut(null,"abort",f,o,l);else{t=!("async"in o)||o.async;if(f.open(o.type,o.url,t,o.username,o.password),o.xhrFields)for(m in o.xhrFields)f[m]=o.xhrFields[m];for(m in n)i.apply(f,n[m]);0<o.timeout&&(c=setTimeout(function(){f.onreadystatechange=R,f.abort(),ut(null,"timeout",f,o,l)},o.timeout)),f.send(o.data||null)}return f},A.get=function(){return A.ajax(ft.apply(null,arguments))},A.post=function(){var e=ft.apply(null,arguments);return e.type="POST",A.ajax(e)},A.getJSON=function(){var e=ft.apply(null,arguments);return e.dataType="json",A.ajax(e)},A.fn.load=function(e,t,r){var n,i,a,s;return this.length&&(n=this,i=e.split(/\s/),e=ft(e,t,r),s=e.success,1<i.length&&(e.url=i[0],a=i[1]),e.success=function(e){n.html(a?A("<div>").html(e.replace(me,"")).find(a):e),s&&s.apply(n,arguments)},A.ajax(e)),this},Te=encodeURIComponent,A.param=function(e,t){var r=[];return r.add=function(e,t){null==(t=A.isFunction(t)?t():t)&&(t=""),this.push(Te(e)+"="+Te(t))},function r(n,e,i,a){var s,o=A.isArray(e),l=A.isPlainObject(e);A.each(e,function(e,t){s=A.type(t),a&&(e=i?a:a+"["+(l||"object"==s||"array"==s?e:"")+"]"),!a&&o?n.add(t.name,t.value):"array"==s||!i&&"object"==s?r(n,t,i,e):n.add(e,t)})}(r,e,t),r.join("&").replace(/%20/g,"+")},(Se=t).Callbacks=function(n){n=Se.extend({},n);function i(e){for(t=n.memory&&e,r=!0,l=s||0,s=0,o=u.length,a=!0;u&&l<o;++l)if(!1===u[l].apply(e[0],e[1])&&n.stopOnFalse){t=!1;break}a=!1,u&&(c?c.length&&i(c.shift()):t?u.length=0:d.disable())}var t,r,a,s,o,l,u=[],c=!n.once&&[],d={add:function(){var e,r;return u&&(e=u.length,(r=function(e){Se.each(e,function(e,t){"function"==typeof t?n.unique&&d.has(t)||u.push(t):t&&t.length&&"string"!=typeof t&&r(t)})})(arguments),a?o=u.length:t&&(s=e,i(t))),this},remove:function(){return u&&Se.each(arguments,function(e,t){for(var r;-1<(r=Se.inArray(t,u,r));)u.splice(r,1),a&&(r<=o&&--o,r<=l)&&--l}),this},has:function(e){return!(!u||!(e?-1<Se.inArray(e,u):u.length))},empty:function(){return o=u.length=0,this},disable:function(){return u=c=t=void 0,this},disabled:function(){return!u},lock:function(){return c=void 0,t||d.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!u||r&&!c||(t=[e,(t=t||[]).slice?t.slice():t],a?c.push(t):i(t)),this},fire:function(){return d.fireWith(this,arguments)},fired:function(){return!!r}};return d},y=t,Ce=Array.prototype.slice,y.when=function(e){function t(t,r,n){return function(e){r[t]=this,n[t]=1<arguments.length?Ce.call(arguments):e,n===i?u.notifyWith(r,n):--l||u.resolveWith(r,n)}}var i,r,n,a=Ce.call(arguments),s=a.length,o=0,l=1!==s||e&&y.isFunction(e.promise)?s:0,u=1===l?e:ht();if(1<s)for(i=new Array(s),r=new Array(s),n=new Array(s);o<s;++o)a[o]&&y.isFunction(a[o].promise)?a[o].promise().done(t(o,n,a)).fail(u.reject).progress(t(o,r,i)):--l;return l||u.resolveWith(n,a),u.promise()},y.Deferred=ht,E=t,Re=1,we=Array.prototype.slice,Oe=E.isFunction,Le={},Ie={},De="onfocusin"in window,Pe={focus:"focusin",blur:"focusout"},Ne={mouseenter:"mouseover",mouseleave:"mouseout"},Ie.click=Ie.mousedown=Ie.mouseup=Ie.mousemove="MouseEvents",E.event={add:yt,remove:Et},E.proxy=function(e,t){var r,n=2 in arguments&&we.call(arguments,2);if(Oe(e))return(r=function(){return e.apply(t,n?n.concat(we.call(arguments)):arguments)})._zid=pt(e),r;if(w(t))return n?(n.unshift(e[t],e),E.proxy.apply(null,n)):E.proxy(e[t],e);throw new TypeError("expected function")},E.fn.bind=function(e,t,r){return this.on(e,t,r)},E.fn.unbind=function(e,t){return this.off(e,t)},E.fn.one=function(e,t,r,n){return this.on(e,t,r,n,1)},xe=function(){return!0},Me=function(){return!1},Fe=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,Be={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},E.fn.delegate=function(e,t,r){return this.on(t,e,r)},E.fn.undelegate=function(e,t,r){return this.off(t,e,r)},E.fn.live=function(e,t){return E(document.body).delegate(this.selector,e,t),this},E.fn.die=function(e,t){return E(document.body).undelegate(this.selector,e,t),this},E.fn.on=function(t,n,i,a,s){var o,l,r=this;return t&&!w(t)?(E.each(t,function(e,t){r.on(e,n,i,t,s)}),r):(w(n)||Oe(a)||!1===a||(a=i,i=n,n=b),a!==b&&!1!==i||(a=i,i=b),!1===a&&(a=Me),r.each(function(e,r){s&&(o=function(e){return Et(r,e.type,a),a.apply(this,arguments)}),yt(r,t,a,i,n,(l=n?function(e){var t=E(e.target).closest(n,r).get(0);if(t&&t!==r)return e=E.extend(kt(e),{currentTarget:t,liveFired:r}),(o||a).apply(t,[e].concat(we.call(arguments,1)))}:l)||o)}))},E.fn.off=function(e,r,t){var n=this;return e&&!w(e)?(E.each(e,function(e,t){n.off(e,r,t)}),n):(w(r)||Oe(t)||!1===t||(t=r,r=b),!1===t&&(t=Me),n.each(function(){Et(this,e,t,r)}))},E.fn.trigger=function(e,t){return(e=w(e)||E.isPlainObject(e)?E.Event(e):bt(e))._args=t,this.each(function(){e.type in Pe&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):E(this).triggerHandler(e,t)})},E.fn.triggerHandler=function(r,n){var i,a;return this.each(function(e,t){(i=kt(w(r)?E.Event(r):r))._args=n,i.target=t,E.each(vt(t,r.type||r),function(e,t){if(a=t.proxy(i),i.isImmediatePropagationStopped())return!1})}),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){E.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),E.Event=function(e,t){w(e)||(e=(t=e).type);var r=document.createEvent(Ie[e]||"Events"),n=!0;if(t)for(var i in t)"bubbles"==i?n=!!t[i]:r[i]=t[i];return r.initEvent(e,n,!0),bt(r)};try{getComputedStyle(void 0)}catch(e){var _t=getComputedStyle;window.getComputedStyle=function(e,t){try{return _t(e,t)}catch(e){return null}}}function Tt(e){return((e=Ue(e)).width()||e.height())&&"none"!==e.css("display")}function St(e,t){e=e.replace(/=#\]/g,'="#"]');var r,n,i=Ke.exec(e);return i&&i[2]in Ge&&(n=Ge[i[2]],r=i[3],e=i[1],r)&&(i=Number(r),r=isNaN(i)?r.replace(/^["']|["']$/g,""):i),t(e,n,r)}k=(Ue=t).zepto,je=k.qsa,Ve=k.matches,Ge=Ue.expr[":"]={visible:function(){if(Tt(this))return this},hidden:function(){if(!Tt(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(e){if(0===e)return this},last:function(e,t){if(e===t.length-1)return this},eq:function(e,t,r){if(e===r)return this},contains:function(e,t,r){if(-1<Ue(this).text().indexOf(r))return this},has:function(e,t,r){if(k.qsa(this,r).length)return this}},Ke=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),Ye=/^\s*>/,He="Zepto"+ +new Date,k.qsa=function(a,s){return St(s,function(e,r,n){try{!e&&r?e="*":Ye.test(e)&&(t=Ue(a).addClass(He),e="."+He+" "+e);var t,i=je(a,e)}catch(e){throw console.error("error performing selector: %o",s),e}finally{t&&t.removeClass(He)}return r?k.uniq(Ue.map(i,function(e,t){return r.call(e,t,i,n)})):i})},k.matches=function(n,e){return St(e,function(e,t,r){return(!e||Ve(n,e))&&(!t||t.call(n,null,r)===n)})};function Ct(e,t){var r=e.split(".",2);t.fullVersion=e,r[0]&&(t.majorVersion=parseInt(r[0])),r[1]&&(t.minorVersion=parseInt(r[1]))}function Rt(e,t,r){var n="["==t.substr(0,1)?new RegExp(t,"g"):t,n=e.split(n,2);"."!=t&&(e=e.replace(new RegExp(t,"g"),".")),r.fullVersion=e,n&&n[0]&&(r.majorVersion=parseInt(n[0])),n&&n[1]&&(r.minorVersion=parseInt(n[1]))}var O=t,wt=[{name:"Chromium",group:"Chrome",identifier:"Chromium/([0-9.]*)"},{name:"Chrome Mobile",group:"Chrome",identifier:"Chrome/([0-9.]*) Mobile",versionIdentifier:"Chrome/([0-9.]*)"},{name:"Chrome",group:"Chrome",identifier:"Chrome/([0-9.]*)"},{name:"Chrome for iOS",group:"Chrome",identifier:"CriOS/([0-9.]*)"},{name:"Android Browser",group:"Chrome",identifier:"CrMo/([0-9.]*)"},{name:"Firefox",group:"Firefox",identifier:"Firefox/([0-9.]*)"},{name:"Opera Mini",group:"Opera",identifier:"Opera Mini/([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera ([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"},{name:"IEMobile",group:"Explorer",identifier:"IEMobile/([0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"MSIE ([a-zA-Z0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"Trident/([0-9.]*)",versionIdentifier:"rv:([0-9.]*)"},{name:"Spartan",group:"Spartan",identifier:"Edge/([0-9.]*)",versionIdentifier:"Edge/([0-9.]*)"},{name:"Safari",group:"Safari",identifier:"Safari/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"}],Ot=[{name:"Windows 2000",group:"Windows",identifier:"Windows NT 5.0",version:"5.0"},{name:"Windows XP",group:"Windows",identifier:"Windows NT 5.1",version:"5.1"},{name:"Windows Vista",group:"Windows",identifier:"Windows NT 6.0",version:"6.0"},{name:"Windows 7",group:"Windows",identifier:"Windows NT 6.1",version:"7.0"},{name:"Windows 8",group:"Windows",identifier:"Windows NT 6.2",version:"8.0"},{name:"Windows 8.1",group:"Windows",identifier:"Windows NT 6.3",version:"8.1"},{name:"Windows 10",group:"Windows",identifier:"Windows NT 10.0",version:"10.0"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone ([0-9.]*)"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone OS ([0-9.]*)"},{name:"Windows",group:"Windows",identifier:"Windows"},{name:"Chrome OS",group:"Chrome OS",identifier:"CrOS"},{name:"Android",group:"Android",identifier:"Android",versionIdentifier:"Android ([a-zA-Z0-9.-]*)"},{name:"iPad",group:"iOS",identifier:"iPad",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPod",group:"iOS",identifier:"iPod",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPhone",group:"iOS",identifier:"iPhone OS",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"Mac OS X High Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])13([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])12([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X El Capitan",group:"Mac OS",identifier:"Mac OS X (10([_|.])11([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Yosemite",group:"Mac OS",identifier:"Mac OS X (10([_|.])10([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mavericks",group:"Mac OS",identifier:"Mac OS X (10([_|.])9([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mountain Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])8([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])7([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Snow Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])6([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])5([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Tiger",group:"Mac OS",identifier:"Mac OS X (10([_|.])4([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Panther",group:"Mac OS",identifier:"Mac OS X (10([_|.])3([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Jaguar",group:"Mac OS",identifier:"Mac OS X (10([_|.])2([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Puma",group:"Mac OS",identifier:"Mac OS X (10([_|.])1([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Cheetah",group:"Mac OS",identifier:"Mac OS X (10([_|.])0([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS",group:"Mac OS",identifier:"Mac OS"},{name:"Ubuntu",group:"Linux",identifier:"Ubuntu",versionIdentifier:"Ubuntu/([0-9.]*)"},{name:"Debian",group:"Linux",identifier:"Debian"},{name:"Gentoo",group:"Linux",identifier:"Gentoo"},{name:"Linux",group:"Linux",identifier:"Linux"},{name:"BlackBerry",group:"BlackBerry",identifier:"BlackBerry"}],L={},e=function(e){var t,r=e.match(/\b(playstation 4|nx|opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(r[1]))return t=/\brv[ :]+(\d+)/g.exec(e)||[],{name:"IE",version:parseInt(t[1]||"")};if("Chrome"===r[1]){if(null!=(t=e.match(/\bOPR\/(\d+)/)))return{name:"Opera",version:parseInt(t[1])};if(null!=(t=e.match(/\bEdge\/(\d+)/)))return{name:"Edge",version:parseInt(t[1])}}else/android/i.test(e)&&(t=e.match(/version\/(\d+)/i))&&(r.splice(1,1,"Android WebView"),r.splice(2,1,t[1]));return{name:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"])[0],version:parseInt(r[1])}}(navigator.userAgent);if(L.isEdge=/edge/i.test(navigator.userAgent),L.isChrome=/chrome|CriOS/i.test(navigator.userAgent)&&!L.isEdge,L.isSafari=/safari/i.test(navigator.userAgent)&&!L.isChrome&&!L.isEdge,L.isFirefox=/firefox/i.test(navigator.userAgent),L.isLegacyIE=!!window.ActiveXObject,L.isIE=L.isLegacyIE||/trident.*rv:1\d/i.test(navigator.userAgent),L.isIE11=/trident.*rv:11/i.test(navigator.userAgent),L.isChromecast=L.isChrome&&/CrKey/i.test(navigator.userAgent),L.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(navigator.userAgent),L.isiOS=/iPad|iPhone|iPod/i.test(navigator.userAgent),L.isAndroid=/Android/i.test(navigator.userAgent),L.isWindowsPhone=/Windows Phone/i.test(navigator.userAgent),L.isWin8App=/MSAppHost/i.test(navigator.userAgent),L.isWiiU=/WiiU/i.test(navigator.userAgent),L.isPS4=/PlayStation 4/i.test(navigator.userAgent),L.hasLocalstorage=function(){try{return localStorage.setItem("clappr","clappr"),localStorage.removeItem("clappr"),!0}catch(e){return!1}}(),L.hasFlash=function(){try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return!(!navigator.mimeTypes||void 0===navigator.mimeTypes["application/x-shockwave-flash"]||!navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)}}(),L.name=e.name,L.version=e.version,L.userAgent=navigator.userAgent,L.data=function(){var e,t={},r=L.userAgent.toLowerCase(),n=W(wt);try{for(n.s();!(e=n.n()).done;){var i,a=e.value,s=new RegExp(a.identifier.toLowerCase()).exec(r);if(null!=s&&s[1]){t.name=a.name,t.group=a.group,a.versionIdentifier?null!=(i=new RegExp(a.versionIdentifier.toLowerCase()).exec(r))&&i[1]&&Ct(i[1],t):Ct(s[1],t);break}}}catch(e){n.e(e)}finally{n.f()}return t}(),L.os=function(){var e,t={},r=L.userAgent.toLowerCase(),n=W(Ot);try{for(n.s();!(e=n.n()).done;){var i,a=e.value,s=new RegExp(a.identifier.toLowerCase()).exec(r);if(null!=s){t.name=a.name,t.group=a.group,a.version?Rt(a.version,a.versionSeparator||".",t):s[1]?Rt(s[1],a.versionSeparator||".",t):a.versionIdentifier&&null!=(i=new RegExp(a.versionIdentifier.toLowerCase()).exec(r))&&i[1]&&Rt(i[1],a.versionSeparator||".",t);break}}}catch(e){n.e(e)}finally{n.f()}return t}(),L.viewport=((t={}).width=O(window).width(),t.height=O(window).height(),t),L.device=function(e){e=/\((iP(?:hone|ad|od))?(?:[^;]*; ){0,2}([^)]+(?=\)))/.exec(e);return e&&(e[1]||e[2])||""}(L.userAgent),void 0!==window.orientation)switch(window.orientation){case-90:case 90:L.viewport.orientation="landscape";break;default:L.viewport.orientation="portrait"}var Lt={},It=[],Dt=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}).bind(window),Pt=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);function Nt(e,t){if(t)for(var r in t){var n=Object.getOwnPropertyDescriptor(t,r);n?Object.defineProperty(e,r,n):e[r]=t[r]}return e}function xt(e,s){var t=function(){c(a,e);var i=d(a);function a(){var e;u(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e=i.call.apply(i,[this].concat(r)),s.initialize&&s.initialize.apply(G(e),r),e}return a}();return Nt(t.prototype,s),t}var Mt={fullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullscreen:function(e){if(e.requestFullscreen)return e.requestFullscreen();if(e.webkitRequestFullscreen){if("function"==typeof e.then)return e.webkitRequestFullscreen();e.webkitRequestFullscreen()}else{if(e.mozRequestFullScreen)return e.mozRequestFullScreen();{if(e.msRequestFullscreen)return e.msRequestFullscreen();e.querySelector&&e.querySelector("video")&&e.querySelector("video").webkitEnterFullScreen?e.querySelector("video").webkitEnterFullScreen():e.webkitEnterFullScreen&&e.webkitEnterFullScreen()}}},cancelFullscreen:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;e.exitFullscreen?e.exitFullscreen():e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen()},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},e=function(){function e(){u(this,e)}return s(e,null,[{key:"_defaultConfig",value:function(){return{volume:{value:100,parse:parseInt}}}},{key:"_defaultValueFor",value:function(e){try{return this._defaultConfig()[e].parse(this._defaultConfig()[e].value)}catch(e){}}},{key:"_createKeyspace",value:function(e){return"clappr.".concat(document.domain,".").concat(e)}},{key:"restore",value:function(e){return L.hasLocalstorage&&localStorage[this._createKeyspace(e)]?this._defaultConfig()[e].parse(localStorage[this._createKeyspace(e)]):this._defaultValueFor(e)}},{key:"persist",value:function(e,t){if(L.hasLocalstorage)try{return localStorage[this._createKeyspace(e)]=t,!0}catch(e){return!1}}}]),e}(),Ft=function(){function e(){u(this,e)}return s(e,null,[{key:"parse",value:function(e){for(var t,r=/\+/g,n=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(r," "))},a={};t=n.exec(e);)a[i(t[1]).toLowerCase()]=i(t[2]);return a}},{key:"params",get:function(){var e=window.location.search.substring(1);return e!==this.query&&(this._urlParams=this.parse(e),this.query=e),this._urlParams}},{key:"hashParams",get:function(){var e=window.location.hash.substring(1);return e!==this.hash&&(this._hashParams=this.parse(e),this.hash=e),this._hashParams}}]),e}();function Bt(){var r,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"t",n=0,e=Ft.params[e]||Ft.hashParams[e]||"",t=e.match(/[0-9]+[hms]+/g)||[];return 0<t.length?(r={h:3600,m:60,s:1},t.forEach(function(e){var t;e&&(t=e[e.length-1],e=parseInt(e.slice(0,e.length-1),10),n+=e*r[t])})):e&&(n=parseInt(e,10)),n}function Ut(e){return Lt[e]||(Lt[e]=0),e+ ++Lt[e]}function jt(e){return 0<=e-parseFloat(e)+1}function Vt(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function Gt(){return window.navigator&&window.navigator.language}function Kt(r,e){var t=(e=Object.assign({inline:!1,muted:!1,timeout:250,type:"video",source:ze.mp4,element:null},e)).element||document.createElement(e.type),t=(t.muted=e.muted,!0===e.muted&&t.setAttribute("muted","muted"),!0===e.inline&&t.setAttribute("playsinline","playsinline"),t.src=e.source,t.play()),n=setTimeout(function(){i(!1,new Error("Timeout ".concat(e.timeout," ms has been reached")))},e.timeout),i=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(n),r(e,t)};void 0!==t?t.then(function(){return i(!0)}).catch(function(e){return i(!1,e)}):i(!0)}function Yt(e,t,r,n){if(r){if("object"===F(r)){for(var i in r)e[t].apply(e,[i,r[i]].concat(n));return}if(rr.test(r)){for(var a=r.split(rr),s=0,o=a.length;s<o;s++)e[t].apply(e,[a[s]].concat(n));return}}return 1}function Ht(e,r,n,i){var a,s=-1,o=e.length,l=r[0],u=r[1],c=r[2];!function t(){try{switch(r.length){case 0:for(;++s<o;)(a=e[s]).callback.call(a.ctx);return;case 1:for(;++s<o;)(a=e[s]).callback.call(a.ctx,l);return;case 2:for(;++s<o;)(a=e[s]).callback.call(a.ctx,l,u);return;case 3:for(;++s<o;)(a=e[s]).callback.call(a.ctx,l,u,c);return;default:for(;++s<o;)(a=e[s]).callback.apply(a.ctx,r);return}}catch(e){D.error.apply(D,[n,"error on event",i,"trigger","-",e]),t()}}()}function zt(e){return null===e?"":(""+e).replace(ur,function(e){return lr[e]})}function $t(a,e){var t,r=new RegExp([(ir.escape||ar).source,(ir.interpolate||ar).source,(ir.evaluate||ar).source].join("|")+"|$","g"),s=0,o="__p+='";a.replace(r,function(e,t,r,n,i){return o+=a.slice(s,i).replace(or,function(e){return"\\"+sr[e]}),t&&(o+="'+\n((__t=("+t+"))==null?'':escapeExpr(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),n&&(o+="';\n"+n+"\n__p+='"),s=i+e.length,e}),o+="';\n",o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(o=ir.variable?o:"with(obj||{}){\n"+o+"}\n")+"return __p;\n//# sourceURL=/microtemplates/source["+cr+++"]";try{t=new Function(ir.variable||"obj","escapeExpr",o)}catch(e){throw e.source=o,e}return e?t(e,zt):((r=function(e){return t.call(this,e,zt)}).source="function("+(ir.variable||"obj")+"){\n"+o+"}",r)}function Wt(e,t){return e&&t?Object.entries(e).filter(function(e){return Y(e,2)[1].type===t}).reduce(function(e,t){var t=Y(t,2),r=t[0],t=t[1];return e[r]=t,e},{}):{}}var I,qt=function(){function e(){u(this,e)}return s(e,null,[{key:"configure",value:function(e){this.options=O.extend(!0,this.options,e)}},{key:"create",value:function(e){return this.options.recycleVideo&&"video"===e&&0<It.length?It.shift():document.createElement(e)}},{key:"garbage",value:function(t){this.options.recycleVideo&&"VIDEO"===t.tagName.toUpperCase()&&(O(t).children().remove(),Object.values(t.attributes).forEach(function(e){return t.removeAttribute(e.name)}),It.push(t))}}]),e}(),Xt=(qt.options={recycleVideo:!1},function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:500;u(this,t),this.delay=e,this.lastTime=0}return s(t,[{key:"handle",value:function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=(new Date).getTime(),i=n-this.lastTime;i<this.delay&&0<i&&(t(),r)&&e.preventDefault(),this.lastTime=n}}]),t}()),Zt={Config:e,Fullscreen:Mt,QueryString:Ft,DomRecycler:qt,assign:Nt,extend:xt,formatTime:function(e,t){if(!isFinite(e))return"--:--";e*=1e3;var r=(e=parseInt(e/1e3))%60,n=(e=parseInt(e/60))%60,i=(e=parseInt(e/60))%24,e=parseInt(e/24),a="";return e&&0<e&&(a+=e+":",i<1)&&(a+="00:"),(i&&0<i||t)&&(a+=("0"+i).slice(-2)+":"),(a=(a+=("0"+n).slice(-2)+":")+("0"+r).slice(-2)).trim()},seekStringToSeconds:Bt,uniqueId:Ut,currentScriptUrl:Vt,isNumber:jt,requestAnimationFrame:Dt,cancelAnimationFrame:Pt,getBrowserLanguage:Gt,now:function(){return(window.performance&&window.performance.now?performance:Date).now()},removeArrayItem:function(e,t){0<=(t=e.indexOf(t))&&e.splice(t,1)},listContainsIgnoreCase:function(t,e){return void 0!==t&&void 0!==e&&void 0!==e.find(function(e){return t.toLowerCase()===e.toLowerCase()})},canAutoPlayMedia:Kt,Media:ze,DoubleEventHandler:Xt},t="font-weight: bold; font-size: 13px;",Qt="color: #ff8000;"+t,e="color: #ff0000;"+t,Jt=["color: #0000ff;font-weight: bold; font-size: 13px;","color: #006600;font-weight: bold; font-size: 13px;",Qt,e,e],er=["debug","info","warn","error","disabled"],D=function(){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3;u(this,r),this.EXCLUDE_LIST=["timeupdate","playback:timeupdate","playback:progress","container:hover","container:timeupdate","container:progress"],this.level=e,this.previousLevel=this.level,this.offLevel=t}return s(r,[{key:"level",get:function(){return this._level},set:function(e){this._level=e}}]),s(r,[{key:"debug",value:function(e){this.log(e,0,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(e){this.log(e,1,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(e){this.log(e,2,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(e){this.log(e,3,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Clappr.Log] set log level to "+er[this.level],Qt)}},{key:"log",value:function(e,t,r){0<=this.EXCLUDE_LIST.indexOf(r[0])||t<this.level||(r||(r=e,e=null),window.console&&window.console.log&&window.console.log.apply(console,["%c["+er[t]+"]"+(e?"["+e+"]":""),Jt[t]].concat(r)))}}]),r}(),tr=(D.LEVEL_DEBUG=0,D.LEVEL_INFO=1,D.LEVEL_WARN=2,D.LEVEL_ERROR=3,D.getInstance=function(){return void 0===this._instance&&(this._instance=new this),this._instance},D.setLevel=function(e){this.getInstance().level=e},D.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)},D.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)},D.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)},D.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)},Array.prototype.slice),rr=/\s+/,P=function(){function r(){u(this,r)}return s(r,[{key:"on",value:function(e,t,r){return Yt(this,"on",e,[t,r])&&t&&(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:r,ctx:r||this})),this}},{key:"once",value:function(e,t,r){var n,i=this;return Yt(this,"once",e,[t,r])&&t?(n=function(){i.off(e,n),t.apply(this,arguments)},this.on(e,n,r)):this}},{key:"off",value:function(e,t,r){var n,i,a,s,o,l,u,c;if(this._events&&Yt(this,"off",e,[t,r]))if(e||t||r){for(o=0,l=(s=e?[e]:Object.keys(this._events)).length;o<l;o++)if(e=s[o],a=this._events[e]){if(this._events[e]=n=[],t||r)for(u=0,c=a.length;u<c;u++)i=a[u],(t&&t!==i.callback&&t!==i.callback._callback||r&&r!==i.context)&&n.push(i);n.length||delete this._events[e]}}else this._events=void 0;return this}},{key:"trigger",value:function(e){var t,r,n,i=this.name||this.constructor.name;return D.debug.apply(D,[i].concat(Array.prototype.slice.call(arguments))),this._events&&(t=tr.call(arguments,1),Yt(this,"trigger",e,t))&&(r=this._events[e],n=this._events.all,r&&Ht(r,t,i,e),n)&&Ht(n,arguments,i,e),this}},{key:"stopListening",value:function(e,t,r){var n=this._listeningTo;if(n){var i,a=!t&&!r;for(i in r||"object"!==F(t)||(r=this),e&&((n={})[e._listenId]=e),n)(e=n[i]).off(t,r,this),!a&&0!==Object.keys(e._events).length||delete this._listeningTo[i]}return this}}],[{key:"register",value:function(e){r.Custom||(r.Custom={});var t="string"==typeof e&&e.toUpperCase().trim();t&&!r.Custom[t]?r.Custom[t]=t.toLowerCase().split("_").map(function(e,t){return 0===t?e:e[0].toUpperCase()+e.slice(1)}).join(""):D.error("Events","Error when register event: "+e)}},{key:"listAvailableCustomEvents",value:function(){return r.Custom||(r.Custom={}),Object.keys(r.Custom).filter(function(e){return"string"==typeof r.Custom[e]})}}]),r}(),nr={listenTo:"on",listenToOnce:"once"},N=(Object.keys(nr).forEach(function(n){P.prototype[n]=function(e,t,r){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=Ut("l"))]=e,r||"object"!==F(t)||(r=this),e[nr[n]](t,r,this),this}}),P.PLAYER_READY="ready",P.PLAYER_RESIZE="resize",P.PLAYER_FULLSCREEN="fullscreen",P.PLAYER_PLAY="play",P.PLAYER_PAUSE="pause",P.PLAYER_STOP="stop",P.PLAYER_ENDED="ended",P.PLAYER_SEEK="seek",P.PLAYER_ERROR="playererror",P.ERROR="error",P.PLAYER_TIMEUPDATE="timeupdate",P.PLAYER_VOLUMEUPDATE="volumeupdate",P.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable",P.PLAYBACK_PROGRESS="playback:progress",P.PLAYBACK_TIMEUPDATE="playback:timeupdate",P.PLAYBACK_READY="playback:ready",P.PLAYBACK_BUFFERING="playback:buffering",P.PLAYBACK_BUFFERFULL="playback:bufferfull",P.PLAYBACK_SETTINGSUPDATE="playback:settingsupdate",P.PLAYBACK_LOADEDMETADATA="playback:loadedmetadata",P.PLAYBACK_HIGHDEFINITIONUPDATE="playback:highdefinitionupdate",P.PLAYBACK_BITRATE="playback:bitrate",P.PLAYBACK_LEVELS_AVAILABLE="playback:levels:available",P.PLAYBACK_LEVEL_SWITCH_START="playback:levels:switch:start",P.PLAYBACK_LEVEL_SWITCH_END="playback:levels:switch:end",P.PLAYBACK_PLAYBACKSTATE="playback:playbackstate",P.PLAYBACK_DVR="playback:dvr",P.PLAYBACK_MEDIACONTROL_DISABLE="playback:mediacontrol:disable",P.PLAYBACK_MEDIACONTROL_ENABLE="playback:mediacontrol:enable",P.PLAYBACK_ENDED="playback:ended",P.PLAYBACK_PLAY_INTENT="playback:play:intent",P.PLAYBACK_PLAY="playback:play",P.PLAYBACK_PAUSE="playback:pause",P.PLAYBACK_SEEK="playback:seek",P.PLAYBACK_SEEKED="playback:seeked",P.PLAYBACK_STOP="playback:stop",P.PLAYBACK_ERROR="playback:error",P.PLAYBACK_STATS_ADD="playback:stats:add",P.PLAYBACK_FRAGMENT_LOADED="playback:fragment:loaded",P.PLAYBACK_LEVEL_SWITCH="playback:level:switch",P.PLAYBACK_SUBTITLE_AVAILABLE="playback:subtitle:available",P.PLAYBACK_SUBTITLE_CHANGED="playback:subtitle:changed",P.CORE_CONTAINERS_CREATED="core:containers:created",P.CORE_ACTIVE_CONTAINER_CHANGED="core:active:container:changed",P.CORE_OPTIONS_CHANGE="core:options:change",P.CORE_READY="core:ready",P.CORE_FULLSCREEN="core:fullscreen",P.CORE_RESIZE="core:resize",P.CORE_SCREEN_ORIENTATION_CHANGED="core:screen:orientation:changed",P.CORE_MOUSE_MOVE="core:mousemove",P.CORE_MOUSE_LEAVE="core:mouseleave",P.CONTAINER_PLAYBACKSTATE="container:playbackstate",P.CONTAINER_PLAYBACKDVRSTATECHANGED="container:dvr",P.CONTAINER_BITRATE="container:bitrate",P.CONTAINER_STATS_REPORT="container:stats:report",P.CONTAINER_DESTROYED="container:destroyed",P.CONTAINER_READY="container:ready",P.CONTAINER_RESIZE="container:resize",P.CONTAINER_ERROR="container:error",P.CONTAINER_LOADEDMETADATA="container:loadedmetadata",P.CONTAINER_SUBTITLE_AVAILABLE="container:subtitle:available",P.CONTAINER_SUBTITLE_CHANGED="container:subtitle:changed",P.CONTAINER_TIMEUPDATE="container:timeupdate",P.CONTAINER_PROGRESS="container:progress",P.CONTAINER_PLAY="container:play",P.CONTAINER_STOP="container:stop",P.CONTAINER_PAUSE="container:pause",P.CONTAINER_ENDED="container:ended",P.CONTAINER_CLICK="container:click",P.CONTAINER_DBLCLICK="container:dblclick",P.CONTAINER_CONTEXTMENU="container:contextmenu",P.CONTAINER_MOUSE_ENTER="container:mouseenter",P.CONTAINER_MOUSE_LEAVE="container:mouseleave",P.CONTAINER_MOUSE_UP="container:mouseup",P.CONTAINER_MOUSE_DOWN="container:mousedown",P.CONTAINER_SEEK="container:seek",P.CONTAINER_SEEKED="container:seeked",P.CONTAINER_VOLUME="container:volume",P.CONTAINER_FULLSCREEN="container:fullscreen",P.CONTAINER_STATE_BUFFERING="container:state:buffering",P.CONTAINER_STATE_BUFFERFULL="container:state:bufferfull",P.CONTAINER_SETTINGSUPDATE="container:settingsupdate",P.CONTAINER_HIGHDEFINITIONUPDATE="container:highdefinitionupdate",P.CONTAINER_MEDIACONTROL_SHOW="container:mediacontrol:show",P.CONTAINER_MEDIACONTROL_HIDE="container:mediacontrol:hide",P.CONTAINER_MEDIACONTROL_DISABLE="container:mediacontrol:disable",P.CONTAINER_MEDIACONTROL_ENABLE="container:mediacontrol:enable",P.CONTAINER_STATS_ADD="container:stats:add",P.CONTAINER_OPTIONS_CHANGE="container:options:change",P.MEDIACONTROL_RENDERED="mediacontrol:rendered",P.MEDIACONTROL_FULLSCREEN="mediacontrol:fullscreen",P.MEDIACONTROL_SHOW="mediacontrol:show",P.MEDIACONTROL_HIDE="mediacontrol:hide",P.MEDIACONTROL_MOUSEMOVE_SEEKBAR="mediacontrol:mousemove:seekbar",P.MEDIACONTROL_MOUSELEAVE_SEEKBAR="mediacontrol:mouseleave:seekbar",P.MEDIACONTROL_PLAYING="mediacontrol:playing",P.MEDIACONTROL_NOTPLAYING="mediacontrol:notplaying",P.MEDIACONTROL_CONTAINERCHANGED="mediacontrol:containerchanged",P.MEDIACONTROL_OPTIONS_CHANGE="mediacontrol:options:change",function(){c(n,P);var r=d(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return u(this,n),(e=r.call(this,t))._options=t,e.uniqueId=Ut("o"),e}return s(n,[{key:"options",get:function(){return this._options}}]),n}()),ir={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ar=/(.)^/,sr={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},or=/\\|'|\r|\n|\t|\u2028|\u2029/g,lr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},ur=new RegExp("[&<>\"']","g"),cr=0,dr=($t.settings=ir,{getStyleFor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{baseUrl:""};return O('<style class="clappr-style"></style>').html($t(e.toString())(t))}}),fr=/^(\S+)\s*(.*)$/,hr=function(){c(r,N);var t=d(r);function r(e){return u(this,r),(e=t.call(this,e)).cid=Ut("c"),e._ensureElement(),e.delegateEvents(),e}return s(r,[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}}]),s(r,[{key:"$",value:function(e){return this.$el.find(e)}},{key:"render",value:function(){return this}},{key:"destroy",value:function(){return this.$el.remove(),this.stopListening(),this.undelegateEvents(),this}},{key:"setElement",value:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=O.zepto.isZ(e)?e:O(e),this.el=this.$el[0],!1!==t&&this.delegateEvents(),this}},{key:"delegateEvents",value:function(e){for(var t in e=e||this.events,this.undelegateEvents(),e){var r,n=e[t];(n=n&&n.constructor!==Function?this[e[t]]:n)&&(r=(t=t.match(fr))[1],t=t[2],r+=".delegateEvents"+this.cid,""===t?this.$el.on(r,n.bind(this)):this.$el.on(r,t,n.bind(this)))}return this}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"_ensureElement",value:function(){var e;this.el?this.setElement(this.el,!1):(e=O.extend(!0,{},this.attributes),this.id&&(e.id=this.id),this.className&&(e.class=this.className),e=O(qt.create(this.tagName)).attr(e),this.setElement(e,!1))}}]),r}(),pr=function(){c(n,N);var r=d(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;return u(this,n),(e=r.call(this,e)).core=t,e}return s(n,[{key:"name",get:function(){return"error"}}],[{key:"Levels",get:function(){return{FATAL:"FATAL",WARN:"WARN",INFO:"INFO"}}}]),s(n,[{key:"createError",value:function(e){this.core?this.core.trigger(P.ERROR,e):D.warn(this.name,"Core is not set. Error: ",e)}}]),n}(),t={createError:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{useCodePrefix:!0},r=this.constructor&&this.constructor.type||"",n=this.name||r,i=this.i18n||this.core&&this.core.i18n||this.container&&this.container.i18n,a="".concat(n,":").concat(e&&e.code||"unknown"),r={description:"",level:pr.Levels.FATAL,origin:n,scope:r,raw:{}},r=Object.assign({},r,e,{code:t.useCodePrefix?a:e.code});return i&&r.level==pr.Levels.FATAL&&!r.UI&&(t={title:i.t("default_error_title"),message:i.t("default_error_message")},r.UI=t),this.playerError?this.playerError.createError(r):D.warn(n,"PlayerError is not defined. Error: ",r),r}},vr=function(){c(n,hr);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e.options)).core=e,t.enabled=!0,t.bindEvents(),t.render(),t}return s(n,[{key:"playerError",get:function(){return this.core.playerError}}]),s(n,[{key:"bindEvents",value:function(){}},{key:"getExternalInterface",value:function(){return{}}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"render",value:function(){return this}}]),n}(),gr=(Object.assign(vr.prototype,t),vr.extend=function(e){return xt(vr,e)},vr.type="core",function(){c(a,hr);var i=d(a);function a(e,t,r){var n;return u(this,a),(n=i.call(this,e))._i18n=t,n.currentTime=0,n.volume=100,n.playback=e.playback,n.playerError=r,n.settings=O.extend(!0,{},n.playback.settings),n.isReady=!1,n.mediaControlDisabled=!1,n.plugins=[n.playback],n.dblTapHandler=new Xt(500),n.clickTimer=null,n.clickDelay=200,n.bindEvents(),n}return s(a,[{key:"name",get:function(){return"Container"}},{key:"attributes",get:function(){return{class:"container","data-container":""}}},{key:"events",get:function(){return{click:"clicked",dblclick:"dblClicked",touchend:"dblTap",contextmenu:"onContextMenu",mouseenter:"mouseEnter",mouseleave:"mouseLeave",mouseup:"onMouseUp",mousedown:"onMouseDown"}}},{key:"ended",get:function(){return this.playback.ended}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"i18n",get:function(){return this._i18n}},{key:"hasClosedCaptionsTracks",get:function(){return this.playback.hasClosedCaptionsTracks}},{key:"closedCaptionsTracks",get:function(){return this.playback.closedCaptionsTracks}},{key:"closedCaptionsTrackId",get:function(){return this.playback.closedCaptionsTrackId},set:function(e){this.playback.closedCaptionsTrackId=e}}]),s(a,[{key:"bindEvents",value:function(){this.listenTo(this.playback,P.PLAYBACK_PROGRESS,this.onProgress),this.listenTo(this.playback,P.PLAYBACK_TIMEUPDATE,this.timeUpdated),this.listenTo(this.playback,P.PLAYBACK_READY,this.ready),this.listenTo(this.playback,P.PLAYBACK_BUFFERING,this.onBuffering),this.listenTo(this.playback,P.PLAYBACK_BUFFERFULL,this.bufferfull),this.listenTo(this.playback,P.PLAYBACK_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.playback,P.PLAYBACK_LOADEDMETADATA,this.loadedMetadata),this.listenTo(this.playback,P.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.playback,P.PLAYBACK_BITRATE,this.updateBitrate),this.listenTo(this.playback,P.PLAYBACK_PLAYBACKSTATE,this.playbackStateChanged),this.listenTo(this.playback,P.PLAYBACK_DVR,this.playbackDvrStateChanged),this.listenTo(this.playback,P.PLAYBACK_MEDIACONTROL_DISABLE,this.disableMediaControl),this.listenTo(this.playback,P.PLAYBACK_MEDIACONTROL_ENABLE,this.enableMediaControl),this.listenTo(this.playback,P.PLAYBACK_SEEK,this.onSeek),this.listenTo(this.playback,P.PLAYBACK_SEEKED,this.onSeeked),this.listenTo(this.playback,P.PLAYBACK_ENDED,this.onEnded),this.listenTo(this.playback,P.PLAYBACK_PLAY,this.playing),this.listenTo(this.playback,P.PLAYBACK_PAUSE,this.paused),this.listenTo(this.playback,P.PLAYBACK_STOP,this.stopped),this.listenTo(this.playback,P.PLAYBACK_ERROR,this.error),this.listenTo(this.playback,P.PLAYBACK_SUBTITLE_AVAILABLE,this.subtitleAvailable),this.listenTo(this.playback,P.PLAYBACK_SUBTITLE_CHANGED,this.subtitleChanged)}},{key:"subtitleAvailable",value:function(){this.trigger(P.CONTAINER_SUBTITLE_AVAILABLE)}},{key:"subtitleChanged",value:function(e){this.trigger(P.CONTAINER_SUBTITLE_CHANGED,e)}},{key:"playbackStateChanged",value:function(e){this.trigger(P.CONTAINER_PLAYBACKSTATE,e)}},{key:"playbackDvrStateChanged",value:function(e){this.settings=this.playback.settings,this.dvrInUse=e,this.trigger(P.CONTAINER_PLAYBACKDVRSTATECHANGED,e)}},{key:"updateBitrate",value:function(e){this.trigger(P.CONTAINER_BITRATE,e)}},{key:"statsReport",value:function(e){this.trigger(P.CONTAINER_STATS_REPORT,e)}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"isDvrEnabled",value:function(){return!!this.playback.dvrEnabled}},{key:"isDvrInUse",value:function(){return!!this.dvrInUse}},{key:"destroy",value:function(){this.disableResizeObserver(),this.trigger(P.CONTAINER_DESTROYED,this,this.name),this.stopListening(),this.plugins.forEach(function(e){return e.destroy()}),this.$el.remove()}},{key:"setStyle",value:function(e){this.$el.css(e)}},{key:"animate",value:function(e,t){return this.$el.animate(e,t).promise()}},{key:"ready",value:function(){this.isReady=!0,this.trigger(P.CONTAINER_READY,this.name)}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"getStartTimeOffset",value:function(){return this.playback.getStartTimeOffset()}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"error",value:function(e){this.isReady||this.ready(),this.trigger(P.CONTAINER_ERROR,e,this.name)}},{key:"loadedMetadata",value:function(e){this.trigger(P.CONTAINER_LOADEDMETADATA,e)}},{key:"timeUpdated",value:function(e){this.currentTime=e.current,this.trigger(P.CONTAINER_TIMEUPDATE,e,this.name)}},{key:"onProgress",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trigger.apply(this,[P.CONTAINER_PROGRESS].concat(t,[this.name]))}},{key:"playing",value:function(){this.trigger(P.CONTAINER_PLAY,this.name)}},{key:"paused",value:function(){this.trigger(P.CONTAINER_PAUSE,this.name)}},{key:"play",value:function(){this.playback.play()}},{key:"stop",value:function(){this.playback.stop(),this.currentTime=0}},{key:"pause",value:function(){this.playback.pause()}},{key:"onEnded",value:function(){this.trigger(P.CONTAINER_ENDED,this,this.name),this.currentTime=0}},{key:"stopped",value:function(){this.trigger(P.CONTAINER_STOP)}},{key:"clicked",value:function(){var e=this;this.options.chromeless&&!this.options.allowUserInteraction||(this.clickTimer=setTimeout(function(){e.clickTimer&&e.trigger(P.CONTAINER_CLICK,e,e.name)},this.clickDelay))}},{key:"cancelClicked",value:function(){clearTimeout(this.clickTimer),this.clickTimer=null}},{key:"dblClicked",value:function(){this.options.chromeless&&!this.options.allowUserInteraction||(this.cancelClicked(),this.trigger(P.CONTAINER_DBLCLICK,this,this.name))}},{key:"dblTap",value:function(e){var t=this;this.options.chromeless&&!this.options.allowUserInteraction||this.dblTapHandler.handle(e,function(){t.cancelClicked(),t.trigger(P.CONTAINER_DBLCLICK,t,t.name)})}},{key:"onContextMenu",value:function(e){this.options.chromeless&&!this.options.allowUserInteraction||this.trigger(P.CONTAINER_CONTEXTMENU,e,this.name)}},{key:"seek",value:function(e){this.playback.seek(e)}},{key:"onSeek",value:function(e){this.trigger(P.CONTAINER_SEEK,e,this.name)}},{key:"onSeeked",value:function(){this.trigger(P.CONTAINER_SEEKED,this.name)}},{key:"seekPercentage",value:function(e){var t=this.getDuration();0<=e&&e<=100&&this.seek(t*(e/100))}},{key:"setVolume",value:function(e){this.volume=parseFloat(e),this.trigger(P.CONTAINER_VOLUME,this.volume,this.name),this.playback.volume(this.volume)}},{key:"fullscreen",value:function(){this.trigger(P.CONTAINER_FULLSCREEN,this.name)}},{key:"onBuffering",value:function(){this.trigger(P.CONTAINER_STATE_BUFFERING,this.name)}},{key:"bufferfull",value:function(){this.trigger(P.CONTAINER_STATE_BUFFERFULL,this.name)}},{key:"addPlugin",value:function(e){this.plugins.push(e)}},{key:"hasPlugin",value:function(e){return!!this.getPlugin(e)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(e){return e.name===t})[0]}},{key:"mouseEnter",value:function(){this.options.chromeless&&!this.options.allowUserInteraction||this.trigger(P.CONTAINER_MOUSE_ENTER)}},{key:"mouseLeave",value:function(){this.options.chromeless&&!this.options.allowUserInteraction||this.trigger(P.CONTAINER_MOUSE_LEAVE)}},{key:"mouseUp",value:function(){this.options.chromeless&&!this.options.allowUserInteraction||this.trigger(P.CONTAINER_MOUSE_UP)}},{key:"mouseDown",value:function(){this.options.chromeless&&!this.options.allowUserInteraction||this.trigger(P.CONTAINER_MOUSE_DOWN)}},{key:"settingsUpdate",value:function(){this.settings=this.playback.settings,this.trigger(P.CONTAINER_SETTINGSUPDATE)}},{key:"highDefinitionUpdate",value:function(e){this.trigger(P.CONTAINER_HIGHDEFINITIONUPDATE,e)}},{key:"isHighDefinitionInUse",value:function(){return this.playback.isHighDefinitionInUse()}},{key:"disableMediaControl",value:function(){this.mediaControlDisabled||(this.mediaControlDisabled=!0,this.trigger(P.CONTAINER_MEDIACONTROL_DISABLE))}},{key:"enableMediaControl",value:function(){this.mediaControlDisabled&&(this.mediaControlDisabled=!1,this.trigger(P.CONTAINER_MEDIACONTROL_ENABLE))}},{key:"updateStyle",value:function(){!this.options.chromeless||this.options.allowUserInteraction?this.$el.removeClass("chromeless"):this.$el.addClass("chromeless")}},{key:"enableResizeObserver",value:function(){var e=this;this.disableResizeObserver(),this.resizeObserverInterval=setInterval(function(){return e.checkResize()},500)}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval)}},{key:"checkResize",value:function(){var e={width:this.el.clientWidth,height:this.el.clientHeight},t=this.currentSize||{},r=t.width;t.height===e.height&&r===e.width||(this.currentSize=e,this.trigger(P.CONTAINER_RESIZE,e))}},{key:"configure",value:function(e){this._options=O.extend(!0,this._options,e),this.updateStyle(),this.playback.configure(this.options),this.trigger(P.CONTAINER_OPTIONS_CHANGE)}},{key:"render",value:function(){var e=dr.getStyleFor(".container[data-container] {\n  position: absolute;\n  background-color: black;\n  height: 100%;\n  width: 100%;\n  max-width: 100%; }\n  .container[data-container] .chromeless {\n    cursor: default; }\n\n[data-player]:not(.nocursor) .container[data-container]:not(.chromeless).pointer-enabled {\n  cursor: pointer; }\n".toString(),{baseUrl:this.options.baseUrl});return this.$el.append(e[0]),this.$el.append(this.playback.render().el),this.updateStyle(),this.checkResize(),this.enableResizeObserver(),this}}]),a}()),x=(Object.assign(gr.prototype,t),function(){c(i,hr);var n=d(i);function i(e,t,r){return u(this,i),(e=n.call(this,e)).settings={},e._i18n=t,e.playerError=r,e._consented=!1,e}return s(i,[{key:"isAudioOnly",get:function(){return!1}},{key:"isAdaptive",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"i18n",get:function(){return this._i18n}},{key:"buffering",get:function(){return!1}}]),s(i,[{key:"consent",value:function(e){"function"==typeof e&&e()}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"stop",value:function(){}},{key:"seek",value:function(e){}},{key:"seekPercentage",value:function(e){}},{key:"getStartTimeOffset",value:function(){return 0}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"getPlaybackType",value:function(){return i.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"mute",value:function(){}},{key:"unmute",value:function(){}},{key:"volume",value:function(e){}},{key:"configure",value:function(e){this._options=O.extend(!0,this._options,e)}},{key:"attemptAutoPlay",value:function(){var r=this;this.canAutoPlay(function(e,t){e&&r.play()})}},{key:"canAutoPlay",value:function(e){e(!0,null)}},{key:"isReady",get:function(){return!1}},{key:"hasClosedCaptionsTracks",get:function(){return 0<this.closedCaptionsTracks.length}},{key:"closedCaptionsTracks",get:function(){return[]}},{key:"closedCaptionsTrackId",get:function(){return-1},set:function(e){}}]),i}()),Ar=(Object.assign(x.prototype,t),x.extend=function(e){return xt(x,e)},x.canPlay=function(e,t){return!1},x.VOD="vod",x.AOD="aod",x.LIVE="live",x.NO_OP="no_op",x.type="playback",function(){c(a,N);var i=d(a);function a(e,t,r,n){return u(this,a),(e=i.call(this,e))._i18n=r,e.loader=t,e.playerError=n,e}return s(a,[{key:"options",get:function(){return this._options},set:function(e){this._options=e}}]),s(a,[{key:"createContainers",value:function(){var t=this;return O.Deferred(function(e){e.resolve(t.options.sources.map(function(e){return t.createContainer(e)}))})}},{key:"findPlaybackPlugin",value:function(t,r){return this.loader.playbackPlugins.filter(function(e){return e.canPlay(t,r)})[0]}},{key:"createContainer",value:function(e){var t=null,r=this.options.mimeType,e=("object"===F(e)?(t=e.source.toString(),e.mimeType&&(r=e.mimeType)):t=e.toString(),t.match(/^\/\//)&&(t=window.location.protocol+t),j(j({},this.options),{},{src:t,mimeType:r})),t=this.findPlaybackPlugin(t,r),r=t?new t(e,this._i18n,this.playerError):new x,e=j(j({},e),{},{playback:r}),n=new gr(e,this._i18n,this.playerError),i=O.Deferred();return i.promise(n),this.addContainerPlugins(n),this.listenToOnce(n,P.CONTAINER_READY,function(){return i.resolve(n)}),n}},{key:"addContainerPlugins",value:function(t){this.loader.containerPlugins.forEach(function(e){t.addPlugin(new e(t))})}}]),a}()),mr=function(){c(n,hr);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e)).playerError=new pr(e,G(t)),t.configureDomRecycler(),t.firstResize=!0,t.plugins=[],t.containers=[],t._boundFullscreenHandler=function(){return t.handleFullscreenChange()},O(document).bind("fullscreenchange",t._boundFullscreenHandler),O(document).bind("MSFullscreenChange",t._boundFullscreenHandler),O(document).bind("mozfullscreenchange",t._boundFullscreenHandler),L.isMobile&&O(window).bind("resize",function(e){t.handleWindowResize(e)}),t}return s(n,[{key:"events",get:function(){return{webkitfullscreenchange:"handleFullscreenChange",mousemove:"onMouseMove",mouseleave:"onMouseLeave"}}},{key:"attributes",get:function(){return{"data-player":"",tabindex:9999}}},{key:"isReady",get:function(){return!!this.ready}},{key:"i18n",get:function(){return this.getPlugin("strings")||{t:function(e){return e}}}},{key:"mediaControl",get:function(){return this._mediaControl||(this._mediaControl=this.getPlugin("media_control"))||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl||(this._dummyMediaControl=new vr(this)),this._dummyMediaControl}},{key:"activeContainer",get:function(){return this._activeContainer},set:function(e){this._activeContainer=e,this.trigger(P.CORE_ACTIVE_CONTAINER_CHANGED,this._activeContainer)}},{key:"activePlayback",get:function(){return this.activeContainer&&this.activeContainer.playback}}]),s(n,[{key:"configureDomRecycler",value:function(){var e=this.options&&this.options.playback&&this.options.playback.recycleVideo;qt.configure({recycleVideo:e})}},{key:"createContainers",value:function(e){this.defer=O.Deferred(),this.defer.promise(this),this.containerFactory=new Ar(e,e.loader,this.i18n,this.playerError),this.prepareContainers()}},{key:"prepareContainers",value:function(){var t=this;this.containerFactory.createContainers().then(function(e){return t.setupContainers(e)}).then(function(e){return t.resolveOnContainersReady(e)})}},{key:"updateSize",value:function(){this.isFullscreen()?this.setFullscreen():this.setPlayerSize()}},{key:"setFullscreen",value:function(){L.isiOS||(this.$el.addClass("fullscreen"),this.$el.removeAttr("style"),this.previousSize={width:this.options.width,height:this.options.height},this.currentSize={width:O(window).width(),height:O(window).height()})}},{key:"setPlayerSize",value:function(){this.$el.removeClass("fullscreen"),this.currentSize=this.previousSize,this.previousSize={width:O(window).width(),height:O(window).height()},this.resize(this.currentSize)}},{key:"resize",value:function(e){jt(e.height)||jt(e.width)?(this.el.style.height="".concat(e.height,"px"),this.el.style.width="".concat(e.width,"px")):(this.el.style.height="".concat(e.height),this.el.style.width="".concat(e.width)),this.previousSize={width:this.options.width,height:this.options.height},this.options.width=e.width,this.options.height=e.height,this.currentSize=e,this.triggerResize(this.currentSize)}},{key:"enableResizeObserver",value:function(){var e=this;this.disableResizeObserver();this.resizeObserverInterval=setInterval(function(){e.triggerResize({width:e.el.clientWidth,height:e.el.clientHeight})},500)}},{key:"triggerResize",value:function(e){!this.firstResize&&this.oldHeight===e.height&&this.oldWidth===e.width||(this.oldHeight=e.height,this.oldWidth=e.width,this.computedSize=e,this.firstResize=!1,this.trigger(P.CORE_RESIZE,e))}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval),this.resizeObserverInterval=null}},{key:"resolveOnContainersReady",value:function(e){var t=this;O.when.apply(O,e).done(function(){t.defer.resolve(t),t.ready=!0,t.trigger(P.CORE_READY)})}},{key:"addPlugin",value:function(e){this.plugins.push(e)}},{key:"hasPlugin",value:function(e){return!!this.getPlugin(e)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(e){return e.name===t})[0]}},{key:"load",value:function(e,t){this.options.mimeType=t,e=e&&e.constructor===Array?e:[e],this.options.sources=e,this.containers.forEach(function(e){return e.destroy()}),this.containerFactory.options=O.extend(!0,this.options,{sources:e}),this.prepareContainers()}},{key:"destroy",value:function(){this.disableResizeObserver(),this.containers.forEach(function(e){return e.destroy()}),this.plugins.forEach(function(e){return e.destroy()}),this.$el.remove(),O(document).unbind("fullscreenchange",this._boundFullscreenHandler),O(document).unbind("MSFullscreenChange",this._boundFullscreenHandler),O(document).unbind("mozfullscreenchange",this._boundFullscreenHandler),this.stopListening()}},{key:"handleFullscreenChange",value:function(){this.trigger(P.CORE_FULLSCREEN,this.isFullscreen()),this.updateSize()}},{key:"handleWindowResize",value:function(e){var t=window.innerWidth>window.innerHeight?"landscape":"portrait";this._screenOrientation!==t&&(this._screenOrientation=t,this.triggerResize({width:this.el.clientWidth,height:this.el.clientHeight}),this.trigger(P.CORE_SCREEN_ORIENTATION_CHANGED,{event:e,orientation:this._screenOrientation}))}},{key:"removeContainer",value:function(t){this.stopListening(t),this.containers=this.containers.filter(function(e){return e!==t})}},{key:"setupContainer",value:function(e){this.listenTo(e,P.CONTAINER_DESTROYED,this.removeContainer),this.containers.push(e)}},{key:"setupContainers",value:function(e){return e.forEach(this.setupContainer.bind(this)),this.trigger(P.CORE_CONTAINERS_CREATED),this.renderContainers(),this.activeContainer=e[0],this.render(),this.appendToParent(),this.containers}},{key:"renderContainers",value:function(){var t=this;this.containers.forEach(function(e){return t.el.appendChild(e.render().el)})}},{key:"createContainer",value:function(e,t){e=this.containerFactory.createContainer(e,t);return this.setupContainer(e),this.el.appendChild(e.render().el),e}},{key:"getCurrentContainer",value:function(){return this.activeContainer}},{key:"getCurrentPlayback",value:function(){return this.activePlayback}},{key:"getPlaybackType",value:function(){return this.activeContainer&&this.activeContainer.getPlaybackType()}},{key:"isFullscreen",value:function(){var e,t=Mt.fullscreenElement();return!!t&&(e=this.activePlayback&&this.activePlayback.el,t===this.el||t===e)}},{key:"toggleFullscreen",value:function(){var e,t=this;this.isFullscreen()?(Mt.cancelFullscreen(),L.isiOS||this.$el.removeClass("fullscreen nocursor")):(e=L.isiOS?this.activePlayback&&this.activePlayback.el:this.el)&&(L.isSafari||L.isiOS?Mt.requestFullscreen(e):Mt.requestFullscreen(e).then(function(e){return e},function(e){return setTimeout(function(){if(!t.isFullscreen())throw new ReferenceError(e)},600)}),L.isiOS||this.$el.addClass("fullscreen"))}},{key:"onMouseMove",value:function(e){this.trigger(P.CORE_MOUSE_MOVE,e)}},{key:"onMouseLeave",value:function(e){this.trigger(P.CORE_MOUSE_LEAVE,e)}},{key:"configure",value:function(e){var t=this,r=(this._options=O.extend(!0,this._options,e),this.configureDomRecycler(),e.source||e.sources);r&&this.load(r,e.mimeType||this.options.mimeType),this.trigger(P.CORE_OPTIONS_CHANGE,e),this.containers.forEach(function(e){return e.configure(t.options)})}},{key:"appendToParent",value:function(){var e=dr.getStyleFor('[data-player] {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  transform: translate3d(0, 0, 0);\n  position: relative;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-style: normal;\n  font-weight: normal;\n  text-align: center;\n  overflow: hidden;\n  font-size: 100%;\n  font-family: "Roboto", "Open Sans", Arial, sans-serif;\n  text-shadow: 0 0 0;\n  box-sizing: border-box; }\n  [data-player]:focus {\n    outline: 0; }\n  [data-player] * {\n    box-sizing: inherit; }\n  [data-player] > * {\n    float: none;\n    max-width: none; }\n  [data-player] > div {\n    display: block; }\n  [data-player].fullscreen {\n    width: 100% !important;\n    height: 100% !important;\n    top: 0;\n    left: 0; }\n  [data-player].nocursor {\n    cursor: none; }\n\n.clappr-style {\n  display: none !important; }\n'.toString(),{baseUrl:this.options.baseUrl}),t=dr.getStyleFor('[data-player] div, [data-player] span, [data-player] applet, [data-player] object, [data-player] iframe,\n[data-player] h1, [data-player] h2, [data-player] h3, [data-player] h4, [data-player] h5, [data-player] h6, [data-player] p, [data-player] blockquote, [data-player] pre,\n[data-player] a, [data-player] abbr, [data-player] acronym, [data-player] address, [data-player] big, [data-player] cite, [data-player] code,\n[data-player] del, [data-player] dfn, [data-player] em, [data-player] img, [data-player] ins, [data-player] kbd, [data-player] q, [data-player] s, [data-player] samp,\n[data-player] small, [data-player] strike, [data-player] strong, [data-player] sub, [data-player] sup, [data-player] tt, [data-player] var,\n[data-player] b, [data-player] u, [data-player] i, [data-player] center,\n[data-player] dl, [data-player] dt, [data-player] dd, [data-player] ol, [data-player] ul, [data-player] li,\n[data-player] fieldset, [data-player] form, [data-player] label, [data-player] legend,\n[data-player] table, [data-player] caption, [data-player] tbody, [data-player] tfoot, [data-player] thead, [data-player] tr, [data-player] th, [data-player] td,\n[data-player] article, [data-player] aside, [data-player] canvas, [data-player] details, [data-player] embed,\n[data-player] figure, [data-player] figcaption, [data-player] footer, [data-player] header, [data-player] hgroup,\n[data-player] menu, [data-player] nav, [data-player] output, [data-player] ruby, [data-player] section, [data-player] summary,\n[data-player] time, [data-player] mark, [data-player] audio, [data-player] video {\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font: inherit;\n  font-size: 100%;\n  vertical-align: baseline; }\n\n[data-player] table {\n  border-collapse: collapse;\n  border-spacing: 0; }\n\n[data-player] caption, [data-player] th, [data-player] td {\n  text-align: left;\n  font-weight: normal;\n  vertical-align: middle; }\n\n[data-player] q, [data-player] blockquote {\n  quotes: none; }\n  [data-player] q:before, [data-player] q:after, [data-player] blockquote:before, [data-player] blockquote:after {\n    content: "";\n    content: none; }\n\n[data-player] a img {\n  border: none; }\n'.toString(),{baseUrl:this.options.baseUrl});this.$el.append(e[0]),this.options.includeResetStyle&&this.$el.append(t[0]),this.$el.parent()&&this.$el.parent().length||this.$el.appendTo(this.options.parentElement)}},{key:"render",value:function(){this.options.width=this.options.width||this.$el.width(),this.options.height=this.options.height||this.$el.height();var e={width:this.options.width,height:this.options.height};return this.previousSize=this.currentSize=this.computedSize=e,this.updateSize(),this.enableResizeObserver(),this}}]),n}(),yr=(Object.assign(mr.prototype,t),function(){c(n,N);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e.options)).player=e,t}return s(n,[{key:"loader",get:function(){return this.player.loader}}]),s(n,[{key:"create",value:function(){return this.options.loader=this.loader,this.core=new mr(this.options),this.addCorePlugins(),this.core.createContainers(this.options),this.core}},{key:"addCorePlugins",value:function(){var t=this;return this.loader.corePlugins.forEach(function(e){e=new e(t.core);t.core.addPlugin(e),t.setupExternalInterface(e)}),this.core}},{key:"setupExternalInterface",value:function(e){var t,r=e.getExternalInterface();for(t in r)this.player[t]=r[t].bind(e)}}]),n}()),Er=/(\d+)(?:\.(\d+))?(?:\.(\d+))?/,br=function(){function n(e,t,r){u(this,n),this.major=parseInt(e||0,10),this.minor=parseInt(t||0,10),this.patch=parseInt(r||0,10)}return s(n,null,[{key:"parse",value:function(){var e=Y((0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").match(Er)||[],4),t=e[1],r=e[2],e=e[3];return void 0===t?null:new n(t,r,e)}}]),s(n,[{key:"compare",value:function(e){return this.major-e.major||this.minor-e.minor||this.patch-e.patch}},{key:"inc",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"patch";return void 0!==this[e]&&(this[e]+=1),this}},{key:"satisfies",value:function(e,t){return 0<=this.compare(e)&&(!t||this.compare(t)<0)}},{key:"toString",value:function(){return"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}]),n}(),kr=(I={plugins:{},playbacks:[]},function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=(u(this,i),this.playerId=t,this.playbackPlugins=H(I.playbacks),i.registeredPlugins),r=t.core,t=t.container;this.containerPlugins=Object.values(t),this.corePlugins=Object.values(r),Array.isArray(e)||this.validateExternalPluginsType(e),this.addExternalPlugins(e)}return s(i,null,[{key:"checkVersionSupport",value:function(e){var t,e=e.prototype,r=e.supportedVersion,e=e.name;return r&&r.min?(t=r.max?br.parse(r.max):br.parse(r.min).inc("minor"),r=br.parse(r.min),!!br.parse("0.4.19").satisfies(r,t)||(D.warn("Loader","unsupported plugin ".concat(e,": Clappr version ").concat("0.4.19"," does not match required range [").concat(r,",").concat(t,")")),!1)):(D.warn("Loader","missing version information for ".concat(e)),!1)}},{key:"registerPlugin",value:function(e){if(!e||!e.prototype.name)return D.warn("Loader","missing information to register plugin: ".concat(e)),!1;i.checkVersionSupport(e);var t,r=I.plugins;return!!r&&((t=r[e.prototype.name])&&D.warn("Loader","overriding plugin entry: ".concat(e.prototype.name," - ").concat(t)),r[e.prototype.name]=e,!0)}},{key:"registerPlayback",value:function(t){if(!t||!t.prototype.name)return!1;i.checkVersionSupport(t);var e,r=I.playbacks,n=r.findIndex(function(e){return e.prototype.name===t.prototype.name});return 0<=n&&(e=r[n],r.splice(n,1),D.warn("Loader","overriding playback entry: ".concat(e.name," - ").concat(e))),I.playbacks=[t].concat(H(r)),!0}},{key:"unregisterPlugin",value:function(e){var t;return!!e&&!!(t=I.plugins)[e]&&(delete t[e],!0)}},{key:"unregisterPlayback",value:function(t){var e,r;return!!t&&!((r=(e=I.playbacks).findIndex(function(e){return e.prototype.name===t}))<0||(e.splice(r,1),I.playbacks=e,0))}},{key:"clearPlugins",value:function(){I.plugins={}}},{key:"clearPlaybacks",value:function(){I.playbacks=[]}},{key:"registeredPlaybacks",get:function(){return H(I.playbacks)}},{key:"registeredPlugins",get:function(){var e=I.plugins;return{core:Wt(e,"core"),container:Wt(e,"container")}}}]),s(i,[{key:"groupPluginsByType",value:function(e){return e=Array.isArray(e)?e.reduce(function(e,t){return e[t.type]||(e[t.type]=[]),e[t.type].push(t),e},{}):e}},{key:"removeDups",value:function(e){var t,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=e.reduceRight(function(e,t){return e[t.prototype.name]&&r||(e[t.prototype.name]&&delete e[t.prototype.name],e[t.prototype.name]=t),e},Object.create(null)),i=[];for(t in n)i.unshift(n[t]);return i}},{key:"addExternalPlugins",value:function(e){var t,r="boolean"!=typeof e.loadExternalPluginsFirst||e.loadExternalPluginsFirst,n="boolean"!=typeof e.loadExternalPlaybacksFirst||e.loadExternalPlaybacksFirst;(e=this.groupPluginsByType(e)).playback&&(t=e.playback.filter(function(e){return i.checkVersionSupport(e),!0}),this.playbackPlugins=n?this.removeDups(t.concat(this.playbackPlugins)):this.removeDups(this.playbackPlugins.concat(t),!0)),e.container&&(n=e.container.filter(function(e){return i.checkVersionSupport(e),!0}),this.containerPlugins=r?this.removeDups(n.concat(this.containerPlugins)):this.removeDups(this.containerPlugins.concat(n),!0)),e.core&&(t=e.core.filter(function(e){return i.checkVersionSupport(e),!0}),this.corePlugins=r?this.removeDups(t.concat(this.corePlugins)):this.removeDups(this.corePlugins.concat(t),!0))}},{key:"validateExternalPluginsType",value:function(e){["playback","container","core"].forEach(function(r){(e[r]||[]).forEach(function(e){var t="external "+e.type+" plugin on "+r+" array";if(e.type!==r)throw new ReferenceError(t)})})}}]),i}()),_r=Vt().replace(/\/[^/]+$/,""),e=function(){c(i,N);var n=d(i);function i(e){u(this,i),t=n.call(this,e);var t,r={playerId:Ut(""),persistConfig:!0,width:640,height:360,baseUrl:_r,allowUserInteraction:L.isMobile,includeResetStyle:!0,playback:{recycleVideo:!0}};return t._options=O.extend(!0,r,e),t.options.sources=t._normalizeSources(e),t.options.chromeless||(t.options.allowUserInteraction=!0),t.options.allowUserInteraction||(t.options.disableKeyboardShortcuts=!0),t._registerOptionEventListeners(t.options.events),t._coreFactory=new yr(G(t)),t.options.parentId?t.setParentId(t.options.parentId):t.options.parent&&t.attachTo(t.options.parent),t}return s(i,[{key:"loader",set:function(e){this._loader=e},get:function(){return this._loader||(this._loader=new kr(this.options.plugins||{},this.options.playerId)),this._loader}},{key:"ended",get:function(){return this.core.activeContainer.ended}},{key:"buffering",get:function(){return this.core.activeContainer.buffering}},{key:"isReady",get:function(){return!!this._ready}},{key:"eventsMapping",get:function(){return{onReady:P.PLAYER_READY,onResize:P.PLAYER_RESIZE,onPlay:P.PLAYER_PLAY,onPause:P.PLAYER_PAUSE,onStop:P.PLAYER_STOP,onEnded:P.PLAYER_ENDED,onSeek:P.PLAYER_SEEK,onError:P.PLAYER_ERROR,onTimeUpdate:P.PLAYER_TIMEUPDATE,onVolumeUpdate:P.PLAYER_VOLUMEUPDATE,onSubtitleAvailable:P.PLAYER_SUBTITLE_AVAILABLE}}}]),s(i,[{key:"setParentId",value:function(e){e=document.querySelector(e);return e&&this.attachTo(e),this}},{key:"attachTo",value:function(e){return this.options.parentElement=e,this.core=this._coreFactory.create(),this._addEventListeners(),this}},{key:"_addEventListeners",value:function(){return this.core.isReady?this._onReady():this.listenToOnce(this.core,P.CORE_READY,this._onReady),this.listenTo(this.core,P.CORE_ACTIVE_CONTAINER_CHANGED,this._containerChanged),this.listenTo(this.core,P.CORE_FULLSCREEN,this._onFullscreenChange),this.listenTo(this.core,P.CORE_RESIZE,this._onResize),this}},{key:"_addContainerEventListeners",value:function(){var e=this.core.activeContainer;return e&&(this.listenTo(e,P.CONTAINER_PLAY,this._onPlay),this.listenTo(e,P.CONTAINER_PAUSE,this._onPause),this.listenTo(e,P.CONTAINER_STOP,this._onStop),this.listenTo(e,P.CONTAINER_ENDED,this._onEnded),this.listenTo(e,P.CONTAINER_SEEK,this._onSeek),this.listenTo(e,P.CONTAINER_ERROR,this._onError),this.listenTo(e,P.CONTAINER_TIMEUPDATE,this._onTimeUpdate),this.listenTo(e,P.CONTAINER_VOLUME,this._onVolumeUpdate),this.listenTo(e,P.CONTAINER_SUBTITLE_AVAILABLE,this._onSubtitleAvailable)),this}},{key:"_registerOptionEventListeners",value:function(){var r=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return 0<Object.keys(n).length&&Object.keys(i).forEach(function(e){var t=r.eventsMapping[e];t&&r.off(t,i[e])}),Object.keys(n).forEach(function(e){var t=r.eventsMapping[e];t&&(e="function"==typeof(e=n[e])&&e)&&r.on(t,e)}),this}},{key:"_containerChanged",value:function(){this.stopListening(),this._addEventListeners()}},{key:"_onReady",value:function(){this._ready=!0,this._addContainerEventListeners(),this.trigger(P.PLAYER_READY)}},{key:"_onFullscreenChange",value:function(e){this.trigger(P.PLAYER_FULLSCREEN,e)}},{key:"_onVolumeUpdate",value:function(e){this.trigger(P.PLAYER_VOLUMEUPDATE,e)}},{key:"_onSubtitleAvailable",value:function(){this.trigger(P.PLAYER_SUBTITLE_AVAILABLE)}},{key:"_onResize",value:function(e){this.trigger(P.PLAYER_RESIZE,e)}},{key:"_onPlay",value:function(){this.trigger(P.PLAYER_PLAY)}},{key:"_onPause",value:function(){this.trigger(P.PLAYER_PAUSE)}},{key:"_onStop",value:function(){this.trigger(P.PLAYER_STOP,this.getCurrentTime())}},{key:"_onEnded",value:function(){this.trigger(P.PLAYER_ENDED)}},{key:"_onSeek",value:function(e){this.trigger(P.PLAYER_SEEK,e)}},{key:"_onTimeUpdate",value:function(e){this.trigger(P.PLAYER_TIMEUPDATE,e)}},{key:"_onError",value:function(e){this.trigger(P.PLAYER_ERROR,e)}},{key:"_normalizeSources",value:function(e){e=e.sources||(void 0!==e.source?[e.source]:[]);return 0===e.length?[{source:"",mimeType:""}]:e}},{key:"resize",value:function(e){return this.core.resize(e),this}},{key:"load",value:function(e,t,r){return void 0!==r&&this.configure({autoPlay:!!r}),this.core.load(e,t),this}},{key:"destroy",value:function(){return this.stopListening(),this.core.destroy(),this}},{key:"consent",value:function(e){this.core.getCurrentPlayback().consent(e)}},{key:"play",value:function(){return this.core.activeContainer.play(),this}},{key:"pause",value:function(){return this.core.activeContainer.pause(),this}},{key:"stop",value:function(){return this.core.activeContainer.stop(),this}},{key:"seek",value:function(e){return this.core.activeContainer.seek(e),this}},{key:"seekPercentage",value:function(e){return this.core.activeContainer.seekPercentage(e),this}},{key:"mute",value:function(){return this.core.activePlayback.mute(),this}},{key:"unmute",value:function(){return this.core.activePlayback.unmute(),this}},{key:"isPlaying",value:function(){return this.core.activeContainer.isPlaying()}},{key:"isDvrEnabled",value:function(){return this.core.activeContainer.isDvrEnabled()}},{key:"isDvrInUse",value:function(){return this.core.activeContainer.isDvrInUse()}},{key:"configure",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._registerOptionEventListeners(e.events,this.options.events),this.core.configure(e),this}},{key:"getPlugin",value:function(t){return this.core.plugins.concat(this.core.activeContainer.plugins).filter(function(e){return e.name===t})[0]}},{key:"getCurrentTime",value:function(){return this.core.activeContainer.getCurrentTime()}},{key:"getStartTimeOffset",value:function(){return this.core.activeContainer.getStartTimeOffset()}},{key:"getDuration",value:function(){return this.core.activeContainer.getDuration()}}]),i}(),Tr=(Object.assign(e.prototype,t),function(){c(n,N);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e.options)).container=e,t.enabled=!0,t.bindEvents(),t}return s(n,[{key:"playerError",get:function(){return this.container.playerError}}]),s(n,[{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"bindEvents",value:function(){}},{key:"destroy",value:function(){this.stopListening()}}]),n}()),Sr=(Object.assign(Tr.prototype,t),Tr.extend=function(e){return xt(Tr,e)},Tr.type="container",function(){c(n,N);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e.options)).core=e,t.enabled=!0,t.bindEvents(),t}return s(n,[{key:"playerError",get:function(){return this.core.playerError}}]),s(n,[{key:"bindEvents",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"getExternalInterface",value:function(){return{}}},{key:"destroy",value:function(){this.stopListening()}}]),n}()),Cr=(Object.assign(Sr.prototype,t),Sr.extend=function(e){return xt(Sr,e)},Sr.type="core",function(){c(n,hr);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e.options)).container=e,t.enabled=!0,t.bindEvents(),t}return s(n,[{key:"playerError",get:function(){return this.container.playerError}}]),s(n,[{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"bindEvents",value:function(){}}]),n}()),Rr=(Object.assign(Cr.prototype,t),Cr.extend=function(e){return xt(Cr,e)},Cr.type="container",{mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]}),wr=(Rr.ogv=Rr.ogg,Rr["3gp"]=Rr["3gpp"],{wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]}),Or=Object.keys(wr).reduce(function(e,t){return[].concat(H(e),H(wr[t]))},[]),Lr={code:"unknown",message:"unknown"},M=function(){c(l,x);var o=d(l);function l(){var e;u(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=o.call.apply(o,[this].concat(r)))._destroyed=!1,e._loadStarted=!1,e._isBuffering=!1,e._playheadMoving=!1,e._playheadMovingTimer=null,e._stopped=!1,e._ccTrackId=-1,e._setupSrc(e.options.src),e.options.playback||(e.options.playback=e.options||{}),e.options.playback.disableContextMenu=e.options.playback.disableContextMenu||e.options.disableVideoTagContextMenu,e._minDvrSize=e.isValidMinimumDVRSizeConfig?e.minimumDVRSizeConfig:60;var i,a=e.options.playback,s=a.preload||(L.isSafari?"auto":e.options.preload);return e.options.poster&&("string"==typeof e.options.poster?i=e.options.poster:"string"==typeof e.options.poster.url&&(i=e.options.poster.url)),O.extend(!0,e.el,{muted:e.options.mute,defaultMuted:e.options.mute,loop:e.options.loop,poster:i,preload:s||"metadata",crossOrigin:a.crossOrigin,"x-webkit-playsinline":a.playInline}),(a.controls||e.options.useVideoTagDefaultControls)&&e.$el.attr("controls",""),a.playInline&&e.$el.attr({playsinline:"playsinline"}),a.crossOrigin&&e.$el.attr({crossorigin:a.crossOrigin}),e.settings={default:["seekbar"]},e.settings.left=["playpause","position","duration"],e.settings.right=["fullscreen","volume","hd-indicator"],a.externalTracks&&e._setupExternalTracks(a.externalTracks),e.options.autoPlay&&e.attemptAutoPlay(),e}return s(l,[{key:"name",get:function(){return"html5_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.19"}}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"isAudioOnly",get:function(){var e=this.options.src,e=l._mimeTypesForUrl(e,wr,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||0<=Or.indexOf(e[0])}},{key:"attributes",get:function(){return{"data-html5-video":""}}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_handleBufferingEvents",durationchange:"_onDurationChange",ended:"_onEnded",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",stalled:"_handleBufferingEvents",timeupdate:"_onTimeUpdate",waiting:"_onWaiting"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}},{key:"isLive",get:function(){return this.getPlaybackType()===x.LIVE}},{key:"dvrEnabled",get:function(){return this.getDuration()>=this._minDvrSize&&this.isLive}},{key:"minimumDVRSizeConfig",get:function(){return this.options.playback&&this.options.playback.minimumDvrSize}},{key:"isValidMinimumDVRSizeConfig",get:function(){return void 0!==this.minimumDVRSizeConfig&&"number"==typeof this.minimumDVRSizeConfig}}]),s(l,[{key:"configure",value:function(e){K(a(l.prototype),"configure",this).call(this,e),this.el.loop=!!e.loop}},{key:"attemptAutoPlay",value:function(){var r=this;this.canAutoPlay(function(e,t){t&&D.warn(r.name,"autoplay error.",{result:e,error:t}),e&&setTimeout(function(){return!r._destroyed&&r.play()},0)})}},{key:"canAutoPlay",value:function(e){var t;this.options.disableCanAutoPlay?e(!0,null):(t={timeout:this.options.autoPlayTimeout||500,inline:this.options.playback.playInline||!1,muted:this.options.mute||!1},L.isMobile&&qt.options.recycleVideo&&(t.element=this.el),Kt(e,t))}},{key:"_setupExternalTracks",value:function(e){this._externalTracks=e.map(function(e){return{kind:e.kind||"subtitles",label:e.label,lang:e.lang,src:e.src}})}},{key:"_setupSrc",value:function(e){this.el.src!==e&&(this._ccIsSetup=!1,this.el.src=e,this._src=this.el.src)}},{key:"_onLoadedMetadata",value:function(e){this._handleBufferingEvents(),this.trigger(P.PLAYBACK_LOADEDMETADATA,{duration:e.target.duration,data:e}),this._updateSettings();e=void 0===this._options.autoSeekFromUrl||this._options.autoSeekFromUrl;this.getPlaybackType()!==x.LIVE&&e&&this._checkInitialSeek()}},{key:"_onDurationChange",value:function(){this._updateSettings(),this._onTimeUpdate(),this._onProgress()}},{key:"_updateSettings",value:function(){this.getPlaybackType()===x.VOD||this.getPlaybackType()===x.AOD?this.settings.left=["playpause","position","duration"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(P.PLAYBACK_SETTINGSUPDATE)}},{key:"isSeekEnabled",value:function(){return isFinite(this.getDuration())}},{key:"getPlaybackType",value:function(){var e="audio"===this.tagName?x.AOD:x.VOD;return 0<=[0,void 0,1/0].indexOf(this.el.duration)?x.LIVE:e}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"consent",value:function(t){var e,r=this;this.isPlaying()||this.el._consented?K(a(l.prototype),"consent",this).call(this,t):(this.el.addEventListener("loadedmetadata",e=function e(){r.el.removeEventListener("loadedmetadata",e,!1),r.el.removeEventListener("error",e,!1),r.el._consented=!0,K(a(l.prototype),"consent",r).call(r,t)},!1),this.el.addEventListener("error",e,!1),this.el.load())}},{key:"play",value:function(){this.trigger(P.PLAYBACK_PLAY_INTENT),this._stopped=!1,this._setupSrc(this._src),this._handleBufferingEvents();var e=this.el.play();e&&e.catch&&e.catch(function(){})}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this.el.removeAttribute("src"),this.el.load(),this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(P.PLAYBACK_STOP)}},{key:"volume",value:function(e){0===e?(this.$el.attr({muted:"true"}),this.el.muted=!0):(this.$el.attr({muted:null}),this.el.muted=!1,this.el.volume=e/100)}},{key:"mute",value:function(){this.el.muted=!0}},{key:"unmute",value:function(){this.el.muted=!1}},{key:"isMuted",value:function(){return!0===this.el.muted||0===this.el.volume}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"_startPlayheadMovingChecks",value:function(){null===this._playheadMovingTimer&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){null!==this._playheadMovingTimer&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var e=this._playheadMovingTimeOnCheck,t=this.el.currentTime;this._playheadMoving=e!==t,this._playheadMovingTimeOnCheck=t,this._handleBufferingEvents()}},{key:"_onWaiting",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onPlaying",value:function(){this._checkForClosedCaptions(),this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(P.PLAYBACK_PLAY)}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(P.PLAYBACK_PAUSE)}},{key:"_onSeeking",value:function(){this.trigger(P.PLAYBACK_SEEK,this.getCurrentTime()),this._handleBufferingEvents()}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(P.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(P.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingEvents",value:function(){var e=!this.el.ended&&!this.el.paused,e=this._loadStarted&&!this.el.ended&&!this._stopped&&(e&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!==e&&((this._isBuffering=e)?this.trigger(P.PLAYBACK_BUFFERING,this.name):this.trigger(P.PLAYBACK_BUFFERFULL,this.name))}},{key:"_onError",value:function(){var e=this.el.error||Lr,t=e.code,e=e.message,r=t===Lr.code,t=this.createError({code:t,description:e,raw:this.el.error,level:r?pr.Levels.WARN:pr.Levels.FATAL});r?D.warn(this.name,"HTML5 unknown error: ",t):this.trigger(P.PLAYBACK_ERROR,t)}},{key:"destroy",value:function(){this._destroyed=!0,this.handleTextTrackChange&&this.el.textTracks.removeEventListener("change",this.handleTextTrackChange),K(a(l.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this.el.load(),this._src=null,qt.garbage(this.el)}},{key:"_updateDvr",value:function(e){this.trigger(P.PLAYBACK_DVR,e),this.trigger(P.PLAYBACK_STATS_ADD,{dvr:e})}},{key:"seek",value:function(e){e<0&&(D.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),e=this.getDuration()),this.dvrEnabled&&this._updateDvr(e<this.getDuration()-3),e+=this.el.seekable.start(0),this.el.currentTime=e}},{key:"seekPercentage",value:function(e){e=this.el.duration*(e/100);this.seek(e)}},{key:"_checkInitialSeek",value:function(){var e=Bt();0!==e&&this.seek(e)}},{key:"getCurrentTime",value:function(){return this.el.currentTime}},{key:"getDuration",value:function(){if(this.isLive){if(0<this.el.seekable.length)return this.el.seekable.end(0)-this.el.seekable.start(0);this._scheduleUpdateSettingsCheck()}return this.el.duration}},{key:"_scheduleUpdateSettingsCheck",value:function(){var e=this;this._updateSettingsCheckInFlight||(this._updateSettingsCheckInFlight=setTimeout(function(){e._updateSettings(),e._updateSettingsCheckInFlight=null},1e3))}},{key:"_onTimeUpdate",value:function(){var e=this.isLive?this.getDuration():this.el.duration;this.trigger(P.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:e},this.name)}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var e=[],t=0,r=0;r<this.el.buffered.length;r++)e=[].concat(H(e),[{start:this.el.buffered.start(r),end:this.el.buffered.end(r)}]),this.el.currentTime>=e[r].start&&this.el.currentTime<=e[r].end&&(t=r);var n={start:e[t].start,current:e[t].end,total:this.el.duration};this.trigger(P.PLAYBACK_PROGRESS,n,e)}}},{key:"_typeFor",value:function(e){var t=l._mimeTypesForUrl(e,Rr,this.options.mimeType);return((t=0===t.length?l._mimeTypesForUrl(e,wr,this.options.mimeType):t)[0]||"").split(";")[0]}},{key:"_ready",value:function(){this._isReadyState||(this._isReadyState=!0,this.trigger(P.PLAYBACK_READY,this.name))}},{key:"_checkForClosedCaptions",value:function(){var e;this.isHTML5Video&&!this._ccIsSetup&&(this.hasClosedCaptionsTracks&&(this.trigger(P.PLAYBACK_SUBTITLE_AVAILABLE),e=this.closedCaptionsTrackId,this.closedCaptionsTrackId=e,this.handleTextTrackChange=this._handleTextTrackChange.bind(this),this.el.textTracks.addEventListener("change",this.handleTextTrackChange)),this._ccIsSetup=!0)}},{key:"_handleTextTrackChange",value:function(){var e=this.closedCaptionsTracks.find(function(e){return"showing"===e.track.mode})||{id:-1};this._ccTrackId!==e.id&&(this._ccTrackId=e.id,this.trigger(P.PLAYBACK_SUBTITLE_CHANGED,{id:e.id}))}},{key:"render",value:function(){this.options.playback.disableContextMenu&&this.$el.on("contextmenu",function(){return!1}),this._externalTracks&&0<this._externalTracks.length&&this.$el.html(this.template({tracks:this._externalTracks})),this._ready();var e=dr.getStyleFor("[data-html5-video] {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  display: block; }\n".toString(),{baseUrl:this.options.baseUrl});return this.$el.append(e[0]),this}},{key:"isReady",get:function(){return this._isReadyState}},{key:"isHTML5Video",get:function(){return this.name===l.prototype.name}},{key:"closedCaptionsTracks",get:function(){var t=0;return(this.el.textTracks?Array.from(this.el.textTracks):[]).filter(function(e){return"subtitles"===e.kind||"captions"===e.kind}).map(function(e){return{id:t++,name:e.label,track:e}})}},{key:"closedCaptionsTrackId",get:function(){return this._ccTrackId},set:function(t){if(jt(t)){var e,r=this.closedCaptionsTracks;if(-1!==t){if(!(e=r.find(function(e){return e.id===t})))return;if("showing"===e.track.mode)return}r.filter(function(e){return"hidden"!==e.track.mode}).forEach(function(e){return e.track.mode="hidden"}),e&&(e.track.mode="showing"),this._ccTrackId=t,this.trigger(P.PLAYBACK_SUBTITLE_CHANGED,{id:t})}}},{key:"template",get:function(){return $t('<% for (var i = 0; i < tracks.length; i++) { %>\n  <track data-html5-video-track="<%= i %>" kind="<%= tracks[i].kind %>" label="<%= tracks[i].label %>" srclang="<%= tracks[i].lang %>" src="<%= tracks[i].src %>">\n<% }; %>\n')}}]),l}(),e=(M._mimeTypesForUrl=function(e,t,r){e=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],r=r||e&&t[e.toLowerCase()]||[];return r.constructor===Array?r:[r]},M._canPlay=function(e,t,r,n){var r=M._mimeTypesForUrl(r,t,n),i=document.createElement(e);return!!r.filter(function(e){return!!i.canPlayType(e).replace(/no/,"")})[0]},M.canPlay=function(e,t){return M._canPlay("audio",wr,e,t)||M._canPlay("video",Rr,e,t)},function(){c(t,M);var e=d(t);function t(){return u(this,t),e.apply(this,arguments)}return s(t,[{key:"updateSettings",value:function(){this.settings.left=["playpause","position","duration"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(P.PLAYBACK_SETTINGSUPDATE)}},{key:"getPlaybackType",value:function(){return x.AOD}},{key:"name",get:function(){return"html5_audio"}},{key:"supportedVersion",get:function(){return{min:"0.4.19"}}},{key:"tagName",get:function(){return"audio"}},{key:"isAudioOnly",get:function(){return!0}}]),t}()),t=(e.canPlay=function(e,t){return M._canPlay("audio",{wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},e,t)},function(){c(n,x);var r=d(n);function n(e){var t;return u(this,n),(t=r.call(this,e)).el.src=e.src,t}return s(n,[{key:"getPlaybackType",value:function(){return x.NO_OP}},{key:"name",get:function(){return"html_img"}},{key:"supportedVersion",get:function(){return{min:"0.4.19"}}},{key:"tagName",get:function(){return"img"}},{key:"attributes",get:function(){return{"data-html-img":""}}},{key:"events",get:function(){return{load:"_onLoad",abort:"_onError",error:"_onError"}}}]),s(n,[{key:"render",value:function(){var e=dr.getStyleFor("[data-html-img] {\n  max-width: 100%;\n  max-height: 100%; }\n".toString(),{baseUrl:this.options.baseUrl});return this.$el.append(e[0]),this.trigger(P.PLAYBACK_READY,this.name),this}},{key:"_onLoad",value:function(){this.trigger(P.PLAYBACK_ENDED,this.name)}},{key:"_onError",value:function(e){e="error"===e.type?"load error":"loading aborted";this.trigger(P.PLAYBACK_ERROR,{message:e},this.name)}}]),n}()),Ir=(t.canPlay=function(e){return/\.(png|jpg|jpeg|gif|bmp|tiff|pgm|pnm|webp)(|\?.*)$/i.test(e)},function(){c(a,x);var i=d(a);function a(){var e;u(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=i.call.apply(i,[this].concat(r)))._noiseFrameNum=-1,e}return s(a,[{key:"name",get:function(){return"no_op"}},{key:"supportedVersion",get:function(){return{min:"0.4.19"}}},{key:"template",get:function(){return $t("<canvas data-no-op-canvas></canvas>\n<p data-no-op-msg><%=message%></p><p>\n</p>")}},{key:"attributes",get:function(){return{"data-no-op":""}}}]),s(a,[{key:"render",value:function(){var e=this.options.playbackNotSupportedMessage||this.i18n.t("playback_not_supported"),t=dr.getStyleFor("[data-no-op] {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  text-align: center; }\n\n[data-no-op] p[data-no-op-msg] {\n  position: absolute;\n  text-align: center;\n  font-size: 25px;\n  left: 0;\n  right: 0;\n  color: white;\n  padding: 10px;\n  /* center vertically */\n  top: 50%;\n  transform: translateY(-50%);\n  max-height: 100%;\n  overflow: auto; }\n\n[data-no-op] canvas[data-no-op-canvas] {\n  background-color: #777;\n  height: 100%;\n  width: 100%; }\n".toString(),{baseUrl:this.options.baseUrl}),t=(this.$el.append(t[0]),this.$el.html(this.template({message:e})),this.trigger(P.PLAYBACK_READY,this.name),!(!this.options.poster||!this.options.poster.showForNoOp));return!this.options.autoPlay&&t||this._animate(),this}},{key:"_noise",value:function(){if(this._noiseFrameNum=(this._noiseFrameNum+1)%5,!this._noiseFrameNum){var t=this.context.createImageData(this.context.canvas.width,this.context.canvas.height);try{r=new Uint32Array(t.data.buffer)}catch(e){for(var r=new Uint32Array(this.context.canvas.width*this.context.canvas.height*4),n=t.data,i=0;i<n.length;i++)r[i]=n[i]}for(var e=r.length,a=6*Math.random()+4,s=0,o=0,l=0;l<e;)s<0&&(s=a*Math.random(),o=255*Math.pow(Math.random(),.4)<<24),--s,r[l++]=o;this.context.putImageData(t,0,0)}}},{key:"_loop",value:function(){var e=this;this._stop||(this._noise(),this._animationHandle=Dt(function(){return e._loop()}))}},{key:"destroy",value:function(){this._animationHandle&&(Pt(this._animationHandle),this._stop=!0)}},{key:"_animate",value:function(){this.canvas=this.$el.find("canvas[data-no-op-canvas]")[0],this.context=this.canvas.getContext("2d"),this._loop()}}]),a}()),Dr=(Ir.canPlay=function(e){return!0},function(){c(r,Sr);var t=d(r);function r(e){return u(this,r),(e=t.call(this,e))._initializeMessages(),e}return s(r,[{key:"name",get:function(){return"strings"}},{key:"supportedVersion",get:function(){return{min:"0.4.19"}}}]),s(r,[{key:"t",value:function(e){var t=this._language(),r=this._messages.en;return(t&&this._messages[t]||r)[e]||r[e]||e}},{key:"_language",value:function(){return this.core.options.language||Gt()}},{key:"_initializeMessages",value:function(){this._messages=O.extend(!0,{en:{live:"live",back_to_live:"back to live",disabled:"Disabled",playback_not_supported:"Your browser does not support the playback of this video. Please try using a different browser.",default_error_title:"Could not play video.",default_error_message:"There was a problem trying to load the video."},de:{live:"Live",back_to_live:"Zurück zum Live-Video",disabled:"Deaktiviert",playback_not_supported:"Ihr Browser unterstützt das Playback Verfahren nicht. Bitte vesuchen Sie es mit einem anderen Browser.",default_error_title:"Video kann nicht abgespielt werden",default_error_message:"Es gab ein Problem beim Laden des Videos"},pt:{live:"ao vivo",back_to_live:"voltar para o ao vivo",disabled:"Desativado",playback_not_supported:"Seu navegador não supporta a reprodução deste video. Por favor, tente usar um navegador diferente.",default_error_title:"Não foi possível reproduzir o vídeo.",default_error_message:"Ocorreu um problema ao tentar carregar o vídeo."},es:{live:"vivo",back_to_live:"volver en vivo",disabled:"Discapacitado",playback_not_supported:"Su navegador no soporta la reproducción de un video. Por favor, trate de usar un navegador diferente."},ru:{live:"прямой эфир",back_to_live:"к прямому эфиру",disabled:"Отключено",playback_not_supported:"Ваш браузер не поддерживает воспроизведение этого видео. Пожалуйста, попробуйте другой браузер."},fr:{live:"en direct",back_to_live:"retour au direct",disabled:"Désactivé",playback_not_supported:"Votre navigateur ne supporte pas la lecture de cette vidéo. Merci de tenter sur un autre navigateur.",default_error_title:"Impossible de lire la vidéo.",default_error_message:"Un problème est survenu lors du chargement de la vidéo."},tr:{live:"canlı",back_to_live:"canlı yayına dön",disabled:"Engelli",playback_not_supported:"Tarayıcınız bu videoyu oynatma desteğine sahip değil. Lütfen farklı bir tarayıcı ile deneyin."},et:{live:"Otseülekanne",back_to_live:"Tagasi otseülekande juurde",disabled:"Keelatud",playback_not_supported:"Teie brauser ei toeta selle video taasesitust. Proovige kasutada muud brauserit."},ar:{live:"مباشر",back_to_live:"الرجوع إلى المباشر",disabled:"معطّل",playback_not_supported:"المتصفح الذي تستخدمه لا يدعم تشغيل هذا الفيديو. الرجاء إستخدام متصفح آخر.",default_error_title:"غير قادر الى التشغيل.",default_error_message:"حدثت مشكلة أثناء تحميل الفيديو."}},this.core.options.strings||{}),this._messages["de-DE"]=this._messages.de,this._messages["pt-BR"]=this._messages.pt,this._messages["en-US"]=this._messages.en,this._messages["es-419"]=this._messages.es,this._messages["fr-FR"]=this._messages.fr,this._messages["tr-TR"]=this._messages.tr,this._messages["et-EE"]=this._messages.et,this._messages["ar-IQ"]=this._messages.ar}}]),r}()),Pr=function(){c(t,Sr);var e=d(t);function t(){return u(this,t),e.apply(this,arguments)}return s(t,[{key:"bindEvents",value:function(){this.listenTo(this.core,P.CORE_CONTAINERS_CREATED,this.onContainersCreated)}},{key:"onContainersCreated",value:function(){var t=this.core.containers.filter(function(e){return"no_op"!==e.playback.name})[0]||this.core.containers[0];t&&this.core.containers.forEach(function(e){e!==t&&e.destroy()})}},{key:"name",get:function(){return"sources"}},{key:"supportedVersion",get:function(){return{min:"0.4.19"}}}]),t}();kr.registerPlugin(Dr),kr.registerPlugin(Pr),kr.registerPlayback(Ir),kr.registerPlayback(t),kr.registerPlayback(e),kr.registerPlayback(M)},89:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#010101" d="M1.425.35L14.575 8l-13.15 7.65V.35z"></path></svg>'}}]);